\hypertarget{a00059}{
\section{The u\-IP TCP/IP stack}
\label{a00059}\index{The uIP TCP/IP stack@{The uIP TCP/IP stack}}
}


Collaboration diagram for The u\-IP TCP/IP stack:

\subsection*{Files}
\begin{CompactItemize}
\item 
file \hyperlink{a00054}{uip.h}
\begin{CompactList}\small\item\em Header file for the u\-IP TCP/IP stack. \item\end{CompactList}

\item 
file \hyperlink{a00053}{uip.c}
\begin{CompactList}\small\item\em The u\-IP TCP/IP stack code. \item\end{CompactList}

\end{CompactItemize}
\subsection*{Modules}
\begin{CompactItemize}
\item 
\hyperlink{a00061}{u\-IP configuration functions}
\begin{CompactList}\small\item\em The u\-IP configuration functions are used for setting run-time parameters in u\-IP such as IP addresses. \item\end{CompactList}

\item 
\hyperlink{a00062}{u\-IP initialization functions}
\begin{CompactList}\small\item\em The u\-IP initialization functions are used for booting u\-IP. \item\end{CompactList}

\item 
\hyperlink{a00063}{u\-IP device driver functions}
\begin{CompactList}\small\item\em These functions are used by a network device driver for interacting with u\-IP. \item\end{CompactList}

\item 
\hyperlink{a00064}{u\-IP application functions}
\begin{CompactList}\small\item\em Functions used by an application running of top of u\-IP. \item\end{CompactList}

\item 
\hyperlink{a00065}{u\-IP conversion functions}
\begin{CompactList}\small\item\em These functions can be used for converting between different data formats used by u\-IP. \item\end{CompactList}

\item 
\hyperlink{a00067}{u\-IP Address Resolution Protocol}
\begin{CompactList}\small\item\em The Address Resolution Protocol ARP is used for mapping between IP addresses and link level addresses such as the Ethernet MAC addresses. \item\end{CompactList}

\item 
\hyperlink{a00068}{Serial Line IP (SLIP) protocol}
\begin{CompactList}\small\item\em The SLIP protocol is a very simple way to transmit IP packets over a serial line. \item\end{CompactList}

\item 
\hyperlink{a00083}{u\-IP hostname resolver functions}
\begin{CompactList}\small\item\em The u\-IP DNS resolver functions are used to lookup a hostname and map it to a numerical IP address. \item\end{CompactList}

\item 
\hyperlink{a00066}{Architecture specific u\-IP functions}
\begin{CompactList}\small\item\em The functions in the architecture specific module implement the IP check sum and 32-bit additions. \item\end{CompactList}

\end{CompactItemize}
\subsection*{Data Structures}
\begin{CompactItemize}
\item 
struct \hyperlink{a00028}{uip\_\-conn}
\begin{CompactList}\small\item\em Representation of a u\-IP TCP connection. \item\end{CompactList}\item 
struct \hyperlink{a00032}{uip\_\-udp\_\-conn}
\begin{CompactList}\small\item\em Representation of a u\-IP UDP connection. \item\end{CompactList}\item 
struct \hyperlink{a00031}{uip\_\-stats}
\begin{CompactList}\small\item\em The structure holding the TCP/IP statistics that are gathered if UIP\_\-STATISTICS is set to 1. \item\end{CompactList}\end{CompactItemize}
\subsection*{Functions}
\begin{CompactItemize}
\item 
void \hyperlink{a00059_gc48ed5f0d27721ef62a3ed02a5ad8d2e}{uip\_\-init} (void)
\begin{CompactList}\small\item\em u\-IP initialization function. \item\end{CompactList}\item 
\hyperlink{a00032}{uip\_\-udp\_\-conn} $\ast$ \hyperlink{a00059_g527ff0e535266167077b06d3a4742822}{uip\_\-udp\_\-new} (\hyperlink{a00070_gfc6499c1f28697aa3bfc2804d496fd11}{u16\_\-t} $\ast$ripaddr, \hyperlink{a00070_gfc6499c1f28697aa3bfc2804d496fd11}{u16\_\-t} rport)
\begin{CompactList}\small\item\em Set up a new UDP connection. \item\end{CompactList}\item 
void \hyperlink{a00059_gaa585784b0914cac1d37f07f85457008}{uip\_\-unlisten} (\hyperlink{a00070_gfc6499c1f28697aa3bfc2804d496fd11}{u16\_\-t} port)
\begin{CompactList}\small\item\em Stop listening to the specified port. \item\end{CompactList}\item 
void \hyperlink{a00059_gdd1ab3704ecd4900eec61a6897d32dc8}{uip\_\-listen} (\hyperlink{a00070_gfc6499c1f28697aa3bfc2804d496fd11}{u16\_\-t} port)
\begin{CompactList}\small\item\em Start listening to the specified port. \item\end{CompactList}\item 
\hyperlink{a00070_gfc6499c1f28697aa3bfc2804d496fd11}{u16\_\-t} \hyperlink{a00059_ga22b04cac8cf283ca12f028578bebc06}{htons} (\hyperlink{a00070_gfc6499c1f28697aa3bfc2804d496fd11}{u16\_\-t} val)
\begin{CompactList}\small\item\em Convert 16-bit quantity from host byte order to network byte order. \item\end{CompactList}\end{CompactItemize}
\subsection*{Variables}
\begin{CompactItemize}
\item 
volatile \hyperlink{a00070_ge081489b4906f65a3cb18e9fbe9f8d23}{u8\_\-t} $\ast$ \hyperlink{a00059_ge71ae1aa130be22a5f028e76d8d1e31e}{uip\_\-appdata}
\begin{CompactList}\small\item\em Pointer to the application data in the packet buffer. \item\end{CompactList}\item 
\hyperlink{a00031}{uip\_\-stats} \hyperlink{a00059_g9ee50a40597e67fce96541ab56c3b712}{uip\_\-stat}
\begin{CompactList}\small\item\em The u\-IP TCP/IP statistics. \item\end{CompactList}\item 
\hyperlink{a00070_ge081489b4906f65a3cb18e9fbe9f8d23}{u8\_\-t} \hyperlink{a00059_gb81e78f890dbbee50c533a9734b74fd9}{uip\_\-buf} \mbox{[}UIP\_\-BUFSIZE+2\mbox{]}
\begin{CompactList}\small\item\em The u\-IP packet buffer. \item\end{CompactList}\item 
volatile \hyperlink{a00070_ge081489b4906f65a3cb18e9fbe9f8d23}{u8\_\-t} $\ast$ \hyperlink{a00059_ge71ae1aa130be22a5f028e76d8d1e31e}{uip\_\-appdata}
\begin{CompactList}\small\item\em Pointer to the application data in the packet buffer. \item\end{CompactList}\item 
\hypertarget{a00059_g838108341703d67d15fc09e0808c2561}{
volatile \hyperlink{a00070_ge081489b4906f65a3cb18e9fbe9f8d23}{u8\_\-t} \hyperlink{a00059_g838108341703d67d15fc09e0808c2561}{uip\_\-acc32} \mbox{[}4\mbox{]}}
\label{a00059_g838108341703d67d15fc09e0808c2561}

\begin{CompactList}\small\item\em 4-byte array used for the 32-bit sequence number calculations. \item\end{CompactList}\end{CompactItemize}


\subsection{Function Documentation}
\hypertarget{a00059_ga22b04cac8cf283ca12f028578bebc06}{
\index{uip@{uip}!htons@{htons}}
\index{htons@{htons}!uip@{uip}}
\subsubsection[htons]{\setlength{\rightskip}{0pt plus 5cm}\hyperlink{a00070_gfc6499c1f28697aa3bfc2804d496fd11}{u16\_\-t} htons (\hyperlink{a00070_gfc6499c1f28697aa3bfc2804d496fd11}{u16\_\-t} {\em val})}}
\label{a00059_ga22b04cac8cf283ca12f028578bebc06}


Convert 16-bit quantity from host byte order to network byte order. 

This function is primarily used for converting variables from host byte order to network byte order. For converting constants to network byte order, use the \hyperlink{a00065_g69a7a4951ff21b302267532c21ee78fc}{HTONS()} macro instead. \hypertarget{a00059_gc48ed5f0d27721ef62a3ed02a5ad8d2e}{
\index{uip@{uip}!uip_init@{uip\_\-init}}
\index{uip_init@{uip\_\-init}!uip@{uip}}
\subsubsection[uip\_\-init]{\setlength{\rightskip}{0pt plus 5cm}void uip\_\-init (void)}}
\label{a00059_gc48ed5f0d27721ef62a3ed02a5ad8d2e}


u\-IP initialization function. 

This function should be called at boot up to initilize the u\-IP TCP/IP stack. \hypertarget{a00059_gdd1ab3704ecd4900eec61a6897d32dc8}{
\index{uip@{uip}!uip_listen@{uip\_\-listen}}
\index{uip_listen@{uip\_\-listen}!uip@{uip}}
\subsubsection[uip\_\-listen]{\setlength{\rightskip}{0pt plus 5cm}void uip\_\-listen (\hyperlink{a00070_gfc6499c1f28697aa3bfc2804d496fd11}{u16\_\-t} {\em port})}}
\label{a00059_gdd1ab3704ecd4900eec61a6897d32dc8}


Start listening to the specified port. 

\begin{Desc}
\item[Note:]Since this function expects the port number in network byte order, a conversion using \hyperlink{a00065_g69a7a4951ff21b302267532c21ee78fc}{HTONS()} or \hyperlink{a00065_ga22b04cac8cf283ca12f028578bebc06}{htons()} is necessary.\end{Desc}


\footnotesize\begin{verbatim} uip_listen(HTONS(80)); 
\end{verbatim}
\normalsize


\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em port}]A 16-bit port number in network byte order. \end{description}
\end{Desc}
\hypertarget{a00059_g527ff0e535266167077b06d3a4742822}{
\index{uip@{uip}!uip_udp_new@{uip\_\-udp\_\-new}}
\index{uip_udp_new@{uip\_\-udp\_\-new}!uip@{uip}}
\subsubsection[uip\_\-udp\_\-new]{\setlength{\rightskip}{0pt plus 5cm}struct \hyperlink{a00032}{uip\_\-udp\_\-conn}$\ast$ uip\_\-udp\_\-new (\hyperlink{a00070_gfc6499c1f28697aa3bfc2804d496fd11}{u16\_\-t} $\ast$ {\em ripaddr}, \hyperlink{a00070_gfc6499c1f28697aa3bfc2804d496fd11}{u16\_\-t} {\em rport})}}
\label{a00059_g527ff0e535266167077b06d3a4742822}


Set up a new UDP connection. 

\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em ripaddr}]A pointer to a 4-byte structure representing the IP address of the remote host.\item[{\em rport}]The remote port number in network byte order.\end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]The \hyperlink{a00032}{uip\_\-udp\_\-conn} structure for the new connection or NULL if no connection could be allocated. \end{Desc}
\hypertarget{a00059_gaa585784b0914cac1d37f07f85457008}{
\index{uip@{uip}!uip_unlisten@{uip\_\-unlisten}}
\index{uip_unlisten@{uip\_\-unlisten}!uip@{uip}}
\subsubsection[uip\_\-unlisten]{\setlength{\rightskip}{0pt plus 5cm}void uip\_\-unlisten (\hyperlink{a00070_gfc6499c1f28697aa3bfc2804d496fd11}{u16\_\-t} {\em port})}}
\label{a00059_gaa585784b0914cac1d37f07f85457008}


Stop listening to the specified port. 

\begin{Desc}
\item[Note:]Since this function expects the port number in network byte order, a conversion using \hyperlink{a00065_g69a7a4951ff21b302267532c21ee78fc}{HTONS()} or \hyperlink{a00065_ga22b04cac8cf283ca12f028578bebc06}{htons()} is necessary.\end{Desc}


\footnotesize\begin{verbatim} uip_unlisten(HTONS(80)); 
\end{verbatim}
\normalsize


\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em port}]A 16-bit port number in network byte order. \end{description}
\end{Desc}


\subsection{Variable Documentation}
\hypertarget{a00059_ge71ae1aa130be22a5f028e76d8d1e31e}{
\index{uip@{uip}!uip_appdata@{uip\_\-appdata}}
\index{uip_appdata@{uip\_\-appdata}!uip@{uip}}
\subsubsection[uip\_\-appdata]{\setlength{\rightskip}{0pt plus 5cm}volatile \hyperlink{a00070_ge081489b4906f65a3cb18e9fbe9f8d23}{u8\_\-t}$\ast$ \hyperlink{a00059_ge71ae1aa130be22a5f028e76d8d1e31e}{uip\_\-appdata}}}
\label{a00059_ge71ae1aa130be22a5f028e76d8d1e31e}


Pointer to the application data in the packet buffer. 

This pointer points to the application data when the application is called. If the application wishes to send data, the application may use this space to write the data into before calling \hyperlink{a00064_gb59415b2801e568f52bc1d86ef10e159}{uip\_\-send()}. \hypertarget{a00059_ge71ae1aa130be22a5f028e76d8d1e31e}{
\index{uip@{uip}!uip_appdata@{uip\_\-appdata}}
\index{uip_appdata@{uip\_\-appdata}!uip@{uip}}
\subsubsection[uip\_\-appdata]{\setlength{\rightskip}{0pt plus 5cm}volatile \hyperlink{a00070_ge081489b4906f65a3cb18e9fbe9f8d23}{u8\_\-t}$\ast$ \hyperlink{a00059_ge71ae1aa130be22a5f028e76d8d1e31e}{uip\_\-appdata}}}
\label{a00059_ge71ae1aa130be22a5f028e76d8d1e31e}


Pointer to the application data in the packet buffer. 

This pointer points to the application data when the application is called. If the application wishes to send data, the application may use this space to write the data into before calling \hyperlink{a00064_gb59415b2801e568f52bc1d86ef10e159}{uip\_\-send()}. \hypertarget{a00059_gb81e78f890dbbee50c533a9734b74fd9}{
\index{uip@{uip}!uip_buf@{uip\_\-buf}}
\index{uip_buf@{uip\_\-buf}!uip@{uip}}
\subsubsection[uip\_\-buf]{\setlength{\rightskip}{0pt plus 5cm}\hyperlink{a00070_ge081489b4906f65a3cb18e9fbe9f8d23}{u8\_\-t} \hyperlink{a00059_gb81e78f890dbbee50c533a9734b74fd9}{uip\_\-buf}\mbox{[}UIP\_\-BUFSIZE+2\mbox{]}}}
\label{a00059_gb81e78f890dbbee50c533a9734b74fd9}


The u\-IP packet buffer. 

The uip\_\-buf array is used to hold incoming and outgoing packets. The device driver should place incoming data into this buffer. When sending data, the device driver should read the link level headers and the TCP/IP headers from this buffer. The size of the link level headers is configured by the UIP\_\-LLH\_\-LEN define.

\begin{Desc}
\item[Note:]The application data need not be placed in this buffer, so the device driver must read it from the place pointed to by the uip\_\-appdata pointer as illustrated by the following example: 

\footnotesize\begin{verbatim} void
 devicedriver_send(void)
 {
    hwsend(&uip_buf[0], UIP_LLH_LEN);
    hwsend(&uip_buf[UIP_LLH_LEN], 40);
    hwsend(uip_appdata, uip_len - 40 - UIP_LLH_LEN);
 }
\end{verbatim}
\normalsize
 \end{Desc}
\hypertarget{a00059_g9ee50a40597e67fce96541ab56c3b712}{
\index{uip@{uip}!uip_stat@{uip\_\-stat}}
\index{uip_stat@{uip\_\-stat}!uip@{uip}}
\subsubsection[uip\_\-stat]{\setlength{\rightskip}{0pt plus 5cm}struct \hyperlink{a00031}{uip\_\-stats} \hyperlink{a00059_g9ee50a40597e67fce96541ab56c3b712}{uip\_\-stat}}}
\label{a00059_g9ee50a40597e67fce96541ab56c3b712}


The u\-IP TCP/IP statistics. 

This is the variable in which the u\-IP TCP/IP statistics are gathered. 