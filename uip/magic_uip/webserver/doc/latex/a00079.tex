\hypertarget{a00079}{
\section{Web client}
\label{a00079}\index{Web client@{Web client}}
}


Collaboration diagram for Web client:

\subsection{Detailed Description}
This example shows a HTTP client that is able to download web pages and files from web servers. 

It requires a number of callback functions to be implemented by the module that utilizes the code: \hyperlink{a00079_gc4b119801e50cc1824498a1cdf9adc37}{webclient\_\-datahandler()}, \hyperlink{a00079_g6b942c1ef22f8cd1a726ef3364c9fbea}{webclient\_\-connected()}, \hyperlink{a00079_g23705efb9077187881f094fc9be13bde}{webclient\_\-timedout()}, \hyperlink{a00079_gf11d9915ec12a8cdd9fdcbb5e8fcd5c7}{webclient\_\-aborted()}, \hyperlink{a00079_gf8f12c820cc08da32aa62898bfc02db3}{webclient\_\-closed()}. 

\subsection*{Files}
\begin{CompactItemize}
\item 
file \hyperlink{a00049}{webclient.h}
\begin{CompactList}\small\item\em Header file for the HTTP client. \item\end{CompactList}

\item 
file \hyperlink{a00048}{webclient.c}
\begin{CompactList}\small\item\em Implementation of the HTTP client. \item\end{CompactList}

\end{CompactItemize}
\subsection*{Functions}
\begin{CompactItemize}
\item 
void \hyperlink{a00079_gc4b119801e50cc1824498a1cdf9adc37}{webclient\_\-datahandler} (char $\ast$data, \hyperlink{a00070_gfc6499c1f28697aa3bfc2804d496fd11}{u16\_\-t} len)
\begin{CompactList}\small\item\em Callback function that is called from the webclient code when HTTP data has been received. \item\end{CompactList}\item 
void \hyperlink{a00079_g6b942c1ef22f8cd1a726ef3364c9fbea}{webclient\_\-connected} (void)
\begin{CompactList}\small\item\em Callback function that is called from the webclient code when the HTTP connection has been connected to the web server. \item\end{CompactList}\item 
void \hyperlink{a00079_g23705efb9077187881f094fc9be13bde}{webclient\_\-timedout} (void)
\begin{CompactList}\small\item\em Callback function that is called from the webclient code if the HTTP connection to the web server has timed out. \item\end{CompactList}\item 
void \hyperlink{a00079_gf11d9915ec12a8cdd9fdcbb5e8fcd5c7}{webclient\_\-aborted} (void)
\begin{CompactList}\small\item\em Callback function that is called from the webclient code if the HTTP connection to the web server has been aborted by the web server. \item\end{CompactList}\item 
void \hyperlink{a00079_gf8f12c820cc08da32aa62898bfc02db3}{webclient\_\-closed} (void)
\begin{CompactList}\small\item\em Callback function that is called from the webclient code when the HTTP connection to the web server has been closed. \item\end{CompactList}\item 
\hypertarget{a00079_g3caacabb2fe1c71921e1a471719ccbd2}{
void \hyperlink{a00079_g3caacabb2fe1c71921e1a471719ccbd2}{webclient\_\-init} (void)}
\label{a00079_g3caacabb2fe1c71921e1a471719ccbd2}

\begin{CompactList}\small\item\em Initialize the webclient module. \item\end{CompactList}\item 
unsigned char \hyperlink{a00079_gf9385ef9ecc74c7d53ff2f15e62bfde3}{webclient\_\-get} (char $\ast$host, \hyperlink{a00070_gfc6499c1f28697aa3bfc2804d496fd11}{u16\_\-t} port, char $\ast$file)
\begin{CompactList}\small\item\em Open an HTTP connection to a web server and ask for a file using the GET method. \item\end{CompactList}\item 
\hypertarget{a00079_g1d34be506a61db90dd7829117efdf8cf}{
void \hyperlink{a00079_g1d34be506a61db90dd7829117efdf8cf}{webclient\_\-close} (void)}
\label{a00079_g1d34be506a61db90dd7829117efdf8cf}

\begin{CompactList}\small\item\em Close the currently open HTTP connection. \item\end{CompactList}\item 
char $\ast$ \hyperlink{a00079_g4433d3af16ea083a81576d0f18ba57c9}{webclient\_\-mimetype} (void)
\begin{CompactList}\small\item\em Obtain the MIME type of the current HTTP data stream. \item\end{CompactList}\item 
char $\ast$ \hyperlink{a00079_g41e616d3fcc17e0aabfe8ab45ef0d30f}{webclient\_\-filename} (void)
\begin{CompactList}\small\item\em Obtain the filename of the current HTTP data stream. \item\end{CompactList}\item 
char $\ast$ \hyperlink{a00079_g0e0ea5f24b77f124ba33bcbc7ede5bfb}{webclient\_\-hostname} (void)
\begin{CompactList}\small\item\em Obtain the hostname of the current HTTP data stream. \item\end{CompactList}\item 
unsigned short \hyperlink{a00079_g2a939aa4fcffabbce1dc1f784a7e0ad3}{webclient\_\-port} (void)
\begin{CompactList}\small\item\em Obtain the port number of the current HTTP data stream. \item\end{CompactList}\end{CompactItemize}


\subsection{Function Documentation}
\hypertarget{a00079_gf11d9915ec12a8cdd9fdcbb5e8fcd5c7}{
\index{webclient@{webclient}!webclient_aborted@{webclient\_\-aborted}}
\index{webclient_aborted@{webclient\_\-aborted}!webclient@{webclient}}
\subsubsection[webclient\_\-aborted]{\setlength{\rightskip}{0pt plus 5cm}void webclient\_\-aborted (void)}}
\label{a00079_gf11d9915ec12a8cdd9fdcbb5e8fcd5c7}


Callback function that is called from the webclient code if the HTTP connection to the web server has been aborted by the web server. 

This function must be implemented by the module that uses the webclient code. \hypertarget{a00079_gf8f12c820cc08da32aa62898bfc02db3}{
\index{webclient@{webclient}!webclient_closed@{webclient\_\-closed}}
\index{webclient_closed@{webclient\_\-closed}!webclient@{webclient}}
\subsubsection[webclient\_\-closed]{\setlength{\rightskip}{0pt plus 5cm}void webclient\_\-closed (void)}}
\label{a00079_gf8f12c820cc08da32aa62898bfc02db3}


Callback function that is called from the webclient code when the HTTP connection to the web server has been closed. 

This function must be implemented by the module that uses the webclient code. \hypertarget{a00079_g6b942c1ef22f8cd1a726ef3364c9fbea}{
\index{webclient@{webclient}!webclient_connected@{webclient\_\-connected}}
\index{webclient_connected@{webclient\_\-connected}!webclient@{webclient}}
\subsubsection[webclient\_\-connected]{\setlength{\rightskip}{0pt plus 5cm}void webclient\_\-connected (void)}}
\label{a00079_g6b942c1ef22f8cd1a726ef3364c9fbea}


Callback function that is called from the webclient code when the HTTP connection has been connected to the web server. 

This function must be implemented by the module that uses the webclient code. \hypertarget{a00079_gc4b119801e50cc1824498a1cdf9adc37}{
\index{webclient@{webclient}!webclient_datahandler@{webclient\_\-datahandler}}
\index{webclient_datahandler@{webclient\_\-datahandler}!webclient@{webclient}}
\subsubsection[webclient\_\-datahandler]{\setlength{\rightskip}{0pt plus 5cm}void webclient\_\-datahandler (char $\ast$ {\em data}, \hyperlink{a00070_gfc6499c1f28697aa3bfc2804d496fd11}{u16\_\-t} {\em len})}}
\label{a00079_gc4b119801e50cc1824498a1cdf9adc37}


Callback function that is called from the webclient code when HTTP data has been received. 

This function must be implemented by the module that uses the webclient code. The function is called from the webclient module when HTTP data has been received. The function is not called when HTTP headers are received, only for the actual data.

\begin{Desc}
\item[Note:]This function is called many times, repetedly, when data is being received, and not once when all data has been received.\end{Desc}
\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em data}]A pointer to the data that has been received. \item[{\em len}]The length of the data that has been received. \end{description}
\end{Desc}
\hypertarget{a00079_g41e616d3fcc17e0aabfe8ab45ef0d30f}{
\index{webclient@{webclient}!webclient_filename@{webclient\_\-filename}}
\index{webclient_filename@{webclient\_\-filename}!webclient@{webclient}}
\subsubsection[webclient\_\-filename]{\setlength{\rightskip}{0pt plus 5cm}char $\ast$ webclient\_\-filename (void)}}
\label{a00079_g41e616d3fcc17e0aabfe8ab45ef0d30f}


Obtain the filename of the current HTTP data stream. 

The filename of an HTTP request may be changed by the web server, and may therefore not be the same as when the original GET request was made with \hyperlink{a00079_gf9385ef9ecc74c7d53ff2f15e62bfde3}{webclient\_\-get()}. This function is used for obtaining the current filename.

\begin{Desc}
\item[Returns:]A pointer to the current filename. \end{Desc}
\hypertarget{a00079_gf9385ef9ecc74c7d53ff2f15e62bfde3}{
\index{webclient@{webclient}!webclient_get@{webclient\_\-get}}
\index{webclient_get@{webclient\_\-get}!webclient@{webclient}}
\subsubsection[webclient\_\-get]{\setlength{\rightskip}{0pt plus 5cm}unsigned char webclient\_\-get (char $\ast$ {\em host}, \hyperlink{a00070_gfc6499c1f28697aa3bfc2804d496fd11}{u16\_\-t} {\em port}, char $\ast$ {\em file})}}
\label{a00079_gf9385ef9ecc74c7d53ff2f15e62bfde3}


Open an HTTP connection to a web server and ask for a file using the GET method. 

This function opens an HTTP connection to the specified web server and requests the specified file using the GET method. When the HTTP connection has been connected, the \hyperlink{a00079_g6b942c1ef22f8cd1a726ef3364c9fbea}{webclient\_\-connected()} callback function is called and when the HTTP data arrives the \hyperlink{a00079_gc4b119801e50cc1824498a1cdf9adc37}{webclient\_\-datahandler()} callback function is called.

The callback function \hyperlink{a00079_g23705efb9077187881f094fc9be13bde}{webclient\_\-timedout()} is called if the web server could not be contacted, and the \hyperlink{a00079_gf11d9915ec12a8cdd9fdcbb5e8fcd5c7}{webclient\_\-aborted()} callback function is called if the HTTP connection is aborted by the web server.

When the HTTP request has been completed and the HTTP connection is closed, the \hyperlink{a00079_gf8f12c820cc08da32aa62898bfc02db3}{webclient\_\-closed()} callback function will be called.

\begin{Desc}
\item[Note:]If the function is passed a host name, it must already be in the resolver cache in order for the function to connect to the web server. It is therefore up to the calling module to implement the resolver calls and the signal handler used for reporting a resolv query answer.\end{Desc}
\begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em host}]A pointer to a string containing either a host name or a numerical IP address in dotted decimal notation (e.g., 192.168.23.1).\item[{\em port}]The port number to which to connect, in host byte order.\item[{\em file}]A pointer to the name of the file to get.\end{description}
\end{Desc}
\begin{Desc}
\item[Return values:]
\begin{description}
\item[{\em 0}]if the host name could not be found in the cache, or if a TCP connection could not be created.\item[{\em 1}]if the connection was initiated. \end{description}
\end{Desc}
\hypertarget{a00079_g0e0ea5f24b77f124ba33bcbc7ede5bfb}{
\index{webclient@{webclient}!webclient_hostname@{webclient\_\-hostname}}
\index{webclient_hostname@{webclient\_\-hostname}!webclient@{webclient}}
\subsubsection[webclient\_\-hostname]{\setlength{\rightskip}{0pt plus 5cm}char $\ast$ webclient\_\-hostname (void)}}
\label{a00079_g0e0ea5f24b77f124ba33bcbc7ede5bfb}


Obtain the hostname of the current HTTP data stream. 

The hostname of the web server of an HTTP request may be changed by the web server, and may therefore not be the same as when the original GET request was made with \hyperlink{a00079_gf9385ef9ecc74c7d53ff2f15e62bfde3}{webclient\_\-get()}. This function is used for obtaining the current hostname.

\begin{Desc}
\item[Returns:]A pointer to the current hostname. \end{Desc}
\hypertarget{a00079_g4433d3af16ea083a81576d0f18ba57c9}{
\index{webclient@{webclient}!webclient_mimetype@{webclient\_\-mimetype}}
\index{webclient_mimetype@{webclient\_\-mimetype}!webclient@{webclient}}
\subsubsection[webclient\_\-mimetype]{\setlength{\rightskip}{0pt plus 5cm}char $\ast$ webclient\_\-mimetype (void)}}
\label{a00079_g4433d3af16ea083a81576d0f18ba57c9}


Obtain the MIME type of the current HTTP data stream. 

\begin{Desc}
\item[Returns:]A pointer to a string contaning the MIME type. The string may be empty if no MIME type was reported by the web server. \end{Desc}
\hypertarget{a00079_g2a939aa4fcffabbce1dc1f784a7e0ad3}{
\index{webclient@{webclient}!webclient_port@{webclient\_\-port}}
\index{webclient_port@{webclient\_\-port}!webclient@{webclient}}
\subsubsection[webclient\_\-port]{\setlength{\rightskip}{0pt plus 5cm}unsigned short webclient\_\-port (void)}}
\label{a00079_g2a939aa4fcffabbce1dc1f784a7e0ad3}


Obtain the port number of the current HTTP data stream. 

The port number of an HTTP request may be changed by the web server, and may therefore not be the same as when the original GET request was made with \hyperlink{a00079_gf9385ef9ecc74c7d53ff2f15e62bfde3}{webclient\_\-get()}. This function is used for obtaining the current port number.

\begin{Desc}
\item[Returns:]The port number of the current HTTP data stream, in host byte order. \end{Desc}
\hypertarget{a00079_g23705efb9077187881f094fc9be13bde}{
\index{webclient@{webclient}!webclient_timedout@{webclient\_\-timedout}}
\index{webclient_timedout@{webclient\_\-timedout}!webclient@{webclient}}
\subsubsection[webclient\_\-timedout]{\setlength{\rightskip}{0pt plus 5cm}void webclient\_\-timedout (void)}}
\label{a00079_g23705efb9077187881f094fc9be13bde}


Callback function that is called from the webclient code if the HTTP connection to the web server has timed out. 

This function must be implemented by the module that uses the webclient code. 