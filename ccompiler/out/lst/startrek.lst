out/startrek.asm line 15009: Maximum number of args exceeded. ("LT. Uhura reports:\n Message from Starfleet Command:\n\n Permission to attempt crossing of galactic perimeter\n is hereby *denied*. Shut down your engines.\n\n Chief Engineer Scott reports:\n Warp Engines shut down at sector %d, %d of quadrant %d, %d.\n\n",0)
out/startrek.asm line 15051: Maximum number of args exceeded. ("\nTechnicians standing by to effect repairs to your ship;\nEstimated time to repair: %s stardates.\n Will you authorize the repair order (y/N)? ",0)
0001   0000             ; --- FILENAME: games/startrek
0002   0000             .include "lib/asm/kernel.exp"
0001+  0000             text_org    .EQU  $0400
0002+  0000             sys_bkpt         .EQU  $0000
0003+  0000             sys_rtc          .EQU  $0001
0004+  0000             sys_ide          .EQU  $0002
0005+  0000             sys_io           .EQU  $0003
0006+  0000             sys_filesystem   .EQU  $0004
0007+  0000             sys_spawn_proc   .EQU  $0005
0008+  0000             sys_list         .EQU  $0006
0009+  0000             sys_datetime     .EQU  $0007
0010+  0000             sys_reboot       .EQU  $0008
0011+  0000             sys_pause_proc   .EQU  $0009
0012+  0000             sys_resume_proc  .EQU  $000a
0013+  0000             sys_terminate_proc .EQU  $000b
0014+  0000             sys_system       .EQU  $000c
0015+  0000             sys_boot_install .EQU  $000d
0003   0000             .include "lib/asm/bios.exp"
0001+  0000             BIOS_RESET_VECTOR .EQU  $01c0
0002+  0000             IDE_buffer       .EQU  $8204
0003+  0000             boot_origin      .EQU  $8004
0004+  0000             bios_uart        .EQU  $0002
0005+  0000             bios_ide         .EQU  $0003
0004   0400             .org text_org
0005   0400             
0006   0400             ; --- BEGIN TEXT BLOCK
0007   0400             main:
0008   0400 FD 49 E0 FF   mov bp, $FFE0 ;
0009   0404 FD 47 E0 FF   mov sp, $FFE0 ; Make space for argc(2 bytes) and for 10 pointers in argv (local variables)
0010   0408             ;; intro(); 
0011   0408 07 DA 21      call intro
0012   040B             ;; new_game(); 
0013   040B 07 3B 22      call new_game
0014   040E             ;; return (0); 
0015   040E 26 00 00      mov b, $0
0016   0411 F9            leave
0017   0412 05 0B         syscall sys_terminate_proc
0018   0414             
0019   0414             strcpy:
0020   0414 F8 00 00      enter 0 ; (push bp; mov bp, sp)
0021   0417             ; $psrc 
0022   0417             ; $pdest 
0023   0417 52 04 00      sub sp, 4
0024   041A             ;; psrc = src; 
0025   041A FA FF FF      lea d, [bp + -1] ; $psrc
0026   041D DA            push d
0027   041E FA 07 00      lea d, [bp + 7] ; $src
0028   0421 2A            mov b, [d]
0029   0422 E7            pop d
0030   0423 FD 43         mov [d], b
0031   0425             ;; pdest = dest; 
0032   0425 FA FD FF      lea d, [bp + -3] ; $pdest
0033   0428 DA            push d
0034   0429 FA 05 00      lea d, [bp + 5] ; $dest
0035   042C 2A            mov b, [d]
0036   042D E7            pop d
0037   042E FD 43         mov [d], b
0038   0430             ;; while(*psrc) *pdest++ = *psrc++; 
0039   0430             _while1_cond:
0040   0430 FA FF FF      lea d, [bp + -1] ; $psrc
0041   0433 2A            mov b, [d]
0042   0434 74            mov d, b
0043   0435 32            mov bl, [d]
0044   0436 A7 00         mov bh, 0
0045   0438 C0 00 00      cmp b, 0
0046   043B C6 63 04      je _while1_exit
0047   043E             _while1_block:
0048   043E             ;; *pdest++ = *psrc++; 
0049   043E FA FD FF      lea d, [bp + -3] ; $pdest
0050   0441 2A            mov b, [d]
0051   0442 D8            push b
0052   0443 FD 77         inc b
0053   0445 FA FD FF      lea d, [bp + -3] ; $pdest
0054   0448 FD 43         mov [d], b
0055   044A E5            pop b
0056   044B D8            push b
0057   044C FA FF FF      lea d, [bp + -1] ; $psrc
0058   044F 2A            mov b, [d]
0059   0450 D8            push b
0060   0451 FD 77         inc b
0061   0453 FA FF FF      lea d, [bp + -1] ; $psrc
0062   0456 FD 43         mov [d], b
0063   0458 E5            pop b
0064   0459 74            mov d, b
0065   045A 32            mov bl, [d]
0066   045B A7 00         mov bh, 0
0067   045D E7            pop d
0068   045E FD 3E         mov [d], bl
0069   0460 0A 30 04      jmp _while1_cond
0070   0463             _while1_exit:
0071   0463             ;; *pdest = '\0'; 
0072   0463 FA FD FF      lea d, [bp + -3] ; $pdest
0073   0466 2A            mov b, [d]
0074   0467 D8            push b
0075   0468 26 00 00      mov b, $0
0076   046B E7            pop d
0077   046C FD 3E         mov [d], bl
0078   046E F9            leave
0079   046F 09            ret
0080   0470             
0081   0470             strcmp:
0082   0470 F8 00 00      enter 0 ; (push bp; mov bp, sp)
0083   0473             ;; while (*s1 && (*s1 == *s2)) { 
0084   0473             _while2_cond:
0085   0473 FA 05 00      lea d, [bp + 5] ; $s1
0086   0476 2A            mov b, [d]
0087   0477 74            mov d, b
0088   0478 32            mov bl, [d]
0089   0479 A7 00         mov bh, 0
0090   047B D7            push a
0091   047C 11            mov a, b
0092   047D FA 05 00      lea d, [bp + 5] ; $s1
0093   0480 2A            mov b, [d]
0094   0481 74            mov d, b
0095   0482 32            mov bl, [d]
0096   0483 A7 00         mov bh, 0
0097   0485             ; START RELATIONAL
0098   0485 D7            push a
0099   0486 11            mov a, b
0100   0487 FA 07 00      lea d, [bp + 7] ; $s2
0101   048A 2A            mov b, [d]
0102   048B 74            mov d, b
0103   048C 32            mov bl, [d]
0104   048D A7 00         mov bh, 0
0105   048F B0            cmp a, b
0106   0490 FD 71         seq ; ==
0107   0492 E4            pop a
0108   0493             ; END RELATIONAL
0109   0493 FD A7         sand a, b
0110   0495 E4            pop a
0111   0496 C0 00 00      cmp b, 0
0112   0499 C6 B9 04      je _while2_exit
0113   049C             _while2_block:
0114   049C             ;; s1++; 
0115   049C FA 05 00      lea d, [bp + 5] ; $s1
0116   049F 2A            mov b, [d]
0117   04A0 D8            push b
0118   04A1 FD 77         inc b
0119   04A3 FA 05 00      lea d, [bp + 5] ; $s1
0120   04A6 FD 43         mov [d], b
0121   04A8 E5            pop b
0122   04A9             ;; s2++; 
0123   04A9 FA 07 00      lea d, [bp + 7] ; $s2
0124   04AC 2A            mov b, [d]
0125   04AD D8            push b
0126   04AE FD 77         inc b
0127   04B0 FA 07 00      lea d, [bp + 7] ; $s2
0128   04B3 FD 43         mov [d], b
0129   04B5 E5            pop b
0130   04B6 0A 73 04      jmp _while2_cond
0131   04B9             _while2_exit:
0132   04B9             ;; return *s1 - *s2; 
0133   04B9 FA 05 00      lea d, [bp + 5] ; $s1
0134   04BC 2A            mov b, [d]
0135   04BD 74            mov d, b
0136   04BE 32            mov bl, [d]
0137   04BF A7 00         mov bh, 0
0138   04C1             ; START TERMS
0139   04C1 D7            push a
0140   04C2 11            mov a, b
0141   04C3 FA 07 00      lea d, [bp + 7] ; $s2
0142   04C6 2A            mov b, [d]
0143   04C7 74            mov d, b
0144   04C8 32            mov bl, [d]
0145   04C9 A7 00         mov bh, 0
0146   04CB 60            sub a, b
0147   04CC 27            mov b, a
0148   04CD E4            pop a
0149   04CE             ; END TERMS
0150   04CE F9            leave
0151   04CF 09            ret
0152   04D0             
0153   04D0             strncmp:
0154   04D0 F8 00 00      enter 0 ; (push bp; mov bp, sp)
0155   04D3 F9            leave
0156   04D4 09            ret
0157   04D5             
0158   04D5             strcat:
0159   04D5 F8 00 00      enter 0 ; (push bp; mov bp, sp)
0160   04D8             ; $dest_len 
0161   04D8             ; $i 
0162   04D8 52 04 00      sub sp, 4
0163   04DB             ;; dest_len = strlen(dest); 
0164   04DB FA FF FF      lea d, [bp + -1] ; $dest_len
0165   04DE DA            push d
0166   04DF FA 05 00      lea d, [bp + 5] ; $dest
0167   04E2 2A            mov b, [d]
0168   04E3 FD AB         swp b
0169   04E5 D8            push b
0170   04E6 07 88 05      call strlen
0171   04E9 51 02 00      add sp, 2
0172   04EC E7            pop d
0173   04ED FD 43         mov [d], b
0174   04EF             ;; for (i = 0; src[i] != 0; i=i+1) { 
0175   04EF             _for3_init:
0176   04EF FA FD FF      lea d, [bp + -3] ; $i
0177   04F2 DA            push d
0178   04F3 26 00 00      mov b, $0
0179   04F6 E7            pop d
0180   04F7 FD 43         mov [d], b
0181   04F9             _for3_cond:
0182   04F9 FA 07 00      lea d, [bp + 7] ; $src
0183   04FC FD 2A         mov d, [d]
0184   04FE D7            push a
0185   04FF DA            push d
0186   0500 FA FD FF      lea d, [bp + -3] ; $i
0187   0503 2A            mov b, [d]
0188   0504 E7            pop d
0189   0505 FD 13 01 00   mma 1 ; mov a, 1; mul a b; add d, b
0190   0509 E4            pop a
0191   050A 32            mov bl, [d]
0192   050B A7 00         mov bh, 0
0193   050D             ; START RELATIONAL
0194   050D D7            push a
0195   050E 11            mov a, b
0196   050F 26 00 00      mov b, $0
0197   0512 B0            cmp a, b
0198   0513 FD 72         sneq ; !=
0199   0515 E4            pop a
0200   0516             ; END RELATIONAL
0201   0516 C0 00 00      cmp b, 0
0202   0519 C6 62 05      je _for3_exit
0203   051C             _for3_block:
0204   051C             ;; dest[dest_len + i] = src[i]; 
0205   051C FA 05 00      lea d, [bp + 5] ; $dest
0206   051F FD 2A         mov d, [d]
0207   0521 D7            push a
0208   0522 DA            push d
0209   0523 FA FF FF      lea d, [bp + -1] ; $dest_len
0210   0526 2A            mov b, [d]
0211   0527             ; START TERMS
0212   0527 D7            push a
0213   0528 11            mov a, b
0214   0529 FA FD FF      lea d, [bp + -3] ; $i
0215   052C 2A            mov b, [d]
0216   052D 56            add b, a
0217   052E E4            pop a
0218   052F             ; END TERMS
0219   052F E7            pop d
0220   0530 FD 13 01 00   mma 1 ; mov a, 1; mul a b; add d, b
0221   0534 E4            pop a
0222   0535 DA            push d
0223   0536 FA 07 00      lea d, [bp + 7] ; $src
0224   0539 FD 2A         mov d, [d]
0225   053B D7            push a
0226   053C DA            push d
0227   053D FA FD FF      lea d, [bp + -3] ; $i
0228   0540 2A            mov b, [d]
0229   0541 E7            pop d
0230   0542 FD 13 01 00   mma 1 ; mov a, 1; mul a b; add d, b
0231   0546 E4            pop a
0232   0547 32            mov bl, [d]
0233   0548 A7 00         mov bh, 0
0234   054A E7            pop d
0235   054B FD 3E         mov [d], bl
0236   054D             _for3_update:
0237   054D FA FD FF      lea d, [bp + -3] ; $i
0238   0550 DA            push d
0239   0551 FA FD FF      lea d, [bp + -3] ; $i
0240   0554 2A            mov b, [d]
0241   0555             ; START TERMS
0242   0555 D7            push a
0243   0556 11            mov a, b
0244   0557 26 01 00      mov b, $1
0245   055A 56            add b, a
0246   055B E4            pop a
0247   055C             ; END TERMS
0248   055C E7            pop d
0249   055D FD 43         mov [d], b
0250   055F 0A F9 04      jmp _for3_cond
0251   0562             _for3_exit:
0252   0562             ;; dest[dest_len + i] = 0; 
0253   0562 FA 05 00      lea d, [bp + 5] ; $dest
0254   0565 FD 2A         mov d, [d]
0255   0567 D7            push a
0256   0568 DA            push d
0257   0569 FA FF FF      lea d, [bp + -1] ; $dest_len
0258   056C 2A            mov b, [d]
0259   056D             ; START TERMS
0260   056D D7            push a
0261   056E 11            mov a, b
0262   056F FA FD FF      lea d, [bp + -3] ; $i
0263   0572 2A            mov b, [d]
0264   0573 56            add b, a
0265   0574 E4            pop a
0266   0575             ; END TERMS
0267   0575 E7            pop d
0268   0576 FD 13 01 00   mma 1 ; mov a, 1; mul a b; add d, b
0269   057A E4            pop a
0270   057B DA            push d
0271   057C 26 00 00      mov b, $0
0272   057F E7            pop d
0273   0580 FD 3E         mov [d], bl
0274   0582             ;; return dest; 
0275   0582 FA 05 00      lea d, [bp + 5] ; $dest
0276   0585 2A            mov b, [d]
0277   0586 F9            leave
0278   0587 09            ret
0279   0588             
0280   0588             strlen:
0281   0588 F8 00 00      enter 0 ; (push bp; mov bp, sp)
0282   058B             ; $length 
0283   058B 52 02 00      sub sp, 2
0284   058E             ;; length = 0; 
0285   058E FA FF FF      lea d, [bp + -1] ; $length
0286   0591 DA            push d
0287   0592 26 00 00      mov b, $0
0288   0595 E7            pop d
0289   0596 FD 43         mov [d], b
0290   0598             ;; while (str[length] != 0) { 
0291   0598             _while4_cond:
0292   0598 FA 05 00      lea d, [bp + 5] ; $str
0293   059B FD 2A         mov d, [d]
0294   059D D7            push a
0295   059E DA            push d
0296   059F FA FF FF      lea d, [bp + -1] ; $length
0297   05A2 2A            mov b, [d]
0298   05A3 E7            pop d
0299   05A4 FD 13 01 00   mma 1 ; mov a, 1; mul a b; add d, b
0300   05A8 E4            pop a
0301   05A9 32            mov bl, [d]
0302   05AA A7 00         mov bh, 0
0303   05AC             ; START RELATIONAL
0304   05AC D7            push a
0305   05AD 11            mov a, b
0306   05AE 26 00 00      mov b, $0
0307   05B1 B0            cmp a, b
0308   05B2 FD 72         sneq ; !=
0309   05B4 E4            pop a
0310   05B5             ; END RELATIONAL
0311   05B5 C0 00 00      cmp b, 0
0312   05B8 C6 CB 05      je _while4_exit
0313   05BB             _while4_block:
0314   05BB             ;; length++; 
0315   05BB FA FF FF      lea d, [bp + -1] ; $length
0316   05BE 2A            mov b, [d]
0317   05BF D8            push b
0318   05C0 FD 77         inc b
0319   05C2 FA FF FF      lea d, [bp + -1] ; $length
0320   05C5 FD 43         mov [d], b
0321   05C7 E5            pop b
0322   05C8 0A 98 05      jmp _while4_cond
0323   05CB             _while4_exit:
0324   05CB             ;; return length; 
0325   05CB FA FF FF      lea d, [bp + -1] ; $length
0326   05CE 2A            mov b, [d]
0327   05CF F9            leave
0328   05D0 09            ret
0329   05D1             
0330   05D1             printf:
0331   05D1 F8 00 00      enter 0 ; (push bp; mov bp, sp)
0332   05D4             ; $p 
0333   05D4             ; $format_p 
0334   05D4 52 04 00      sub sp, 4
0335   05D7             ;; format_p = format; 
0336   05D7 FA FD FF      lea d, [bp + -3] ; $format_p
0337   05DA DA            push d
0338   05DB FA 05 00      lea d, [bp + 5] ; $format
0339   05DE 2A            mov b, [d]
0340   05DF E7            pop d
0341   05E0 FD 43         mov [d], b
0342   05E2             ;; p = &format + 2; 
0343   05E2 FA FF FF      lea d, [bp + -1] ; $p
0344   05E5 DA            push d
0345   05E6 FA 05 00      lea d, [bp + 5] ; $format
0346   05E9 2D            mov b, d
0347   05EA             ; START TERMS
0348   05EA D7            push a
0349   05EB 11            mov a, b
0350   05EC 26 02 00      mov b, $2
0351   05EF 56            add b, a
0352   05F0 E4            pop a
0353   05F1             ; END TERMS
0354   05F1 E7            pop d
0355   05F2 FD 43         mov [d], b
0356   05F4             ;; for(;;){ 
0357   05F4             _for5_init:
0358   05F4             _for5_cond:
0359   05F4             _for5_block:
0360   05F4             ;; if(!*format_p) break; 
0361   05F4             _if6_cond:
0362   05F4 FA FD FF      lea d, [bp + -3] ; $format_p
0363   05F7 2A            mov b, [d]
0364   05F8 74            mov d, b
0365   05F9 32            mov bl, [d]
0366   05FA A7 00         mov bh, 0
0367   05FC C0 00 00      cmp b, 0
0368   05FF FD 71         seq ; !
0369   0601 C0 00 00      cmp b, 0
0370   0604 C6 0D 06      je _if6_else
0371   0607             _if6_true:
0372   0607             ;; break; 
0373   0607 0A 30 08      jmp _for5_exit ; for break
0374   060A 0A 2D 08      jmp _if6_exit
0375   060D             _if6_else:
0376   060D             ;; if(*format_p == '%'){ 
0377   060D             _if7_cond:
0378   060D FA FD FF      lea d, [bp + -3] ; $format_p
0379   0610 2A            mov b, [d]
0380   0611 74            mov d, b
0381   0612 32            mov bl, [d]
0382   0613 A7 00         mov bh, 0
0383   0615             ; START RELATIONAL
0384   0615 D7            push a
0385   0616 11            mov a, b
0386   0617 26 25 00      mov b, $25
0387   061A B0            cmp a, b
0388   061B FD 71         seq ; ==
0389   061D E4            pop a
0390   061E             ; END RELATIONAL
0391   061E C0 00 00      cmp b, 0
0392   0621 C6 11 08      je _if7_else
0393   0624             _if7_true:
0394   0624             ;; format_p++; 
0395   0624 FA FD FF      lea d, [bp + -3] ; $format_p
0396   0627 2A            mov b, [d]
0397   0628 D8            push b
0398   0629 FD 77         inc b
0399   062B FA FD FF      lea d, [bp + -3] ; $format_p
0400   062E FD 43         mov [d], b
0401   0630 E5            pop b
0402   0631             ;; switch(*format_p){ 
0403   0631             _switch8_expr:
0404   0631 FA FD FF      lea d, [bp + -3] ; $format_p
0405   0634 2A            mov b, [d]
0406   0635 74            mov d, b
0407   0636 32            mov bl, [d]
0408   0637 A7 00         mov bh, 0
0409   0639             _switch8_comparisons:
0410   0639 C1 6C         cmp bl, $6c
0411   063B C6 67 06      je _switch8_case0
0412   063E C1 4C         cmp bl, $4c
0413   0640 C6 67 06      je _switch8_case1
0414   0643 C1 64         cmp bl, $64
0415   0645 C6 51 07      je _switch8_case2
0416   0648 C1 69         cmp bl, $69
0417   064A C6 51 07      je _switch8_case3
0418   064D C1 75         cmp bl, $75
0419   064F C6 75 07      je _switch8_case4
0420   0652 C1 78         cmp bl, $78
0421   0654 C6 99 07      je _switch8_case5
0422   0657 C1 63         cmp bl, $63
0423   0659 C6 B7 07      je _switch8_case6
0424   065C C1 73         cmp bl, $73
0425   065E C6 D6 07      je _switch8_case7
0426   0661 0A F5 07      jmp _switch8_default
0427   0664 0A 01 08      jmp _switch8_exit
0428   0667             _switch8_case0:
0429   0667             _switch8_case1:
0430   0667             ;; format_p++; 
0431   0667 FA FD FF      lea d, [bp + -3] ; $format_p
0432   066A 2A            mov b, [d]
0433   066B D8            push b
0434   066C FD 77         inc b
0435   066E FA FD FF      lea d, [bp + -3] ; $format_p
0436   0671 FD 43         mov [d], b
0437   0673 E5            pop b
0438   0674             ;; if(*format_p == 'd' || *format_p == 'i') 
0439   0674             _if9_cond:
0440   0674 FA FD FF      lea d, [bp + -3] ; $format_p
0441   0677 2A            mov b, [d]
0442   0678 74            mov d, b
0443   0679 32            mov bl, [d]
0444   067A A7 00         mov bh, 0
0445   067C             ; START RELATIONAL
0446   067C D7            push a
0447   067D 11            mov a, b
0448   067E 26 64 00      mov b, $64
0449   0681 B0            cmp a, b
0450   0682 FD 71         seq ; ==
0451   0684 E4            pop a
0452   0685             ; END RELATIONAL
0453   0685 D7            push a
0454   0686 11            mov a, b
0455   0687 FA FD FF      lea d, [bp + -3] ; $format_p
0456   068A 2A            mov b, [d]
0457   068B 74            mov d, b
0458   068C 32            mov bl, [d]
0459   068D A7 00         mov bh, 0
0460   068F             ; START RELATIONAL
0461   068F D7            push a
0462   0690 11            mov a, b
0463   0691 26 69 00      mov b, $69
0464   0694 B0            cmp a, b
0465   0695 FD 71         seq ; ==
0466   0697 E4            pop a
0467   0698             ; END RELATIONAL
0468   0698 FD A8         sor a, b ; ||
0469   069A E4            pop a
0470   069B C0 00 00      cmp b, 0
0471   069E C6 C1 06      je _if9_else
0472   06A1             _if9_true:
0473   06A1             ;; print_signed_long(*(long *)p); 
0474   06A1 FA FF FF      lea d, [bp + -1] ; $p
0475   06A4 2A            mov b, [d]
0476   06A5 A7 00         mov bh, 0
0477   06A7 74            mov d, b
0478   06A8 32            mov bl, [d]
0479   06A9 A7 00         mov bh, 0
out/startrek.asm line 0480: Label not found: (b)
out/startrek.asm line 0480: Unused data in MS byte of argument. (2)
0480   06AB FD 22 00 00   mov g, b
0481   06AF 28            mov b, c
0482   06B0 FD AB         swp b
0483   06B2 D8            push b
0484   06B3 FD 27         mov b, g
0485   06B5 FD AB         swp b
0486   06B7 D8            push b
0487   06B8 07 F6 0C      call print_signed_long
0488   06BB 51 04 00      add sp, 4
0489   06BE 0A 3C 07      jmp _if9_exit
0490   06C1             _if9_else:
0491   06C1             ;; if(*format_p == 'u') 
0492   06C1             _if10_cond:
0493   06C1 FA FD FF      lea d, [bp + -3] ; $format_p
0494   06C4 2A            mov b, [d]
0495   06C5 74            mov d, b
0496   06C6 32            mov bl, [d]
0497   06C7 A7 00         mov bh, 0
0498   06C9             ; START RELATIONAL
0499   06C9 D7            push a
0500   06CA 11            mov a, b
0501   06CB 26 75 00      mov b, $75
0502   06CE B0            cmp a, b
0503   06CF FD 71         seq ; ==
0504   06D1 E4            pop a
0505   06D2             ; END RELATIONAL
0506   06D2 C0 00 00      cmp b, 0
0507   06D5 C6 F8 06      je _if10_else
0508   06D8             _if10_true:
0509   06D8             ;; print_unsigned_long(*(unsigned long *)p); 
0510   06D8 FA FF FF      lea d, [bp + -1] ; $p
0511   06DB 2A            mov b, [d]
0512   06DC A7 00         mov bh, 0
0513   06DE 74            mov d, b
0514   06DF 32            mov bl, [d]
0515   06E0 A7 00         mov bh, 0
out/startrek.asm line 0516: Label not found: (b)
out/startrek.asm line 0516: Unused data in MS byte of argument. (2)
0516   06E2 FD 22 00 00   mov g, b
0517   06E6 28            mov b, c
0518   06E7 FD AB         swp b
0519   06E9 D8            push b
0520   06EA FD 27         mov b, g
0521   06EC FD AB         swp b
0522   06EE D8            push b
0523   06EF 07 35 10      call print_unsigned_long
0524   06F2 51 04 00      add sp, 4
0525   06F5 0A 3C 07      jmp _if10_exit
0526   06F8             _if10_else:
0527   06F8             ;; if(*format_p == 'x') 
0528   06F8             _if11_cond:
0529   06F8 FA FD FF      lea d, [bp + -3] ; $format_p
0530   06FB 2A            mov b, [d]
0531   06FC 74            mov d, b
0532   06FD 32            mov bl, [d]
0533   06FE A7 00         mov bh, 0
0534   0700             ; START RELATIONAL
0535   0700 D7            push a
0536   0701 11            mov a, b
0537   0702 26 78 00      mov b, $78
0538   0705 B0            cmp a, b
0539   0706 FD 71         seq ; ==
0540   0708 E4            pop a
0541   0709             ; END RELATIONAL
0542   0709 C0 00 00      cmp b, 0
0543   070C C6 30 07      je _if11_else
0544   070F             _if11_true:
0545   070F             ;; printx32(*(long int *)p); 
0546   070F FA FF FF      lea d, [bp + -1] ; $p
0547   0712 2A            mov b, [d]
0548   0713 74            mov d, b
0549   0714 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
0550   0717 FD 39         mov c, b ; And place it into C
0551   0719 2A            mov b, [d] ; Lower Word in B
out/startrek.asm line 0552: Label not found: (b)
out/startrek.asm line 0552: Unused data in MS byte of argument. (2)
0552   071A FD 22 00 00   mov g, b
0553   071E 28            mov b, c
0554   071F FD AB         swp b
0555   0721 D8            push b
0556   0722 FD 27         mov b, g
0557   0724 FD AB         swp b
0558   0726 D8            push b
0559   0727 07 7F 0A      call printx32
0560   072A 51 04 00      add sp, 4
0561   072D 0A 3C 07      jmp _if11_exit
0562   0730             _if11_else:
0563   0730             ;; err("Unexpected format in printf."); 
0564   0730 26 12 66      mov b, __s29 ; "Unexpected format in printf."
0565   0733 FD AB         swp b
0566   0735 D8            push b
0567   0736 07 6D 0A      call err
0568   0739 51 02 00      add sp, 2
0569   073C             _if11_exit:
0570   073C             _if10_exit:
0571   073C             _if9_exit:
0572   073C             ;; p = p + 4; 
0573   073C FA FF FF      lea d, [bp + -1] ; $p
0574   073F DA            push d
0575   0740 FA FF FF      lea d, [bp + -1] ; $p
0576   0743 2A            mov b, [d]
0577   0744             ; START TERMS
0578   0744 D7            push a
0579   0745 11            mov a, b
0580   0746 26 04 00      mov b, $4
0581   0749 56            add b, a
0582   074A E4            pop a
0583   074B             ; END TERMS
0584   074B E7            pop d
0585   074C FD 43         mov [d], b
0586   074E             ;; break; 
0587   074E 0A 01 08      jmp _switch8_exit ; case break
0588   0751             _switch8_case2:
0589   0751             _switch8_case3:
0590   0751             ;; print_signed(*(int*)p); 
0591   0751 FA FF FF      lea d, [bp + -1] ; $p
0592   0754 2A            mov b, [d]
0593   0755 74            mov d, b
0594   0756 2A            mov b, [d]
0595   0757 FD AB         swp b
0596   0759 D8            push b
0597   075A 07 06 0C      call print_signed
0598   075D 51 02 00      add sp, 2
0599   0760             ;; p = p + 2; 
0600   0760 FA FF FF      lea d, [bp + -1] ; $p
0601   0763 DA            push d
0602   0764 FA FF FF      lea d, [bp + -1] ; $p
0603   0767 2A            mov b, [d]
0604   0768             ; START TERMS
0605   0768 D7            push a
0606   0769 11            mov a, b
0607   076A 26 02 00      mov b, $2
0608   076D 56            add b, a
0609   076E E4            pop a
0610   076F             ; END TERMS
0611   076F E7            pop d
0612   0770 FD 43         mov [d], b
0613   0772             ;; break; 
0614   0772 0A 01 08      jmp _switch8_exit ; case break
0615   0775             _switch8_case4:
0616   0775             ;; print_unsigned(*(unsigned int*)p); 
0617   0775 FA FF FF      lea d, [bp + -1] ; $p
0618   0778 2A            mov b, [d]
0619   0779 74            mov d, b
0620   077A 2A            mov b, [d]
0621   077B FD AB         swp b
0622   077D D8            push b
0623   077E 07 31 12      call print_unsigned
0624   0781 51 02 00      add sp, 2
0625   0784             ;; p = p + 2; 
0626   0784 FA FF FF      lea d, [bp + -1] ; $p
0627   0787 DA            push d
0628   0788 FA FF FF      lea d, [bp + -1] ; $p
0629   078B 2A            mov b, [d]
0630   078C             ; START TERMS
0631   078C D7            push a
0632   078D 11            mov a, b
0633   078E 26 02 00      mov b, $2
0634   0791 56            add b, a
0635   0792 E4            pop a
0636   0793             ; END TERMS
0637   0793 E7            pop d
0638   0794 FD 43         mov [d], b
0639   0796             ;; break; 
0640   0796 0A 01 08      jmp _switch8_exit ; case break
0641   0799             _switch8_case5:
0642   0799             
0643   0799             ; --- BEGIN INLINE ASM BLOCK
0644   0799 FA FF FF      lea d, [bp + -1] ; $p
0645   079C FD 2A         mov d, [d]
0646   079E 2A            mov b, [d]
0647   079F 07 34 16      call print_u16x
0648   07A2             ; --- END INLINE ASM BLOCK
0649   07A2             
0650   07A2             ;; p = p + 2; 
0651   07A2 FA FF FF      lea d, [bp + -1] ; $p
0652   07A5 DA            push d
0653   07A6 FA FF FF      lea d, [bp + -1] ; $p
0654   07A9 2A            mov b, [d]
0655   07AA             ; START TERMS
0656   07AA D7            push a
0657   07AB 11            mov a, b
0658   07AC 26 02 00      mov b, $2
0659   07AF 56            add b, a
0660   07B0 E4            pop a
0661   07B1             ; END TERMS
0662   07B1 E7            pop d
0663   07B2 FD 43         mov [d], b
0664   07B4             ;; break; 
0665   07B4 0A 01 08      jmp _switch8_exit ; case break
0666   07B7             _switch8_case6:
0667   07B7             
0668   07B7             ; --- BEGIN INLINE ASM BLOCK
0669   07B7 FA FF FF      lea d, [bp + -1] ; $p
0670   07BA FD 2A         mov d, [d]
0671   07BC 1E            mov al, [d]
0672   07BD 23            mov ah, al
0673   07BE 07 92 14      call _putchar
0674   07C1             ; --- END INLINE ASM BLOCK
0675   07C1             
0676   07C1             ;; p = p + 2; 
0677   07C1 FA FF FF      lea d, [bp + -1] ; $p
0678   07C4 DA            push d
0679   07C5 FA FF FF      lea d, [bp + -1] ; $p
0680   07C8 2A            mov b, [d]
0681   07C9             ; START TERMS
0682   07C9 D7            push a
0683   07CA 11            mov a, b
0684   07CB 26 02 00      mov b, $2
0685   07CE 56            add b, a
0686   07CF E4            pop a
0687   07D0             ; END TERMS
0688   07D0 E7            pop d
0689   07D1 FD 43         mov [d], b
0690   07D3             ;; break; 
0691   07D3 0A 01 08      jmp _switch8_exit ; case break
0692   07D6             _switch8_case7:
0693   07D6             
0694   07D6             ; --- BEGIN INLINE ASM BLOCK
0695   07D6 FA FF FF      lea d, [bp + -1] ; $p
0696   07D9 FD 2A         mov d, [d]
0697   07DB FD 2A         mov d, [d]
0698   07DD 07 DC 15      call _puts
0699   07E0             ; --- END INLINE ASM BLOCK
0700   07E0             
0701   07E0             ;; p = p + 2; 
0702   07E0 FA FF FF      lea d, [bp + -1] ; $p
0703   07E3 DA            push d
0704   07E4 FA FF FF      lea d, [bp + -1] ; $p
0705   07E7 2A            mov b, [d]
0706   07E8             ; START TERMS
0707   07E8 D7            push a
0708   07E9 11            mov a, b
0709   07EA 26 02 00      mov b, $2
0710   07ED 56            add b, a
0711   07EE E4            pop a
0712   07EF             ; END TERMS
0713   07EF E7            pop d
0714   07F0 FD 43         mov [d], b
0715   07F2             ;; break; 
0716   07F2 0A 01 08      jmp _switch8_exit ; case break
0717   07F5             _switch8_default:
0718   07F5             ;; print("Error: Unknown argument type.\n"); 
0719   07F5 26 2F 66      mov b, __s30 ; "Error: Unknown argument type.\n"
0720   07F8 FD AB         swp b
0721   07FA D8            push b
0722   07FB 07 49 13      call print
0723   07FE 51 02 00      add sp, 2
0724   0801             _switch8_exit:
0725   0801             ;; format_p++; 
0726   0801 FA FD FF      lea d, [bp + -3] ; $format_p
0727   0804 2A            mov b, [d]
0728   0805 D8            push b
0729   0806 FD 77         inc b
0730   0808 FA FD FF      lea d, [bp + -3] ; $format_p
0731   080B FD 43         mov [d], b
0732   080D E5            pop b
0733   080E 0A 2D 08      jmp _if7_exit
0734   0811             _if7_else:
0735   0811             ;; putchar(*format_p); 
0736   0811 FA FD FF      lea d, [bp + -3] ; $format_p
0737   0814 2A            mov b, [d]
0738   0815 74            mov d, b
0739   0816 32            mov bl, [d]
0740   0817 A7 00         mov bh, 0
0741   0819 DD            push bl
0742   081A 07 01 13      call putchar
0743   081D 51 01 00      add sp, 1
0744   0820             ;; format_p++; 
0745   0820 FA FD FF      lea d, [bp + -3] ; $format_p
0746   0823 2A            mov b, [d]
0747   0824 D8            push b
0748   0825 FD 77         inc b
0749   0827 FA FD FF      lea d, [bp + -3] ; $format_p
0750   082A FD 43         mov [d], b
0751   082C E5            pop b
0752   082D             _if7_exit:
0753   082D             _if6_exit:
0754   082D             _for5_update:
0755   082D 0A F4 05      jmp _for5_cond
0756   0830             _for5_exit:
0757   0830 F9            leave
0758   0831 09            ret
0759   0832             
0760   0832             scanf:
0761   0832 F8 00 00      enter 0 ; (push bp; mov bp, sp)
0762   0835             ; $p 
0763   0835             ; $format_p 
0764   0835             ; $c 
0765   0835             ; $i 
0766   0835             ; $input_string 
0767   0835 52 07 02      sub sp, 519
0768   0838             ;; format_p = format; 
0769   0838 FA FD FF      lea d, [bp + -3] ; $format_p
0770   083B DA            push d
0771   083C FA 05 00      lea d, [bp + 5] ; $format
0772   083F 2A            mov b, [d]
0773   0840 E7            pop d
0774   0841 FD 43         mov [d], b
0775   0843             ;; p = &format + 2; 
0776   0843 FA FF FF      lea d, [bp + -1] ; $p
0777   0846 DA            push d
0778   0847 FA 05 00      lea d, [bp + 5] ; $format
0779   084A 2D            mov b, d
0780   084B             ; START TERMS
0781   084B D7            push a
0782   084C 11            mov a, b
0783   084D 26 02 00      mov b, $2
0784   0850 56            add b, a
0785   0851 E4            pop a
0786   0852             ; END TERMS
0787   0852 E7            pop d
0788   0853 FD 43         mov [d], b
0789   0855             ;; for(;;){ 
0790   0855             _for12_init:
0791   0855             _for12_cond:
0792   0855             _for12_block:
0793   0855             ;; if(!*format_p) break; 
0794   0855             _if13_cond:
0795   0855 FA FD FF      lea d, [bp + -3] ; $format_p
0796   0858 2A            mov b, [d]
0797   0859 74            mov d, b
0798   085A 32            mov bl, [d]
0799   085B A7 00         mov bh, 0
0800   085D C0 00 00      cmp b, 0
0801   0860 FD 71         seq ; !
0802   0862 C0 00 00      cmp b, 0
0803   0865 C6 6E 08      je _if13_else
0804   0868             _if13_true:
0805   0868             ;; break; 
0806   0868 0A 6B 0A      jmp _for12_exit ; for break
0807   086B 0A 68 0A      jmp _if13_exit
0808   086E             _if13_else:
0809   086E             ;; if(*format_p == '%'){ 
0810   086E             _if14_cond:
0811   086E FA FD FF      lea d, [bp + -3] ; $format_p
0812   0871 2A            mov b, [d]
0813   0872 74            mov d, b
0814   0873 32            mov bl, [d]
0815   0874 A7 00         mov bh, 0
0816   0876             ; START RELATIONAL
0817   0876 D7            push a
0818   0877 11            mov a, b
0819   0878 26 25 00      mov b, $25
0820   087B B0            cmp a, b
0821   087C FD 71         seq ; ==
0822   087E E4            pop a
0823   087F             ; END RELATIONAL
0824   087F C0 00 00      cmp b, 0
0825   0882 C6 4C 0A      je _if14_else
0826   0885             _if14_true:
0827   0885             ;; format_p++; 
0828   0885 FA FD FF      lea d, [bp + -3] ; $format_p
0829   0888 2A            mov b, [d]
0830   0889 D8            push b
0831   088A FD 77         inc b
0832   088C FA FD FF      lea d, [bp + -3] ; $format_p
0833   088F FD 43         mov [d], b
0834   0891 E5            pop b
0835   0892             ;; switch(*format_p){ 
0836   0892             _switch15_expr:
0837   0892 FA FD FF      lea d, [bp + -3] ; $format_p
0838   0895 2A            mov b, [d]
0839   0896 74            mov d, b
0840   0897 32            mov bl, [d]
0841   0898 A7 00         mov bh, 0
0842   089A             _switch15_comparisons:
0843   089A C1 6C         cmp bl, $6c
0844   089C C6 C8 08      je _switch15_case0
0845   089F C1 4C         cmp bl, $4c
0846   08A1 C6 C8 08      je _switch15_case1
0847   08A4 C1 64         cmp bl, $64
0848   08A6 C6 5A 09      je _switch15_case2
0849   08A9 C1 69         cmp bl, $69
0850   08AB C6 5A 09      je _switch15_case3
0851   08AE C1 75         cmp bl, $75
0852   08B0 C6 87 09      je _switch15_case4
0853   08B3 C1 78         cmp bl, $78
0854   08B5 C6 B4 09      je _switch15_case5
0855   08B8 C1 63         cmp bl, $63
0856   08BA C6 C9 09      je _switch15_case6
0857   08BD C1 73         cmp bl, $73
0858   08BF C6 F8 09      je _switch15_case7
0859   08C2 0A 30 0A      jmp _switch15_default
0860   08C5 0A 3C 0A      jmp _switch15_exit
0861   08C8             _switch15_case0:
0862   08C8             _switch15_case1:
0863   08C8             ;; format_p++; 
0864   08C8 FA FD FF      lea d, [bp + -3] ; $format_p
0865   08CB 2A            mov b, [d]
0866   08CC D8            push b
0867   08CD FD 77         inc b
0868   08CF FA FD FF      lea d, [bp + -3] ; $format_p
0869   08D2 FD 43         mov [d], b
0870   08D4 E5            pop b
0871   08D5             ;; if(*format_p == 'd' || *format_p == 'i'); 
0872   08D5             _if16_cond:
0873   08D5 FA FD FF      lea d, [bp + -3] ; $format_p
0874   08D8 2A            mov b, [d]
0875   08D9 74            mov d, b
0876   08DA 32            mov bl, [d]
0877   08DB A7 00         mov bh, 0
0878   08DD             ; START RELATIONAL
0879   08DD D7            push a
0880   08DE 11            mov a, b
0881   08DF 26 64 00      mov b, $64
0882   08E2 B0            cmp a, b
0883   08E3 FD 71         seq ; ==
0884   08E5 E4            pop a
0885   08E6             ; END RELATIONAL
0886   08E6 D7            push a
0887   08E7 11            mov a, b
0888   08E8 FA FD FF      lea d, [bp + -3] ; $format_p
0889   08EB 2A            mov b, [d]
0890   08EC 74            mov d, b
0891   08ED 32            mov bl, [d]
0892   08EE A7 00         mov bh, 0
0893   08F0             ; START RELATIONAL
0894   08F0 D7            push a
0895   08F1 11            mov a, b
0896   08F2 26 69 00      mov b, $69
0897   08F5 B0            cmp a, b
0898   08F6 FD 71         seq ; ==
0899   08F8 E4            pop a
0900   08F9             ; END RELATIONAL
0901   08F9 FD A8         sor a, b ; ||
0902   08FB E4            pop a
0903   08FC C0 00 00      cmp b, 0
0904   08FF C6 05 09      je _if16_else
0905   0902             _if16_true:
0906   0902             ;; ; 
0907   0902 0A 45 09      jmp _if16_exit
0908   0905             _if16_else:
0909   0905             ;; if(*format_p == 'u'); 
0910   0905             _if17_cond:
0911   0905 FA FD FF      lea d, [bp + -3] ; $format_p
0912   0908 2A            mov b, [d]
0913   0909 74            mov d, b
0914   090A 32            mov bl, [d]
0915   090B A7 00         mov bh, 0
0916   090D             ; START RELATIONAL
0917   090D D7            push a
0918   090E 11            mov a, b
0919   090F 26 75 00      mov b, $75
0920   0912 B0            cmp a, b
0921   0913 FD 71         seq ; ==
0922   0915 E4            pop a
0923   0916             ; END RELATIONAL
0924   0916 C0 00 00      cmp b, 0
0925   0919 C6 1F 09      je _if17_else
0926   091C             _if17_true:
0927   091C             ;; ; 
0928   091C 0A 45 09      jmp _if17_exit
0929   091F             _if17_else:
0930   091F             ;; if(*format_p == 'x'); 
0931   091F             _if18_cond:
0932   091F FA FD FF      lea d, [bp + -3] ; $format_p
0933   0922 2A            mov b, [d]
0934   0923 74            mov d, b
0935   0924 32            mov bl, [d]
0936   0925 A7 00         mov bh, 0
0937   0927             ; START RELATIONAL
0938   0927 D7            push a
0939   0928 11            mov a, b
0940   0929 26 78 00      mov b, $78
0941   092C B0            cmp a, b
0942   092D FD 71         seq ; ==
0943   092F E4            pop a
0944   0930             ; END RELATIONAL
0945   0930 C0 00 00      cmp b, 0
0946   0933 C6 39 09      je _if18_else
0947   0936             _if18_true:
0948   0936             ;; ; 
0949   0936 0A 45 09      jmp _if18_exit
0950   0939             _if18_else:
0951   0939             ;; err("Unexpected format in printf."); 
0952   0939 26 12 66      mov b, __s29 ; "Unexpected format in printf."
0953   093C FD AB         swp b
0954   093E D8            push b
0955   093F 07 6D 0A      call err
0956   0942 51 02 00      add sp, 2
0957   0945             _if18_exit:
0958   0945             _if17_exit:
0959   0945             _if16_exit:
0960   0945             ;; p = p + 4; 
0961   0945 FA FF FF      lea d, [bp + -1] ; $p
0962   0948 DA            push d
0963   0949 FA FF FF      lea d, [bp + -1] ; $p
0964   094C 2A            mov b, [d]
0965   094D             ; START TERMS
0966   094D D7            push a
0967   094E 11            mov a, b
0968   094F 26 04 00      mov b, $4
0969   0952 56            add b, a
0970   0953 E4            pop a
0971   0954             ; END TERMS
0972   0954 E7            pop d
0973   0955 FD 43         mov [d], b
0974   0957             ;; break; 
0975   0957 0A 3C 0A      jmp _switch15_exit ; case break
0976   095A             _switch15_case2:
0977   095A             _switch15_case3:
0978   095A             ;; i = scann(); 
0979   095A FA FA FF      lea d, [bp + -6] ; $i
0980   095D DA            push d
0981   095E 07 24 13      call scann
0982   0961 E7            pop d
0983   0962 FD 43         mov [d], b
0984   0964             ;; **(int **)p = i; 
0985   0964 FA FF FF      lea d, [bp + -1] ; $p
0986   0967 2A            mov b, [d]
0987   0968 74            mov d, b
0988   0969 2A            mov b, [d]
0989   096A D8            push b
0990   096B FA FA FF      lea d, [bp + -6] ; $i
0991   096E 2A            mov b, [d]
0992   096F E7            pop d
0993   0970 FD 43         mov [d], b
0994   0972             ;; p = p + 2; 
0995   0972 FA FF FF      lea d, [bp + -1] ; $p
0996   0975 DA            push d
0997   0976 FA FF FF      lea d, [bp + -1] ; $p
0998   0979 2A            mov b, [d]
0999   097A             ; START TERMS
1000   097A D7            push a
1001   097B 11            mov a, b
1002   097C 26 02 00      mov b, $2
1003   097F 56            add b, a
1004   0980 E4            pop a
1005   0981             ; END TERMS
1006   0981 E7            pop d
1007   0982 FD 43         mov [d], b
1008   0984             ;; break; 
1009   0984 0A 3C 0A      jmp _switch15_exit ; case break
1010   0987             _switch15_case4:
1011   0987             ;; i = scann(); 
1012   0987 FA FA FF      lea d, [bp + -6] ; $i
1013   098A DA            push d
1014   098B 07 24 13      call scann
1015   098E E7            pop d
1016   098F FD 43         mov [d], b
1017   0991             ;; **(int **)p = i; 
1018   0991 FA FF FF      lea d, [bp + -1] ; $p
1019   0994 2A            mov b, [d]
1020   0995 74            mov d, b
1021   0996 2A            mov b, [d]
1022   0997 D8            push b
1023   0998 FA FA FF      lea d, [bp + -6] ; $i
1024   099B 2A            mov b, [d]
1025   099C E7            pop d
1026   099D FD 43         mov [d], b
1027   099F             ;; p = p + 2; 
1028   099F FA FF FF      lea d, [bp + -1] ; $p
1029   09A2 DA            push d
1030   09A3 FA FF FF      lea d, [bp + -1] ; $p
1031   09A6 2A            mov b, [d]
1032   09A7             ; START TERMS
1033   09A7 D7            push a
1034   09A8 11            mov a, b
1035   09A9 26 02 00      mov b, $2
1036   09AC 56            add b, a
1037   09AD E4            pop a
1038   09AE             ; END TERMS
1039   09AE E7            pop d
1040   09AF FD 43         mov [d], b
1041   09B1             ;; break; 
1042   09B1 0A 3C 0A      jmp _switch15_exit ; case break
1043   09B4             _switch15_case5:
1044   09B4             ;; p = p + 2; 
1045   09B4 FA FF FF      lea d, [bp + -1] ; $p
1046   09B7 DA            push d
1047   09B8 FA FF FF      lea d, [bp + -1] ; $p
1048   09BB 2A            mov b, [d]
1049   09BC             ; START TERMS
1050   09BC D7            push a
1051   09BD 11            mov a, b
1052   09BE 26 02 00      mov b, $2
1053   09C1 56            add b, a
1054   09C2 E4            pop a
1055   09C3             ; END TERMS
1056   09C3 E7            pop d
1057   09C4 FD 43         mov [d], b
1058   09C6             ;; break; 
1059   09C6 0A 3C 0A      jmp _switch15_exit ; case break
1060   09C9             _switch15_case6:
1061   09C9             ;; c = getchar(); 
1062   09C9 FA FC FF      lea d, [bp + -4] ; $c
1063   09CC DA            push d
1064   09CD 07 0E 13      call getchar
1065   09D0 E7            pop d
1066   09D1 FD 3E         mov [d], bl
1067   09D3             ;; **(char **)p = c; 
1068   09D3 FA FF FF      lea d, [bp + -1] ; $p
1069   09D6 2A            mov b, [d]
1070   09D7 74            mov d, b
1071   09D8 2A            mov b, [d]
1072   09D9 D8            push b
1073   09DA FA FC FF      lea d, [bp + -4] ; $c
1074   09DD 32            mov bl, [d]
1075   09DE A7 00         mov bh, 0
1076   09E0 E7            pop d
1077   09E1 FD 43         mov [d], b
1078   09E3             ;; p = p + 2; 
1079   09E3 FA FF FF      lea d, [bp + -1] ; $p
1080   09E6 DA            push d
1081   09E7 FA FF FF      lea d, [bp + -1] ; $p
1082   09EA 2A            mov b, [d]
1083   09EB             ; START TERMS
1084   09EB D7            push a
1085   09EC 11            mov a, b
1086   09ED 26 02 00      mov b, $2
1087   09F0 56            add b, a
1088   09F1 E4            pop a
1089   09F2             ; END TERMS
1090   09F2 E7            pop d
1091   09F3 FD 43         mov [d], b
1092   09F5             ;; break; 
1093   09F5 0A 3C 0A      jmp _switch15_exit ; case break
1094   09F8             _switch15_case7:
1095   09F8             ;; gets(input_string); 
1096   09F8 FA FA FD      lea d, [bp + -518] ; $input_string
1097   09FB 2D            mov b, d
1098   09FC FD AB         swp b
1099   09FE D8            push b
1100   09FF 07 EC 0B      call gets
1101   0A02 51 02 00      add sp, 2
1102   0A05             ;; strcpy(*(char **)p, input_string); 
1103   0A05 FA FA FD      lea d, [bp + -518] ; $input_string
1104   0A08 2D            mov b, d
1105   0A09 FD AB         swp b
1106   0A0B D8            push b
1107   0A0C FA FF FF      lea d, [bp + -1] ; $p
1108   0A0F 2A            mov b, [d]
1109   0A10 74            mov d, b
1110   0A11 2A            mov b, [d]
1111   0A12 FD AB         swp b
1112   0A14 D8            push b
1113   0A15 07 14 04      call strcpy
1114   0A18 51 04 00      add sp, 4
1115   0A1B             ;; p = p + 2; 
1116   0A1B FA FF FF      lea d, [bp + -1] ; $p
1117   0A1E DA            push d
1118   0A1F FA FF FF      lea d, [bp + -1] ; $p
1119   0A22 2A            mov b, [d]
1120   0A23             ; START TERMS
1121   0A23 D7            push a
1122   0A24 11            mov a, b
1123   0A25 26 02 00      mov b, $2
1124   0A28 56            add b, a
1125   0A29 E4            pop a
1126   0A2A             ; END TERMS
1127   0A2A E7            pop d
1128   0A2B FD 43         mov [d], b
1129   0A2D             ;; break; 
1130   0A2D 0A 3C 0A      jmp _switch15_exit ; case break
1131   0A30             _switch15_default:
1132   0A30             ;; print("Error: Unknown argument type.\n"); 
1133   0A30 26 2F 66      mov b, __s30 ; "Error: Unknown argument type.\n"
1134   0A33 FD AB         swp b
1135   0A35 D8            push b
1136   0A36 07 49 13      call print
1137   0A39 51 02 00      add sp, 2
1138   0A3C             _switch15_exit:
1139   0A3C             ;; format_p++; 
1140   0A3C FA FD FF      lea d, [bp + -3] ; $format_p
1141   0A3F 2A            mov b, [d]
1142   0A40 D8            push b
1143   0A41 FD 77         inc b
1144   0A43 FA FD FF      lea d, [bp + -3] ; $format_p
1145   0A46 FD 43         mov [d], b
1146   0A48 E5            pop b
1147   0A49 0A 68 0A      jmp _if14_exit
1148   0A4C             _if14_else:
1149   0A4C             ;; putchar(*format_p); 
1150   0A4C FA FD FF      lea d, [bp + -3] ; $format_p
1151   0A4F 2A            mov b, [d]
1152   0A50 74            mov d, b
1153   0A51 32            mov bl, [d]
1154   0A52 A7 00         mov bh, 0
1155   0A54 DD            push bl
1156   0A55 07 01 13      call putchar
1157   0A58 51 01 00      add sp, 1
1158   0A5B             ;; format_p++; 
1159   0A5B FA FD FF      lea d, [bp + -3] ; $format_p
1160   0A5E 2A            mov b, [d]
1161   0A5F D8            push b
1162   0A60 FD 77         inc b
1163   0A62 FA FD FF      lea d, [bp + -3] ; $format_p
1164   0A65 FD 43         mov [d], b
1165   0A67 E5            pop b
1166   0A68             _if14_exit:
1167   0A68             _if13_exit:
1168   0A68             _for12_update:
1169   0A68 0A 55 08      jmp _for12_cond
1170   0A6B             _for12_exit:
1171   0A6B F9            leave
1172   0A6C 09            ret
1173   0A6D             
1174   0A6D             err:
1175   0A6D F8 00 00      enter 0 ; (push bp; mov bp, sp)
1176   0A70             ;; print(e); 
1177   0A70 FA 05 00      lea d, [bp + 5] ; $e
1178   0A73 2A            mov b, [d]
1179   0A74 FD AB         swp b
1180   0A76 D8            push b
1181   0A77 07 49 13      call print
1182   0A7A 51 02 00      add sp, 2
1183   0A7D F9            leave
1184   0A7E 09            ret
1185   0A7F             
1186   0A7F             printx32:
1187   0A7F F8 00 00      enter 0 ; (push bp; mov bp, sp)
1188   0A82             
1189   0A82             ; --- BEGIN INLINE ASM BLOCK
1190   0A82 FA 05 00      lea d, [bp + 5] ; $hex
1191   0A85 2B 02 00      mov b, [d+2]
1192   0A88 07 34 16      call print_u16x
1193   0A8B 2A            mov b, [d]
1194   0A8C 07 34 16      call print_u16x
1195   0A8F             ; --- END INLINE ASM BLOCK
1196   0A8F             
1197   0A8F F9            leave
1198   0A90 09            ret
1199   0A91             
1200   0A91             printx16:
1201   0A91 F8 00 00      enter 0 ; (push bp; mov bp, sp)
1202   0A94             
1203   0A94             ; --- BEGIN INLINE ASM BLOCK
1204   0A94 FA 05 00      lea d, [bp + 5] ; $hex
1205   0A97 2A            mov b, [d]
1206   0A98 07 34 16      call print_u16x
1207   0A9B             ; --- END INLINE ASM BLOCK
1208   0A9B             
1209   0A9B F9            leave
1210   0A9C 09            ret
1211   0A9D             
1212   0A9D             printx8:
1213   0A9D F8 00 00      enter 0 ; (push bp; mov bp, sp)
1214   0AA0             
1215   0AA0             ; --- BEGIN INLINE ASM BLOCK
1216   0AA0 FA 05 00      lea d, [bp + 5] ; $hex
1217   0AA3 32            mov bl, [d]
1218   0AA4 07 78 16      call print_u8x
1219   0AA7             ; --- END INLINE ASM BLOCK
1220   0AA7             
1221   0AA7 F9            leave
1222   0AA8 09            ret
1223   0AA9             
1224   0AA9             hex_str_to_int:
1225   0AA9 F8 00 00      enter 0 ; (push bp; mov bp, sp)
1226   0AAC             ; $value 
1227   0AAC 10 00 00      mov a, $0
1228   0AAF 45 FF FF      mov [bp + -1], a
1229   0AB2             ; $i 
1230   0AB2             ; $hex_char 
1231   0AB2             ; $len 
1232   0AB2 52 07 00      sub sp, 7
1233   0AB5             ;; len = strlen(hex_string); 
1234   0AB5 FA FA FF      lea d, [bp + -6] ; $len
1235   0AB8 DA            push d
1236   0AB9 FA 05 00      lea d, [bp + 5] ; $hex_string
1237   0ABC 2A            mov b, [d]
1238   0ABD FD AB         swp b
1239   0ABF D8            push b
1240   0AC0 07 88 05      call strlen
1241   0AC3 51 02 00      add sp, 2
1242   0AC6 E7            pop d
1243   0AC7 FD 43         mov [d], b
1244   0AC9             ;; for (i = 0; i < len; i++) { 
1245   0AC9             _for19_init:
1246   0AC9 FA FD FF      lea d, [bp + -3] ; $i
1247   0ACC DA            push d
1248   0ACD 26 00 00      mov b, $0
1249   0AD0 E7            pop d
1250   0AD1 FD 43         mov [d], b
1251   0AD3             _for19_cond:
1252   0AD3 FA FD FF      lea d, [bp + -3] ; $i
1253   0AD6 2A            mov b, [d]
1254   0AD7             ; START RELATIONAL
1255   0AD7 D7            push a
1256   0AD8 11            mov a, b
1257   0AD9 FA FA FF      lea d, [bp + -6] ; $len
1258   0ADC 2A            mov b, [d]
1259   0ADD B0            cmp a, b
1260   0ADE FD 73         slt ; < (signed)
1261   0AE0 E4            pop a
1262   0AE1             ; END RELATIONAL
1263   0AE1 C0 00 00      cmp b, 0
1264   0AE4 C6 E6 0B      je _for19_exit
1265   0AE7             _for19_block:
1266   0AE7             ;; hex_char = hex_string[i]; 
1267   0AE7 FA FC FF      lea d, [bp + -4] ; $hex_char
1268   0AEA DA            push d
1269   0AEB FA 05 00      lea d, [bp + 5] ; $hex_string
1270   0AEE FD 2A         mov d, [d]
1271   0AF0 D7            push a
1272   0AF1 DA            push d
1273   0AF2 FA FD FF      lea d, [bp + -3] ; $i
1274   0AF5 2A            mov b, [d]
1275   0AF6 E7            pop d
1276   0AF7 FD 13 01 00   mma 1 ; mov a, 1; mul a b; add d, b
1277   0AFB E4            pop a
1278   0AFC 32            mov bl, [d]
1279   0AFD A7 00         mov bh, 0
1280   0AFF E7            pop d
1281   0B00 FD 3E         mov [d], bl
1282   0B02             ;; if (hex_char >= 'a' && hex_char <= 'f')  
1283   0B02             _if20_cond:
1284   0B02 FA FC FF      lea d, [bp + -4] ; $hex_char
1285   0B05 32            mov bl, [d]
1286   0B06 A7 00         mov bh, 0
1287   0B08             ; START RELATIONAL
1288   0B08 D7            push a
1289   0B09 11            mov a, b
1290   0B0A 26 61 00      mov b, $61
1291   0B0D B0            cmp a, b
1292   0B0E FD 80         sge ; >=
1293   0B10 E4            pop a
1294   0B11             ; END RELATIONAL
1295   0B11 D7            push a
1296   0B12 11            mov a, b
1297   0B13 FA FC FF      lea d, [bp + -4] ; $hex_char
1298   0B16 32            mov bl, [d]
1299   0B17 A7 00         mov bh, 0
1300   0B19             ; START RELATIONAL
1301   0B19 D7            push a
1302   0B1A 11            mov a, b
1303   0B1B 26 66 00      mov b, $66
1304   0B1E B0            cmp a, b
1305   0B1F FD 73         slt ; <= (signed)
1306   0B21 E4            pop a
1307   0B22             ; END RELATIONAL
1308   0B22 FD A7         sand a, b
1309   0B24 E4            pop a
1310   0B25 C0 00 00      cmp b, 0
1311   0B28 C6 59 0B      je _if20_else
1312   0B2B             _if20_true:
1313   0B2B             ;; value = (value * 16) + (hex_char - 'a' + 10); 
1314   0B2B FA FF FF      lea d, [bp + -1] ; $value
1315   0B2E DA            push d
1316   0B2F FA FF FF      lea d, [bp + -1] ; $value
1317   0B32 2A            mov b, [d]
1318   0B33             ; START FACTORS
1319   0B33 D7            push a
1320   0B34 11            mov a, b
1321   0B35 26 10 00      mov b, $10
1322   0B38 AC            mul a, b ; *
1323   0B39 11            mov a, b
1324   0B3A 27            mov b, a
1325   0B3B E4            pop a
1326   0B3C             ; END FACTORS
1327   0B3C             ; START TERMS
1328   0B3C D7            push a
1329   0B3D 11            mov a, b
1330   0B3E FA FC FF      lea d, [bp + -4] ; $hex_char
1331   0B41 32            mov bl, [d]
1332   0B42 A7 00         mov bh, 0
1333   0B44             ; START TERMS
1334   0B44 D7            push a
1335   0B45 11            mov a, b
1336   0B46 26 61 00      mov b, $61
1337   0B49 60            sub a, b
1338   0B4A 27            mov b, a
1339   0B4B 11            mov a, b
1340   0B4C 26 0A 00      mov b, $a
1341   0B4F 56            add b, a
1342   0B50 E4            pop a
1343   0B51             ; END TERMS
1344   0B51 56            add b, a
1345   0B52 E4            pop a
1346   0B53             ; END TERMS
1347   0B53 E7            pop d
1348   0B54 FD 43         mov [d], b
1349   0B56 0A D6 0B      jmp _if20_exit
1350   0B59             _if20_else:
1351   0B59             ;; if (hex_char >= 'A' && hex_char <= 'F')  
1352   0B59             _if21_cond:
1353   0B59 FA FC FF      lea d, [bp + -4] ; $hex_char
1354   0B5C 32            mov bl, [d]
1355   0B5D A7 00         mov bh, 0
1356   0B5F             ; START RELATIONAL
1357   0B5F D7            push a
1358   0B60 11            mov a, b
1359   0B61 26 41 00      mov b, $41
1360   0B64 B0            cmp a, b
1361   0B65 FD 80         sge ; >=
1362   0B67 E4            pop a
1363   0B68             ; END RELATIONAL
1364   0B68 D7            push a
1365   0B69 11            mov a, b
1366   0B6A FA FC FF      lea d, [bp + -4] ; $hex_char
1367   0B6D 32            mov bl, [d]
1368   0B6E A7 00         mov bh, 0
1369   0B70             ; START RELATIONAL
1370   0B70 D7            push a
1371   0B71 11            mov a, b
1372   0B72 26 46 00      mov b, $46
1373   0B75 B0            cmp a, b
1374   0B76 FD 73         slt ; <= (signed)
1375   0B78 E4            pop a
1376   0B79             ; END RELATIONAL
1377   0B79 FD A7         sand a, b
1378   0B7B E4            pop a
1379   0B7C C0 00 00      cmp b, 0
1380   0B7F C6 B0 0B      je _if21_else
1381   0B82             _if21_true:
1382   0B82             ;; value = (value * 16) + (hex_char - 'A' + 10); 
1383   0B82 FA FF FF      lea d, [bp + -1] ; $value
1384   0B85 DA            push d
1385   0B86 FA FF FF      lea d, [bp + -1] ; $value
1386   0B89 2A            mov b, [d]
1387   0B8A             ; START FACTORS
1388   0B8A D7            push a
1389   0B8B 11            mov a, b
1390   0B8C 26 10 00      mov b, $10
1391   0B8F AC            mul a, b ; *
1392   0B90 11            mov a, b
1393   0B91 27            mov b, a
1394   0B92 E4            pop a
1395   0B93             ; END FACTORS
1396   0B93             ; START TERMS
1397   0B93 D7            push a
1398   0B94 11            mov a, b
1399   0B95 FA FC FF      lea d, [bp + -4] ; $hex_char
1400   0B98 32            mov bl, [d]
1401   0B99 A7 00         mov bh, 0
1402   0B9B             ; START TERMS
1403   0B9B D7            push a
1404   0B9C 11            mov a, b
1405   0B9D 26 41 00      mov b, $41
1406   0BA0 60            sub a, b
1407   0BA1 27            mov b, a
1408   0BA2 11            mov a, b
1409   0BA3 26 0A 00      mov b, $a
1410   0BA6 56            add b, a
1411   0BA7 E4            pop a
1412   0BA8             ; END TERMS
1413   0BA8 56            add b, a
1414   0BA9 E4            pop a
1415   0BAA             ; END TERMS
1416   0BAA E7            pop d
1417   0BAB FD 43         mov [d], b
1418   0BAD 0A D6 0B      jmp _if21_exit
1419   0BB0             _if21_else:
1420   0BB0             ;; value = (value * 16) + (hex_char - '0'); 
1421   0BB0 FA FF FF      lea d, [bp + -1] ; $value
1422   0BB3 DA            push d
1423   0BB4 FA FF FF      lea d, [bp + -1] ; $value
1424   0BB7 2A            mov b, [d]
1425   0BB8             ; START FACTORS
1426   0BB8 D7            push a
1427   0BB9 11            mov a, b
1428   0BBA 26 10 00      mov b, $10
1429   0BBD AC            mul a, b ; *
1430   0BBE 11            mov a, b
1431   0BBF 27            mov b, a
1432   0BC0 E4            pop a
1433   0BC1             ; END FACTORS
1434   0BC1             ; START TERMS
1435   0BC1 D7            push a
1436   0BC2 11            mov a, b
1437   0BC3 FA FC FF      lea d, [bp + -4] ; $hex_char
1438   0BC6 32            mov bl, [d]
1439   0BC7 A7 00         mov bh, 0
1440   0BC9             ; START TERMS
1441   0BC9 D7            push a
1442   0BCA 11            mov a, b
1443   0BCB 26 30 00      mov b, $30
1444   0BCE 60            sub a, b
1445   0BCF 27            mov b, a
1446   0BD0 E4            pop a
1447   0BD1             ; END TERMS
1448   0BD1 56            add b, a
1449   0BD2 E4            pop a
1450   0BD3             ; END TERMS
1451   0BD3 E7            pop d
1452   0BD4 FD 43         mov [d], b
1453   0BD6             _if21_exit:
1454   0BD6             _if20_exit:
1455   0BD6             _for19_update:
1456   0BD6 FA FD FF      lea d, [bp + -3] ; $i
1457   0BD9 2A            mov b, [d]
1458   0BDA D8            push b
1459   0BDB FD 77         inc b
1460   0BDD FA FD FF      lea d, [bp + -3] ; $i
1461   0BE0 FD 43         mov [d], b
1462   0BE2 E5            pop b
1463   0BE3 0A D3 0A      jmp _for19_cond
1464   0BE6             _for19_exit:
1465   0BE6             ;; return value; 
1466   0BE6 FA FF FF      lea d, [bp + -1] ; $value
1467   0BE9 2A            mov b, [d]
1468   0BEA F9            leave
1469   0BEB 09            ret
1470   0BEC             
1471   0BEC             gets:
1472   0BEC F8 00 00      enter 0 ; (push bp; mov bp, sp)
1473   0BEF             
1474   0BEF             ; --- BEGIN INLINE ASM BLOCK
1475   0BEF FA 05 00      lea d, [bp + 5] ; $s
1476   0BF2 15            mov a, [d]
1477   0BF3 3C            mov d, a
1478   0BF4 07 99 14      call _gets
1479   0BF7             ; --- END INLINE ASM BLOCK
1480   0BF7             
1481   0BF7             ;; return strlen(s); 
1482   0BF7 FA 05 00      lea d, [bp + 5] ; $s
1483   0BFA 2A            mov b, [d]
1484   0BFB FD AB         swp b
1485   0BFD D8            push b
1486   0BFE 07 88 05      call strlen
1487   0C01 51 02 00      add sp, 2
1488   0C04 F9            leave
1489   0C05 09            ret
1490   0C06             
1491   0C06             print_signed:
1492   0C06 F8 00 00      enter 0 ; (push bp; mov bp, sp)
1493   0C09             ; $digits 
1494   0C09             ; $i 
1495   0C09 10 00 00      mov a, $0
1496   0C0C 45 FA FF      mov [bp + -6], a
1497   0C0F 52 07 00      sub sp, 7
1498   0C12             ;; if (num < 0) { 
1499   0C12             _if22_cond:
1500   0C12 FA 05 00      lea d, [bp + 5] ; $num
1501   0C15 2A            mov b, [d]
1502   0C16             ; START RELATIONAL
1503   0C16 D7            push a
1504   0C17 11            mov a, b
1505   0C18 26 00 00      mov b, $0
1506   0C1B B0            cmp a, b
1507   0C1C FD 73         slt ; < (signed)
1508   0C1E E4            pop a
1509   0C1F             ; END RELATIONAL
1510   0C1F C0 00 00      cmp b, 0
1511   0C22 C6 3F 0C      je _if22_else
1512   0C25             _if22_true:
1513   0C25             ;; putchar('-'); 
1514   0C25 26 2D 00      mov b, $2d
1515   0C28 DD            push bl
1516   0C29 07 01 13      call putchar
1517   0C2C 51 01 00      add sp, 1
1518   0C2F             ;; num = -num; 
1519   0C2F FA 05 00      lea d, [bp + 5] ; $num
1520   0C32 DA            push d
1521   0C33 FA 05 00      lea d, [bp + 5] ; $num
1522   0C36 2A            mov b, [d]
1523   0C37 FD 97         neg b
1524   0C39 E7            pop d
1525   0C3A FD 43         mov [d], b
1526   0C3C 0A 61 0C      jmp _if22_exit
1527   0C3F             _if22_else:
1528   0C3F             ;; if (num == 0) { 
1529   0C3F             _if23_cond:
1530   0C3F FA 05 00      lea d, [bp + 5] ; $num
1531   0C42 2A            mov b, [d]
1532   0C43             ; START RELATIONAL
1533   0C43 D7            push a
1534   0C44 11            mov a, b
1535   0C45 26 00 00      mov b, $0
1536   0C48 B0            cmp a, b
1537   0C49 FD 71         seq ; ==
1538   0C4B E4            pop a
1539   0C4C             ; END RELATIONAL
1540   0C4C C0 00 00      cmp b, 0
1541   0C4F C6 61 0C      je _if23_exit
1542   0C52             _if23_true:
1543   0C52             ;; putchar('0'); 
1544   0C52 26 30 00      mov b, $30
1545   0C55 DD            push bl
1546   0C56 07 01 13      call putchar
1547   0C59 51 01 00      add sp, 1
1548   0C5C             ;; return; 
1549   0C5C F9            leave
1550   0C5D 09            ret
1551   0C5E 0A 61 0C      jmp _if23_exit
1552   0C61             _if23_exit:
1553   0C61             _if22_exit:
1554   0C61             ;; while (num > 0) { 
1555   0C61             _while24_cond:
1556   0C61 FA 05 00      lea d, [bp + 5] ; $num
1557   0C64 2A            mov b, [d]
1558   0C65             ; START RELATIONAL
1559   0C65 D7            push a
1560   0C66 11            mov a, b
1561   0C67 26 00 00      mov b, $0
1562   0C6A B0            cmp a, b
1563   0C6B FD 7F         sgt ; >
1564   0C6D E4            pop a
1565   0C6E             ; END RELATIONAL
1566   0C6E C0 00 00      cmp b, 0
1567   0C71 C6 BB 0C      je _while24_exit
1568   0C74             _while24_block:
1569   0C74             ;; digits[i] = '0' + (num % 10); 
1570   0C74 FA FC FF      lea d, [bp + -4] ; $digits
1571   0C77 D7            push a
1572   0C78 DA            push d
1573   0C79 FA FA FF      lea d, [bp + -6] ; $i
1574   0C7C 2A            mov b, [d]
1575   0C7D E7            pop d
1576   0C7E 5A            add d, b
1577   0C7F E4            pop a
1578   0C80 DA            push d
1579   0C81 26 30 00      mov b, $30
1580   0C84             ; START TERMS
1581   0C84 D7            push a
1582   0C85 11            mov a, b
1583   0C86 FA 05 00      lea d, [bp + 5] ; $num
1584   0C89 2A            mov b, [d]
1585   0C8A             ; START FACTORS
1586   0C8A D7            push a
1587   0C8B 11            mov a, b
1588   0C8C 26 0A 00      mov b, $a
1589   0C8F AE            div a, b ; 
1590   0C90 11            mov a, b
1591   0C91 27            mov b, a
1592   0C92 E4            pop a
1593   0C93             ; END FACTORS
1594   0C93 56            add b, a
1595   0C94 E4            pop a
1596   0C95             ; END TERMS
1597   0C95 E7            pop d
1598   0C96 FD 3E         mov [d], bl
1599   0C98             ;; num = num / 10; 
1600   0C98 FA 05 00      lea d, [bp + 5] ; $num
1601   0C9B DA            push d
1602   0C9C FA 05 00      lea d, [bp + 5] ; $num
1603   0C9F 2A            mov b, [d]
1604   0CA0             ; START FACTORS
1605   0CA0 D7            push a
1606   0CA1 11            mov a, b
1607   0CA2 26 0A 00      mov b, $a
1608   0CA5 AE            div a, b
1609   0CA6 27            mov b, a
1610   0CA7 E4            pop a
1611   0CA8             ; END FACTORS
1612   0CA8 E7            pop d
1613   0CA9 FD 43         mov [d], b
1614   0CAB             ;; i++; 
1615   0CAB FA FA FF      lea d, [bp + -6] ; $i
1616   0CAE 2A            mov b, [d]
1617   0CAF D8            push b
1618   0CB0 FD 77         inc b
1619   0CB2 FA FA FF      lea d, [bp + -6] ; $i
1620   0CB5 FD 43         mov [d], b
1621   0CB7 E5            pop b
1622   0CB8 0A 61 0C      jmp _while24_cond
1623   0CBB             _while24_exit:
1624   0CBB             ;; while (i > 0) { 
1625   0CBB             _while25_cond:
1626   0CBB FA FA FF      lea d, [bp + -6] ; $i
1627   0CBE 2A            mov b, [d]
1628   0CBF             ; START RELATIONAL
1629   0CBF D7            push a
1630   0CC0 11            mov a, b
1631   0CC1 26 00 00      mov b, $0
1632   0CC4 B0            cmp a, b
1633   0CC5 FD 7F         sgt ; >
1634   0CC7 E4            pop a
1635   0CC8             ; END RELATIONAL
1636   0CC8 C0 00 00      cmp b, 0
1637   0CCB C6 F4 0C      je _while25_exit
1638   0CCE             _while25_block:
1639   0CCE             ;; i--; 
1640   0CCE FA FA FF      lea d, [bp + -6] ; $i
1641   0CD1 2A            mov b, [d]
1642   0CD2 D8            push b
1643   0CD3 FD 7D         dec b
1644   0CD5 FA FA FF      lea d, [bp + -6] ; $i
1645   0CD8 FD 43         mov [d], b
1646   0CDA E5            pop b
1647   0CDB             ;; putchar(digits[i]); 
1648   0CDB FA FC FF      lea d, [bp + -4] ; $digits
1649   0CDE D7            push a
1650   0CDF DA            push d
1651   0CE0 FA FA FF      lea d, [bp + -6] ; $i
1652   0CE3 2A            mov b, [d]
1653   0CE4 E7            pop d
1654   0CE5 5A            add d, b
1655   0CE6 E4            pop a
1656   0CE7 32            mov bl, [d]
1657   0CE8 A7 00         mov bh, 0
1658   0CEA DD            push bl
1659   0CEB 07 01 13      call putchar
1660   0CEE 51 01 00      add sp, 1
1661   0CF1 0A BB 0C      jmp _while25_cond
1662   0CF4             _while25_exit:
1663   0CF4 F9            leave
1664   0CF5 09            ret
1665   0CF6             
1666   0CF6             print_signed_long:
1667   0CF6 F8 00 00      enter 0 ; (push bp; mov bp, sp)
1668   0CF9             ; $digits 
1669   0CF9             ; $i 
1670   0CF9 10 00 00      mov a, $0
1671   0CFC 45 F5 FF      mov [bp + -11], a
1672   0CFF 52 0C 00      sub sp, 12
1673   0D02             ;; if (num < 0) { 
1674   0D02             _if26_cond:
1675   0D02 FA 05 00      lea d, [bp + 5] ; $num
1676   0D05 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
1677   0D08 FD 39         mov c, b ; And place it into C
1678   0D0A 2A            mov b, [d] ; Lower Word in B
1679   0D0B             ; START RELATIONAL
1680   0D0B D7            push a
1681   0D0C FD D8         push g
1682   0D0E 11            mov a, b
out/startrek.asm line 1683: Label not found: (c)
out/startrek.asm line 1683: Unused data in MS byte of argument. (2)
1683   0D0F FD 22 00 00   mov g, c
1684   0D13 26 00 00      mov b, $0
1685   0D16 38 00 00      mov c, 0
1686   0D19 FD AF 00 00   cmp32 ga, cb
1686   0D1D 00 00 00 00 
1686   0D21 00 00 00 00 
1686   0D25 00 00 00 00 
1686   0D29 00 00 00 00 
1686   0D2D 00 00 00 00 
1686   0D31 00 00 00 00 
1686   0D35 00 00 00 00 
1686   0D39 00 00 00 00 
1686   0D3D 00 00 00 00 
1686   0D41 00 00 00 00 
1686   0D45 00 00 00 00 
1686   0D49 00 00 00 00 
1686   0D4D 00 00 00 00 
1686   0D51 00 00 00 00 
1686   0D55 00 00 00 00 
1686   0D59 00 00 00 00 
1686   0D5D 00 00 00 00 
1686   0D61 00 00 00 00 
1686   0D65 00 00 00 00 
1686   0D69 00 00 00 00 
1686   0D6D 00 00 00 00 
1686   0D71 00 00 00 00 
1686   0D75 00 00 00 00 
1686   0D79 00 00 00 00 
1686   0D7D 00 00 00 00 
1686   0D81 00 00 00 00 
1686   0D85 00 00 00 00 
1686   0D89 00 00 00 00 
1686   0D8D 00 00 00 00 
1686   0D91 00 00 00 00 
1686   0D95 00 00 00 00 
1686   0D99 00 00 00 00 
1686   0D9D 00 00 00 00 
1686   0DA1 00 00 00 00 
1686   0DA5 00 00 00 00 
1686   0DA9 00 00 00 00 
1686   0DAD 00 00 00 00 
1686   0DB1 00 00 00 00 
1686   0DB5 00 00 00 00 
1686   0DB9 00 00 00 00 
1686   0DBD 00 00 00 00 
1686   0DC1 00 00 00 00 
1686   0DC5 00 00 00 00 
1686   0DC9 00 00 00 00 
1686   0DCD 00 00 00 00 
1686   0DD1 00 00 00 00 
1686   0DD5 00 00 00 00 
1686   0DD9 00 00 00 00 
1686   0DDD 00 00 00 00 
1686   0DE1 00 00 00 00 
1686   0DE5 00 00 00 00 
1686   0DE9 00 00 00 00 
1686   0DED 00 00 00 00 
1686   0DF1 00 00 00 00 
1686   0DF5 00 00 00 00 
1686   0DF9 00 00 00 00 
1686   0DFD 00 00 00 00 
1686   0E01 00 00 00 00 
1686   0E05 00 00 00 00 
1686   0E09 00 00 00 00 
1686   0E0D 00 00 00 00 
1686   0E11 00 00 00 00 
1686   0E15 00 00 00 00 
1686   0E19 00 
1687   0E1A FD 73         slt ; <
1688   0E1C FD F1         pop g
1689   0E1E E4            pop a
1690   0E1F             ; END RELATIONAL
1691   0E1F C0 00 00      cmp b, 0
1692   0E22 C6 49 0E      je _if26_else
1693   0E25             _if26_true:
1694   0E25             ;; putchar('-'); 
1695   0E25 26 2D 00      mov b, $2d
1696   0E28 DD            push bl
1697   0E29 07 01 13      call putchar
1698   0E2C 51 01 00      add sp, 1
1699   0E2F             ;; num = -num; 
1700   0E2F FA 05 00      lea d, [bp + 5] ; $num
1701   0E32 DA            push d
1702   0E33 FA 05 00      lea d, [bp + 5] ; $num
1703   0E36 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
1704   0E39 FD 39         mov c, b ; And place it into C
1705   0E3B 2A            mov b, [d] ; Lower Word in B
1706   0E3C FD 97         neg b
1707   0E3E E7            pop d
1708   0E3F FD 43         mov [d], b
1709   0E41 28            mov b, c
1710   0E42 FD 44 02 00   mov [d + 2], b
1711   0E46 0A 7B 0F      jmp _if26_exit
1712   0E49             _if26_else:
1713   0E49             ;; if (num == 0) { 
1714   0E49             _if27_cond:
1715   0E49 FA 05 00      lea d, [bp + 5] ; $num
1716   0E4C 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
1717   0E4F FD 39         mov c, b ; And place it into C
1718   0E51 2A            mov b, [d] ; Lower Word in B
1719   0E52             ; START RELATIONAL
1720   0E52 D7            push a
1721   0E53 FD D8         push g
1722   0E55 11            mov a, b
out/startrek.asm line 1723: Label not found: (c)
out/startrek.asm line 1723: Unused data in MS byte of argument. (2)
1723   0E56 FD 22 00 00   mov g, c
1724   0E5A 26 00 00      mov b, $0
1725   0E5D 38 00 00      mov c, 0
1726   0E60 FD AF 00 00   cmp32 ga, cb
1726   0E64 00 00 00 00 
1726   0E68 00 00 00 00 
1726   0E6C 00 00 00 00 
1726   0E70 00 00 00 00 
1726   0E74 00 00 00 00 
1726   0E78 00 00 00 00 
1726   0E7C 00 00 00 00 
1726   0E80 00 00 00 00 
1726   0E84 00 00 00 00 
1726   0E88 00 00 00 00 
1726   0E8C 00 00 00 00 
1726   0E90 00 00 00 00 
1726   0E94 00 00 00 00 
1726   0E98 00 00 00 00 
1726   0E9C 00 00 00 00 
1726   0EA0 00 00 00 00 
1726   0EA4 00 00 00 00 
1726   0EA8 00 00 00 00 
1726   0EAC 00 00 00 00 
1726   0EB0 00 00 00 00 
1726   0EB4 00 00 00 00 
1726   0EB8 00 00 00 00 
1726   0EBC 00 00 00 00 
1726   0EC0 00 00 00 00 
1726   0EC4 00 00 00 00 
1726   0EC8 00 00 00 00 
1726   0ECC 00 00 00 00 
1726   0ED0 00 00 00 00 
1726   0ED4 00 00 00 00 
1726   0ED8 00 00 00 00 
1726   0EDC 00 00 00 00 
1726   0EE0 00 00 00 00 
1726   0EE4 00 00 00 00 
1726   0EE8 00 00 00 00 
1726   0EEC 00 00 00 00 
1726   0EF0 00 00 00 00 
1726   0EF4 00 00 00 00 
1726   0EF8 00 00 00 00 
1726   0EFC 00 00 00 00 
1726   0F00 00 00 00 00 
1726   0F04 00 00 00 00 
1726   0F08 00 00 00 00 
1726   0F0C 00 00 00 00 
1726   0F10 00 00 00 00 
1726   0F14 00 00 00 00 
1726   0F18 00 00 00 00 
1726   0F1C 00 00 00 00 
1726   0F20 00 00 00 00 
1726   0F24 00 00 00 00 
1726   0F28 00 00 00 00 
1726   0F2C 00 00 00 00 
1726   0F30 00 00 00 00 
1726   0F34 00 00 00 00 
1726   0F38 00 00 00 00 
1726   0F3C 00 00 00 00 
1726   0F40 00 00 00 00 
1726   0F44 00 00 00 00 
1726   0F48 00 00 00 00 
1726   0F4C 00 00 00 00 
1726   0F50 00 00 00 00 
1726   0F54 00 00 00 00 
1726   0F58 00 00 00 00 
1726   0F5C 00 00 00 00 
1726   0F60 00 
1727   0F61 FD 71         seq ; ==
1728   0F63 FD F1         pop g
1729   0F65 E4            pop a
1730   0F66             ; END RELATIONAL
1731   0F66 C0 00 00      cmp b, 0
1732   0F69 C6 7B 0F      je _if27_exit
1733   0F6C             _if27_true:
1734   0F6C             ;; putchar('0'); 
1735   0F6C 26 30 00      mov b, $30
1736   0F6F DD            push bl
1737   0F70 07 01 13      call putchar
1738   0F73 51 01 00      add sp, 1
1739   0F76             ;; return; 
1740   0F76 F9            leave
1741   0F77 09            ret
1742   0F78 0A 7B 0F      jmp _if27_exit
1743   0F7B             _if27_exit:
1744   0F7B             _if26_exit:
1745   0F7B             ;; while (num > 0) { 
1746   0F7B             _while28_cond:
1747   0F7B FA 05 00      lea d, [bp + 5] ; $num
1748   0F7E 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
1749   0F81 FD 39         mov c, b ; And place it into C
1750   0F83 2A            mov b, [d] ; Lower Word in B
1751   0F84             ; START RELATIONAL
1752   0F84 D7            push a
1753   0F85 FD D8         push g
1754   0F87 11            mov a, b
out/startrek.asm line 1755: Label not found: (c)
out/startrek.asm line 1755: Unused data in MS byte of argument. (2)
1755   0F88 FD 22 00 00   mov g, c
1756   0F8C 26 00 00      mov b, $0
1757   0F8F 38 00 00      mov c, 0
1758   0F92 FD 7F         sgt
1759   0F94 FD F1         pop g
1760   0F96 E4            pop a
1761   0F97             ; END RELATIONAL
1762   0F97 C0 00 00      cmp b, 0
1763   0F9A C6 FA 0F      je _while28_exit
1764   0F9D             _while28_block:
1765   0F9D             ;; digits[i] = '0' + (num % 10); 
1766   0F9D FA F7 FF      lea d, [bp + -9] ; $digits
1767   0FA0 D7            push a
1768   0FA1 DA            push d
1769   0FA2 FA F5 FF      lea d, [bp + -11] ; $i
1770   0FA5 2A            mov b, [d]
1771   0FA6 E7            pop d
1772   0FA7 5A            add d, b
1773   0FA8 E4            pop a
1774   0FA9 DA            push d
1775   0FAA 26 30 00      mov b, $30
1776   0FAD             ; START TERMS
1777   0FAD D7            push a
1778   0FAE 11            mov a, b
1779   0FAF FA 05 00      lea d, [bp + 5] ; $num
1780   0FB2 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
1781   0FB5 FD 39         mov c, b ; And place it into C
1782   0FB7 2A            mov b, [d] ; Lower Word in B
1783   0FB8             ; START FACTORS
1784   0FB8 D7            push a
1785   0FB9 11            mov a, b
1786   0FBA 26 0A 00      mov b, $a
1787   0FBD AE            div a, b ; 
1788   0FBE 11            mov a, b
1789   0FBF 27            mov b, a
1790   0FC0 E4            pop a
1791   0FC1             ; END FACTORS
1792   0FC1 54            add a, b
1793   0FC2 D7            push a
1794   0FC3 FD 12         mov a, g
1795   0FC5 28            mov b, c
1796   0FC6 5C            adc a, b
1797   0FC7 39            mov c, a
1798   0FC8 E5            pop b
1799   0FC9 E4            pop a
1800   0FCA             ; END TERMS
1801   0FCA E7            pop d
1802   0FCB FD 3E         mov [d], bl
1803   0FCD             ;; num = num / 10; 
1804   0FCD FA 05 00      lea d, [bp + 5] ; $num
1805   0FD0 DA            push d
1806   0FD1 FA 05 00      lea d, [bp + 5] ; $num
1807   0FD4 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
1808   0FD7 FD 39         mov c, b ; And place it into C
1809   0FD9 2A            mov b, [d] ; Lower Word in B
1810   0FDA             ; START FACTORS
1811   0FDA D7            push a
1812   0FDB 11            mov a, b
1813   0FDC 26 0A 00      mov b, $a
1814   0FDF AE            div a, b
1815   0FE0 27            mov b, a
1816   0FE1 E4            pop a
1817   0FE2             ; END FACTORS
1818   0FE2 E7            pop d
1819   0FE3 FD 43         mov [d], b
1820   0FE5 28            mov b, c
1821   0FE6 FD 44 02 00   mov [d + 2], b
1822   0FEA             ;; i++; 
1823   0FEA FA F5 FF      lea d, [bp + -11] ; $i
1824   0FED 2A            mov b, [d]
1825   0FEE D8            push b
1826   0FEF FD 77         inc b
1827   0FF1 FA F5 FF      lea d, [bp + -11] ; $i
1828   0FF4 FD 43         mov [d], b
1829   0FF6 E5            pop b
1830   0FF7 0A 7B 0F      jmp _while28_cond
1831   0FFA             _while28_exit:
1832   0FFA             ;; while (i > 0) { 
1833   0FFA             _while29_cond:
1834   0FFA FA F5 FF      lea d, [bp + -11] ; $i
1835   0FFD 2A            mov b, [d]
1836   0FFE             ; START RELATIONAL
1837   0FFE D7            push a
1838   0FFF 11            mov a, b
1839   1000 26 00 00      mov b, $0
1840   1003 B0            cmp a, b
1841   1004 FD 7F         sgt ; >
1842   1006 E4            pop a
1843   1007             ; END RELATIONAL
1844   1007 C0 00 00      cmp b, 0
1845   100A C6 33 10      je _while29_exit
1846   100D             _while29_block:
1847   100D             ;; i--; 
1848   100D FA F5 FF      lea d, [bp + -11] ; $i
1849   1010 2A            mov b, [d]
1850   1011 D8            push b
1851   1012 FD 7D         dec b
1852   1014 FA F5 FF      lea d, [bp + -11] ; $i
1853   1017 FD 43         mov [d], b
1854   1019 E5            pop b
1855   101A             ;; putchar(digits[i]); 
1856   101A FA F7 FF      lea d, [bp + -9] ; $digits
1857   101D D7            push a
1858   101E DA            push d
1859   101F FA F5 FF      lea d, [bp + -11] ; $i
1860   1022 2A            mov b, [d]
1861   1023 E7            pop d
1862   1024 5A            add d, b
1863   1025 E4            pop a
1864   1026 32            mov bl, [d]
1865   1027 A7 00         mov bh, 0
1866   1029 DD            push bl
1867   102A 07 01 13      call putchar
1868   102D 51 01 00      add sp, 1
1869   1030 0A FA 0F      jmp _while29_cond
1870   1033             _while29_exit:
1871   1033 F9            leave
1872   1034 09            ret
1873   1035             
1874   1035             print_unsigned_long:
1875   1035 F8 00 00      enter 0 ; (push bp; mov bp, sp)
1876   1038             ; $digits 
1877   1038             ; $i 
1878   1038 52 0C 00      sub sp, 12
1879   103B             ;; i = 0; 
1880   103B FA F5 FF      lea d, [bp + -11] ; $i
1881   103E DA            push d
1882   103F 26 00 00      mov b, $0
1883   1042 E7            pop d
1884   1043 FD 43         mov [d], b
1885   1045             ;; if(num == 0){ 
1886   1045             _if30_cond:
1887   1045 FA 05 00      lea d, [bp + 5] ; $num
1888   1048 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
1889   104B FD 39         mov c, b ; And place it into C
1890   104D 2A            mov b, [d] ; Lower Word in B
1891   104E             ; START RELATIONAL
1892   104E D7            push a
1893   104F FD D8         push g
1894   1051 11            mov a, b
out/startrek.asm line 1895: Label not found: (c)
out/startrek.asm line 1895: Unused data in MS byte of argument. (2)
1895   1052 FD 22 00 00   mov g, c
1896   1056 26 00 00      mov b, $0
1897   1059 38 00 00      mov c, 0
1898   105C FD AF 00 00   cmp32 ga, cb
1898   1060 00 00 00 00 
1898   1064 00 00 00 00 
1898   1068 00 00 00 00 
1898   106C 00 00 00 00 
1898   1070 00 00 00 00 
1898   1074 00 00 00 00 
1898   1078 00 00 00 00 
1898   107C 00 00 00 00 
1898   1080 00 00 00 00 
1898   1084 00 00 00 00 
1898   1088 00 00 00 00 
1898   108C 00 00 00 00 
1898   1090 00 00 00 00 
1898   1094 00 00 00 00 
1898   1098 00 00 00 00 
1898   109C 00 00 00 00 
1898   10A0 00 00 00 00 
1898   10A4 00 00 00 00 
1898   10A8 00 00 00 00 
1898   10AC 00 00 00 00 
1898   10B0 00 00 00 00 
1898   10B4 00 00 00 00 
1898   10B8 00 00 00 00 
1898   10BC 00 00 00 00 
1898   10C0 00 00 00 00 
1898   10C4 00 00 00 00 
1898   10C8 00 00 00 00 
1898   10CC 00 00 00 00 
1898   10D0 00 00 00 00 
1898   10D4 00 00 00 00 
1898   10D8 00 00 00 00 
1898   10DC 00 00 00 00 
1898   10E0 00 00 00 00 
1898   10E4 00 00 00 00 
1898   10E8 00 00 00 00 
1898   10EC 00 00 00 00 
1898   10F0 00 00 00 00 
1898   10F4 00 00 00 00 
1898   10F8 00 00 00 00 
1898   10FC 00 00 00 00 
1898   1100 00 00 00 00 
1898   1104 00 00 00 00 
1898   1108 00 00 00 00 
1898   110C 00 00 00 00 
1898   1110 00 00 00 00 
1898   1114 00 00 00 00 
1898   1118 00 00 00 00 
1898   111C 00 00 00 00 
1898   1120 00 00 00 00 
1898   1124 00 00 00 00 
1898   1128 00 00 00 00 
1898   112C 00 00 00 00 
1898   1130 00 00 00 00 
1898   1134 00 00 00 00 
1898   1138 00 00 00 00 
1898   113C 00 00 00 00 
1898   1140 00 00 00 00 
1898   1144 00 00 00 00 
1898   1148 00 00 00 00 
1898   114C 00 00 00 00 
1898   1150 00 00 00 00 
1898   1154 00 00 00 00 
1898   1158 00 00 00 00 
1898   115C 00 
1899   115D FD 71         seq ; ==
1900   115F FD F1         pop g
1901   1161 E4            pop a
1902   1162             ; END RELATIONAL
1903   1162 C0 00 00      cmp b, 0
1904   1165 C6 77 11      je _if30_exit
1905   1168             _if30_true:
1906   1168             ;; putchar('0'); 
1907   1168 26 30 00      mov b, $30
1908   116B DD            push bl
1909   116C 07 01 13      call putchar
1910   116F 51 01 00      add sp, 1
1911   1172             ;; return; 
1912   1172 F9            leave
1913   1173 09            ret
1914   1174 0A 77 11      jmp _if30_exit
1915   1177             _if30_exit:
1916   1177             ;; while (num > 0) { 
1917   1177             _while31_cond:
1918   1177 FA 05 00      lea d, [bp + 5] ; $num
1919   117A 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
1920   117D FD 39         mov c, b ; And place it into C
1921   117F 2A            mov b, [d] ; Lower Word in B
1922   1180             ; START RELATIONAL
1923   1180 D7            push a
1924   1181 FD D8         push g
1925   1183 11            mov a, b
out/startrek.asm line 1926: Label not found: (c)
out/startrek.asm line 1926: Unused data in MS byte of argument. (2)
1926   1184 FD 22 00 00   mov g, c
1927   1188 26 00 00      mov b, $0
1928   118B 38 00 00      mov c, 0
1929   118E FD 81         sgu
1930   1190 FD F1         pop g
1931   1192 E4            pop a
1932   1193             ; END RELATIONAL
1933   1193 C0 00 00      cmp b, 0
1934   1196 C6 F6 11      je _while31_exit
1935   1199             _while31_block:
1936   1199             ;; digits[i] = '0' + (num % 10); 
1937   1199 FA F7 FF      lea d, [bp + -9] ; $digits
1938   119C D7            push a
1939   119D DA            push d
1940   119E FA F5 FF      lea d, [bp + -11] ; $i
1941   11A1 2A            mov b, [d]
1942   11A2 E7            pop d
1943   11A3 5A            add d, b
1944   11A4 E4            pop a
1945   11A5 DA            push d
1946   11A6 26 30 00      mov b, $30
1947   11A9             ; START TERMS
1948   11A9 D7            push a
1949   11AA 11            mov a, b
1950   11AB FA 05 00      lea d, [bp + 5] ; $num
1951   11AE 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
1952   11B1 FD 39         mov c, b ; And place it into C
1953   11B3 2A            mov b, [d] ; Lower Word in B
1954   11B4             ; START FACTORS
1955   11B4 D7            push a
1956   11B5 11            mov a, b
1957   11B6 26 0A 00      mov b, $a
1958   11B9 AE            div a, b ; 
1959   11BA 11            mov a, b
1960   11BB 27            mov b, a
1961   11BC E4            pop a
1962   11BD             ; END FACTORS
1963   11BD 54            add a, b
1964   11BE D7            push a
1965   11BF FD 12         mov a, g
1966   11C1 28            mov b, c
1967   11C2 5C            adc a, b
1968   11C3 39            mov c, a
1969   11C4 E5            pop b
1970   11C5 E4            pop a
1971   11C6             ; END TERMS
1972   11C6 E7            pop d
1973   11C7 FD 3E         mov [d], bl
1974   11C9             ;; num = num / 10; 
1975   11C9 FA 05 00      lea d, [bp + 5] ; $num
1976   11CC DA            push d
1977   11CD FA 05 00      lea d, [bp + 5] ; $num
1978   11D0 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
1979   11D3 FD 39         mov c, b ; And place it into C
1980   11D5 2A            mov b, [d] ; Lower Word in B
1981   11D6             ; START FACTORS
1982   11D6 D7            push a
1983   11D7 11            mov a, b
1984   11D8 26 0A 00      mov b, $a
1985   11DB AE            div a, b
1986   11DC 27            mov b, a
1987   11DD E4            pop a
1988   11DE             ; END FACTORS
1989   11DE E7            pop d
1990   11DF FD 43         mov [d], b
1991   11E1 28            mov b, c
1992   11E2 FD 44 02 00   mov [d + 2], b
1993   11E6             ;; i++; 
1994   11E6 FA F5 FF      lea d, [bp + -11] ; $i
1995   11E9 2A            mov b, [d]
1996   11EA D8            push b
1997   11EB FD 77         inc b
1998   11ED FA F5 FF      lea d, [bp + -11] ; $i
1999   11F0 FD 43         mov [d], b
2000   11F2 E5            pop b
2001   11F3 0A 77 11      jmp _while31_cond
2002   11F6             _while31_exit:
2003   11F6             ;; while (i > 0) { 
2004   11F6             _while32_cond:
2005   11F6 FA F5 FF      lea d, [bp + -11] ; $i
2006   11F9 2A            mov b, [d]
2007   11FA             ; START RELATIONAL
2008   11FA D7            push a
2009   11FB 11            mov a, b
2010   11FC 26 00 00      mov b, $0
2011   11FF B0            cmp a, b
2012   1200 FD 7F         sgt ; >
2013   1202 E4            pop a
2014   1203             ; END RELATIONAL
2015   1203 C0 00 00      cmp b, 0
2016   1206 C6 2F 12      je _while32_exit
2017   1209             _while32_block:
2018   1209             ;; i--; 
2019   1209 FA F5 FF      lea d, [bp + -11] ; $i
2020   120C 2A            mov b, [d]
2021   120D D8            push b
2022   120E FD 7D         dec b
2023   1210 FA F5 FF      lea d, [bp + -11] ; $i
2024   1213 FD 43         mov [d], b
2025   1215 E5            pop b
2026   1216             ;; putchar(digits[i]); 
2027   1216 FA F7 FF      lea d, [bp + -9] ; $digits
2028   1219 D7            push a
2029   121A DA            push d
2030   121B FA F5 FF      lea d, [bp + -11] ; $i
2031   121E 2A            mov b, [d]
2032   121F E7            pop d
2033   1220 5A            add d, b
2034   1221 E4            pop a
2035   1222 32            mov bl, [d]
2036   1223 A7 00         mov bh, 0
2037   1225 DD            push bl
2038   1226 07 01 13      call putchar
2039   1229 51 01 00      add sp, 1
2040   122C 0A F6 11      jmp _while32_cond
2041   122F             _while32_exit:
2042   122F F9            leave
2043   1230 09            ret
2044   1231             
2045   1231             print_unsigned:
2046   1231 F8 00 00      enter 0 ; (push bp; mov bp, sp)
2047   1234             ; $digits 
2048   1234             ; $i 
2049   1234 52 07 00      sub sp, 7
2050   1237             ;; i = 0; 
2051   1237 FA FA FF      lea d, [bp + -6] ; $i
2052   123A DA            push d
2053   123B 26 00 00      mov b, $0
2054   123E E7            pop d
2055   123F FD 43         mov [d], b
2056   1241             ;; if(num == 0){ 
2057   1241             _if33_cond:
2058   1241 FA 05 00      lea d, [bp + 5] ; $num
2059   1244 2A            mov b, [d]
2060   1245             ; START RELATIONAL
2061   1245 D7            push a
2062   1246 11            mov a, b
2063   1247 26 00 00      mov b, $0
2064   124A B0            cmp a, b
2065   124B FD 71         seq ; ==
2066   124D E4            pop a
2067   124E             ; END RELATIONAL
2068   124E C0 00 00      cmp b, 0
2069   1251 C6 63 12      je _if33_exit
2070   1254             _if33_true:
2071   1254             ;; putchar('0'); 
2072   1254 26 30 00      mov b, $30
2073   1257 DD            push bl
2074   1258 07 01 13      call putchar
2075   125B 51 01 00      add sp, 1
2076   125E             ;; return; 
2077   125E F9            leave
2078   125F 09            ret
2079   1260 0A 63 12      jmp _if33_exit
2080   1263             _if33_exit:
2081   1263             ;; while (num > 0) { 
2082   1263             _while34_cond:
2083   1263 FA 05 00      lea d, [bp + 5] ; $num
2084   1266 2A            mov b, [d]
2085   1267             ; START RELATIONAL
2086   1267 D7            push a
2087   1268 11            mov a, b
2088   1269 26 00 00      mov b, $0
2089   126C B0            cmp a, b
2090   126D FD 81         sgu ; > (unsigned)
2091   126F E4            pop a
2092   1270             ; END RELATIONAL
2093   1270 C0 00 00      cmp b, 0
2094   1273 C6 BD 12      je _while34_exit
2095   1276             _while34_block:
2096   1276             ;; digits[i] = '0' + (num % 10); 
2097   1276 FA FC FF      lea d, [bp + -4] ; $digits
2098   1279 D7            push a
2099   127A DA            push d
2100   127B FA FA FF      lea d, [bp + -6] ; $i
2101   127E 2A            mov b, [d]
2102   127F E7            pop d
2103   1280 5A            add d, b
2104   1281 E4            pop a
2105   1282 DA            push d
2106   1283 26 30 00      mov b, $30
2107   1286             ; START TERMS
2108   1286 D7            push a
2109   1287 11            mov a, b
2110   1288 FA 05 00      lea d, [bp + 5] ; $num
2111   128B 2A            mov b, [d]
2112   128C             ; START FACTORS
2113   128C D7            push a
2114   128D 11            mov a, b
2115   128E 26 0A 00      mov b, $a
2116   1291 AE            div a, b ; 
2117   1292 11            mov a, b
2118   1293 27            mov b, a
2119   1294 E4            pop a
2120   1295             ; END FACTORS
2121   1295 56            add b, a
2122   1296 E4            pop a
2123   1297             ; END TERMS
2124   1297 E7            pop d
2125   1298 FD 3E         mov [d], bl
2126   129A             ;; num = num / 10; 
2127   129A FA 05 00      lea d, [bp + 5] ; $num
2128   129D DA            push d
2129   129E FA 05 00      lea d, [bp + 5] ; $num
2130   12A1 2A            mov b, [d]
2131   12A2             ; START FACTORS
2132   12A2 D7            push a
2133   12A3 11            mov a, b
2134   12A4 26 0A 00      mov b, $a
2135   12A7 AE            div a, b
2136   12A8 27            mov b, a
2137   12A9 E4            pop a
2138   12AA             ; END FACTORS
2139   12AA E7            pop d
2140   12AB FD 43         mov [d], b
2141   12AD             ;; i++; 
2142   12AD FA FA FF      lea d, [bp + -6] ; $i
2143   12B0 2A            mov b, [d]
2144   12B1 D8            push b
2145   12B2 FD 77         inc b
2146   12B4 FA FA FF      lea d, [bp + -6] ; $i
2147   12B7 FD 43         mov [d], b
2148   12B9 E5            pop b
2149   12BA 0A 63 12      jmp _while34_cond
2150   12BD             _while34_exit:
2151   12BD             ;; while (i > 0) { 
2152   12BD             _while35_cond:
2153   12BD FA FA FF      lea d, [bp + -6] ; $i
2154   12C0 2A            mov b, [d]
2155   12C1             ; START RELATIONAL
2156   12C1 D7            push a
2157   12C2 11            mov a, b
2158   12C3 26 00 00      mov b, $0
2159   12C6 B0            cmp a, b
2160   12C7 FD 7F         sgt ; >
2161   12C9 E4            pop a
2162   12CA             ; END RELATIONAL
2163   12CA C0 00 00      cmp b, 0
2164   12CD C6 F6 12      je _while35_exit
2165   12D0             _while35_block:
2166   12D0             ;; i--; 
2167   12D0 FA FA FF      lea d, [bp + -6] ; $i
2168   12D3 2A            mov b, [d]
2169   12D4 D8            push b
2170   12D5 FD 7D         dec b
2171   12D7 FA FA FF      lea d, [bp + -6] ; $i
2172   12DA FD 43         mov [d], b
2173   12DC E5            pop b
2174   12DD             ;; putchar(digits[i]); 
2175   12DD FA FC FF      lea d, [bp + -4] ; $digits
2176   12E0 D7            push a
2177   12E1 DA            push d
2178   12E2 FA FA FF      lea d, [bp + -6] ; $i
2179   12E5 2A            mov b, [d]
2180   12E6 E7            pop d
2181   12E7 5A            add d, b
2182   12E8 E4            pop a
2183   12E9 32            mov bl, [d]
2184   12EA A7 00         mov bh, 0
2185   12EC DD            push bl
2186   12ED 07 01 13      call putchar
2187   12F0 51 01 00      add sp, 1
2188   12F3 0A BD 12      jmp _while35_cond
2189   12F6             _while35_exit:
2190   12F6 F9            leave
2191   12F7 09            ret
2192   12F8             
2193   12F8             date:
2194   12F8 F8 00 00      enter 0 ; (push bp; mov bp, sp)
2195   12FB             
2196   12FB             ; --- BEGIN INLINE ASM BLOCK
2197   12FB 19 00         mov al, 0 
2198   12FD 05 07         syscall sys_datetime
2199   12FF             ; --- END INLINE ASM BLOCK
2200   12FF             
2201   12FF F9            leave
2202   1300 09            ret
2203   1301             
2204   1301             putchar:
2205   1301 F8 00 00      enter 0 ; (push bp; mov bp, sp)
2206   1304             
2207   1304             ; --- BEGIN INLINE ASM BLOCK
2208   1304 FA 05 00      lea d, [bp + 5] ; $c
2209   1307 1E            mov al, [d]
2210   1308 23            mov ah, al
2211   1309 07 92 14      call _putchar
2212   130C             ; --- END INLINE ASM BLOCK
2213   130C             
2214   130C F9            leave
2215   130D 09            ret
2216   130E             
2217   130E             getchar:
2218   130E F8 00 00      enter 0 ; (push bp; mov bp, sp)
2219   1311             ; $c 
2220   1311 52 01 00      sub sp, 1
2221   1314             
2222   1314             ; --- BEGIN INLINE ASM BLOCK
2223   1314 07 8B 14      call getch
2224   1317 1A            mov al, ah
2225   1318 FA 00 00      lea d, [bp + 0] ; $c
2226   131B 3E            mov [d], al
2227   131C             ; --- END INLINE ASM BLOCK
2228   131C             
2229   131C             ;; return c; 
2230   131C FA 00 00      lea d, [bp + 0] ; $c
2231   131F 32            mov bl, [d]
2232   1320 A7 00         mov bh, 0
2233   1322 F9            leave
2234   1323 09            ret
2235   1324             
2236   1324             scann:
2237   1324 F8 00 00      enter 0 ; (push bp; mov bp, sp)
2238   1327             ; $m 
2239   1327 52 02 00      sub sp, 2
2240   132A             
2241   132A             ; --- BEGIN INLINE ASM BLOCK
2242   132A 07 D6 16      call scan_u16d
2243   132D FA FF FF      lea d, [bp + -1] ; $m
2244   1330 43            mov [d], a
2245   1331             ; --- END INLINE ASM BLOCK
2246   1331             
2247   1331             ;; return m; 
2248   1331 FA FF FF      lea d, [bp + -1] ; $m
2249   1334 2A            mov b, [d]
2250   1335 F9            leave
2251   1336 09            ret
2252   1337             
2253   1337             puts:
2254   1337 F8 00 00      enter 0 ; (push bp; mov bp, sp)
2255   133A             
2256   133A             ; --- BEGIN INLINE ASM BLOCK
2257   133A FA 05 00      lea d, [bp + 5] ; $s
2258   133D 15            mov a, [d]
2259   133E 3C            mov d, a
2260   133F 07 DC 15      call _puts
2261   1342 10 00 0A      mov a, $0A00
2262   1345 05 03         syscall sys_io
2263   1347             ; --- END INLINE ASM BLOCK
2264   1347             
2265   1347 F9            leave
2266   1348 09            ret
2267   1349             
2268   1349             print:
2269   1349 F8 00 00      enter 0 ; (push bp; mov bp, sp)
2270   134C             
2271   134C             ; --- BEGIN INLINE ASM BLOCK
2272   134C FA 05 00      lea d, [bp + 5] ; $s
2273   134F FD 2A         mov d, [d]
2274   1351 07 DC 15      call _puts
2275   1354             ; --- END INLINE ASM BLOCK
2276   1354             
2277   1354 F9            leave
2278   1355 09            ret
2279   1356             
2280   1356             getparam:
2281   1356 F8 00 00      enter 0 ; (push bp; mov bp, sp)
2282   1359             ; $data 
2283   1359 52 01 00      sub sp, 1
2284   135C             
2285   135C             ; --- BEGIN INLINE ASM BLOCK
2286   135C 19 04         mov al, 4
2287   135E FA 05 00      lea d, [bp + 5] ; $address
2288   1361 FD 2A         mov d, [d]
2289   1363 05 0C         syscall sys_system
2290   1365 FA 00 00      lea d, [bp + 0] ; $data
2291   1368 FD 3E         mov [d], bl
2292   136A             ; --- END INLINE ASM BLOCK
2293   136A             
2294   136A             ;; return data; 
2295   136A FA 00 00      lea d, [bp + 0] ; $data
2296   136D 32            mov bl, [d]
2297   136E A7 00         mov bh, 0
2298   1370 F9            leave
2299   1371 09            ret
2300   1372             
2301   1372             clear:
2302   1372 F8 00 00      enter 0 ; (push bp; mov bp, sp)
2303   1375             ;; print("\033[2J\033[H"); 
2304   1375 26 4E 66      mov b, __s31 ; "\033[2J\033[H"
2305   1378 FD AB         swp b
2306   137A D8            push b
2307   137B 07 49 13      call print
2308   137E 51 02 00      add sp, 2
2309   1381 F9            leave
2310   1382 09            ret
2311   1383             
2312   1383             abs:
2313   1383 F8 00 00      enter 0 ; (push bp; mov bp, sp)
2314   1386             ;; return i < 0 ? -i : i; 
2315   1386             _ternary36_cond:
2316   1386 FA 05 00      lea d, [bp + 5] ; $i
2317   1389 2A            mov b, [d]
2318   138A             ; START RELATIONAL
2319   138A D7            push a
2320   138B 11            mov a, b
2321   138C 26 00 00      mov b, $0
2322   138F B0            cmp a, b
2323   1390 FD 73         slt ; < (signed)
2324   1392 E4            pop a
2325   1393             ; END RELATIONAL
2326   1393 C0 00 00      cmp b, 0
2327   1396 C6 A2 13      je _ternary36_false
2328   1399             _ternary36_true:
2329   1399 FA 05 00      lea d, [bp + 5] ; $i
2330   139C 2A            mov b, [d]
2331   139D FD 97         neg b
2332   139F 0A A6 13      jmp _ternary36_exit
2333   13A2             _ternary36_false:
2334   13A2 FA 05 00      lea d, [bp + 5] ; $i
2335   13A5 2A            mov b, [d]
2336   13A6             _ternary36_exit:
2337   13A6 F9            leave
2338   13A7 09            ret
2339   13A8             
2340   13A8             include_stdio_asm:
2341   13A8 F8 00 00      enter 0 ; (push bp; mov bp, sp)
2342   13AB             
2343   13AB             ; --- BEGIN INLINE ASM BLOCK
2344   13AB             .include "lib/asm/stdio.asm"
0001+  13AB             ;-----------------------------------------------------------------------------
0002+  13AB             ; stdio.s
0003+  13AB             ;-----------------------------------------------------------------------------
0004+  13AB             .include "lib/asm/string.asm"
0001++ 13AB             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0002++ 13AB             ; string.s
0003++ 13AB             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0004++ 13AB             
0005++ 13AB             
0006++ 13AB             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0007++ 13AB             ; _strrev
0008++ 13AB             ; reverse a string
0009++ 13AB             ; D = string address
0010++ 13AB             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0011++ 13AB             ; 01234
0012++ 13AB             _strrev:
0013++ 13AB 4B          	pusha
0014++ 13AC 07 F2 13    	call _strlen	; length in C
0015++ 13AF 12          	mov a, c
0016++ 13B0 AF 01 00    	cmp a, 1
0017++ 13B3 D0 CD 13    	jleu _strrev_end	; check string length. string len must be > 1
0018++ 13B6 7D          	dec a
0019++ 13B7 FD 4E       	mov si, d	; beginning of string
0020++ 13B9 FD 50       	mov di, d	; beginning of string (for destinations)
0021++ 13BB 59          	add d, a	; end of string
0022++ 13BC 12          	mov a, c
0023++ 13BD FD 9B       	shr a		; divide by 2
0024++ 13BF 39          	mov c, a	; C now counts the steps
0025++ 13C0             _strrev_L0:
0026++ 13C0 32          	mov bl, [d]	; save load right-side char into BL
0027++ 13C1 F6          	lodsb		; load left-side char into AL; increase SI
0028++ 13C2 3E          	mov [d], al	; store left char into right side
0029++ 13C3 1B          	mov al, bl
0030++ 13C4 F7          	stosb		; store right-side char into left-side; increase DI
0031++ 13C5 7E          	dec c
0032++ 13C6 7F          	dec d
0033++ 13C7 C2 00 00    	cmp c, 0
0034++ 13CA C7 C0 13    	jne _strrev_L0
0035++ 13CD             _strrev_end:
0036++ 13CD 4C          	popa
0037++ 13CE 09          	ret
0038++ 13CF             	
0039++ 13CF             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0040++ 13CF             ; _strchr
0041++ 13CF             ; search string in D for char in AL
0042++ 13CF             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0043++ 13CF             _strchr:
0044++ 13CF             _strchr_L0:
0045++ 13CF 32          	mov bl, [d]
0046++ 13D0 C1 00       	cmp bl, 0
0047++ 13D2 C6 DD 13    	je _strchr_end
0048++ 13D5 BA          	cmp al, bl
0049++ 13D6 C6 DD 13    	je _strchr_end
0050++ 13D9 79          	inc d
0051++ 13DA 0A CF 13    	jmp _strchr_L0
0052++ 13DD             _strchr_end:
0053++ 13DD 1B          	mov al, bl
0054++ 13DE 09          	ret
0055++ 13DF             
0056++ 13DF             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0057++ 13DF             ; _strstr
0058++ 13DF             ; find sub-string
0059++ 13DF             ; str1 in SI
0060++ 13DF             ; str2 in DI
0061++ 13DF             ; SI points to end of source string
0062++ 13DF             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0063++ 13DF             _strstr:
0064++ 13DF DB          	push al
0065++ 13E0 DA          	push d
0066++ 13E1 E3          	push di
0067++ 13E2             _strstr_loop:
0068++ 13E2 F3          	cmpsb					; compare a byte of the strings
0069++ 13E3 C7 EE 13    	jne _strstr_ret
0070++ 13E6 FC 00 00    	lea d, [di + 0]
0071++ 13E9 BD 00       	cmp byte[d], 0				; check if at end of string (null)
0072++ 13EB C7 E2 13    	jne _strstr_loop				; equal chars but not at end
0073++ 13EE             _strstr_ret:
0074++ 13EE F0          	pop di
0075++ 13EF E7          	pop d
0076++ 13F0 E8          	pop al
0077++ 13F1 09          	ret
0078++ 13F2             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0079++ 13F2             ; length of null terminated string
0080++ 13F2             ; result in C
0081++ 13F2             ; pointer in D
0082++ 13F2             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0083++ 13F2             _strlen:
0084++ 13F2 DA          	push d
0085++ 13F3 38 00 00    	mov c, 0
0086++ 13F6             _strlen_L1:
0087++ 13F6 BD 00       	cmp byte [d], 0
0088++ 13F8 C6 00 14    	je _strlen_ret
0089++ 13FB 79          	inc d
0090++ 13FC 78          	inc c
0091++ 13FD 0A F6 13    	jmp _strlen_L1
0092++ 1400             _strlen_ret:
0093++ 1400 E7          	pop d
0094++ 1401 09          	ret
0095++ 1402             
0096++ 1402             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0097++ 1402             ; STRCMP
0098++ 1402             ; compare two strings
0099++ 1402             ; str1 in SI
0100++ 1402             ; str2 in DI
0101++ 1402             ; CREATE A STRING COMPAIRON INSTRUCION ?????
0102++ 1402             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0103++ 1402             _strcmp:
0104++ 1402 DB          	push al
0105++ 1403 DA          	push d
0106++ 1404 E3          	push di
0107++ 1405 E2          	push si
0108++ 1406             _strcmp_loop:
0109++ 1406 F3          	cmpsb					; compare a byte of the strings
0110++ 1407 C7 12 14    	jne _strcmp_ret
0111++ 140A FB FF FF    	lea d, [si +- 1]
0112++ 140D BD 00       	cmp byte[d], 0				; check if at end of string (null)
0113++ 140F C7 06 14    	jne _strcmp_loop				; equal chars but not at end
0114++ 1412             _strcmp_ret:
0115++ 1412 EF          	pop si
0116++ 1413 F0          	pop di
0117++ 1414 E7          	pop d
0118++ 1415 E8          	pop al
0119++ 1416 09          	ret
0120++ 1417             
0121++ 1417             
0122++ 1417             ; STRCPY
0123++ 1417             ; copy null terminated string from SI to DI
0124++ 1417             ; source in SI
0125++ 1417             ; destination in DI
0126++ 1417             _strcpy:
0127++ 1417 E2          	push si
0128++ 1418 E3          	push di
0129++ 1419 DB          	push al
0130++ 141A             _strcpy_L1:
0131++ 141A F6          	lodsb
0132++ 141B F7          	stosb
0133++ 141C B9 00       	cmp al, 0
0134++ 141E C7 1A 14    	jne _strcpy_L1
0135++ 1421             _strcpy_end:
0136++ 1421 E8          	pop al
0137++ 1422 F0          	pop di
0138++ 1423 EF          	pop si
0139++ 1424 09          	ret
0140++ 1425             
0141++ 1425             ; STRCAT
0142++ 1425             ; concatenate a NULL terminated string into string at DI, from string at SI
0143++ 1425             ; source in SI
0144++ 1425             ; destination in DI
0145++ 1425             _strcat:
0146++ 1425 E2          	push si
0147++ 1426 E3          	push di
0148++ 1427 D7          	push a
0149++ 1428 DA          	push d
0150++ 1429 50          	mov a, di
0151++ 142A 3C          	mov d, a
0152++ 142B             _strcat_goto_end_L1:
0153++ 142B BD 00       	cmp byte[d], 0
0154++ 142D C6 34 14    	je _strcat_start
0155++ 1430 79          	inc d
0156++ 1431 0A 2B 14    	jmp _strcat_goto_end_L1
0157++ 1434             _strcat_start:
0158++ 1434 FD 50       	mov di, d
0159++ 1436             _strcat_L1:
0160++ 1436 F6          	lodsb
0161++ 1437 F7          	stosb
0162++ 1438 B9 00       	cmp al, 0
0163++ 143A C7 36 14    	jne _strcat_L1
0164++ 143D             _strcat_end:
0165++ 143D E7          	pop d
0166++ 143E E4          	pop a
0167++ 143F F0          	pop di
0168++ 1440 EF          	pop si
0169++ 1441 09          	ret
0170++ 1442             
0171++ 1442             
0005+  1442             
0006+  1442             ;-----------------------------------------------------------------------------
0007+  1442             ; CONVERT ASCII 'O'..'F' TO INTEGER 0..15
0008+  1442             ; ASCII in BL
0009+  1442             ; result in AL
0010+  1442             ; ascii for F = 0100 0110
0011+  1442             ; ascii for 9 = 0011 1001
0012+  1442             ;-----------------------------------------------------------------------------
0013+  1442             hex_ascii_encode:
0014+  1442 1B            mov al, bl
0015+  1443 93 40         test al, $40        ; test if letter or number
0016+  1445 C7 4B 14      jnz hex_letter
0017+  1448 87 0F         and al, $0F        ; get number
0018+  144A 09            ret
0019+  144B             hex_letter:
0020+  144B 87 0F         and al, $0F        ; get letter
0021+  144D 6A 09         add al, 9
0022+  144F 09            ret
0023+  1450             
0024+  1450             ;-----------------------------------------------------------------------------
0025+  1450             ; ATOI
0026+  1450             ; 2 letter hex string in B
0027+  1450             ; 8bit integer returned in AL
0028+  1450             ;-----------------------------------------------------------------------------
0029+  1450             _atoi:
0030+  1450 D8            push b
0031+  1451 07 42 14      call hex_ascii_encode      ; convert BL to 4bit code in AL
0032+  1454 30            mov bl, bh
0033+  1455 DB            push al          ; save a
0034+  1456 07 42 14      call hex_ascii_encode
0035+  1459 EA            pop bl  
0036+  145A FD 9E 04      shl al, 4
0037+  145D 8C            or al, bl
0038+  145E E5            pop b
0039+  145F 09            ret  
0040+  1460             
0041+  1460             
0042+  1460             ;-----------------------------------------------------------------------------
0043+  1460             ; ITOA
0044+  1460             ; 8bit value in BL
0045+  1460             ; 2 byte ASCII result in A
0046+  1460             ;-----------------------------------------------------------------------------
0047+  1460             _itoa:
0048+  1460 DA            push d
0049+  1461 D8            push b
0050+  1462 A7 00         mov bh, 0
0051+  1464 FD A4 04      shr bl, 4  
0052+  1467 74            mov d, b
0053+  1468 1F 10 17      mov al, [d + s_hex_digits]
0054+  146B 23            mov ah, al
0055+  146C               
0056+  146C E5            pop b
0057+  146D D8            push b
0058+  146E A7 00         mov bh, 0
0059+  1470 FD 87 0F      and bl, $0F
0060+  1473 74            mov d, b
0061+  1474 1F 10 17      mov al, [d + s_hex_digits]
0062+  1477 E5            pop b
0063+  1478 E7            pop d
0064+  1479 09            ret
0065+  147A             
0066+  147A             ;-----------------------------------------------------------------------------
0067+  147A             ; HEX STRING TO BINARY
0068+  147A             ; di = destination address
0069+  147A             ; si = source
0070+  147A             ;-----------------------------------------------------------------------------
0071+  147A             _hex_to_int:
0072+  147A             _hex_to_int_L1:
0073+  147A F6            lodsb          ; load from [SI] to AL
0074+  147B B9 00         cmp al, 0        ; check if ASCII 0
0075+  147D C6 8A 14      jz _hex_to_int_ret
0076+  1480 36            mov bh, al
0077+  1481 F6            lodsb
0078+  1482 2F            mov bl, al
0079+  1483 07 50 14      call _atoi        ; convert ASCII byte in B to int (to AL)
0080+  1486 F7            stosb          ; store AL to [DI]
0081+  1487 0A 7A 14      jmp _hex_to_int_L1
0082+  148A             _hex_to_int_ret:
0083+  148A 09            ret    
0084+  148B             
0085+  148B             ;-----------------------------------------------------------------------------
0086+  148B             ; GETCHAR
0087+  148B             ; char in ah
0088+  148B             ;-----------------------------------------------------------------------------
0089+  148B             getch:
0090+  148B DB            push al
0091+  148C             getch_retry:
0092+  148C 19 01         mov al, 1
0093+  148E 05 03         syscall sys_io      ; receive in AH
0094+  1490 E8            pop al
0095+  1491 09            ret
0096+  1492             
0097+  1492             ;-----------------------------------------------------------------------------
0098+  1492             ; PUTCHAR
0099+  1492             ; char in ah
0100+  1492             ;-----------------------------------------------------------------------------
0101+  1492             _putchar:
0102+  1492 D7            push a
0103+  1493 19 00         mov al, 0
0104+  1495 05 03         syscall sys_io      ; char in AH
0105+  1497 E4            pop a
0106+  1498 09            ret
0107+  1499             
0108+  1499             ;-----------------------------------------------------------------------------
0109+  1499             ;; INPUT A STRING
0110+  1499             ;; terminates with null
0111+  1499             ;; pointer in D
0112+  1499             ;-----------------------------------------------------------------------------
0113+  1499             _gets:
0114+  1499 D7            push a
0115+  149A DA            push d
0116+  149B             _gets_loop:
0117+  149B 19 01         mov al, 1
0118+  149D 05 03         syscall sys_io      ; receive in AH
0119+  149F B9 00         cmp al, 0        ; check error code (AL)
0120+  14A1 C6 9B 14      je _gets_loop      ; if no char received, retry
0121+  14A4             
0122+  14A4 76 1B         cmp ah, 27
0123+  14A6 C6 C7 14      je _gets_ansi_esc
0124+  14A9 76 0A         cmp ah, $0A        ; LF
0125+  14AB C6 32 15      je _gets_end
0126+  14AE 76 0D         cmp ah, $0D        ; CR
0127+  14B0 C6 32 15      je _gets_end
0128+  14B3 76 5C         cmp ah, $5C        ; '\\'
0129+  14B5 C6 F3 14      je _gets_escape
0130+  14B8               
0131+  14B8 76 08         cmp ah, $08      ; check for backspace
0132+  14BA C6 C3 14      je _gets_backspace
0133+  14BD             
0134+  14BD 1A            mov al, ah
0135+  14BE 3E            mov [d], al
0136+  14BF 79            inc d
0137+  14C0 0A 9B 14      jmp _gets_loop
0138+  14C3             _gets_backspace:
0139+  14C3 7F            dec d
0140+  14C4 0A 9B 14      jmp _gets_loop
0141+  14C7             _gets_ansi_esc:
0142+  14C7 19 01         mov al, 1
0143+  14C9 05 03         syscall sys_io        ; receive in AH without echo
0144+  14CB B9 00         cmp al, 0          ; check error code (AL)
0145+  14CD C6 C7 14      je _gets_ansi_esc    ; if no char received, retry
0146+  14D0 76 5B         cmp ah, '['
0147+  14D2 C7 9B 14      jne _gets_loop
0148+  14D5             _gets_ansi_esc_2:
0149+  14D5 19 01         mov al, 1
0150+  14D7 05 03         syscall sys_io          ; receive in AH without echo
0151+  14D9 B9 00         cmp al, 0            ; check error code (AL)
0152+  14DB C6 D5 14      je _gets_ansi_esc_2  ; if no char received, retry
0153+  14DE 76 44         cmp ah, 'D'
0154+  14E0 C6 EB 14      je _gets_left_arrow
0155+  14E3 76 43         cmp ah, 'C'
0156+  14E5 C6 EF 14      je _gets_right_arrow
0157+  14E8 0A 9B 14      jmp _gets_loop
0158+  14EB             _gets_left_arrow:
0159+  14EB 7F            dec d
0160+  14EC 0A 9B 14      jmp _gets_loop
0161+  14EF             _gets_right_arrow:
0162+  14EF 79            inc d
0163+  14F0 0A 9B 14      jmp _gets_loop
0164+  14F3             _gets_escape:
0165+  14F3 19 01         mov al, 1
0166+  14F5 05 03         syscall sys_io      ; receive in AH
0167+  14F7 B9 00         cmp al, 0        ; check error code (AL)
0168+  14F9 C6 F3 14      je _gets_escape      ; if no char received, retry
0169+  14FC 76 6E         cmp ah, 'n'
0170+  14FE C6 1D 15      je _gets_LF
0171+  1501 76 72         cmp ah, 'r'
0172+  1503 C6 24 15      je _gets_CR
0173+  1506 76 30         cmp ah, '0'
0174+  1508 C6 2B 15      je _gets_NULL
0175+  150B 76 5C         cmp ah, $5C  ; '\'
0176+  150D C6 16 15      je _gets_slash
0177+  1510 1A            mov al, ah        ; if not a known escape, it is just a normal letter
0178+  1511 3E            mov [d], al
0179+  1512 79            inc d
0180+  1513 0A 9B 14      jmp _gets_loop
0181+  1516             _gets_slash:
0182+  1516 19 5C         mov al, $5C
0183+  1518 3E            mov [d], al
0184+  1519 79            inc d
0185+  151A 0A 9B 14      jmp _gets_loop
0186+  151D             _gets_LF:
0187+  151D 19 0A         mov al, $0A
0188+  151F 3E            mov [d], al
0189+  1520 79            inc d
0190+  1521 0A 9B 14      jmp _gets_loop
0191+  1524             _gets_CR:
0192+  1524 19 0D         mov al, $0D
0193+  1526 3E            mov [d], al
0194+  1527 79            inc d
0195+  1528 0A 9B 14      jmp _gets_loop
0196+  152B             _gets_NULL:
0197+  152B 19 00         mov al, $00
0198+  152D 3E            mov [d], al
0199+  152E 79            inc d
0200+  152F 0A 9B 14      jmp _gets_loop
0201+  1532             _gets_end:
0202+  1532 19 00         mov al, 0
0203+  1534 3E            mov [d], al        ; terminate string
0204+  1535 E7            pop d
0205+  1536 E4            pop a
0206+  1537 09            ret
0207+  1538             
0208+  1538             ;-----------------------------------------------------------------------------
0209+  1538             ;; INPUT TEXT
0210+  1538             ;; terminated with CTRL+D
0211+  1538             ;; pointer in D
0212+  1538             ;-----------------------------------------------------------------------------
0213+  1538             _gettxt:
0214+  1538 D7            push a
0215+  1539 DA            push d
0216+  153A             _gettxt_loop:
0217+  153A 19 01         mov al, 1
0218+  153C 05 03         syscall sys_io      ; receive in AH
0219+  153E B9 00         cmp al, 0        ; check error code (AL)
0220+  1540 C6 3A 15      je _gettxt_loop    ; if no char received, retry
0221+  1543 76 04         cmp ah, 4      ; EOT
0222+  1545 C6 83 15      je _gettxt_end
0223+  1548 76 08         cmp ah, $08      ; check for backspace
0224+  154A C6 7F 15      je _gettxt_backspace
0225+  154D 76 5C         cmp ah, $5C        ; '\'
0226+  154F C6 58 15      je _gettxt_escape
0227+  1552 1A            mov al, ah
0228+  1553 3E            mov [d], al
0229+  1554 79            inc d
0230+  1555 0A 3A 15      jmp _gettxt_loop
0231+  1558             _gettxt_escape:
0232+  1558 19 01         mov al, 1
0233+  155A 05 03         syscall sys_io      ; receive in AH
0234+  155C B9 00         cmp al, 0        ; check error code (AL)
0235+  155E C6 58 15      je _gettxt_escape    ; if no char received, retry
0236+  1561 76 6E         cmp ah, 'n'
0237+  1563 C6 71 15      je _gettxt_LF
0238+  1566 76 72         cmp ah, 'r'
0239+  1568 C6 78 15      je _gettxt_CR
0240+  156B 1A            mov al, ah        ; if not a known escape, it is just a normal letter
0241+  156C 3E            mov [d], al
0242+  156D 79            inc d
0243+  156E 0A 3A 15      jmp _gettxt_loop
0244+  1571             _gettxt_LF:
0245+  1571 19 0A         mov al, $0A
0246+  1573 3E            mov [d], al
0247+  1574 79            inc d
0248+  1575 0A 3A 15      jmp _gettxt_loop
0249+  1578             _gettxt_CR:
0250+  1578 19 0D         mov al, $0D
0251+  157A 3E            mov [d], al
0252+  157B 79            inc d
0253+  157C 0A 3A 15      jmp _gettxt_loop
0254+  157F             _gettxt_backspace:
0255+  157F 7F            dec d
0256+  1580 0A 3A 15      jmp _gettxt_loop
0257+  1583             _gettxt_end:
0258+  1583 19 00         mov al, 0
0259+  1585 3E            mov [d], al        ; terminate string
0260+  1586 E7            pop d
0261+  1587 E4            pop a
0262+  1588 09            ret
0263+  1589             
0264+  1589             ;-----------------------------------------------------------------------------
0265+  1589             ; PRINT NEW LINE
0266+  1589             ;-----------------------------------------------------------------------------
0267+  1589             printnl:
0268+  1589 D7            push a
0269+  158A 10 00 0A      mov a, $0A00
0270+  158D 05 03         syscall sys_io
0271+  158F 10 00 0D      mov a, $0D00
0272+  1592 05 03         syscall sys_io
0273+  1594 E4            pop a
0274+  1595 09            ret
0275+  1596             
0276+  1596             ;-----------------------------------------------------------------------------
0277+  1596             ; _strtoint
0278+  1596             ; 4 digit hex string number in d
0279+  1596             ; integer returned in A
0280+  1596             ;-----------------------------------------------------------------------------
0281+  1596             _strtointx:
0282+  1596 D8            push b
0283+  1597 32            mov bl, [d]
0284+  1598 37            mov bh, bl
0285+  1599 33 01 00      mov bl, [d + 1]
0286+  159C 07 50 14      call _atoi        ; convert to int in AL
0287+  159F 23            mov ah, al        ; move to AH
0288+  15A0 33 02 00      mov bl, [d + 2]
0289+  15A3 37            mov bh, bl
0290+  15A4 33 03 00      mov bl, [d + 3]
0291+  15A7 07 50 14      call _atoi        ; convert to int in AL
0292+  15AA E5            pop b
0293+  15AB 09            ret
0294+  15AC             
0295+  15AC             ;-----------------------------------------------------------------------------
0296+  15AC             ; _strtoint
0297+  15AC             ; 5 digit base10 string number in d
0298+  15AC             ; integer returned in A
0299+  15AC             ;-----------------------------------------------------------------------------
0300+  15AC             _strtoint:
0301+  15AC E2            push si
0302+  15AD D8            push b
0303+  15AE D9            push c
0304+  15AF DA            push d
0305+  15B0 07 F2 13      call _strlen      ; get string length in C
0306+  15B3 7E            dec c
0307+  15B4 FD 4E         mov si, d
0308+  15B6 12            mov a, c
0309+  15B7 FD 99         shl a
0310+  15B9 3B 28 17      mov d, table_power
0311+  15BC 59            add d, a
0312+  15BD 38 00 00      mov c, 0
0313+  15C0             _strtoint_L0:
0314+  15C0 F6            lodsb      ; load ASCII to al
0315+  15C1 B9 00         cmp al, 0
0316+  15C3 C6 D6 15      je _strtoint_end
0317+  15C6 6F 30         sub al, $30    ; make into integer
0318+  15C8 22 00         mov ah, 0
0319+  15CA 2A            mov b, [d]
0320+  15CB AC            mul a, b      ; result in B since it fits in 16bits
0321+  15CC 11            mov a, b
0322+  15CD 28            mov b, c
0323+  15CE 54            add a, b
0324+  15CF 39            mov c, a
0325+  15D0 63 02 00      sub d, 2
0326+  15D3 0A C0 15      jmp _strtoint_L0
0327+  15D6             _strtoint_end:
0328+  15D6 12            mov a, c
0329+  15D7 E7            pop d
0330+  15D8 E6            pop c
0331+  15D9 E5            pop b
0332+  15DA EF            pop si
0333+  15DB 09            ret
0334+  15DC             
0335+  15DC             ;-----------------------------------------------------------------------------
0336+  15DC             ; PRINT NULL TERMINATED STRING
0337+  15DC             ; pointer in D
0338+  15DC             ;-----------------------------------------------------------------------------
0339+  15DC             _puts:
0340+  15DC D7            push a
0341+  15DD DA            push d
0342+  15DE             _puts_L1:
0343+  15DE 1E            mov al, [d]
0344+  15DF B9 00         cmp al, 0
0345+  15E1 C6 ED 15      jz _puts_END
0346+  15E4 23            mov ah, al
0347+  15E5 19 00         mov al, 0
0348+  15E7 05 03         syscall sys_io
0349+  15E9 79            inc d
0350+  15EA 0A DE 15      jmp _puts_L1
0351+  15ED             _puts_END:
0352+  15ED E7            pop d
0353+  15EE E4            pop a
0354+  15EF 09            ret
0355+  15F0             
0356+  15F0             ;-----------------------------------------------------------------------------
0357+  15F0             ; PRINT N SIZE STRING
0358+  15F0             ; pointer in D
0359+  15F0             ; size in C
0360+  15F0             ;-----------------------------------------------------------------------------
0361+  15F0             _putsn:
0362+  15F0 DB            push al
0363+  15F1 DA            push d
0364+  15F2 D9            push c
0365+  15F3             _putsn_L0:
0366+  15F3 1E            mov al, [d]
0367+  15F4 23            mov ah, al
0368+  15F5 19 00         mov al, 0
0369+  15F7 05 03         syscall sys_io
0370+  15F9 79            inc d
0371+  15FA 7E            dec c  
0372+  15FB C2 00 00      cmp c, 0
0373+  15FE C7 F3 15      jne _putsn_L0
0374+  1601             _putsn_end:
0375+  1601 E6            pop c
0376+  1602 E7            pop d
0377+  1603 E8            pop al
0378+  1604 09            ret
0379+  1605             
0380+  1605             ;-----------------------------------------------------------------------------
0381+  1605             ; print 16bit decimal number
0382+  1605             ; input number in A
0383+  1605             ;-----------------------------------------------------------------------------
0384+  1605             print_u16d:
0385+  1605 D7            push a
0386+  1606 D8            push b
0387+  1607 26 10 27      mov b, 10000
0388+  160A AE            div a, b      ; get 10000's coeff.
0389+  160B 07 2D 16      call print_number
0390+  160E 11            mov a, b
0391+  160F 26 E8 03      mov b, 1000
0392+  1612 AE            div a, b      ; get 1000's coeff.
0393+  1613 07 2D 16      call print_number
0394+  1616 11            mov a, b
0395+  1617 26 64 00      mov b, 100
0396+  161A AE            div a, b
0397+  161B 07 2D 16      call print_number
0398+  161E 11            mov a, b
0399+  161F 26 0A 00      mov b, 10
0400+  1622 AE            div a, b
0401+  1623 07 2D 16      call print_number
0402+  1626 1B            mov al, bl      ; 1's coeff in bl
0403+  1627 07 2D 16      call print_number
0404+  162A E5            pop b
0405+  162B E4            pop a
0406+  162C 09            ret
0407+  162D             
0408+  162D             ;-----------------------------------------------------------------------------
0409+  162D             ; print AL
0410+  162D             ;-----------------------------------------------------------------------------
0411+  162D             print_number:
0412+  162D 6A 30         add al, $30
0413+  162F 23            mov ah, al
0414+  1630 07 92 14      call _putchar
0415+  1633 09            ret
0416+  1634             
0417+  1634             ;-----------------------------------------------------------------------------
0418+  1634             ; PRINT 16BIT HEX INTEGER
0419+  1634             ; integer value in reg B
0420+  1634             ;-----------------------------------------------------------------------------
0421+  1634             print_u16x:
0422+  1634 D7            push a
0423+  1635 D8            push b
0424+  1636 DD            push bl
0425+  1637 30            mov bl, bh
0426+  1638 07 60 14      call _itoa        ; convert bh to char in A
0427+  163B 2F            mov bl, al        ; save al
0428+  163C 19 00         mov al, 0
0429+  163E 05 03         syscall sys_io        ; display AH
0430+  1640 24            mov ah, bl        ; retrieve al
0431+  1641 19 00         mov al, 0
0432+  1643 05 03         syscall sys_io        ; display AL
0433+  1645             
0434+  1645 EA            pop bl
0435+  1646 07 60 14      call _itoa        ; convert bh to char in A
0436+  1649 2F            mov bl, al        ; save al
0437+  164A 19 00         mov al, 0
0438+  164C 05 03         syscall sys_io        ; display AH
0439+  164E 24            mov ah, bl        ; retrieve al
0440+  164F 19 00         mov al, 0
0441+  1651 05 03         syscall sys_io        ; display AL
0442+  1653             
0443+  1653 E5            pop b
0444+  1654 E4            pop a
0445+  1655 09            ret
0446+  1656             
0447+  1656             ;-----------------------------------------------------------------------------
0448+  1656             ; INPUT 16BIT HEX INTEGER
0449+  1656             ; read 16bit integer into A
0450+  1656             ;-----------------------------------------------------------------------------
0451+  1656             scan_u16x:
0452+  1656 F8 10 00      enter 16
0453+  1659 D8            push b
0454+  165A DA            push d
0455+  165B             
0456+  165B FA F1 FF      lea d, [bp + -15]
0457+  165E 07 99 14      call _gets        ; get number
0458+  1661             
0459+  1661 32            mov bl, [d]
0460+  1662 37            mov bh, bl
0461+  1663 33 01 00      mov bl, [d + 1]
0462+  1666 07 50 14      call _atoi        ; convert to int in AL
0463+  1669 23            mov ah, al        ; move to AH
0464+  166A             
0465+  166A 33 02 00      mov bl, [d + 2]
0466+  166D 37            mov bh, bl
0467+  166E 33 03 00      mov bl, [d + 3]
0468+  1671 07 50 14      call _atoi        ; convert to int in AL
0469+  1674             
0470+  1674 E7            pop d
0471+  1675 E5            pop b
0472+  1676 F9            leave
0473+  1677 09            ret
0474+  1678             
0475+  1678             ;-----------------------------------------------------------------------------
0476+  1678             ; PRINT 8bit HEX INTEGER
0477+  1678             ; integer value in reg bl
0478+  1678             ;-----------------------------------------------------------------------------
0479+  1678             print_u8x:
0480+  1678 D7            push a
0481+  1679 DD            push bl
0482+  167A             
0483+  167A 07 60 14      call _itoa        ; convert bl to char in A
0484+  167D 2F            mov bl, al        ; save al
0485+  167E 19 00         mov al, 0
0486+  1680 05 03         syscall sys_io        ; display AH
0487+  1682 24            mov ah, bl        ; retrieve al
0488+  1683 19 00         mov al, 0
0489+  1685 05 03         syscall sys_io        ; display AL
0490+  1687             
0491+  1687 EA            pop bl
0492+  1688 E4            pop a
0493+  1689 09            ret
0494+  168A             
0495+  168A             ;-----------------------------------------------------------------------------
0496+  168A             ; print 8bit decimal unsigned number
0497+  168A             ; input number in AL
0498+  168A             ;-----------------------------------------------------------------------------
0499+  168A             print_u8d:
0500+  168A D7            push a
0501+  168B D8            push b
0502+  168C             
0503+  168C 22 00         mov ah, 0
0504+  168E 26 64 00      mov b, 100
0505+  1691 AE            div a, b
0506+  1692 D8            push b      ; save remainder
0507+  1693 B9 00         cmp al, 0
0508+  1695 C6 9F 16      je skip100
0509+  1698 6A 30         add al, $30
0510+  169A 23            mov ah, al
0511+  169B 19 00         mov al, 0
0512+  169D 05 03         syscall sys_io  ; print coeff
0513+  169F             skip100:
0514+  169F E4            pop a
0515+  16A0 22 00         mov ah, 0
0516+  16A2 26 0A 00      mov b, 10
0517+  16A5 AE            div a, b
0518+  16A6 D8            push b      ; save remainder
0519+  16A7 B9 00         cmp al, 0
0520+  16A9 C6 B3 16      je skip10
0521+  16AC 6A 30         add al, $30
0522+  16AE 23            mov ah, al
0523+  16AF 19 00         mov al, 0
0524+  16B1 05 03         syscall sys_io  ; print coeff
0525+  16B3             skip10:
0526+  16B3 E4            pop a
0527+  16B4 1B            mov al, bl
0528+  16B5 6A 30         add al, $30
0529+  16B7 23            mov ah, al
0530+  16B8 19 00         mov al, 0
0531+  16BA 05 03         syscall sys_io  ; print coeff
0532+  16BC E5            pop b
0533+  16BD E4            pop a
0534+  16BE 09            ret
0535+  16BF             
0536+  16BF             ;-----------------------------------------------------------------------------
0537+  16BF             ; INPUT 8BIT HEX INTEGER
0538+  16BF             ; read 8bit integer into AL
0539+  16BF             ;-----------------------------------------------------------------------------
0540+  16BF             scan_u8x:
0541+  16BF F8 04 00      enter 4
0542+  16C2 D8            push b
0543+  16C3 DA            push d
0544+  16C4             
0545+  16C4 FA FD FF      lea d, [bp + -3]
0546+  16C7 07 99 14      call _gets        ; get number
0547+  16CA             
0548+  16CA 32            mov bl, [d]
0549+  16CB 37            mov bh, bl
0550+  16CC 33 01 00      mov bl, [d + 1]
0551+  16CF 07 50 14      call _atoi        ; convert to int in AL
0552+  16D2             
0553+  16D2 E7            pop d
0554+  16D3 E5            pop b
0555+  16D4 F9            leave
0556+  16D5 09            ret
0557+  16D6             
0558+  16D6             ;-----------------------------------------------------------------------------
0559+  16D6             ; input decimal number
0560+  16D6             ; result in A
0561+  16D6             ; 655'\0'
0562+  16D6             ; low--------high
0563+  16D6             ;-----------------------------------------------------------------------------
0564+  16D6             scan_u16d:
0565+  16D6 F8 08 00      enter 8
0566+  16D9 E2            push si
0567+  16DA D8            push b
0568+  16DB D9            push c
0569+  16DC DA            push d
0570+  16DD FA F9 FF      lea d, [bp +- 7]
0571+  16E0 07 99 14      call _gets
0572+  16E3 07 F2 13      call _strlen      ; get string length in C
0573+  16E6 7E            dec c
0574+  16E7 FD 4E         mov si, d
0575+  16E9 12            mov a, c
0576+  16EA FD 99         shl a
0577+  16EC 3B 28 17      mov d, table_power
0578+  16EF 59            add d, a
0579+  16F0 38 00 00      mov c, 0
0580+  16F3             mul_loop:
0581+  16F3 F6            lodsb      ; load ASCII to al
0582+  16F4 B9 00         cmp al, 0
0583+  16F6 C6 09 17      je mul_exit
0584+  16F9 6F 30         sub al, $30    ; make into integer
0585+  16FB 22 00         mov ah, 0
0586+  16FD 2A            mov b, [d]
0587+  16FE AC            mul a, b      ; result in B since it fits in 16bits
0588+  16FF 11            mov a, b
0589+  1700 28            mov b, c
0590+  1701 54            add a, b
0591+  1702 39            mov c, a
0592+  1703 63 02 00      sub d, 2
0593+  1706 0A F3 16      jmp mul_loop
0594+  1709             mul_exit:
0595+  1709 12            mov a, c
0596+  170A E7            pop d
0597+  170B E6            pop c
0598+  170C E5            pop b
0599+  170D EF            pop si
0600+  170E F9            leave
0601+  170F 09            ret
0602+  1710             
0603+  1710 30 31 32 33 s_hex_digits:    .db "0123456789ABCDEF"  
0603+  1714 34 35 36 37 
0603+  1718 38 39 41 42 
0603+  171C 43 44 45 46 
0604+  1720 1B 5B 32 4A s_telnet_clear:  .db "\033[2J\033[H", 0
0604+  1724 1B 5B 48 00 
0605+  1728             
0606+  1728             table_power:
0607+  1728 01 00         .dw 1
0608+  172A 0A 00         .dw 10
0609+  172C 64 00         .dw 100
0610+  172E E8 03         .dw 1000
0611+  1730 10 27         .dw 100002345   1732             ; --- END INLINE ASM BLOCK
2346   1732             
2347   1732 F9            leave
2348   1733 09            ret
2349   1734             
2350   1734             exit:
2351   1734 F8 00 00      enter 0 ; (push bp; mov bp, sp)
2352   1737             
2353   1737             ; --- BEGIN INLINE ASM BLOCK
2354   1737 05 0B         syscall sys_terminate_proc
2355   1739             ; --- END INLINE ASM BLOCK
2356   1739             
2357   1739 F9            leave
2358   173A 09            ret
2359   173B             
2360   173B             memset:
2361   173B F8 00 00      enter 0 ; (push bp; mov bp, sp)
2362   173E             ; $i 
2363   173E 52 02 00      sub sp, 2
2364   1741             ;; for(i = 0; i < size; i++){ 
2365   1741             _for37_init:
2366   1741 FA FF FF      lea d, [bp + -1] ; $i
2367   1744 DA            push d
2368   1745 26 00 00      mov b, $0
2369   1748 E7            pop d
2370   1749 FD 43         mov [d], b
2371   174B             _for37_cond:
2372   174B FA FF FF      lea d, [bp + -1] ; $i
2373   174E 2A            mov b, [d]
2374   174F             ; START RELATIONAL
2375   174F D7            push a
2376   1750 11            mov a, b
2377   1751 FA 08 00      lea d, [bp + 8] ; $size
2378   1754 2A            mov b, [d]
2379   1755 B0            cmp a, b
2380   1756 FD 73         slt ; < (signed)
2381   1758 E4            pop a
2382   1759             ; END RELATIONAL
2383   1759 C0 00 00      cmp b, 0
2384   175C C6 85 17      je _for37_exit
2385   175F             _for37_block:
2386   175F             ;; *(s+i) = c; 
2387   175F FA 05 00      lea d, [bp + 5] ; $s
2388   1762 2A            mov b, [d]
2389   1763             ; START TERMS
2390   1763 D7            push a
2391   1764 11            mov a, b
2392   1765 FA FF FF      lea d, [bp + -1] ; $i
2393   1768 2A            mov b, [d]
2394   1769 56            add b, a
2395   176A E4            pop a
2396   176B             ; END TERMS
2397   176B D8            push b
2398   176C FA 07 00      lea d, [bp + 7] ; $c
2399   176F 32            mov bl, [d]
2400   1770 A7 00         mov bh, 0
2401   1772 E7            pop d
2402   1773 FD 3E         mov [d], bl
2403   1775             _for37_update:
2404   1775 FA FF FF      lea d, [bp + -1] ; $i
2405   1778 2A            mov b, [d]
2406   1779 D8            push b
2407   177A FD 77         inc b
2408   177C FA FF FF      lea d, [bp + -1] ; $i
2409   177F FD 43         mov [d], b
2410   1781 E5            pop b
2411   1782 0A 4B 17      jmp _for37_cond
2412   1785             _for37_exit:
2413   1785             ;; return s; 
2414   1785 FA 05 00      lea d, [bp + 5] ; $s
2415   1788 2A            mov b, [d]
2416   1789 F9            leave
2417   178A 09            ret
2418   178B             
2419   178B             atoi:
2420   178B F8 00 00      enter 0 ; (push bp; mov bp, sp)
2421   178E             ; $result 
2422   178E 10 00 00      mov a, $0
2423   1791 45 FF FF      mov [bp + -1], a
2424   1794             ; $sign 
2425   1794 10 01 00      mov a, $1
2426   1797 45 FD FF      mov [bp + -3], a
2427   179A 52 04 00      sub sp, 4
2428   179D             ;; while (*str == ' ') str++; 
2429   179D             _while38_cond:
2430   179D FA 05 00      lea d, [bp + 5] ; $str
2431   17A0 2A            mov b, [d]
2432   17A1 74            mov d, b
2433   17A2 32            mov bl, [d]
2434   17A3 A7 00         mov bh, 0
2435   17A5             ; START RELATIONAL
2436   17A5 D7            push a
2437   17A6 11            mov a, b
2438   17A7 26 20 00      mov b, $20
2439   17AA B0            cmp a, b
2440   17AB FD 71         seq ; ==
2441   17AD E4            pop a
2442   17AE             ; END RELATIONAL
2443   17AE C0 00 00      cmp b, 0
2444   17B1 C6 C4 17      je _while38_exit
2445   17B4             _while38_block:
2446   17B4             ;; str++; 
2447   17B4 FA 05 00      lea d, [bp + 5] ; $str
2448   17B7 2A            mov b, [d]
2449   17B8 D8            push b
2450   17B9 FD 77         inc b
2451   17BB FA 05 00      lea d, [bp + 5] ; $str
2452   17BE FD 43         mov [d], b
2453   17C0 E5            pop b
2454   17C1 0A 9D 17      jmp _while38_cond
2455   17C4             _while38_exit:
2456   17C4             ;; if (*str == '-' || *str == '+') { 
2457   17C4             _if39_cond:
2458   17C4 FA 05 00      lea d, [bp + 5] ; $str
2459   17C7 2A            mov b, [d]
2460   17C8 74            mov d, b
2461   17C9 32            mov bl, [d]
2462   17CA A7 00         mov bh, 0
2463   17CC             ; START RELATIONAL
2464   17CC D7            push a
2465   17CD 11            mov a, b
2466   17CE 26 2D 00      mov b, $2d
2467   17D1 B0            cmp a, b
2468   17D2 FD 71         seq ; ==
2469   17D4 E4            pop a
2470   17D5             ; END RELATIONAL
2471   17D5 D7            push a
2472   17D6 11            mov a, b
2473   17D7 FA 05 00      lea d, [bp + 5] ; $str
2474   17DA 2A            mov b, [d]
2475   17DB 74            mov d, b
2476   17DC 32            mov bl, [d]
2477   17DD A7 00         mov bh, 0
2478   17DF             ; START RELATIONAL
2479   17DF D7            push a
2480   17E0 11            mov a, b
2481   17E1 26 2B 00      mov b, $2b
2482   17E4 B0            cmp a, b
2483   17E5 FD 71         seq ; ==
2484   17E7 E4            pop a
2485   17E8             ; END RELATIONAL
2486   17E8 FD A8         sor a, b ; ||
2487   17EA E4            pop a
2488   17EB C0 00 00      cmp b, 0
2489   17EE C6 28 18      je _if39_exit
2490   17F1             _if39_true:
2491   17F1             ;; if (*str == '-') sign = -1; 
2492   17F1             _if40_cond:
2493   17F1 FA 05 00      lea d, [bp + 5] ; $str
2494   17F4 2A            mov b, [d]
2495   17F5 74            mov d, b
2496   17F6 32            mov bl, [d]
2497   17F7 A7 00         mov bh, 0
2498   17F9             ; START RELATIONAL
2499   17F9 D7            push a
2500   17FA 11            mov a, b
2501   17FB 26 2D 00      mov b, $2d
2502   17FE B0            cmp a, b
2503   17FF FD 71         seq ; ==
2504   1801 E4            pop a
2505   1802             ; END RELATIONAL
2506   1802 C0 00 00      cmp b, 0
2507   1805 C6 18 18      je _if40_exit
2508   1808             _if40_true:
2509   1808             ;; sign = -1; 
2510   1808 FA FD FF      lea d, [bp + -3] ; $sign
2511   180B DA            push d
2512   180C 26 FF FF      mov b, 65535
2513   180F 38 FF FF      mov c, 65535
2514   1812 E7            pop d
2515   1813 FD 43         mov [d], b
2516   1815 0A 18 18      jmp _if40_exit
2517   1818             _if40_exit:
2518   1818             ;; str++; 
2519   1818 FA 05 00      lea d, [bp + 5] ; $str
2520   181B 2A            mov b, [d]
2521   181C D8            push b
2522   181D FD 77         inc b
2523   181F FA 05 00      lea d, [bp + 5] ; $str
2524   1822 FD 43         mov [d], b
2525   1824 E5            pop b
2526   1825 0A 28 18      jmp _if39_exit
2527   1828             _if39_exit:
2528   1828             ;; while (*str >= '0' && *str <= '9') { 
2529   1828             _while41_cond:
2530   1828 FA 05 00      lea d, [bp + 5] ; $str
2531   182B 2A            mov b, [d]
2532   182C 74            mov d, b
2533   182D 32            mov bl, [d]
2534   182E A7 00         mov bh, 0
2535   1830             ; START RELATIONAL
2536   1830 D7            push a
2537   1831 11            mov a, b
2538   1832 26 30 00      mov b, $30
2539   1835 B0            cmp a, b
2540   1836 FD 82         sgeu ; >= (unsigned)
2541   1838 E4            pop a
2542   1839             ; END RELATIONAL
2543   1839 D7            push a
2544   183A 11            mov a, b
2545   183B FA 05 00      lea d, [bp + 5] ; $str
2546   183E 2A            mov b, [d]
2547   183F 74            mov d, b
2548   1840 32            mov bl, [d]
2549   1841 A7 00         mov bh, 0
2550   1843             ; START RELATIONAL
2551   1843 D7            push a
2552   1844 11            mov a, b
2553   1845 26 39 00      mov b, $39
2554   1848 B0            cmp a, b
2555   1849 FD 75         slu ; <= (unsigned)
2556   184B E4            pop a
2557   184C             ; END RELATIONAL
2558   184C FD A7         sand a, b
2559   184E E4            pop a
2560   184F C0 00 00      cmp b, 0
2561   1852 C6 8D 18      je _while41_exit
2562   1855             _while41_block:
2563   1855             ;; result = result * 10 + (*str - '0'); 
2564   1855 FA FF FF      lea d, [bp + -1] ; $result
2565   1858 DA            push d
2566   1859 FA FF FF      lea d, [bp + -1] ; $result
2567   185C 2A            mov b, [d]
2568   185D             ; START FACTORS
2569   185D D7            push a
2570   185E 11            mov a, b
2571   185F 26 0A 00      mov b, $a
2572   1862 AC            mul a, b ; *
2573   1863 11            mov a, b
2574   1864 27            mov b, a
2575   1865 E4            pop a
2576   1866             ; END FACTORS
2577   1866             ; START TERMS
2578   1866 D7            push a
2579   1867 11            mov a, b
2580   1868 FA 05 00      lea d, [bp + 5] ; $str
2581   186B 2A            mov b, [d]
2582   186C 74            mov d, b
2583   186D 32            mov bl, [d]
2584   186E A7 00         mov bh, 0
2585   1870             ; START TERMS
2586   1870 D7            push a
2587   1871 11            mov a, b
2588   1872 26 30 00      mov b, $30
2589   1875 60            sub a, b
2590   1876 27            mov b, a
2591   1877 E4            pop a
2592   1878             ; END TERMS
2593   1878 56            add b, a
2594   1879 E4            pop a
2595   187A             ; END TERMS
2596   187A E7            pop d
2597   187B FD 43         mov [d], b
2598   187D             ;; str++; 
2599   187D FA 05 00      lea d, [bp + 5] ; $str
2600   1880 2A            mov b, [d]
2601   1881 D8            push b
2602   1882 FD 77         inc b
2603   1884 FA 05 00      lea d, [bp + 5] ; $str
2604   1887 FD 43         mov [d], b
2605   1889 E5            pop b
2606   188A 0A 28 18      jmp _while41_cond
2607   188D             _while41_exit:
2608   188D             ;; return sign * result; 
2609   188D FA FD FF      lea d, [bp + -3] ; $sign
2610   1890 2A            mov b, [d]
2611   1891             ; START FACTORS
2612   1891 D7            push a
2613   1892 11            mov a, b
2614   1893 FA FF FF      lea d, [bp + -1] ; $result
2615   1896 2A            mov b, [d]
2616   1897 AC            mul a, b ; *
2617   1898 11            mov a, b
2618   1899 27            mov b, a
2619   189A E4            pop a
2620   189B             ; END FACTORS
2621   189B F9            leave
2622   189C 09            ret
2623   189D             
2624   189D             rand:
2625   189D F8 00 00      enter 0 ; (push bp; mov bp, sp)
2626   18A0             ; $sec 
2627   18A0 52 02 00      sub sp, 2
2628   18A3             
2629   18A3             ; --- BEGIN INLINE ASM BLOCK
2630   18A3 19 00         mov al, 0
2631   18A5 05 01         syscall sys_rtc					
2632   18A7 1A            mov al, ah
2633   18A8 FA FF FF      lea d, [bp + -1] ; $sec
2634   18AB 1E            mov al, [d]
2635   18AC 22 00         mov ah, 0
2636   18AE             ; --- END INLINE ASM BLOCK
2637   18AE             
2638   18AE             ;; return sec; 
2639   18AE FA FF FF      lea d, [bp + -1] ; $sec
2640   18B1 2A            mov b, [d]
2641   18B2 F9            leave
2642   18B3 09            ret
2643   18B4             
2644   18B4             alloc:
2645   18B4 F8 00 00      enter 0 ; (push bp; mov bp, sp)
2646   18B7             ;; heap_top = heap_top + bytes; 
2647   18B7 3B 97 76      mov d, _heap_top ; $heap_top
2648   18BA DA            push d
2649   18BB 3B 97 76      mov d, _heap_top ; $heap_top
2650   18BE 2A            mov b, [d]
2651   18BF             ; START TERMS
2652   18BF D7            push a
2653   18C0 11            mov a, b
2654   18C1 FA 05 00      lea d, [bp + 5] ; $bytes
2655   18C4 2A            mov b, [d]
2656   18C5 56            add b, a
2657   18C6 E4            pop a
2658   18C7             ; END TERMS
2659   18C7 E7            pop d
2660   18C8 FD 43         mov [d], b
2661   18CA             ;; return heap_top - bytes; 
2662   18CA 3B 97 76      mov d, _heap_top ; $heap_top
2663   18CD 2A            mov b, [d]
2664   18CE             ; START TERMS
2665   18CE D7            push a
2666   18CF 11            mov a, b
2667   18D0 FA 05 00      lea d, [bp + 5] ; $bytes
2668   18D3 2A            mov b, [d]
2669   18D4 60            sub a, b
2670   18D5 27            mov b, a
2671   18D6 E4            pop a
2672   18D7             ; END TERMS
2673   18D7 F9            leave
2674   18D8 09            ret
2675   18D9             
2676   18D9             free:
2677   18D9 F8 00 00      enter 0 ; (push bp; mov bp, sp)
2678   18DC             ;; return heap_top = heap_top - bytes; 
2679   18DC 3B 97 76      mov d, _heap_top ; $heap_top
2680   18DF DA            push d
2681   18E0 3B 97 76      mov d, _heap_top ; $heap_top
2682   18E3 2A            mov b, [d]
2683   18E4             ; START TERMS
2684   18E4 D7            push a
2685   18E5 11            mov a, b
2686   18E6 FA 05 00      lea d, [bp + 5] ; $bytes
2687   18E9 2A            mov b, [d]
2688   18EA 60            sub a, b
2689   18EB 27            mov b, a
2690   18EC E4            pop a
2691   18ED             ; END TERMS
2692   18ED E7            pop d
2693   18EE FD 43         mov [d], b
2694   18F0 F9            leave
2695   18F1 09            ret
2696   18F2             
2697   18F2             include_ctype_lib:
2698   18F2 F8 00 00      enter 0 ; (push bp; mov bp, sp)
2699   18F5             
2700   18F5             ; --- BEGIN INLINE ASM BLOCK
2701   18F5             .include "lib/asm/ctype.asm"
0001+  18F5             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0002+  18F5             ; ctype.s
0003+  18F5             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0004+  18F5             
0005+  18F5             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0006+  18F5             ;; C character classification is an operation provided by a group of functions in the ANSI C Standard Library
0007+  18F5             ;; for the C programming language. These functions are used to test characters for membership in a particular
0008+  18F5             ;; class of characters, such as alphabetic characters, control characters, etc. Both single-byte, and wide
0009+  18F5             ;; characters are supported.
0010+  18F5             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0011+  18F5             ;; _isalnum 
0012+  18F5             ;; _isalpha 
0013+  18F5             ;; islower 
0014+  18F5             ;; isupper 
0015+  18F5             ;; _isdigit 
0016+  18F5             ;; isxdigit
0017+  18F5             ;; iscntrl 
0018+  18F5             ;; isgraph 
0019+  18F5             ;; _isspace 
0020+  18F5             ;; isblank 
0021+  18F5             ;; isprint 
0022+  18F5             ;; ispunct 
0023+  18F5             ;; tolower 
0024+  18F5             ;; toupper
0025+  18F5             
0026+  18F5             
0027+  18F5             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0028+  18F5             ;; IS ALPHANUMERIC
0029+  18F5             ;; sets ZF according with result
0030+  18F5             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0031+  18F5             _isalnum:
0032+  18F5 07 12 19    	call _isalpha
0033+  18F8 C6 FE 18    	je _isalnum_exit
0034+  18FB 07 FF 18    	call _isdigit
0035+  18FE             _isalnum_exit:
0036+  18FE 09          	ret	
0037+  18FF             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0038+  18FF             ;; IS DIGIT
0039+  18FF             ;; sets ZF according with result
0040+  18FF             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0041+  18FF             _isdigit:
0042+  18FF DB          	push al
0043+  1900 B9 30       	cmp al, '0'
0044+  1902 C8 0E 19    	jlu _isdigit_false
0045+  1905 B9 39       	cmp al, '9'
0046+  1907 D1 0E 19    	jgu _isdigit_false
0047+  190A 87 00       	and al, 0	; set ZF
0048+  190C E8          	pop al
0049+  190D 09          	ret
0050+  190E             _isdigit_false:
0051+  190E 8B 01       	or al, 1	; clear ZF
0052+  1910 E8          	pop al
0053+  1911 09          	ret	
0054+  1912             	
0055+  1912             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0056+  1912             ;; IS ALPHA
0057+  1912             ;; sets ZF according with result
0058+  1912             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0059+  1912             _isalpha:
0060+  1912 DB          	push al
0061+  1913 B9 5F       	cmp al, '_'
0062+  1915 C6 35 19    	je _isalpha_true
0063+  1918 B9 2E       	cmp al, '.'
0064+  191A C6 35 19    	je _isalpha_true
0065+  191D B9 41       	cmp al, 'A'
0066+  191F C8 31 19    	jlu _isalpha_false
0067+  1922 B9 7A       	cmp al, 'z'
0068+  1924 D1 31 19    	jgu _isalpha_false
0069+  1927 B9 5A       	cmp al, 'Z'
0070+  1929 D0 35 19    	jleu _isalpha_true
0071+  192C B9 61       	cmp al, 'a'
0072+  192E C9 35 19    	jgeu _isalpha_true
0073+  1931             _isalpha_false:
0074+  1931 8B 01       	or al, 1	; clear ZF
0075+  1933 E8          	pop al
0076+  1934 09          	ret
0077+  1935             _isalpha_true:
0078+  1935 87 00       	and al, 0	; set ZF
0079+  1937 E8          	pop al
0080+  1938 09          	ret
0081+  1939             
0082+  1939             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0083+  1939             ;; IS PATH-ALPHA
0084+  1939             ;; sets ZF according with result
0085+  1939             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0086+  1939             ispath:
0087+  1939 DB          	push al
0088+  193A 07 FF 18    	call _isdigit
0089+  193D C6 67 19    	je ispath_true
0090+  1940 B9 5F       	cmp al, '_'
0091+  1942 C6 67 19    	je ispath_true
0092+  1945 B9 2F       	cmp al, '/'
0093+  1947 C6 67 19    	je ispath_true
0094+  194A B9 2E       	cmp al, '.'
0095+  194C C6 67 19    	je ispath_true
0096+  194F B9 41       	cmp al, 'A'
0097+  1951 C8 63 19    	jlu ispath_false
0098+  1954 B9 7A       	cmp al, 'z'
0099+  1956 D1 63 19    	jgu ispath_false
0100+  1959 B9 5A       	cmp al, 'Z'
0101+  195B D0 67 19    	jleu ispath_true
0102+  195E B9 61       	cmp al, 'a'
0103+  1960 C9 67 19    	jgeu ispath_true
0104+  1963             ispath_false:
0105+  1963 8B 01       	or al, 1	; clear ZF
0106+  1965 E8          	pop al
0107+  1966 09          	ret
0108+  1967             ispath_true:
0109+  1967 87 00       	and al, 0	; set ZF
0110+  1969 E8          	pop al
0111+  196A 09          	ret
0112+  196B             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0113+  196B             ;; IS SPACE
0114+  196B             ;; sets ZF according with result
0115+  196B             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0116+  196B             _isspace:
0117+  196B B9 20       	cmp al, $20		; ' '
0118+  196D C6 81 19    	je _isspace_exit
0119+  1970 B9 09       	cmp al, $09		; '\t'
0120+  1972 C6 81 19    	je _isspace_exit
0121+  1975 B9 0A       	cmp al, $0A		; '\n'
0122+  1977 C6 81 19    	je _isspace_exit
0123+  197A B9 0D       	cmp al, $0D		; '\r'
0124+  197C C6 81 19    	je _isspace_exit
0125+  197F B9 0B       	cmp al, $0B		; '\v'
0126+  1981             _isspace_exit:
0127+  1981 09          	ret	
0128+  1982             
0129+  1982             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0130+  1982             ; TO LOWER
0131+  1982             ; input in AL
0132+  1982             ; output in AL
0133+  1982             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0134+  1982             _to_lower:
0135+  1982 B9 5A       	cmp al, 'Z'
0136+  1984 D1 89 19    	jgu _to_lower_ret
0137+  1987 6A 20       	add al, $20				; convert to lower case
0138+  1989             _to_lower_ret:
0139+  1989 09          	ret
0140+  198A             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0141+  198A             ; TO UPPER
0142+  198A             ; input in AL
0143+  198A             ; output in AL
0144+  198A             ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0145+  198A             _to_upper:
0146+  198A B9 61       	cmp al, 'a'
0147+  198C C8 91 19    	jlu _to_upper_ret
0148+  198F 6F 20       	sub al, $20			; convert to upper case
0149+  1991             _to_upper_ret:
0150+  1991 09          	ret
0151+  1992             
2702   1992             ; --- END INLINE ASM BLOCK
2703   1992             
2704   1992 F9            leave
2705   1993 09            ret
2706   1994             
2707   1994             is_space:
2708   1994 F8 00 00      enter 0 ; (push bp; mov bp, sp)
2709   1997             ;; return c == ' ' || c == '\t' || c == '\n' || c == '\r'; 
2710   1997 FA 05 00      lea d, [bp + 5] ; $c
2711   199A 32            mov bl, [d]
2712   199B A7 00         mov bh, 0
2713   199D             ; START RELATIONAL
2714   199D D7            push a
2715   199E 11            mov a, b
2716   199F 26 20 00      mov b, $20
2717   19A2 B0            cmp a, b
2718   19A3 FD 71         seq ; ==
2719   19A5 E4            pop a
2720   19A6             ; END RELATIONAL
2721   19A6 D7            push a
2722   19A7 11            mov a, b
2723   19A8 FA 05 00      lea d, [bp + 5] ; $c
2724   19AB 32            mov bl, [d]
2725   19AC A7 00         mov bh, 0
2726   19AE             ; START RELATIONAL
2727   19AE D7            push a
2728   19AF 11            mov a, b
2729   19B0 26 09 00      mov b, $9
2730   19B3 B0            cmp a, b
2731   19B4 FD 71         seq ; ==
2732   19B6 E4            pop a
2733   19B7             ; END RELATIONAL
2734   19B7 FD A8         sor a, b ; ||
2735   19B9 11            mov a, b
2736   19BA FA 05 00      lea d, [bp + 5] ; $c
2737   19BD 32            mov bl, [d]
2738   19BE A7 00         mov bh, 0
2739   19C0             ; START RELATIONAL
2740   19C0 D7            push a
2741   19C1 11            mov a, b
2742   19C2 26 0A 00      mov b, $a
2743   19C5 B0            cmp a, b
2744   19C6 FD 71         seq ; ==
2745   19C8 E4            pop a
2746   19C9             ; END RELATIONAL
2747   19C9 FD A8         sor a, b ; ||
2748   19CB 11            mov a, b
2749   19CC FA 05 00      lea d, [bp + 5] ; $c
2750   19CF 32            mov bl, [d]
2751   19D0 A7 00         mov bh, 0
2752   19D2             ; START RELATIONAL
2753   19D2 D7            push a
2754   19D3 11            mov a, b
2755   19D4 26 0D 00      mov b, $d
2756   19D7 B0            cmp a, b
2757   19D8 FD 71         seq ; ==
2758   19DA E4            pop a
2759   19DB             ; END RELATIONAL
2760   19DB FD A8         sor a, b ; ||
2761   19DD E4            pop a
2762   19DE F9            leave
2763   19DF 09            ret
2764   19E0             
2765   19E0             is_digit:
2766   19E0 F8 00 00      enter 0 ; (push bp; mov bp, sp)
2767   19E3             ;; return c >= '0' && c <= '9'; 
2768   19E3 FA 05 00      lea d, [bp + 5] ; $c
2769   19E6 32            mov bl, [d]
2770   19E7 A7 00         mov bh, 0
2771   19E9             ; START RELATIONAL
2772   19E9 D7            push a
2773   19EA 11            mov a, b
2774   19EB 26 30 00      mov b, $30
2775   19EE B0            cmp a, b
2776   19EF FD 80         sge ; >=
2777   19F1 E4            pop a
2778   19F2             ; END RELATIONAL
2779   19F2 D7            push a
2780   19F3 11            mov a, b
2781   19F4 FA 05 00      lea d, [bp + 5] ; $c
2782   19F7 32            mov bl, [d]
2783   19F8 A7 00         mov bh, 0
2784   19FA             ; START RELATIONAL
2785   19FA D7            push a
2786   19FB 11            mov a, b
2787   19FC 26 39 00      mov b, $39
2788   19FF B0            cmp a, b
2789   1A00 FD 73         slt ; <= (signed)
2790   1A02 E4            pop a
2791   1A03             ; END RELATIONAL
2792   1A03 FD A7         sand a, b
2793   1A05 E4            pop a
2794   1A06 F9            leave
2795   1A07 09            ret
2796   1A08             
2797   1A08             is_alpha:
2798   1A08 F8 00 00      enter 0 ; (push bp; mov bp, sp)
2799   1A0B             ;; return(c >= 'a' && c <= 'z' || c >= 'A' && c <= 'Z' || c == '_'); 
2800   1A0B FA 05 00      lea d, [bp + 5] ; $c
2801   1A0E 32            mov bl, [d]
2802   1A0F A7 00         mov bh, 0
2803   1A11             ; START RELATIONAL
2804   1A11 D7            push a
2805   1A12 11            mov a, b
2806   1A13 26 61 00      mov b, $61
2807   1A16 B0            cmp a, b
2808   1A17 FD 80         sge ; >=
2809   1A19 E4            pop a
2810   1A1A             ; END RELATIONAL
2811   1A1A D7            push a
2812   1A1B 11            mov a, b
2813   1A1C FA 05 00      lea d, [bp + 5] ; $c
2814   1A1F 32            mov bl, [d]
2815   1A20 A7 00         mov bh, 0
2816   1A22             ; START RELATIONAL
2817   1A22 D7            push a
2818   1A23 11            mov a, b
2819   1A24 26 7A 00      mov b, $7a
2820   1A27 B0            cmp a, b
2821   1A28 FD 73         slt ; <= (signed)
2822   1A2A E4            pop a
2823   1A2B             ; END RELATIONAL
2824   1A2B FD A7         sand a, b
2825   1A2D E4            pop a
2826   1A2E D7            push a
2827   1A2F 11            mov a, b
2828   1A30 FA 05 00      lea d, [bp + 5] ; $c
2829   1A33 32            mov bl, [d]
2830   1A34 A7 00         mov bh, 0
2831   1A36             ; START RELATIONAL
2832   1A36 D7            push a
2833   1A37 11            mov a, b
2834   1A38 26 41 00      mov b, $41
2835   1A3B B0            cmp a, b
2836   1A3C FD 80         sge ; >=
2837   1A3E E4            pop a
2838   1A3F             ; END RELATIONAL
2839   1A3F D7            push a
2840   1A40 11            mov a, b
2841   1A41 FA 05 00      lea d, [bp + 5] ; $c
2842   1A44 32            mov bl, [d]
2843   1A45 A7 00         mov bh, 0
2844   1A47             ; START RELATIONAL
2845   1A47 D7            push a
2846   1A48 11            mov a, b
2847   1A49 26 5A 00      mov b, $5a
2848   1A4C B0            cmp a, b
2849   1A4D FD 73         slt ; <= (signed)
2850   1A4F E4            pop a
2851   1A50             ; END RELATIONAL
2852   1A50 FD A7         sand a, b
2853   1A52 E4            pop a
2854   1A53 FD A8         sor a, b ; ||
2855   1A55 11            mov a, b
2856   1A56 FA 05 00      lea d, [bp + 5] ; $c
2857   1A59 32            mov bl, [d]
2858   1A5A A7 00         mov bh, 0
2859   1A5C             ; START RELATIONAL
2860   1A5C D7            push a
2861   1A5D 11            mov a, b
2862   1A5E 26 5F 00      mov b, $5f
2863   1A61 B0            cmp a, b
2864   1A62 FD 71         seq ; ==
2865   1A64 E4            pop a
2866   1A65             ; END RELATIONAL
2867   1A65 FD A8         sor a, b ; ||
2868   1A67 E4            pop a
2869   1A68 F9            leave
2870   1A69 09            ret
2871   1A6A             
2872   1A6A             tolower:
2873   1A6A F8 00 00      enter 0 ; (push bp; mov bp, sp)
2874   1A6D             ;; if (ch >= 'A' && ch <= 'Z')  
2875   1A6D             _if42_cond:
2876   1A6D FA 05 00      lea d, [bp + 5] ; $ch
2877   1A70 32            mov bl, [d]
2878   1A71 A7 00         mov bh, 0
2879   1A73             ; START RELATIONAL
2880   1A73 D7            push a
2881   1A74 11            mov a, b
2882   1A75 26 41 00      mov b, $41
2883   1A78 B0            cmp a, b
2884   1A79 FD 80         sge ; >=
2885   1A7B E4            pop a
2886   1A7C             ; END RELATIONAL
2887   1A7C D7            push a
2888   1A7D 11            mov a, b
2889   1A7E FA 05 00      lea d, [bp + 5] ; $ch
2890   1A81 32            mov bl, [d]
2891   1A82 A7 00         mov bh, 0
2892   1A84             ; START RELATIONAL
2893   1A84 D7            push a
2894   1A85 11            mov a, b
2895   1A86 26 5A 00      mov b, $5a
2896   1A89 B0            cmp a, b
2897   1A8A FD 73         slt ; <= (signed)
2898   1A8C E4            pop a
2899   1A8D             ; END RELATIONAL
2900   1A8D FD A7         sand a, b
2901   1A8F E4            pop a
2902   1A90 C0 00 00      cmp b, 0
2903   1A93 C6 AE 1A      je _if42_else
2904   1A96             _if42_true:
2905   1A96             ;; return ch - 'A' + 'a'; 
2906   1A96 FA 05 00      lea d, [bp + 5] ; $ch
2907   1A99 32            mov bl, [d]
2908   1A9A A7 00         mov bh, 0
2909   1A9C             ; START TERMS
2910   1A9C D7            push a
2911   1A9D 11            mov a, b
2912   1A9E 26 41 00      mov b, $41
2913   1AA1 60            sub a, b
2914   1AA2 27            mov b, a
2915   1AA3 11            mov a, b
2916   1AA4 26 61 00      mov b, $61
2917   1AA7 56            add b, a
2918   1AA8 E4            pop a
2919   1AA9             ; END TERMS
2920   1AA9 F9            leave
2921   1AAA 09            ret
2922   1AAB 0A B6 1A      jmp _if42_exit
2923   1AAE             _if42_else:
2924   1AAE             ;; return ch; 
2925   1AAE FA 05 00      lea d, [bp + 5] ; $ch
2926   1AB1 32            mov bl, [d]
2927   1AB2 A7 00         mov bh, 0
2928   1AB4 F9            leave
2929   1AB5 09            ret
2930   1AB6             _if42_exit:
2931   1AB6 F9            leave
2932   1AB7 09            ret
2933   1AB8             
2934   1AB8             toupper:
2935   1AB8 F8 00 00      enter 0 ; (push bp; mov bp, sp)
2936   1ABB             ;; if (ch >= 'a' && ch <= 'z')  
2937   1ABB             _if43_cond:
2938   1ABB FA 05 00      lea d, [bp + 5] ; $ch
2939   1ABE 32            mov bl, [d]
2940   1ABF A7 00         mov bh, 0
2941   1AC1             ; START RELATIONAL
2942   1AC1 D7            push a
2943   1AC2 11            mov a, b
2944   1AC3 26 61 00      mov b, $61
2945   1AC6 B0            cmp a, b
2946   1AC7 FD 80         sge ; >=
2947   1AC9 E4            pop a
2948   1ACA             ; END RELATIONAL
2949   1ACA D7            push a
2950   1ACB 11            mov a, b
2951   1ACC FA 05 00      lea d, [bp + 5] ; $ch
2952   1ACF 32            mov bl, [d]
2953   1AD0 A7 00         mov bh, 0
2954   1AD2             ; START RELATIONAL
2955   1AD2 D7            push a
2956   1AD3 11            mov a, b
2957   1AD4 26 7A 00      mov b, $7a
2958   1AD7 B0            cmp a, b
2959   1AD8 FD 73         slt ; <= (signed)
2960   1ADA E4            pop a
2961   1ADB             ; END RELATIONAL
2962   1ADB FD A7         sand a, b
2963   1ADD E4            pop a
2964   1ADE C0 00 00      cmp b, 0
2965   1AE1 C6 FC 1A      je _if43_else
2966   1AE4             _if43_true:
2967   1AE4             ;; return ch - 'a' + 'A'; 
2968   1AE4 FA 05 00      lea d, [bp + 5] ; $ch
2969   1AE7 32            mov bl, [d]
2970   1AE8 A7 00         mov bh, 0
2971   1AEA             ; START TERMS
2972   1AEA D7            push a
2973   1AEB 11            mov a, b
2974   1AEC 26 61 00      mov b, $61
2975   1AEF 60            sub a, b
2976   1AF0 27            mov b, a
2977   1AF1 11            mov a, b
2978   1AF2 26 41 00      mov b, $41
2979   1AF5 56            add b, a
2980   1AF6 E4            pop a
2981   1AF7             ; END TERMS
2982   1AF7 F9            leave
2983   1AF8 09            ret
2984   1AF9 0A 04 1B      jmp _if43_exit
2985   1AFC             _if43_else:
2986   1AFC             ;; return ch; 
2987   1AFC FA 05 00      lea d, [bp + 5] ; $ch
2988   1AFF 32            mov bl, [d]
2989   1B00 A7 00         mov bh, 0
2990   1B02 F9            leave
2991   1B03 09            ret
2992   1B04             _if43_exit:
2993   1B04 F9            leave
2994   1B05 09            ret
2995   1B06             
2996   1B06             is_delimiter:
2997   1B06 F8 00 00      enter 0 ; (push bp; mov bp, sp)
2998   1B09             ;; if( 
2999   1B09             _if44_cond:
3000   1B09 FA 05 00      lea d, [bp + 5] ; $c
3001   1B0C 32            mov bl, [d]
3002   1B0D A7 00         mov bh, 0
3003   1B0F             ; START RELATIONAL
3004   1B0F D7            push a
3005   1B10 11            mov a, b
3006   1B11 26 40 00      mov b, $40
3007   1B14 B0            cmp a, b
3008   1B15 FD 71         seq ; ==
3009   1B17 E4            pop a
3010   1B18             ; END RELATIONAL
3011   1B18 D7            push a
3012   1B19 11            mov a, b
3013   1B1A FA 05 00      lea d, [bp + 5] ; $c
3014   1B1D 32            mov bl, [d]
3015   1B1E A7 00         mov bh, 0
3016   1B20             ; START RELATIONAL
3017   1B20 D7            push a
3018   1B21 11            mov a, b
3019   1B22 26 23 00      mov b, $23
3020   1B25 B0            cmp a, b
3021   1B26 FD 71         seq ; ==
3022   1B28 E4            pop a
3023   1B29             ; END RELATIONAL
3024   1B29 FD A8         sor a, b ; ||
3025   1B2B 11            mov a, b
3026   1B2C FA 05 00      lea d, [bp + 5] ; $c
3027   1B2F 32            mov bl, [d]
3028   1B30 A7 00         mov bh, 0
3029   1B32             ; START RELATIONAL
3030   1B32 D7            push a
3031   1B33 11            mov a, b
3032   1B34 26 24 00      mov b, $24
3033   1B37 B0            cmp a, b
3034   1B38 FD 71         seq ; ==
3035   1B3A E4            pop a
3036   1B3B             ; END RELATIONAL
3037   1B3B FD A8         sor a, b ; ||
3038   1B3D 11            mov a, b
3039   1B3E FA 05 00      lea d, [bp + 5] ; $c
3040   1B41 32            mov bl, [d]
3041   1B42 A7 00         mov bh, 0
3042   1B44             ; START RELATIONAL
3043   1B44 D7            push a
3044   1B45 11            mov a, b
3045   1B46 26 2B 00      mov b, $2b
3046   1B49 B0            cmp a, b
3047   1B4A FD 71         seq ; ==
3048   1B4C E4            pop a
3049   1B4D             ; END RELATIONAL
3050   1B4D FD A8         sor a, b ; ||
3051   1B4F 11            mov a, b
3052   1B50 FA 05 00      lea d, [bp + 5] ; $c
3053   1B53 32            mov bl, [d]
3054   1B54 A7 00         mov bh, 0
3055   1B56             ; START RELATIONAL
3056   1B56 D7            push a
3057   1B57 11            mov a, b
3058   1B58 26 2D 00      mov b, $2d
3059   1B5B B0            cmp a, b
3060   1B5C FD 71         seq ; ==
3061   1B5E E4            pop a
3062   1B5F             ; END RELATIONAL
3063   1B5F FD A8         sor a, b ; ||
3064   1B61 11            mov a, b
3065   1B62 FA 05 00      lea d, [bp + 5] ; $c
3066   1B65 32            mov bl, [d]
3067   1B66 A7 00         mov bh, 0
3068   1B68             ; START RELATIONAL
3069   1B68 D7            push a
3070   1B69 11            mov a, b
3071   1B6A 26 2A 00      mov b, $2a
3072   1B6D B0            cmp a, b
3073   1B6E FD 71         seq ; ==
3074   1B70 E4            pop a
3075   1B71             ; END RELATIONAL
3076   1B71 FD A8         sor a, b ; ||
3077   1B73 11            mov a, b
3078   1B74 FA 05 00      lea d, [bp + 5] ; $c
3079   1B77 32            mov bl, [d]
3080   1B78 A7 00         mov bh, 0
3081   1B7A             ; START RELATIONAL
3082   1B7A D7            push a
3083   1B7B 11            mov a, b
3084   1B7C 26 2F 00      mov b, $2f
3085   1B7F B0            cmp a, b
3086   1B80 FD 71         seq ; ==
3087   1B82 E4            pop a
3088   1B83             ; END RELATIONAL
3089   1B83 FD A8         sor a, b ; ||
3090   1B85 11            mov a, b
3091   1B86 FA 05 00      lea d, [bp + 5] ; $c
3092   1B89 32            mov bl, [d]
3093   1B8A A7 00         mov bh, 0
3094   1B8C             ; START RELATIONAL
3095   1B8C D7            push a
3096   1B8D 11            mov a, b
3097   1B8E 26 25 00      mov b, $25
3098   1B91 B0            cmp a, b
3099   1B92 FD 71         seq ; ==
3100   1B94 E4            pop a
3101   1B95             ; END RELATIONAL
3102   1B95 FD A8         sor a, b ; ||
3103   1B97 11            mov a, b
3104   1B98 FA 05 00      lea d, [bp + 5] ; $c
3105   1B9B 32            mov bl, [d]
3106   1B9C A7 00         mov bh, 0
3107   1B9E             ; START RELATIONAL
3108   1B9E D7            push a
3109   1B9F 11            mov a, b
3110   1BA0 26 5B 00      mov b, $5b
3111   1BA3 B0            cmp a, b
3112   1BA4 FD 71         seq ; ==
3113   1BA6 E4            pop a
3114   1BA7             ; END RELATIONAL
3115   1BA7 FD A8         sor a, b ; ||
3116   1BA9 11            mov a, b
3117   1BAA FA 05 00      lea d, [bp + 5] ; $c
3118   1BAD 32            mov bl, [d]
3119   1BAE A7 00         mov bh, 0
3120   1BB0             ; START RELATIONAL
3121   1BB0 D7            push a
3122   1BB1 11            mov a, b
3123   1BB2 26 5D 00      mov b, $5d
3124   1BB5 B0            cmp a, b
3125   1BB6 FD 71         seq ; ==
3126   1BB8 E4            pop a
3127   1BB9             ; END RELATIONAL
3128   1BB9 FD A8         sor a, b ; ||
3129   1BBB 11            mov a, b
3130   1BBC FA 05 00      lea d, [bp + 5] ; $c
3131   1BBF 32            mov bl, [d]
3132   1BC0 A7 00         mov bh, 0
3133   1BC2             ; START RELATIONAL
3134   1BC2 D7            push a
3135   1BC3 11            mov a, b
3136   1BC4 26 28 00      mov b, $28
3137   1BC7 B0            cmp a, b
3138   1BC8 FD 71         seq ; ==
3139   1BCA E4            pop a
3140   1BCB             ; END RELATIONAL
3141   1BCB FD A8         sor a, b ; ||
3142   1BCD 11            mov a, b
3143   1BCE FA 05 00      lea d, [bp + 5] ; $c
3144   1BD1 32            mov bl, [d]
3145   1BD2 A7 00         mov bh, 0
3146   1BD4             ; START RELATIONAL
3147   1BD4 D7            push a
3148   1BD5 11            mov a, b
3149   1BD6 26 29 00      mov b, $29
3150   1BD9 B0            cmp a, b
3151   1BDA FD 71         seq ; ==
3152   1BDC E4            pop a
3153   1BDD             ; END RELATIONAL
3154   1BDD FD A8         sor a, b ; ||
3155   1BDF 11            mov a, b
3156   1BE0 FA 05 00      lea d, [bp + 5] ; $c
3157   1BE3 32            mov bl, [d]
3158   1BE4 A7 00         mov bh, 0
3159   1BE6             ; START RELATIONAL
3160   1BE6 D7            push a
3161   1BE7 11            mov a, b
3162   1BE8 26 7B 00      mov b, $7b
3163   1BEB B0            cmp a, b
3164   1BEC FD 71         seq ; ==
3165   1BEE E4            pop a
3166   1BEF             ; END RELATIONAL
3167   1BEF FD A8         sor a, b ; ||
3168   1BF1 11            mov a, b
3169   1BF2 FA 05 00      lea d, [bp + 5] ; $c
3170   1BF5 32            mov bl, [d]
3171   1BF6 A7 00         mov bh, 0
3172   1BF8             ; START RELATIONAL
3173   1BF8 D7            push a
3174   1BF9 11            mov a, b
3175   1BFA 26 7D 00      mov b, $7d
3176   1BFD B0            cmp a, b
3177   1BFE FD 71         seq ; ==
3178   1C00 E4            pop a
3179   1C01             ; END RELATIONAL
3180   1C01 FD A8         sor a, b ; ||
3181   1C03 11            mov a, b
3182   1C04 FA 05 00      lea d, [bp + 5] ; $c
3183   1C07 32            mov bl, [d]
3184   1C08 A7 00         mov bh, 0
3185   1C0A             ; START RELATIONAL
3186   1C0A D7            push a
3187   1C0B 11            mov a, b
3188   1C0C 26 3A 00      mov b, $3a
3189   1C0F B0            cmp a, b
3190   1C10 FD 71         seq ; ==
3191   1C12 E4            pop a
3192   1C13             ; END RELATIONAL
3193   1C13 FD A8         sor a, b ; ||
3194   1C15 11            mov a, b
3195   1C16 FA 05 00      lea d, [bp + 5] ; $c
3196   1C19 32            mov bl, [d]
3197   1C1A A7 00         mov bh, 0
3198   1C1C             ; START RELATIONAL
3199   1C1C D7            push a
3200   1C1D 11            mov a, b
3201   1C1E 26 3B 00      mov b, $3b
3202   1C21 B0            cmp a, b
3203   1C22 FD 71         seq ; ==
3204   1C24 E4            pop a
3205   1C25             ; END RELATIONAL
3206   1C25 FD A8         sor a, b ; ||
3207   1C27 11            mov a, b
3208   1C28 FA 05 00      lea d, [bp + 5] ; $c
3209   1C2B 32            mov bl, [d]
3210   1C2C A7 00         mov bh, 0
3211   1C2E             ; START RELATIONAL
3212   1C2E D7            push a
3213   1C2F 11            mov a, b
3214   1C30 26 3C 00      mov b, $3c
3215   1C33 B0            cmp a, b
3216   1C34 FD 71         seq ; ==
3217   1C36 E4            pop a
3218   1C37             ; END RELATIONAL
3219   1C37 FD A8         sor a, b ; ||
3220   1C39 11            mov a, b
3221   1C3A FA 05 00      lea d, [bp + 5] ; $c
3222   1C3D 32            mov bl, [d]
3223   1C3E A7 00         mov bh, 0
3224   1C40             ; START RELATIONAL
3225   1C40 D7            push a
3226   1C41 11            mov a, b
3227   1C42 26 3E 00      mov b, $3e
3228   1C45 B0            cmp a, b
3229   1C46 FD 71         seq ; ==
3230   1C48 E4            pop a
3231   1C49             ; END RELATIONAL
3232   1C49 FD A8         sor a, b ; ||
3233   1C4B 11            mov a, b
3234   1C4C FA 05 00      lea d, [bp + 5] ; $c
3235   1C4F 32            mov bl, [d]
3236   1C50 A7 00         mov bh, 0
3237   1C52             ; START RELATIONAL
3238   1C52 D7            push a
3239   1C53 11            mov a, b
3240   1C54 26 3D 00      mov b, $3d
3241   1C57 B0            cmp a, b
3242   1C58 FD 71         seq ; ==
3243   1C5A E4            pop a
3244   1C5B             ; END RELATIONAL
3245   1C5B FD A8         sor a, b ; ||
3246   1C5D 11            mov a, b
3247   1C5E FA 05 00      lea d, [bp + 5] ; $c
3248   1C61 32            mov bl, [d]
3249   1C62 A7 00         mov bh, 0
3250   1C64             ; START RELATIONAL
3251   1C64 D7            push a
3252   1C65 11            mov a, b
3253   1C66 26 21 00      mov b, $21
3254   1C69 B0            cmp a, b
3255   1C6A FD 71         seq ; ==
3256   1C6C E4            pop a
3257   1C6D             ; END RELATIONAL
3258   1C6D FD A8         sor a, b ; ||
3259   1C6F 11            mov a, b
3260   1C70 FA 05 00      lea d, [bp + 5] ; $c
3261   1C73 32            mov bl, [d]
3262   1C74 A7 00         mov bh, 0
3263   1C76             ; START RELATIONAL
3264   1C76 D7            push a
3265   1C77 11            mov a, b
3266   1C78 26 5E 00      mov b, $5e
3267   1C7B B0            cmp a, b
3268   1C7C FD 71         seq ; ==
3269   1C7E E4            pop a
3270   1C7F             ; END RELATIONAL
3271   1C7F FD A8         sor a, b ; ||
3272   1C81 11            mov a, b
3273   1C82 FA 05 00      lea d, [bp + 5] ; $c
3274   1C85 32            mov bl, [d]
3275   1C86 A7 00         mov bh, 0
3276   1C88             ; START RELATIONAL
3277   1C88 D7            push a
3278   1C89 11            mov a, b
3279   1C8A 26 26 00      mov b, $26
3280   1C8D B0            cmp a, b
3281   1C8E FD 71         seq ; ==
3282   1C90 E4            pop a
3283   1C91             ; END RELATIONAL
3284   1C91 FD A8         sor a, b ; ||
3285   1C93 11            mov a, b
3286   1C94 FA 05 00      lea d, [bp + 5] ; $c
3287   1C97 32            mov bl, [d]
3288   1C98 A7 00         mov bh, 0
3289   1C9A             ; START RELATIONAL
3290   1C9A D7            push a
3291   1C9B 11            mov a, b
3292   1C9C 26 7C 00      mov b, $7c
3293   1C9F B0            cmp a, b
3294   1CA0 FD 71         seq ; ==
3295   1CA2 E4            pop a
3296   1CA3             ; END RELATIONAL
3297   1CA3 FD A8         sor a, b ; ||
3298   1CA5 11            mov a, b
3299   1CA6 FA 05 00      lea d, [bp + 5] ; $c
3300   1CA9 32            mov bl, [d]
3301   1CAA A7 00         mov bh, 0
3302   1CAC             ; START RELATIONAL
3303   1CAC D7            push a
3304   1CAD 11            mov a, b
3305   1CAE 26 7E 00      mov b, $7e
3306   1CB1 B0            cmp a, b
3307   1CB2 FD 71         seq ; ==
3308   1CB4 E4            pop a
3309   1CB5             ; END RELATIONAL
3310   1CB5 FD A8         sor a, b ; ||
3311   1CB7 11            mov a, b
3312   1CB8 FA 05 00      lea d, [bp + 5] ; $c
3313   1CBB 32            mov bl, [d]
3314   1CBC A7 00         mov bh, 0
3315   1CBE             ; START RELATIONAL
3316   1CBE D7            push a
3317   1CBF 11            mov a, b
3318   1CC0 26 2E 00      mov b, $2e
3319   1CC3 B0            cmp a, b
3320   1CC4 FD 71         seq ; ==
3321   1CC6 E4            pop a
3322   1CC7             ; END RELATIONAL
3323   1CC7 FD A8         sor a, b ; ||
3324   1CC9 E4            pop a
3325   1CCA C0 00 00      cmp b, 0
3326   1CCD C6 D8 1C      je _if44_else
3327   1CD0             _if44_true:
3328   1CD0             ;; return 1; 
3329   1CD0 26 01 00      mov b, $1
3330   1CD3 F9            leave
3331   1CD4 09            ret
3332   1CD5 0A DD 1C      jmp _if44_exit
3333   1CD8             _if44_else:
3334   1CD8             ;; return 0; 
3335   1CD8 26 00 00      mov b, $0
3336   1CDB F9            leave
3337   1CDC 09            ret
3338   1CDD             _if44_exit:
3339   1CDD F9            leave
3340   1CDE 09            ret
3341   1CDF             
3342   1CDF             TO_FIXED:
3343   1CDF F8 00 00      enter 0 ; (push bp; mov bp, sp)
3344   1CE2             ;; return x * 10; 
3345   1CE2 FA 05 00      lea d, [bp + 5] ; $x
3346   1CE5 2A            mov b, [d]
3347   1CE6             ; START FACTORS
3348   1CE6 D7            push a
3349   1CE7 11            mov a, b
3350   1CE8 26 0A 00      mov b, $a
3351   1CEB AC            mul a, b ; *
3352   1CEC 11            mov a, b
3353   1CED 27            mov b, a
3354   1CEE E4            pop a
3355   1CEF             ; END FACTORS
3356   1CEF F9            leave
3357   1CF0 09            ret
3358   1CF1             
3359   1CF1             FROM_FIXED:
3360   1CF1 F8 00 00      enter 0 ; (push bp; mov bp, sp)
3361   1CF4             ;; return x / 10; 
3362   1CF4 FA 05 00      lea d, [bp + 5] ; $x
3363   1CF7 2A            mov b, [d]
3364   1CF8             ; START FACTORS
3365   1CF8 D7            push a
3366   1CF9 11            mov a, b
3367   1CFA 26 0A 00      mov b, $a
3368   1CFD AE            div a, b
3369   1CFE 27            mov b, a
3370   1CFF E4            pop a
3371   1D00             ; END FACTORS
3372   1D00 F9            leave
3373   1D01 09            ret
3374   1D02             
3375   1D02             TO_FIXED00:
3376   1D02 F8 00 00      enter 0 ; (push bp; mov bp, sp)
3377   1D05             ;; return x * 100; 
3378   1D05 FA 05 00      lea d, [bp + 5] ; $x
3379   1D08 2A            mov b, [d]
3380   1D09             ; START FACTORS
3381   1D09 D7            push a
3382   1D0A 11            mov a, b
3383   1D0B 26 64 00      mov b, $64
3384   1D0E AC            mul a, b ; *
3385   1D0F 11            mov a, b
3386   1D10 27            mov b, a
3387   1D11 E4            pop a
3388   1D12             ; END FACTORS
3389   1D12 F9            leave
3390   1D13 09            ret
3391   1D14             
3392   1D14             FROM_FIXED00:
3393   1D14 F8 00 00      enter 0 ; (push bp; mov bp, sp)
3394   1D17             ;; return x / 100; 
3395   1D17 FA 05 00      lea d, [bp + 5] ; $x
3396   1D1A 2A            mov b, [d]
3397   1D1B             ; START FACTORS
3398   1D1B D7            push a
3399   1D1C 11            mov a, b
3400   1D1D 26 64 00      mov b, $64
3401   1D20 AE            div a, b
3402   1D21 27            mov b, a
3403   1D22 E4            pop a
3404   1D23             ; END FACTORS
3405   1D23 F9            leave
3406   1D24 09            ret
3407   1D25             
3408   1D25             get_rand:
3409   1D25 F8 00 00      enter 0 ; (push bp; mov bp, sp)
3410   1D28             ; $r 
3411   1D28 52 02 00      sub sp, 2
3412   1D2B             ;; r = rand(); 
3413   1D2B FA FF FF      lea d, [bp + -1] ; $r
3414   1D2E DA            push d
3415   1D2F 07 9D 18      call rand
3416   1D32 E7            pop d
3417   1D33 FD 43         mov [d], b
3418   1D35             ;; r = (r >> 8) | (r << 8); 
3419   1D35 FA FF FF      lea d, [bp + -1] ; $r
3420   1D38 DA            push d
3421   1D39 FA FF FF      lea d, [bp + -1] ; $r
3422   1D3C 2A            mov b, [d]
3423   1D3D             ; START SHIFT
3424   1D3D D7            push a
3425   1D3E 11            mov a, b
3426   1D3F 26 08 00      mov b, $8
3427   1D42 FD 39         mov c, b
3428   1D44 A1            shr a, cl
3429   1D45 27            mov b, a
3430   1D46 E4            pop a
3431   1D47             ; END SHIFT
3432   1D47 D7            push a
3433   1D48 11            mov a, b
3434   1D49 FA FF FF      lea d, [bp + -1] ; $r
3435   1D4C 2A            mov b, [d]
3436   1D4D             ; START SHIFT
3437   1D4D D7            push a
3438   1D4E 11            mov a, b
3439   1D4F 26 08 00      mov b, $8
3440   1D52 FD 39         mov c, b
3441   1D54 9D            shl a, cl
3442   1D55 27            mov b, a
3443   1D56 E4            pop a
3444   1D57             ; END SHIFT
3445   1D57 FD 70         or b, a ; |
3446   1D59 E4            pop a
3447   1D5A E7            pop d
3448   1D5B FD 43         mov [d], b
3449   1D5D             ;; return ((r % spread) + 1); 
3450   1D5D FA FF FF      lea d, [bp + -1] ; $r
3451   1D60 2A            mov b, [d]
3452   1D61             ; START FACTORS
3453   1D61 D7            push a
3454   1D62 11            mov a, b
3455   1D63 FA 05 00      lea d, [bp + 5] ; $spread
3456   1D66 2A            mov b, [d]
3457   1D67 AE            div a, b ; 
3458   1D68 11            mov a, b
3459   1D69 27            mov b, a
3460   1D6A E4            pop a
3461   1D6B             ; END FACTORS
3462   1D6B             ; START TERMS
3463   1D6B D7            push a
3464   1D6C 11            mov a, b
3465   1D6D 26 01 00      mov b, $1
3466   1D70 56            add b, a
3467   1D71 E4            pop a
3468   1D72             ; END TERMS
3469   1D72 F9            leave
3470   1D73 09            ret
3471   1D74             
3472   1D74             rand8:
3473   1D74 F8 00 00      enter 0 ; (push bp; mov bp, sp)
3474   1D77             ;; return (get_rand(8)); 
3475   1D77 26 08 00      mov b, $8
3476   1D7A FD AB         swp b
3477   1D7C D8            push b
3478   1D7D 07 25 1D      call get_rand
3479   1D80 51 02 00      add sp, 2
3480   1D83 F9            leave
3481   1D84 09            ret
3482   1D85             
3483   1D85             input:
3484   1D85 F8 00 00      enter 0 ; (push bp; mov bp, sp)
3485   1D88             ; $c 
3486   1D88 52 02 00      sub sp, 2
3487   1D8B             ;; while((c = getchar()) != '\n') { 
3488   1D8B             _while45_cond:
3489   1D8B FA FF FF      lea d, [bp + -1] ; $c
3490   1D8E DA            push d
3491   1D8F 07 0E 13      call getchar
3492   1D92 E7            pop d
3493   1D93 FD 43         mov [d], b
3494   1D95             ; START RELATIONAL
3495   1D95 D7            push a
3496   1D96 11            mov a, b
3497   1D97 26 0A 00      mov b, $a
3498   1D9A B0            cmp a, b
3499   1D9B FD 72         sneq ; !=
3500   1D9D E4            pop a
3501   1D9E             ; END RELATIONAL
3502   1D9E C0 00 00      cmp b, 0
3503   1DA1 C6 03 1F      je _while45_exit
3504   1DA4             _while45_block:
3505   1DA4             ;; if (c == -1) 
3506   1DA4             _if46_cond:
3507   1DA4 FA FF FF      lea d, [bp + -1] ; $c
3508   1DA7 2A            mov b, [d]
3509   1DA8             ; START RELATIONAL
3510   1DA8 D7            push a
3511   1DA9 11            mov a, b
3512   1DAA 26 FF FF      mov b, 65535
3513   1DAD 38 FF FF      mov c, 65535
3514   1DB0 FD 22 00 00   mov g, 0
3515   1DB4 FD AF 00 00   cmp32 ga, cb
3515   1DB8 00 00 00 00 
3515   1DBC 00 00 00 00 
3515   1DC0 00 00 00 00 
3515   1DC4 00 00 00 00 
3515   1DC8 00 00 00 00 
3515   1DCC 00 00 00 00 
3515   1DD0 00 00 00 00 
3515   1DD4 00 00 00 00 
3515   1DD8 00 00 00 00 
3515   1DDC 00 00 00 00 
3515   1DE0 00 00 00 00 
3515   1DE4 00 00 00 00 
3515   1DE8 00 00 00 00 
3515   1DEC 00 00 00 00 
3515   1DF0 00 00 00 00 
3515   1DF4 00 00 00 00 
3515   1DF8 00 00 00 00 
3515   1DFC 00 00 00 00 
3515   1E00 00 00 00 00 
3515   1E04 00 00 00 00 
3515   1E08 00 00 00 00 
3515   1E0C 00 00 00 00 
3515   1E10 00 00 00 00 
3515   1E14 00 00 00 00 
3515   1E18 00 00 00 00 
3515   1E1C 00 00 00 00 
3515   1E20 00 00 00 00 
3515   1E24 00 00 00 00 
3515   1E28 00 00 00 00 
3515   1E2C 00 00 00 00 
3515   1E30 00 00 00 00 
3515   1E34 00 00 00 00 
3515   1E38 00 00 00 00 
3515   1E3C 00 00 00 00 
3515   1E40 00 00 00 00 
3515   1E44 00 00 00 00 
3515   1E48 00 00 00 00 
3515   1E4C 00 00 00 00 
3515   1E50 00 00 00 00 
3515   1E54 00 00 00 00 
3515   1E58 00 00 00 00 
3515   1E5C 00 00 00 00 
3515   1E60 00 00 00 00 
3515   1E64 00 00 00 00 
3515   1E68 00 00 00 00 
3515   1E6C 00 00 00 00 
3515   1E70 00 00 00 00 
3515   1E74 00 00 00 00 
3515   1E78 00 00 00 00 
3515   1E7C 00 00 00 00 
3515   1E80 00 00 00 00 
3515   1E84 00 00 00 00 
3515   1E88 00 00 00 00 
3515   1E8C 00 00 00 00 
3515   1E90 00 00 00 00 
3515   1E94 00 00 00 00 
3515   1E98 00 00 00 00 
3515   1E9C 00 00 00 00 
3515   1EA0 00 00 00 00 
3515   1EA4 00 00 00 00 
3515   1EA8 00 00 00 00 
3515   1EAC 00 00 00 00 
3515   1EB0 00 00 00 00 
3515   1EB4 00 
3516   1EB5 FD 71         seq ; ==
3517   1EB7 E4            pop a
3518   1EB8             ; END RELATIONAL
3519   1EB8 C0 00 00      cmp b, 0
3520   1EBB C6 C4 1E      je _if46_exit
3521   1EBE             _if46_true:
3522   1EBE             ;; exit(); 
3523   1EBE 07 34 17      call exit
3524   1EC1 0A C4 1E      jmp _if46_exit
3525   1EC4             _if46_exit:
3526   1EC4             ;; if (l > 1) { 
3527   1EC4             _if47_cond:
3528   1EC4 FA 07 00      lea d, [bp + 7] ; $l
3529   1EC7 32            mov bl, [d]
3530   1EC8 A7 00         mov bh, 0
3531   1ECA             ; START RELATIONAL
3532   1ECA D7            push a
3533   1ECB 11            mov a, b
3534   1ECC 26 01 00      mov b, $1
3535   1ECF B0            cmp a, b
3536   1ED0 FD 81         sgu ; > (unsigned)
3537   1ED2 E4            pop a
3538   1ED3             ; END RELATIONAL
3539   1ED3 C0 00 00      cmp b, 0
3540   1ED6 C6 00 1F      je _if47_exit
3541   1ED9             _if47_true:
3542   1ED9             ;; *b++ = c; 
3543   1ED9 FA 05 00      lea d, [bp + 5] ; $b
3544   1EDC 2A            mov b, [d]
3545   1EDD D8            push b
3546   1EDE FD 77         inc b
3547   1EE0 FA 05 00      lea d, [bp + 5] ; $b
3548   1EE3 FD 43         mov [d], b
3549   1EE5 E5            pop b
3550   1EE6 D8            push b
3551   1EE7 FA FF FF      lea d, [bp + -1] ; $c
3552   1EEA 2A            mov b, [d]
3553   1EEB E7            pop d
3554   1EEC FD 3E         mov [d], bl
3555   1EEE             ;; l--; 
3556   1EEE FA 07 00      lea d, [bp + 7] ; $l
3557   1EF1 32            mov bl, [d]
3558   1EF2 A7 00         mov bh, 0
3559   1EF4 D8            push b
3560   1EF5 FD 7D         dec b
3561   1EF7 FA 07 00      lea d, [bp + 7] ; $l
3562   1EFA FD 43         mov [d], b
3563   1EFC E5            pop b
3564   1EFD 0A 00 1F      jmp _if47_exit
3565   1F00             _if47_exit:
3566   1F00 0A 8B 1D      jmp _while45_cond
3567   1F03             _while45_exit:
3568   1F03             ;; *b = 0; 
3569   1F03 FA 05 00      lea d, [bp + 5] ; $b
3570   1F06 2A            mov b, [d]
3571   1F07 D8            push b
3572   1F08 26 00 00      mov b, $0
3573   1F0B E7            pop d
3574   1F0C FD 3E         mov [d], bl
3575   1F0E F9            leave
3576   1F0F 09            ret
3577   1F10             
3578   1F10             yesno:
3579   1F10 F8 00 00      enter 0 ; (push bp; mov bp, sp)
3580   1F13             ; $b 
3581   1F13 52 02 00      sub sp, 2
3582   1F16             ;; input(b,2); 
3583   1F16 26 02 00      mov b, $2
3584   1F19 DD            push bl
3585   1F1A FA FF FF      lea d, [bp + -1] ; $b
3586   1F1D 2D            mov b, d
3587   1F1E FD AB         swp b
3588   1F20 D8            push b
3589   1F21 07 85 1D      call input
3590   1F24 51 03 00      add sp, 3
3591   1F27             ;; if (tolower(*b) == 'y') 
3592   1F27             _if48_cond:
3593   1F27 FA FF FF      lea d, [bp + -1] ; $b
3594   1F2A 2D            mov b, d
3595   1F2B 74            mov d, b
3596   1F2C 32            mov bl, [d]
3597   1F2D A7 00         mov bh, 0
3598   1F2F DD            push bl
3599   1F30 07 6A 1A      call tolower
3600   1F33 51 01 00      add sp, 1
3601   1F36             ; START RELATIONAL
3602   1F36 D7            push a
3603   1F37 11            mov a, b
3604   1F38 26 79 00      mov b, $79
3605   1F3B B0            cmp a, b
3606   1F3C FD 71         seq ; ==
3607   1F3E E4            pop a
3608   1F3F             ; END RELATIONAL
3609   1F3F C0 00 00      cmp b, 0
3610   1F42 C6 4D 1F      je _if48_exit
3611   1F45             _if48_true:
3612   1F45             ;; return 1; 
3613   1F45 26 01 00      mov b, $1
3614   1F48 F9            leave
3615   1F49 09            ret
3616   1F4A 0A 4D 1F      jmp _if48_exit
3617   1F4D             _if48_exit:
3618   1F4D             ;; return 0; 
3619   1F4D 26 00 00      mov b, $0
3620   1F50 F9            leave
3621   1F51 09            ret
3622   1F52             
3623   1F52             input_f00:
3624   1F52 F8 00 00      enter 0 ; (push bp; mov bp, sp)
3625   1F55             ; $v 
3626   1F55             ; $buf 
3627   1F55             ; $x 
3628   1F55 52 0C 00      sub sp, 12
3629   1F58             ;; input(buf, 8); 
3630   1F58 26 08 00      mov b, $8
3631   1F5B DD            push bl
3632   1F5C FA F7 FF      lea d, [bp + -9] ; $buf
3633   1F5F 2D            mov b, d
3634   1F60 FD AB         swp b
3635   1F62 D8            push b
3636   1F63 07 85 1D      call input
3637   1F66 51 03 00      add sp, 3
3638   1F69             ;; x = buf; 
3639   1F69 FA F5 FF      lea d, [bp + -11] ; $x
3640   1F6C DA            push d
3641   1F6D FA F7 FF      lea d, [bp + -9] ; $buf
3642   1F70 2D            mov b, d
3643   1F71 E7            pop d
3644   1F72 FD 43         mov [d], b
3645   1F74             ;; if (!is_digit(*x)) 
3646   1F74             _if49_cond:
3647   1F74 FA F5 FF      lea d, [bp + -11] ; $x
3648   1F77 2A            mov b, [d]
3649   1F78 74            mov d, b
3650   1F79 32            mov bl, [d]
3651   1F7A A7 00         mov bh, 0
3652   1F7C DD            push bl
3653   1F7D 07 E0 19      call is_digit
3654   1F80 51 01 00      add sp, 1
3655   1F83 C0 00 00      cmp b, 0
3656   1F86 FD 71         seq ; !
3657   1F88 C0 00 00      cmp b, 0
3658   1F8B C6 99 1F      je _if49_exit
3659   1F8E             _if49_true:
3660   1F8E             ;; return -1; 
3661   1F8E 26 FF FF      mov b, 65535
3662   1F91 38 FF FF      mov c, 65535
3663   1F94 F9            leave
3664   1F95 09            ret
3665   1F96 0A 99 1F      jmp _if49_exit
3666   1F99             _if49_exit:
3667   1F99             ;; v = 100 * (*x++ - '0'); 
3668   1F99 FA FF FF      lea d, [bp + -1] ; $v
3669   1F9C DA            push d
3670   1F9D 26 64 00      mov b, $64
3671   1FA0             ; START FACTORS
3672   1FA0 D7            push a
3673   1FA1 11            mov a, b
3674   1FA2 FA F5 FF      lea d, [bp + -11] ; $x
3675   1FA5 2A            mov b, [d]
3676   1FA6 D8            push b
3677   1FA7 FD 77         inc b
3678   1FA9 FA F5 FF      lea d, [bp + -11] ; $x
3679   1FAC FD 43         mov [d], b
3680   1FAE E5            pop b
3681   1FAF 74            mov d, b
3682   1FB0 32            mov bl, [d]
3683   1FB1 A7 00         mov bh, 0
3684   1FB3             ; START TERMS
3685   1FB3 D7            push a
3686   1FB4 11            mov a, b
3687   1FB5 26 30 00      mov b, $30
3688   1FB8 60            sub a, b
3689   1FB9 27            mov b, a
3690   1FBA E4            pop a
3691   1FBB             ; END TERMS
3692   1FBB AC            mul a, b ; *
3693   1FBC 11            mov a, b
3694   1FBD 27            mov b, a
3695   1FBE E4            pop a
3696   1FBF             ; END FACTORS
3697   1FBF E7            pop d
3698   1FC0 FD 43         mov [d], b
3699   1FC2             ;; if (*x == 0) 
3700   1FC2             _if50_cond:
3701   1FC2 FA F5 FF      lea d, [bp + -11] ; $x
3702   1FC5 2A            mov b, [d]
3703   1FC6 74            mov d, b
3704   1FC7 32            mov bl, [d]
3705   1FC8 A7 00         mov bh, 0
3706   1FCA             ; START RELATIONAL
3707   1FCA D7            push a
3708   1FCB 11            mov a, b
3709   1FCC 26 00 00      mov b, $0
3710   1FCF B0            cmp a, b
3711   1FD0 FD 71         seq ; ==
3712   1FD2 E4            pop a
3713   1FD3             ; END RELATIONAL
3714   1FD3 C0 00 00      cmp b, 0
3715   1FD6 C6 E2 1F      je _if50_exit
3716   1FD9             _if50_true:
3717   1FD9             ;; return v; 
3718   1FD9 FA FF FF      lea d, [bp + -1] ; $v
3719   1FDC 2A            mov b, [d]
3720   1FDD F9            leave
3721   1FDE 09            ret
3722   1FDF 0A E2 1F      jmp _if50_exit
3723   1FE2             _if50_exit:
3724   1FE2             ;; if (*x++ != '.') 
3725   1FE2             _if51_cond:
3726   1FE2 FA F5 FF      lea d, [bp + -11] ; $x
3727   1FE5 2A            mov b, [d]
3728   1FE6 D8            push b
3729   1FE7 FD 77         inc b
3730   1FE9 FA F5 FF      lea d, [bp + -11] ; $x
3731   1FEC FD 43         mov [d], b
3732   1FEE E5            pop b
3733   1FEF 74            mov d, b
3734   1FF0 32            mov bl, [d]
3735   1FF1 A7 00         mov bh, 0
3736   1FF3             ; START RELATIONAL
3737   1FF3 D7            push a
3738   1FF4 11            mov a, b
3739   1FF5 26 2E 00      mov b, $2e
3740   1FF8 B0            cmp a, b
3741   1FF9 FD 72         sneq ; !=
3742   1FFB E4            pop a
3743   1FFC             ; END RELATIONAL
3744   1FFC C0 00 00      cmp b, 0
3745   1FFF C6 0D 20      je _if51_exit
3746   2002             _if51_true:
3747   2002             ;; return -1; 
3748   2002 26 FF FF      mov b, 65535
3749   2005 38 FF FF      mov c, 65535
3750   2008 F9            leave
3751   2009 09            ret
3752   200A 0A 0D 20      jmp _if51_exit
3753   200D             _if51_exit:
3754   200D             ;; if (!is_digit(*x)) 
3755   200D             _if52_cond:
3756   200D FA F5 FF      lea d, [bp + -11] ; $x
3757   2010 2A            mov b, [d]
3758   2011 74            mov d, b
3759   2012 32            mov bl, [d]
3760   2013 A7 00         mov bh, 0
3761   2015 DD            push bl
3762   2016 07 E0 19      call is_digit
3763   2019 51 01 00      add sp, 1
3764   201C C0 00 00      cmp b, 0
3765   201F FD 71         seq ; !
3766   2021 C0 00 00      cmp b, 0
3767   2024 C6 32 20      je _if52_exit
3768   2027             _if52_true:
3769   2027             ;; return -1; 
3770   2027 26 FF FF      mov b, 65535
3771   202A 38 FF FF      mov c, 65535
3772   202D F9            leave
3773   202E 09            ret
3774   202F 0A 32 20      jmp _if52_exit
3775   2032             _if52_exit:
3776   2032             ;; v = v + 10 * (*x++ - '0'); 
3777   2032 FA FF FF      lea d, [bp + -1] ; $v
3778   2035 DA            push d
3779   2036 FA FF FF      lea d, [bp + -1] ; $v
3780   2039 2A            mov b, [d]
3781   203A             ; START TERMS
3782   203A D7            push a
3783   203B 11            mov a, b
3784   203C 26 0A 00      mov b, $a
3785   203F             ; START FACTORS
3786   203F D7            push a
3787   2040 11            mov a, b
3788   2041 FA F5 FF      lea d, [bp + -11] ; $x
3789   2044 2A            mov b, [d]
3790   2045 D8            push b
3791   2046 FD 77         inc b
3792   2048 FA F5 FF      lea d, [bp + -11] ; $x
3793   204B FD 43         mov [d], b
3794   204D E5            pop b
3795   204E 74            mov d, b
3796   204F 32            mov bl, [d]
3797   2050 A7 00         mov bh, 0
3798   2052             ; START TERMS
3799   2052 D7            push a
3800   2053 11            mov a, b
3801   2054 26 30 00      mov b, $30
3802   2057 60            sub a, b
3803   2058 27            mov b, a
3804   2059 E4            pop a
3805   205A             ; END TERMS
3806   205A AC            mul a, b ; *
3807   205B 11            mov a, b
3808   205C 27            mov b, a
3809   205D E4            pop a
3810   205E             ; END FACTORS
3811   205E 56            add b, a
3812   205F E4            pop a
3813   2060             ; END TERMS
3814   2060 E7            pop d
3815   2061 FD 43         mov [d], b
3816   2063             ;; if (!*x) 
3817   2063             _if53_cond:
3818   2063 FA F5 FF      lea d, [bp + -11] ; $x
3819   2066 2A            mov b, [d]
3820   2067 74            mov d, b
3821   2068 32            mov bl, [d]
3822   2069 A7 00         mov bh, 0
3823   206B C0 00 00      cmp b, 0
3824   206E FD 71         seq ; !
3825   2070 C0 00 00      cmp b, 0
3826   2073 C6 7F 20      je _if53_exit
3827   2076             _if53_true:
3828   2076             ;; return v; 
3829   2076 FA FF FF      lea d, [bp + -1] ; $v
3830   2079 2A            mov b, [d]
3831   207A F9            leave
3832   207B 09            ret
3833   207C 0A 7F 20      jmp _if53_exit
3834   207F             _if53_exit:
3835   207F             ;; if (!is_digit(*x)) 
3836   207F             _if54_cond:
3837   207F FA F5 FF      lea d, [bp + -11] ; $x
3838   2082 2A            mov b, [d]
3839   2083 74            mov d, b
3840   2084 32            mov bl, [d]
3841   2085 A7 00         mov bh, 0
3842   2087 DD            push bl
3843   2088 07 E0 19      call is_digit
3844   208B 51 01 00      add sp, 1
3845   208E C0 00 00      cmp b, 0
3846   2091 FD 71         seq ; !
3847   2093 C0 00 00      cmp b, 0
3848   2096 C6 A4 20      je _if54_exit
3849   2099             _if54_true:
3850   2099             ;; return -1; 
3851   2099 26 FF FF      mov b, 65535
3852   209C 38 FF FF      mov c, 65535
3853   209F F9            leave
3854   20A0 09            ret
3855   20A1 0A A4 20      jmp _if54_exit
3856   20A4             _if54_exit:
3857   20A4             ;; v = v + *x++ - '0'; 
3858   20A4 FA FF FF      lea d, [bp + -1] ; $v
3859   20A7 DA            push d
3860   20A8 FA FF FF      lea d, [bp + -1] ; $v
3861   20AB 2A            mov b, [d]
3862   20AC             ; START TERMS
3863   20AC D7            push a
3864   20AD 11            mov a, b
3865   20AE FA F5 FF      lea d, [bp + -11] ; $x
3866   20B1 2A            mov b, [d]
3867   20B2 D8            push b
3868   20B3 FD 77         inc b
3869   20B5 FA F5 FF      lea d, [bp + -11] ; $x
3870   20B8 FD 43         mov [d], b
3871   20BA E5            pop b
3872   20BB 74            mov d, b
3873   20BC 32            mov bl, [d]
3874   20BD A7 00         mov bh, 0
3875   20BF 56            add b, a
3876   20C0 11            mov a, b
3877   20C1 26 30 00      mov b, $30
3878   20C4 60            sub a, b
3879   20C5 27            mov b, a
3880   20C6 E4            pop a
3881   20C7             ; END TERMS
3882   20C7 E7            pop d
3883   20C8 FD 43         mov [d], b
3884   20CA             ;; return v; 
3885   20CA FA FF FF      lea d, [bp + -1] ; $v
3886   20CD 2A            mov b, [d]
3887   20CE F9            leave
3888   20CF 09            ret
3889   20D0             
3890   20D0             input_int:
3891   20D0 F8 00 00      enter 0 ; (push bp; mov bp, sp)
3892   20D3             ; $x 
3893   20D3 52 08 00      sub sp, 8
3894   20D6             ;; input(x, 8); 
3895   20D6 26 08 00      mov b, $8
3896   20D9 DD            push bl
3897   20DA FA F9 FF      lea d, [bp + -7] ; $x
3898   20DD 2D            mov b, d
3899   20DE FD AB         swp b
3900   20E0 D8            push b
3901   20E1 07 85 1D      call input
3902   20E4 51 03 00      add sp, 3
3903   20E7             ;; if (!is_digit(*x)) 
3904   20E7             _if55_cond:
3905   20E7 FA F9 FF      lea d, [bp + -7] ; $x
3906   20EA 2D            mov b, d
3907   20EB 74            mov d, b
3908   20EC 32            mov bl, [d]
3909   20ED A7 00         mov bh, 0
3910   20EF DD            push bl
3911   20F0 07 E0 19      call is_digit
3912   20F3 51 01 00      add sp, 1
3913   20F6 C0 00 00      cmp b, 0
3914   20F9 FD 71         seq ; !
3915   20FB C0 00 00      cmp b, 0
3916   20FE C6 0C 21      je _if55_exit
3917   2101             _if55_true:
3918   2101             ;; return -1; 
3919   2101 26 FF FF      mov b, 65535
3920   2104 38 FF FF      mov c, 65535
3921   2107 F9            leave
3922   2108 09            ret
3923   2109 0A 0C 21      jmp _if55_exit
3924   210C             _if55_exit:
3925   210C             ;; return atoi(x); 
3926   210C FA F9 FF      lea d, [bp + -7] ; $x
3927   210F 2D            mov b, d
3928   2110 FD AB         swp b
3929   2112 D8            push b
3930   2113 07 8B 17      call atoi
3931   2116 51 02 00      add sp, 2
3932   2119 F9            leave
3933   211A 09            ret
3934   211B             
3935   211B             print100:
3936   211B F8 00 00      enter 0 ; (push bp; mov bp, sp)
3937   211E             ; $p 
3938   211E 52 02 00      sub sp, 2
3939   2121             ;; *p = buf; 
3940   2121 FA FF FF      lea d, [bp + -1] ; $p
3941   2124 2A            mov b, [d]
3942   2125 D8            push b
3943   2126 3B D9 64      mov d, st_print100_buf_dt ; static buf
3944   2129 2D            mov b, d
3945   212A E7            pop d
3946   212B FD 3E         mov [d], bl
3947   212D             ;; if (v < 0) { 
3948   212D             _if56_cond:
3949   212D FA 05 00      lea d, [bp + 5] ; $v
3950   2130 2A            mov b, [d]
3951   2131             ; START RELATIONAL
3952   2131 D7            push a
3953   2132 11            mov a, b
3954   2133 26 00 00      mov b, $0
3955   2136 B0            cmp a, b
3956   2137 FD 73         slt ; < (signed)
3957   2139 E4            pop a
3958   213A             ; END RELATIONAL
3959   213A C0 00 00      cmp b, 0
3960   213D C6 64 21      je _if56_exit
3961   2140             _if56_true:
3962   2140             ;; v = -v; 
3963   2140 FA 05 00      lea d, [bp + 5] ; $v
3964   2143 DA            push d
3965   2144 FA 05 00      lea d, [bp + 5] ; $v
3966   2147 2A            mov b, [d]
3967   2148 FD 97         neg b
3968   214A E7            pop d
3969   214B FD 43         mov [d], b
3970   214D             ;; *p++ = '-'; 
3971   214D FA FF FF      lea d, [bp + -1] ; $p
3972   2150 2A            mov b, [d]
3973   2151 D8            push b
3974   2152 FD 77         inc b
3975   2154 FA FF FF      lea d, [bp + -1] ; $p
3976   2157 FD 43         mov [d], b
3977   2159 E5            pop b
3978   215A D8            push b
3979   215B 26 2D 00      mov b, $2d
3980   215E E7            pop d
3981   215F FD 3E         mov [d], bl
3982   2161 0A 64 21      jmp _if56_exit
3983   2164             _if56_exit:
3984   2164             ;; return buf; 
3985   2164 3B D9 64      mov d, st_print100_buf_dt ; static buf
3986   2167 2D            mov b, d
3987   2168 F9            leave
3988   2169 09            ret
3989   216A             
3990   216A             inoperable:
3991   216A F8 00 00      enter 0 ; (push bp; mov bp, sp)
3992   216D             ;; if (damage[u] < 0) { 
3993   216D             _if57_cond:
3994   216D 3B F1 62      mov d, _damage_data ; $damage
3995   2170 D7            push a
3996   2171 DA            push d
3997   2172 FA 05 00      lea d, [bp + 5] ; $u
3998   2175 32            mov bl, [d]
3999   2176 A7 00         mov bh, 0
4000   2178 E7            pop d
4001   2179 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
4002   217D E4            pop a
4003   217E 2A            mov b, [d]
4004   217F             ; START RELATIONAL
4005   217F D7            push a
4006   2180 11            mov a, b
4007   2181 26 00 00      mov b, $0
4008   2184 B0            cmp a, b
4009   2185 FD 73         slt ; < (signed)
4010   2187 E4            pop a
4011   2188             ; END RELATIONAL
4012   2188 C0 00 00      cmp b, 0
4013   218B C6 D5 21      je _if57_exit
4014   218E             _if57_true:
4015   218E             ;; printf("%s %s inoperable.\n", 
4016   218E             _ternary59_cond:
4017   218E FA 05 00      lea d, [bp + 5] ; $u
4018   2191 32            mov bl, [d]
4019   2192 A7 00         mov bh, 0
4020   2194             ; START RELATIONAL
4021   2194 D7            push a
4022   2195 11            mov a, b
4023   2196 26 05 00      mov b, $5
4024   2199 B0            cmp a, b
4025   219A FD 71         seq ; ==
4026   219C E4            pop a
4027   219D             ; END RELATIONAL
4028   219D C0 00 00      cmp b, 0
4029   21A0 C6 A9 21      je _ternary59_false
4030   21A3             _ternary59_true:
4031   21A3 26 56 66      mov b, __s32 ; "are"
4032   21A6 0A AC 21      jmp _ternary59_exit
4033   21A9             _ternary59_false:
4034   21A9 26 5A 66      mov b, __s33 ; "is"
4035   21AC             _ternary59_exit:
4036   21AC FD AB         swp b
4037   21AE D8            push b
4038   21AF FA 05 00      lea d, [bp + 5] ; $u
4039   21B2 32            mov bl, [d]
4040   21B3 A7 00         mov bh, 0
4041   21B5 FD AB         swp b
4042   21B7 D8            push b
4043   21B8 07 B4 5E      call get_device_name
4044   21BB 51 02 00      add sp, 2
4045   21BE FD AB         swp b
4046   21C0 D8            push b
4047   21C1 26 5D 66      mov b, __s34 ; "%s %s inoperable.\n"
4048   21C4 FD AB         swp b
4049   21C6 D8            push b
4050   21C7 07 D1 05      call printf
4051   21CA 51 06 00      add sp, 6
4052   21CD             ;; return 1; 
4053   21CD 26 01 00      mov b, $1
4054   21D0 F9            leave
4055   21D1 09            ret
4056   21D2 0A D5 21      jmp _if57_exit
4057   21D5             _if57_exit:
4058   21D5             ;; return 0; 
4059   21D5 26 00 00      mov b, $0
4060   21D8 F9            leave
4061   21D9 09            ret
4062   21DA             
4063   21DA             intro:
4064   21DA F8 00 00      enter 0 ; (push bp; mov bp, sp)
4065   21DD             ;; showfile("startrek.intro"); 
4066   21DD 26 70 66      mov b, __s35 ; "startrek.intro"
4067   21E0 FD AB         swp b
4068   21E2 D8            push b
4069   21E3 07 06 62      call showfile
4070   21E6 51 02 00      add sp, 2
4071   21E9             ;; if (yesno()) 
4072   21E9             _if60_cond:
4073   21E9 07 10 1F      call yesno
4074   21EC C0 00 00      cmp b, 0
4075   21EF C6 01 22      je _if60_exit
4076   21F2             _if60_true:
4077   21F2             ;; showfile("startrek.doc"); 
4078   21F2 26 7F 66      mov b, __s36 ; "startrek.doc"
4079   21F5 FD AB         swp b
4080   21F7 D8            push b
4081   21F8 07 06 62      call showfile
4082   21FB 51 02 00      add sp, 2
4083   21FE 0A 01 22      jmp _if60_exit
4084   2201             _if60_exit:
4085   2201             ;; showfile("startrek.logo"); 
4086   2201 26 8C 66      mov b, __s37 ; "startrek.logo"
4087   2204 FD AB         swp b
4088   2206 D8            push b
4089   2207 07 06 62      call showfile
4090   220A 51 02 00      add sp, 2
4091   220D             ;; stardate = TO_FIXED((get_rand(20) + 20) * 100); 
4092   220D 3B 09 63      mov d, _stardate ; $stardate
4093   2210 DA            push d
4094   2211 26 14 00      mov b, $14
4095   2214 FD AB         swp b
4096   2216 D8            push b
4097   2217 07 25 1D      call get_rand
4098   221A 51 02 00      add sp, 2
4099   221D             ; START TERMS
4100   221D D7            push a
4101   221E 11            mov a, b
4102   221F 26 14 00      mov b, $14
4103   2222 56            add b, a
4104   2223 E4            pop a
4105   2224             ; END TERMS
4106   2224             ; START FACTORS
4107   2224 D7            push a
4108   2225 11            mov a, b
4109   2226 26 64 00      mov b, $64
4110   2229 AC            mul a, b ; *
4111   222A 11            mov a, b
4112   222B 27            mov b, a
4113   222C E4            pop a
4114   222D             ; END FACTORS
4115   222D FD AB         swp b
4116   222F D8            push b
4117   2230 07 DF 1C      call TO_FIXED
4118   2233 51 02 00      add sp, 2
4119   2236 E7            pop d
4120   2237 FD 43         mov [d], b
4121   2239 F9            leave
4122   223A 09            ret
4123   223B             
4124   223B             new_game:
4125   223B F8 00 00      enter 0 ; (push bp; mov bp, sp)
4126   223E             ; $cmd 
4127   223E 52 04 00      sub sp, 4
4128   2241             ;; initialize(); 
4129   2241 07 CD 24      call initialize
4130   2244             ;; new_quadrant(); 
4131   2244 07 08 29      call new_quadrant
4132   2247             ;; short_range_scan(); 
4133   2247 07 E2 35      call short_range_scan
4134   224A             ;; while (1) { 
4135   224A             _while61_cond:
4136   224A 26 01 00      mov b, $1
4137   224D C0 00 00      cmp b, 0
4138   2250 C6 CB 24      je _while61_exit
4139   2253             _while61_block:
4140   2253             ;; if (shield + energy <= 10 && (energy < 10 || damage[7] < 0)) { 
4141   2253             _if62_cond:
4142   2253 3B EA 62      mov d, _shield ; $shield
4143   2256 2A            mov b, [d]
4144   2257             ; START TERMS
4145   2257 D7            push a
4146   2258 11            mov a, b
4147   2259 3B 2F 62      mov d, _energy ; $energy
4148   225C 2A            mov b, [d]
4149   225D 56            add b, a
4150   225E E4            pop a
4151   225F             ; END TERMS
4152   225F             ; START RELATIONAL
4153   225F D7            push a
4154   2260 11            mov a, b
4155   2261 26 0A 00      mov b, $a
4156   2264 B0            cmp a, b
4157   2265 FD 73         slt ; <= (signed)
4158   2267 E4            pop a
4159   2268             ; END RELATIONAL
4160   2268 D7            push a
4161   2269 11            mov a, b
4162   226A 3B 2F 62      mov d, _energy ; $energy
4163   226D 2A            mov b, [d]
4164   226E             ; START RELATIONAL
4165   226E D7            push a
4166   226F 11            mov a, b
4167   2270 26 0A 00      mov b, $a
4168   2273 B0            cmp a, b
4169   2274 FD 73         slt ; < (signed)
4170   2276 E4            pop a
4171   2277             ; END RELATIONAL
4172   2277 D7            push a
4173   2278 11            mov a, b
4174   2279 3B F1 62      mov d, _damage_data ; $damage
4175   227C D7            push a
4176   227D DA            push d
4177   227E 26 07 00      mov b, $7
4178   2281 E7            pop d
4179   2282 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
4180   2286 E4            pop a
4181   2287 2A            mov b, [d]
4182   2288             ; START RELATIONAL
4183   2288 D7            push a
4184   2289 11            mov a, b
4185   228A 26 00 00      mov b, $0
4186   228D B0            cmp a, b
4187   228E FD 73         slt ; < (signed)
4188   2290 E4            pop a
4189   2291             ; END RELATIONAL
4190   2291 FD A8         sor a, b ; ||
4191   2293 E4            pop a
4192   2294 FD A7         sand a, b
4193   2296 E4            pop a
4194   2297 C0 00 00      cmp b, 0
4195   229A C6 AF 22      je _if62_exit
4196   229D             _if62_true:
4197   229D             ;; showfile("startrek.fatal"); 
4198   229D 26 9A 66      mov b, __s38 ; "startrek.fatal"
4199   22A0 FD AB         swp b
4200   22A2 D8            push b
4201   22A3 07 06 62      call showfile
4202   22A6 51 02 00      add sp, 2
4203   22A9             ;; end_of_time(); 
4204   22A9 07 37 56      call end_of_time
4205   22AC 0A AF 22      jmp _if62_exit
4206   22AF             _if62_exit:
4207   22AF             ;; puts("Command? "); 
4208   22AF 26 A9 66      mov b, __s39 ; "Command? "
4209   22B2 FD AB         swp b
4210   22B4 D8            push b
4211   22B5 07 37 13      call puts
4212   22B8 51 02 00      add sp, 2
4213   22BB             ;; input(cmd, 4); 
4214   22BB 26 04 00      mov b, $4
4215   22BE DD            push bl
4216   22BF FA FD FF      lea d, [bp + -3] ; $cmd
4217   22C2 2D            mov b, d
4218   22C3 FD AB         swp b
4219   22C5 D8            push b
4220   22C6 07 85 1D      call input
4221   22C9 51 03 00      add sp, 3
4222   22CC             ;; putchar('\n'); 
4223   22CC 26 0A 00      mov b, $a
4224   22CF DD            push bl
4225   22D0 07 01 13      call putchar
4226   22D3 51 01 00      add sp, 1
4227   22D6             ;; if (!strncmp(cmd, "nav", 3)) 
4228   22D6             _if63_cond:
4229   22D6 26 03 00      mov b, $3
4230   22D9 FD AB         swp b
4231   22DB D8            push b
4232   22DC 26 B3 66      mov b, __s40 ; "nav"
4233   22DF FD AB         swp b
4234   22E1 D8            push b
4235   22E2 FA FD FF      lea d, [bp + -3] ; $cmd
4236   22E5 2D            mov b, d
4237   22E6 FD AB         swp b
4238   22E8 D8            push b
4239   22E9 07 D0 04      call strncmp
4240   22EC 51 06 00      add sp, 6
4241   22EF C0 00 00      cmp b, 0
4242   22F2 FD 71         seq ; !
4243   22F4 C0 00 00      cmp b, 0
4244   22F7 C6 00 23      je _if63_else
4245   22FA             _if63_true:
4246   22FA             ;; course_control(); 
4247   22FA 07 91 2C      call course_control
4248   22FD 0A C8 24      jmp _if63_exit
4249   2300             _if63_else:
4250   2300             ;; if (!strncmp(cmd, "srs", 3)) 
4251   2300             _if64_cond:
4252   2300 26 03 00      mov b, $3
4253   2303 FD AB         swp b
4254   2305 D8            push b
4255   2306 26 B7 66      mov b, __s41 ; "srs"
4256   2309 FD AB         swp b
4257   230B D8            push b
4258   230C FA FD FF      lea d, [bp + -3] ; $cmd
4259   230F 2D            mov b, d
4260   2310 FD AB         swp b
4261   2312 D8            push b
4262   2313 07 D0 04      call strncmp
4263   2316 51 06 00      add sp, 6
4264   2319 C0 00 00      cmp b, 0
4265   231C FD 71         seq ; !
4266   231E C0 00 00      cmp b, 0
4267   2321 C6 2A 23      je _if64_else
4268   2324             _if64_true:
4269   2324             ;; short_range_scan(); 
4270   2324 07 E2 35      call short_range_scan
4271   2327 0A C8 24      jmp _if64_exit
4272   232A             _if64_else:
4273   232A             ;; if (!strncmp(cmd, "lrs", 3)) 
4274   232A             _if65_cond:
4275   232A 26 03 00      mov b, $3
4276   232D FD AB         swp b
4277   232F D8            push b
4278   2330 26 BB 66      mov b, __s42 ; "lrs"
4279   2333 FD AB         swp b
4280   2335 D8            push b
4281   2336 FA FD FF      lea d, [bp + -3] ; $cmd
4282   2339 2D            mov b, d
4283   233A FD AB         swp b
4284   233C D8            push b
4285   233D 07 D0 04      call strncmp
4286   2340 51 06 00      add sp, 6
4287   2343 C0 00 00      cmp b, 0
4288   2346 FD 71         seq ; !
4289   2348 C0 00 00      cmp b, 0
4290   234B C6 54 23      je _if65_else
4291   234E             _if65_true:
4292   234E             ;; long_range_scan(); 
4293   234E 07 78 3A      call long_range_scan
4294   2351 0A C8 24      jmp _if65_exit
4295   2354             _if65_else:
4296   2354             ;; if (!strncmp(cmd, "pha", 3)) 
4297   2354             _if66_cond:
4298   2354 26 03 00      mov b, $3
4299   2357 FD AB         swp b
4300   2359 D8            push b
4301   235A 26 BF 66      mov b, __s43 ; "pha"
4302   235D FD AB         swp b
4303   235F D8            push b
4304   2360 FA FD FF      lea d, [bp + -3] ; $cmd
4305   2363 2D            mov b, d
4306   2364 FD AB         swp b
4307   2366 D8            push b
4308   2367 07 D0 04      call strncmp
4309   236A 51 06 00      add sp, 6
4310   236D C0 00 00      cmp b, 0
4311   2370 FD 71         seq ; !
4312   2372 C0 00 00      cmp b, 0
4313   2375 C6 7E 23      je _if66_else
4314   2378             _if66_true:
4315   2378             ;; phaser_control(); 
4316   2378 07 AA 3C      call phaser_control
4317   237B 0A C8 24      jmp _if66_exit
4318   237E             _if66_else:
4319   237E             ;; if (!strncmp(cmd, "tor", 3)) 
4320   237E             _if67_cond:
4321   237E 26 03 00      mov b, $3
4322   2381 FD AB         swp b
4323   2383 D8            push b
4324   2384 26 C3 66      mov b, __s44 ; "tor"
4325   2387 FD AB         swp b
4326   2389 D8            push b
4327   238A FA FD FF      lea d, [bp + -3] ; $cmd
4328   238D 2D            mov b, d
4329   238E FD AB         swp b
4330   2390 D8            push b
4331   2391 07 D0 04      call strncmp
4332   2394 51 06 00      add sp, 6
4333   2397 C0 00 00      cmp b, 0
4334   239A FD 71         seq ; !
4335   239C C0 00 00      cmp b, 0
4336   239F C6 A8 23      je _if67_else
4337   23A2             _if67_true:
4338   23A2             ;; photon_torpedoes(); 
4339   23A2 07 6C 41      call photon_torpedoes
4340   23A5 0A C8 24      jmp _if67_exit
4341   23A8             _if67_else:
4342   23A8             ;; if (!strncmp(cmd, "shi", 3)) 
4343   23A8             _if68_cond:
4344   23A8 26 03 00      mov b, $3
4345   23AB FD AB         swp b
4346   23AD D8            push b
4347   23AE 26 C7 66      mov b, __s45 ; "shi"
4348   23B1 FD AB         swp b
4349   23B3 D8            push b
4350   23B4 FA FD FF      lea d, [bp + -3] ; $cmd
4351   23B7 2D            mov b, d
4352   23B8 FD AB         swp b
4353   23BA D8            push b
4354   23BB 07 D0 04      call strncmp
4355   23BE 51 06 00      add sp, 6
4356   23C1 C0 00 00      cmp b, 0
4357   23C4 FD 71         seq ; !
4358   23C6 C0 00 00      cmp b, 0
4359   23C9 C6 D2 23      je _if68_else
4360   23CC             _if68_true:
4361   23CC             ;; shield_control(); 
4362   23CC 07 11 4A      call shield_control
4363   23CF 0A C8 24      jmp _if68_exit
4364   23D2             _if68_else:
4365   23D2             ;; if (!strncmp(cmd, "dam", 3)) 
4366   23D2             _if69_cond:
4367   23D2 26 03 00      mov b, $3
4368   23D5 FD AB         swp b
4369   23D7 D8            push b
4370   23D8 26 CB 66      mov b, __s46 ; "dam"
4371   23DB FD AB         swp b
4372   23DD D8            push b
4373   23DE FA FD FF      lea d, [bp + -3] ; $cmd
4374   23E1 2D            mov b, d
4375   23E2 FD AB         swp b
4376   23E4 D8            push b
4377   23E5 07 D0 04      call strncmp
4378   23E8 51 06 00      add sp, 6
4379   23EB C0 00 00      cmp b, 0
4380   23EE FD 71         seq ; !
4381   23F0 C0 00 00      cmp b, 0
4382   23F3 C6 FC 23      je _if69_else
4383   23F6             _if69_true:
4384   23F6             ;; damage_control(); 
4385   23F6 07 C6 47      call damage_control
4386   23F9 0A C8 24      jmp _if69_exit
4387   23FC             _if69_else:
4388   23FC             ;; if (!strncmp(cmd, "com", 3)) 
4389   23FC             _if70_cond:
4390   23FC 26 03 00      mov b, $3
4391   23FF FD AB         swp b
4392   2401 D8            push b
4393   2402 26 CF 66      mov b, __s47 ; "com"
4394   2405 FD AB         swp b
4395   2407 D8            push b
4396   2408 FA FD FF      lea d, [bp + -3] ; $cmd
4397   240B 2D            mov b, d
4398   240C FD AB         swp b
4399   240E D8            push b
4400   240F 07 D0 04      call strncmp
4401   2412 51 06 00      add sp, 6
4402   2415 C0 00 00      cmp b, 0
4403   2418 FD 71         seq ; !
4404   241A C0 00 00      cmp b, 0
4405   241D C6 26 24      je _if70_else
4406   2420             _if70_true:
4407   2420             ;; library_computer(); 
4408   2420 07 F0 4A      call library_computer
4409   2423 0A C8 24      jmp _if70_exit
4410   2426             _if70_else:
4411   2426             ;; if (!strncmp(cmd, "xxx", 3)) 
4412   2426             _if71_cond:
4413   2426 26 03 00      mov b, $3
4414   2429 FD AB         swp b
4415   242B D8            push b
4416   242C 26 D3 66      mov b, __s48 ; "xxx"
4417   242F FD AB         swp b
4418   2431 D8            push b
4419   2432 FA FD FF      lea d, [bp + -3] ; $cmd
4420   2435 2D            mov b, d
4421   2436 FD AB         swp b
4422   2438 D8            push b
4423   2439 07 D0 04      call strncmp
4424   243C 51 06 00      add sp, 6
4425   243F C0 00 00      cmp b, 0
4426   2442 FD 71         seq ; !
4427   2444 C0 00 00      cmp b, 0
4428   2447 C6 50 24      je _if71_else
4429   244A             _if71_true:
4430   244A             ;; resign_commision(); 
4431   244A 07 5B 56      call resign_commision
4432   244D 0A C8 24      jmp _if71_exit
4433   2450             _if71_else:
4434   2450             ;; puts("Enter one of the following:\n"); 
4435   2450 26 D7 66      mov b, __s49 ; "Enter one of the following:\n"
4436   2453 FD AB         swp b
4437   2455 D8            push b
4438   2456 07 37 13      call puts
4439   2459 51 02 00      add sp, 2
4440   245C             ;; puts("  nav - To Set Course"); 
4441   245C 26 F4 66      mov b, __s50 ; "  nav - To Set Course"
4442   245F FD AB         swp b
4443   2461 D8            push b
4444   2462 07 37 13      call puts
4445   2465 51 02 00      add sp, 2
4446   2468             ;; puts("  srs - Short Range Sensors"); 
4447   2468 26 0A 67      mov b, __s51 ; "  srs - Short Range Sensors"
4448   246B FD AB         swp b
4449   246D D8            push b
4450   246E 07 37 13      call puts
4451   2471 51 02 00      add sp, 2
4452   2474             ;; puts("  lrs - Long Range Sensors"); 
4453   2474 26 26 67      mov b, __s52 ; "  lrs - Long Range Sensors"
4454   2477 FD AB         swp b
4455   2479 D8            push b
4456   247A 07 37 13      call puts
4457   247D 51 02 00      add sp, 2
4458   2480             ;; puts("  pha - Phasers"); 
4459   2480 26 41 67      mov b, __s53 ; "  pha - Phasers"
4460   2483 FD AB         swp b
4461   2485 D8            push b
4462   2486 07 37 13      call puts
4463   2489 51 02 00      add sp, 2
4464   248C             ;; puts("  tor - Photon Torpedoes"); 
4465   248C 26 51 67      mov b, __s54 ; "  tor - Photon Torpedoes"
4466   248F FD AB         swp b
4467   2491 D8            push b
4468   2492 07 37 13      call puts
4469   2495 51 02 00      add sp, 2
4470   2498             ;; puts("  shi - Shield Control"); 
4471   2498 26 6A 67      mov b, __s55 ; "  shi - Shield Control"
4472   249B FD AB         swp b
4473   249D D8            push b
4474   249E 07 37 13      call puts
4475   24A1 51 02 00      add sp, 2
4476   24A4             ;; puts("  dam - Damage Control"); 
4477   24A4 26 81 67      mov b, __s56 ; "  dam - Damage Control"
4478   24A7 FD AB         swp b
4479   24A9 D8            push b
4480   24AA 07 37 13      call puts
4481   24AD 51 02 00      add sp, 2
4482   24B0             ;; puts("  com - Library Computer"); 
4483   24B0 26 98 67      mov b, __s57 ; "  com - Library Computer"
4484   24B3 FD AB         swp b
4485   24B5 D8            push b
4486   24B6 07 37 13      call puts
4487   24B9 51 02 00      add sp, 2
4488   24BC             ;; puts("  xxx - Resign Command\n"); 
4489   24BC 26 B1 67      mov b, __s58 ; "  xxx - Resign Command\n"
4490   24BF FD AB         swp b
4491   24C1 D8            push b
4492   24C2 07 37 13      call puts
4493   24C5 51 02 00      add sp, 2
4494   24C8             _if71_exit:
4495   24C8             _if70_exit:
4496   24C8             _if69_exit:
4497   24C8             _if68_exit:
4498   24C8             _if67_exit:
4499   24C8             _if66_exit:
4500   24C8             _if65_exit:
4501   24C8             _if64_exit:
4502   24C8             _if63_exit:
4503   24C8 0A 4A 22      jmp _while61_cond
4504   24CB             _while61_exit:
4505   24CB F9            leave
4506   24CC 09            ret
4507   24CD             
4508   24CD             initialize:
4509   24CD F8 00 00      enter 0 ; (push bp; mov bp, sp)
4510   24D0             ; $i 
4511   24D0             ; $j 
4512   24D0             ; $yp 
4513   24D0             ; $xp 
4514   24D0             ; $r 
4515   24D0 52 07 00      sub sp, 7
4516   24D3             ;; time_start = FROM_FIXED(stardate); 
4517   24D3 3B ED 62      mov d, _time_start ; $time_start
4518   24D6 DA            push d
4519   24D7 3B 09 63      mov d, _stardate ; $stardate
4520   24DA 2A            mov b, [d]
4521   24DB FD AB         swp b
4522   24DD D8            push b
4523   24DE 07 F1 1C      call FROM_FIXED
4524   24E1 51 02 00      add sp, 2
4525   24E4 E7            pop d
4526   24E5 FD 43         mov [d], b
4527   24E7             ;; time_up = 25 + get_rand(10); 
4528   24E7 3B EF 62      mov d, _time_up ; $time_up
4529   24EA DA            push d
4530   24EB 26 19 00      mov b, $19
4531   24EE             ; START TERMS
4532   24EE D7            push a
4533   24EF 11            mov a, b
4534   24F0 26 0A 00      mov b, $a
4535   24F3 FD AB         swp b
4536   24F5 D8            push b
4537   24F6 07 25 1D      call get_rand
4538   24F9 51 02 00      add sp, 2
4539   24FC 56            add b, a
4540   24FD E4            pop a
4541   24FE             ; END TERMS
4542   24FE E7            pop d
4543   24FF FD 43         mov [d], b
4544   2501             ;; docked = 0; 
4545   2501 3B 2E 62      mov d, _docked ; $docked
4546   2504 DA            push d
4547   2505 26 00 00      mov b, $0
4548   2508 E7            pop d
4549   2509 FD 3E         mov [d], bl
4550   250B             ;; energy = energy0; 
4551   250B 3B 2F 62      mov d, _energy ; $energy
4552   250E DA            push d
4553   250F 3B 31 62      mov d, _energy0 ; $energy0
4554   2512 2A            mov b, [d]
4555   2513 E7            pop d
4556   2514 FD 43         mov [d], b
4557   2516             ;; torps = torps0; 
4558   2516 3B E4 62      mov d, _torps ; $torps
4559   2519 DA            push d
4560   251A 3B E5 62      mov d, _torps0 ; $torps0
4561   251D 32            mov bl, [d]
4562   251E A7 00         mov bh, 0
4563   2520 E7            pop d
4564   2521 FD 3E         mov [d], bl
4565   2523             ;; shield = 0; 
4566   2523 3B EA 62      mov d, _shield ; $shield
4567   2526 DA            push d
4568   2527 26 00 00      mov b, $0
4569   252A E7            pop d
4570   252B FD 43         mov [d], b
4571   252D             ;; quad_y = rand8(); 
4572   252D 3B E6 62      mov d, _quad_y ; $quad_y
4573   2530 DA            push d
4574   2531 07 74 1D      call rand8
4575   2534 E7            pop d
4576   2535 FD 43         mov [d], b
4577   2537             ;; quad_x = rand8(); 
4578   2537 3B E8 62      mov d, _quad_x ; $quad_x
4579   253A DA            push d
4580   253B 07 74 1D      call rand8
4581   253E E7            pop d
4582   253F FD 43         mov [d], b
4583   2541             ;; ship_y = TO_FIXED00(rand8()); 
4584   2541 3B 05 63      mov d, _ship_y ; $ship_y
4585   2544 DA            push d
4586   2545 07 74 1D      call rand8
4587   2548 FD AB         swp b
4588   254A D8            push b
4589   254B 07 02 1D      call TO_FIXED00
4590   254E 51 02 00      add sp, 2
4591   2551 E7            pop d
4592   2552 FD 43         mov [d], b
4593   2554             ;; ship_x = TO_FIXED00(rand8()); 
4594   2554 3B 07 63      mov d, _ship_x ; $ship_x
4595   2557 DA            push d
4596   2558 07 74 1D      call rand8
4597   255B FD AB         swp b
4598   255D D8            push b
4599   255E 07 02 1D      call TO_FIXED00
4600   2561 51 02 00      add sp, 2
4601   2564 E7            pop d
4602   2565 FD 43         mov [d], b
4603   2567             ;; for (i = 1; i <= 8; i++) 
4604   2567             _for72_init:
4605   2567 FA FF FF      lea d, [bp + -1] ; $i
4606   256A DA            push d
4607   256B 26 01 00      mov b, $1
4608   256E E7            pop d
4609   256F FD 43         mov [d], b
4610   2571             _for72_cond:
4611   2571 FA FF FF      lea d, [bp + -1] ; $i
4612   2574 2A            mov b, [d]
4613   2575             ; START RELATIONAL
4614   2575 D7            push a
4615   2576 11            mov a, b
4616   2577 26 08 00      mov b, $8
4617   257A B0            cmp a, b
4618   257B FD 73         slt ; <= (signed)
4619   257D E4            pop a
4620   257E             ; END RELATIONAL
4621   257E C0 00 00      cmp b, 0
4622   2581 C6 AA 25      je _for72_exit
4623   2584             _for72_block:
4624   2584             ;; damage[i] = 0; 
4625   2584 3B F1 62      mov d, _damage_data ; $damage
4626   2587 D7            push a
4627   2588 DA            push d
4628   2589 FA FF FF      lea d, [bp + -1] ; $i
4629   258C 2A            mov b, [d]
4630   258D E7            pop d
4631   258E FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
4632   2592 E4            pop a
4633   2593 DA            push d
4634   2594 26 00 00      mov b, $0
4635   2597 E7            pop d
4636   2598 FD 43         mov [d], b
4637   259A             _for72_update:
4638   259A FA FF FF      lea d, [bp + -1] ; $i
4639   259D 2A            mov b, [d]
4640   259E D8            push b
4641   259F FD 77         inc b
4642   25A1 FA FF FF      lea d, [bp + -1] ; $i
4643   25A4 FD 43         mov [d], b
4644   25A6 E5            pop b
4645   25A7 0A 71 25      jmp _for72_cond
4646   25AA             _for72_exit:
4647   25AA             ;; for (i = 1; i <= 8; i++) { 
4648   25AA             _for73_init:
4649   25AA FA FF FF      lea d, [bp + -1] ; $i
4650   25AD DA            push d
4651   25AE 26 01 00      mov b, $1
4652   25B1 E7            pop d
4653   25B2 FD 43         mov [d], b
4654   25B4             _for73_cond:
4655   25B4 FA FF FF      lea d, [bp + -1] ; $i
4656   25B7 2A            mov b, [d]
4657   25B8             ; START RELATIONAL
4658   25B8 D7            push a
4659   25B9 11            mov a, b
4660   25BA 26 08 00      mov b, $8
4661   25BD B0            cmp a, b
4662   25BE FD 73         slt ; <= (signed)
4663   25C0 E4            pop a
4664   25C1             ; END RELATIONAL
4665   25C1 C0 00 00      cmp b, 0
4666   25C4 C6 2D 27      je _for73_exit
4667   25C7             _for73_block:
4668   25C7             ;; for (j = 1; j <= 8; j++) { 
4669   25C7             _for74_init:
4670   25C7 FA FD FF      lea d, [bp + -3] ; $j
4671   25CA DA            push d
4672   25CB 26 01 00      mov b, $1
4673   25CE E7            pop d
4674   25CF FD 43         mov [d], b
4675   25D1             _for74_cond:
4676   25D1 FA FD FF      lea d, [bp + -3] ; $j
4677   25D4 2A            mov b, [d]
4678   25D5             ; START RELATIONAL
4679   25D5 D7            push a
4680   25D6 11            mov a, b
4681   25D7 26 08 00      mov b, $8
4682   25DA B0            cmp a, b
4683   25DB FD 73         slt ; <= (signed)
4684   25DD E4            pop a
4685   25DE             ; END RELATIONAL
4686   25DE C0 00 00      cmp b, 0
4687   25E1 C6 1D 27      je _for74_exit
4688   25E4             _for74_block:
4689   25E4             ;; r = get_rand(100); 
4690   25E4 FA FA FF      lea d, [bp + -6] ; $r
4691   25E7 DA            push d
4692   25E8 26 64 00      mov b, $64
4693   25EB FD AB         swp b
4694   25ED D8            push b
4695   25EE 07 25 1D      call get_rand
4696   25F1 51 02 00      add sp, 2
4697   25F4 E7            pop d
4698   25F5 FD 3E         mov [d], bl
4699   25F7             ;; klingons = 0; 
4700   25F7 3B E1 62      mov d, _klingons ; $klingons
4701   25FA DA            push d
4702   25FB 26 00 00      mov b, $0
4703   25FE E7            pop d
4704   25FF FD 3E         mov [d], bl
4705   2601             ;; if (r > 98) 
4706   2601             _if75_cond:
4707   2601 FA FA FF      lea d, [bp + -6] ; $r
4708   2604 32            mov bl, [d]
4709   2605 A7 00         mov bh, 0
4710   2607             ; START RELATIONAL
4711   2607 D7            push a
4712   2608 11            mov a, b
4713   2609 26 62 00      mov b, $62
4714   260C B0            cmp a, b
4715   260D FD 81         sgu ; > (unsigned)
4716   260F E4            pop a
4717   2610             ; END RELATIONAL
4718   2610 C0 00 00      cmp b, 0
4719   2613 C6 23 26      je _if75_else
4720   2616             _if75_true:
4721   2616             ;; klingons = 3; 
4722   2616 3B E1 62      mov d, _klingons ; $klingons
4723   2619 DA            push d
4724   261A 26 03 00      mov b, $3
4725   261D E7            pop d
4726   261E FD 3E         mov [d], bl
4727   2620 0A 67 26      jmp _if75_exit
4728   2623             _if75_else:
4729   2623             ;; if (r > 95) 
4730   2623             _if76_cond:
4731   2623 FA FA FF      lea d, [bp + -6] ; $r
4732   2626 32            mov bl, [d]
4733   2627 A7 00         mov bh, 0
4734   2629             ; START RELATIONAL
4735   2629 D7            push a
4736   262A 11            mov a, b
4737   262B 26 5F 00      mov b, $5f
4738   262E B0            cmp a, b
4739   262F FD 81         sgu ; > (unsigned)
4740   2631 E4            pop a
4741   2632             ; END RELATIONAL
4742   2632 C0 00 00      cmp b, 0
4743   2635 C6 45 26      je _if76_else
4744   2638             _if76_true:
4745   2638             ;; klingons = 2; 
4746   2638 3B E1 62      mov d, _klingons ; $klingons
4747   263B DA            push d
4748   263C 26 02 00      mov b, $2
4749   263F E7            pop d
4750   2640 FD 3E         mov [d], bl
4751   2642 0A 67 26      jmp _if76_exit
4752   2645             _if76_else:
4753   2645             ;; if (r > 80) 
4754   2645             _if77_cond:
4755   2645 FA FA FF      lea d, [bp + -6] ; $r
4756   2648 32            mov bl, [d]
4757   2649 A7 00         mov bh, 0
4758   264B             ; START RELATIONAL
4759   264B D7            push a
4760   264C 11            mov a, b
4761   264D 26 50 00      mov b, $50
4762   2650 B0            cmp a, b
4763   2651 FD 81         sgu ; > (unsigned)
4764   2653 E4            pop a
4765   2654             ; END RELATIONAL
4766   2654 C0 00 00      cmp b, 0
4767   2657 C6 67 26      je _if77_exit
4768   265A             _if77_true:
4769   265A             ;; klingons = 1; 
4770   265A 3B E1 62      mov d, _klingons ; $klingons
4771   265D DA            push d
4772   265E 26 01 00      mov b, $1
4773   2661 E7            pop d
4774   2662 FD 3E         mov [d], bl
4775   2664 0A 67 26      jmp _if77_exit
4776   2667             _if77_exit:
4777   2667             _if76_exit:
4778   2667             _if75_exit:
4779   2667             ;; klingons_left = klingons_left + klingons; 
4780   2667 3B E3 62      mov d, _klingons_left ; $klingons_left
4781   266A DA            push d
4782   266B 3B E3 62      mov d, _klingons_left ; $klingons_left
4783   266E 32            mov bl, [d]
4784   266F A7 00         mov bh, 0
4785   2671             ; START TERMS
4786   2671 D7            push a
4787   2672 11            mov a, b
4788   2673 3B E1 62      mov d, _klingons ; $klingons
4789   2676 32            mov bl, [d]
4790   2677 A7 00         mov bh, 0
4791   2679 56            add b, a
4792   267A E4            pop a
4793   267B             ; END TERMS
4794   267B E7            pop d
4795   267C FD 3E         mov [d], bl
4796   267E             ;; starbases = 0; 
4797   267E 3B 0B 62      mov d, _starbases ; $starbases
4798   2681 DA            push d
4799   2682 26 00 00      mov b, $0
4800   2685 E7            pop d
4801   2686 FD 3E         mov [d], bl
4802   2688             ;; if (get_rand(100) > 96) 
4803   2688             _if78_cond:
4804   2688 26 64 00      mov b, $64
4805   268B FD AB         swp b
4806   268D D8            push b
4807   268E 07 25 1D      call get_rand
4808   2691 51 02 00      add sp, 2
4809   2694             ; START RELATIONAL
4810   2694 D7            push a
4811   2695 11            mov a, b
4812   2696 26 60 00      mov b, $60
4813   2699 B0            cmp a, b
4814   269A FD 7F         sgt ; >
4815   269C E4            pop a
4816   269D             ; END RELATIONAL
4817   269D C0 00 00      cmp b, 0
4818   26A0 C6 B0 26      je _if78_exit
4819   26A3             _if78_true:
4820   26A3             ;; starbases = 1; 
4821   26A3 3B 0B 62      mov d, _starbases ; $starbases
4822   26A6 DA            push d
4823   26A7 26 01 00      mov b, $1
4824   26AA E7            pop d
4825   26AB FD 3E         mov [d], bl
4826   26AD 0A B0 26      jmp _if78_exit
4827   26B0             _if78_exit:
4828   26B0             ;; starbases_left = starbases_left + starbases; 
4829   26B0 3B 0E 62      mov d, _starbases_left ; $starbases_left
4830   26B3 DA            push d
4831   26B4 3B 0E 62      mov d, _starbases_left ; $starbases_left
4832   26B7 32            mov bl, [d]
4833   26B8 A7 00         mov bh, 0
4834   26BA             ; START TERMS
4835   26BA D7            push a
4836   26BB 11            mov a, b
4837   26BC 3B 0B 62      mov d, _starbases ; $starbases
4838   26BF 32            mov bl, [d]
4839   26C0 A7 00         mov bh, 0
4840   26C2 56            add b, a
4841   26C3 E4            pop a
4842   26C4             ; END TERMS
4843   26C4 E7            pop d
4844   26C5 FD 3E         mov [d], bl
4845   26C7             ;; map[i][j] = (klingons << 8) + (starbases << 4) + rand8(); 
4846   26C7 3B 33 62      mov d, _map_data ; $map
4847   26CA D7            push a
4848   26CB DA            push d
4849   26CC FA FF FF      lea d, [bp + -1] ; $i
4850   26CF 2A            mov b, [d]
4851   26D0 E7            pop d
4852   26D1 FD 13 12 00   mma 18 ; mov a, 18; mul a, b; add d, b
4853   26D5 DA            push d
4854   26D6 FA FD FF      lea d, [bp + -3] ; $j
4855   26D9 2A            mov b, [d]
4856   26DA E7            pop d
4857   26DB FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
4858   26DF E4            pop a
4859   26E0 DA            push d
4860   26E1 3B E1 62      mov d, _klingons ; $klingons
4861   26E4 32            mov bl, [d]
4862   26E5 A7 00         mov bh, 0
4863   26E7             ; START SHIFT
4864   26E7 D7            push a
4865   26E8 11            mov a, b
4866   26E9 26 08 00      mov b, $8
4867   26EC FD 39         mov c, b
4868   26EE 9D            shl a, cl
4869   26EF 27            mov b, a
4870   26F0 E4            pop a
4871   26F1             ; END SHIFT
4872   26F1             ; START TERMS
4873   26F1 D7            push a
4874   26F2 11            mov a, b
4875   26F3 3B 0B 62      mov d, _starbases ; $starbases
4876   26F6 32            mov bl, [d]
4877   26F7 A7 00         mov bh, 0
4878   26F9             ; START SHIFT
4879   26F9 D7            push a
4880   26FA 11            mov a, b
4881   26FB 26 04 00      mov b, $4
4882   26FE FD 39         mov c, b
4883   2700 9D            shl a, cl
4884   2701 27            mov b, a
4885   2702 E4            pop a
4886   2703             ; END SHIFT
4887   2703 56            add b, a
4888   2704 11            mov a, b
4889   2705 07 74 1D      call rand8
4890   2708 56            add b, a
4891   2709 E4            pop a
4892   270A             ; END TERMS
4893   270A E7            pop d
4894   270B FD 43         mov [d], b
4895   270D             _for74_update:
4896   270D FA FD FF      lea d, [bp + -3] ; $j
4897   2710 2A            mov b, [d]
4898   2711 D8            push b
4899   2712 FD 77         inc b
4900   2714 FA FD FF      lea d, [bp + -3] ; $j
4901   2717 FD 43         mov [d], b
4902   2719 E5            pop b
4903   271A 0A D1 25      jmp _for74_cond
4904   271D             _for74_exit:
4905   271D             _for73_update:
4906   271D FA FF FF      lea d, [bp + -1] ; $i
4907   2720 2A            mov b, [d]
4908   2721 D8            push b
4909   2722 FD 77         inc b
4910   2724 FA FF FF      lea d, [bp + -1] ; $i
4911   2727 FD 43         mov [d], b
4912   2729 E5            pop b
4913   272A 0A B4 25      jmp _for73_cond
4914   272D             _for73_exit:
4915   272D             ;; if (klingons_left > time_up) 
4916   272D             _if79_cond:
4917   272D 3B E3 62      mov d, _klingons_left ; $klingons_left
4918   2730 32            mov bl, [d]
4919   2731 A7 00         mov bh, 0
4920   2733             ; START RELATIONAL
4921   2733 D7            push a
4922   2734 11            mov a, b
4923   2735 3B EF 62      mov d, _time_up ; $time_up
4924   2738 2A            mov b, [d]
4925   2739 B0            cmp a, b
4926   273A FD 81         sgu ; > (unsigned)
4927   273C E4            pop a
4928   273D             ; END RELATIONAL
4929   273D C0 00 00      cmp b, 0
4930   2740 C6 5A 27      je _if79_exit
4931   2743             _if79_true:
4932   2743             ;; time_up = klingons_left + 1; 
4933   2743 3B EF 62      mov d, _time_up ; $time_up
4934   2746 DA            push d
4935   2747 3B E3 62      mov d, _klingons_left ; $klingons_left
4936   274A 32            mov bl, [d]
4937   274B A7 00         mov bh, 0
4938   274D             ; START TERMS
4939   274D D7            push a
4940   274E 11            mov a, b
4941   274F 26 01 00      mov b, $1
4942   2752 56            add b, a
4943   2753 E4            pop a
4944   2754             ; END TERMS
4945   2754 E7            pop d
4946   2755 FD 43         mov [d], b
4947   2757 0A 5A 27      jmp _if79_exit
4948   275A             _if79_exit:
4949   275A             ;; if (starbases_left == 0) { 
4950   275A             _if80_cond:
4951   275A 3B 0E 62      mov d, _starbases_left ; $starbases_left
4952   275D 32            mov bl, [d]
4953   275E A7 00         mov bh, 0
4954   2760             ; START RELATIONAL
4955   2760 D7            push a
4956   2761 11            mov a, b
4957   2762 26 00 00      mov b, $0
4958   2765 B0            cmp a, b
4959   2766 FD 71         seq ; ==
4960   2768 E4            pop a
4961   2769             ; END RELATIONAL
4962   2769 C0 00 00      cmp b, 0
4963   276C C6 74 28      je _if80_exit
4964   276F             _if80_true:
4965   276F             ;; yp = rand8(); 
4966   276F FA FC FF      lea d, [bp + -4] ; $yp
4967   2772 DA            push d
4968   2773 07 74 1D      call rand8
4969   2776 E7            pop d
4970   2777 FD 3E         mov [d], bl
4971   2779             ;; xp = rand8(); 
4972   2779 FA FB FF      lea d, [bp + -5] ; $xp
4973   277C DA            push d
4974   277D 07 74 1D      call rand8
4975   2780 E7            pop d
4976   2781 FD 3E         mov [d], bl
4977   2783             ;; if (map[yp][xp] < 0x200) { 
4978   2783             _if81_cond:
4979   2783 3B 33 62      mov d, _map_data ; $map
4980   2786 D7            push a
4981   2787 DA            push d
4982   2788 FA FC FF      lea d, [bp + -4] ; $yp
4983   278B 32            mov bl, [d]
4984   278C A7 00         mov bh, 0
4985   278E E7            pop d
4986   278F FD 13 12 00   mma 18 ; mov a, 18; mul a, b; add d, b
4987   2793 DA            push d
4988   2794 FA FB FF      lea d, [bp + -5] ; $xp
4989   2797 32            mov bl, [d]
4990   2798 A7 00         mov bh, 0
4991   279A E7            pop d
4992   279B FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
4993   279F E4            pop a
4994   27A0 2A            mov b, [d]
4995   27A1             ; START RELATIONAL
4996   27A1 D7            push a
4997   27A2 11            mov a, b
4998   27A3 26 00 02      mov b, $200
4999   27A6 B0            cmp a, b
5000   27A7 FD 75         slu ; < (unsigned)
5001   27A9 E4            pop a
5002   27AA             ; END RELATIONAL
5003   27AA C0 00 00      cmp b, 0
5004   27AD C6 12 28      je _if81_exit
5005   27B0             _if81_true:
5006   27B0             ;; map[yp][xp] = map[yp][xp] + (1 << 8); 
5007   27B0 3B 33 62      mov d, _map_data ; $map
5008   27B3 D7            push a
5009   27B4 DA            push d
5010   27B5 FA FC FF      lea d, [bp + -4] ; $yp
5011   27B8 32            mov bl, [d]
5012   27B9 A7 00         mov bh, 0
5013   27BB E7            pop d
5014   27BC FD 13 12 00   mma 18 ; mov a, 18; mul a, b; add d, b
5015   27C0 DA            push d
5016   27C1 FA FB FF      lea d, [bp + -5] ; $xp
5017   27C4 32            mov bl, [d]
5018   27C5 A7 00         mov bh, 0
5019   27C7 E7            pop d
5020   27C8 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
5021   27CC E4            pop a
5022   27CD DA            push d
5023   27CE 3B 33 62      mov d, _map_data ; $map
5024   27D1 D7            push a
5025   27D2 DA            push d
5026   27D3 FA FC FF      lea d, [bp + -4] ; $yp
5027   27D6 32            mov bl, [d]
5028   27D7 A7 00         mov bh, 0
5029   27D9 E7            pop d
5030   27DA FD 13 12 00   mma 18 ; mov a, 18; mul a, b; add d, b
5031   27DE DA            push d
5032   27DF FA FB FF      lea d, [bp + -5] ; $xp
5033   27E2 32            mov bl, [d]
5034   27E3 A7 00         mov bh, 0
5035   27E5 E7            pop d
5036   27E6 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
5037   27EA E4            pop a
5038   27EB 2A            mov b, [d]
5039   27EC             ; START TERMS
5040   27EC D7            push a
5041   27ED 11            mov a, b
5042   27EE 26 01 00      mov b, $1
5043   27F1             ; START SHIFT
5044   27F1 D7            push a
5045   27F2 11            mov a, b
5046   27F3 26 08 00      mov b, $8
5047   27F6 FD 39         mov c, b
5048   27F8 9D            shl a, cl
5049   27F9 27            mov b, a
5050   27FA E4            pop a
5051   27FB             ; END SHIFT
5052   27FB 56            add b, a
5053   27FC E4            pop a
5054   27FD             ; END TERMS
5055   27FD E7            pop d
5056   27FE FD 43         mov [d], b
5057   2800             ;; klingons_left++; 
5058   2800 3B E3 62      mov d, _klingons_left ; $klingons_left
5059   2803 32            mov bl, [d]
5060   2804 A7 00         mov bh, 0
5061   2806 D8            push b
5062   2807 FD 77         inc b
5063   2809 3B E3 62      mov d, _klingons_left ; $klingons_left
5064   280C FD 43         mov [d], b
5065   280E E5            pop b
5066   280F 0A 12 28      jmp _if81_exit
5067   2812             _if81_exit:
5068   2812             ;; map[yp][xp] = map[yp][xp] + (1 << 4); 
5069   2812 3B 33 62      mov d, _map_data ; $map
5070   2815 D7            push a
5071   2816 DA            push d
5072   2817 FA FC FF      lea d, [bp + -4] ; $yp
5073   281A 32            mov bl, [d]
5074   281B A7 00         mov bh, 0
5075   281D E7            pop d
5076   281E FD 13 12 00   mma 18 ; mov a, 18; mul a, b; add d, b
5077   2822 DA            push d
5078   2823 FA FB FF      lea d, [bp + -5] ; $xp
5079   2826 32            mov bl, [d]
5080   2827 A7 00         mov bh, 0
5081   2829 E7            pop d
5082   282A FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
5083   282E E4            pop a
5084   282F DA            push d
5085   2830 3B 33 62      mov d, _map_data ; $map
5086   2833 D7            push a
5087   2834 DA            push d
5088   2835 FA FC FF      lea d, [bp + -4] ; $yp
5089   2838 32            mov bl, [d]
5090   2839 A7 00         mov bh, 0
5091   283B E7            pop d
5092   283C FD 13 12 00   mma 18 ; mov a, 18; mul a, b; add d, b
5093   2840 DA            push d
5094   2841 FA FB FF      lea d, [bp + -5] ; $xp
5095   2844 32            mov bl, [d]
5096   2845 A7 00         mov bh, 0
5097   2847 E7            pop d
5098   2848 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
5099   284C E4            pop a
5100   284D 2A            mov b, [d]
5101   284E             ; START TERMS
5102   284E D7            push a
5103   284F 11            mov a, b
5104   2850 26 01 00      mov b, $1
5105   2853             ; START SHIFT
5106   2853 D7            push a
5107   2854 11            mov a, b
5108   2855 26 04 00      mov b, $4
5109   2858 FD 39         mov c, b
5110   285A 9D            shl a, cl
5111   285B 27            mov b, a
5112   285C E4            pop a
5113   285D             ; END SHIFT
5114   285D 56            add b, a
5115   285E E4            pop a
5116   285F             ; END TERMS
5117   285F E7            pop d
5118   2860 FD 43         mov [d], b
5119   2862             ;; starbases_left++; 
5120   2862 3B 0E 62      mov d, _starbases_left ; $starbases_left
5121   2865 32            mov bl, [d]
5122   2866 A7 00         mov bh, 0
5123   2868 D8            push b
5124   2869 FD 77         inc b
5125   286B 3B 0E 62      mov d, _starbases_left ; $starbases_left
5126   286E FD 43         mov [d], b
5127   2870 E5            pop b
5128   2871 0A 74 28      jmp _if80_exit
5129   2874             _if80_exit:
5130   2874             ;; total_klingons = klingons_left; 
5131   2874 3B E2 62      mov d, _total_klingons ; $total_klingons
5132   2877 DA            push d
5133   2878 3B E3 62      mov d, _klingons_left ; $klingons_left
5134   287B 32            mov bl, [d]
5135   287C A7 00         mov bh, 0
5136   287E E7            pop d
5137   287F FD 3E         mov [d], bl
5138   2881             ;; if (starbases_left != 1) { 
5139   2881             _if82_cond:
5140   2881 3B 0E 62      mov d, _starbases_left ; $starbases_left
5141   2884 32            mov bl, [d]
5142   2885 A7 00         mov bh, 0
5143   2887             ; START RELATIONAL
5144   2887 D7            push a
5145   2888 11            mov a, b
5146   2889 26 01 00      mov b, $1
5147   288C B0            cmp a, b
5148   288D FD 72         sneq ; !=
5149   288F E4            pop a
5150   2890             ; END RELATIONAL
5151   2890 C0 00 00      cmp b, 0
5152   2893 C6 BF 28      je _if82_exit
5153   2896             _if82_true:
5154   2896             ;; strcpy(plural_2, "s"); 
5155   2896 26 C9 67      mov b, __s59 ; "s"
5156   2899 FD AB         swp b
5157   289B D8            push b
5158   289C 3B 02 64      mov d, _plural_2_data ; $plural_2
5159   289F 2D            mov b, d
5160   28A0 FD AB         swp b
5161   28A2 D8            push b
5162   28A3 07 14 04      call strcpy
5163   28A6 51 04 00      add sp, 4
5164   28A9             ;; strcpy(plural, "are"); 
5165   28A9 26 56 66      mov b, __s32 ; "are"
5166   28AC FD AB         swp b
5167   28AE D8            push b
5168   28AF 3B 04 64      mov d, _plural_data ; $plural
5169   28B2 2D            mov b, d
5170   28B3 FD AB         swp b
5171   28B5 D8            push b
5172   28B6 07 14 04      call strcpy
5173   28B9 51 04 00      add sp, 4
5174   28BC 0A BF 28      jmp _if82_exit
5175   28BF             _if82_exit:
5176   28BF             ;; getchar(); 
5177   28BF 07 0E 13      call getchar
5178   28C2 F9            leave
5179   28C3 09            ret
5180   28C4             
5181   28C4             place_ship:
5182   28C4 F8 00 00      enter 0 ; (push bp; mov bp, sp)
5183   28C7             ;; quad[FROM_FIXED00(ship_y) - 1][FROM_FIXED00(ship_x) - 1] =  		4     ; 
5184   28C7 3B 0B 63      mov d, _quad_data ; $quad
5185   28CA D7            push a
5186   28CB DA            push d
5187   28CC 3B 05 63      mov d, _ship_y ; $ship_y
5188   28CF 2A            mov b, [d]
5189   28D0 FD AB         swp b
5190   28D2 D8            push b
5191   28D3 07 14 1D      call FROM_FIXED00
5192   28D6 51 02 00      add sp, 2
5193   28D9             ; START TERMS
5194   28D9 D7            push a
5195   28DA 11            mov a, b
5196   28DB 26 01 00      mov b, $1
5197   28DE 60            sub a, b
5198   28DF 27            mov b, a
5199   28E0 E4            pop a
5200   28E1             ; END TERMS
5201   28E1 E7            pop d
5202   28E2 FD 13 08 00   mma 8 ; mov a, 8; mul a, b; add d, b
5203   28E6 DA            push d
5204   28E7 3B 07 63      mov d, _ship_x ; $ship_x
5205   28EA 2A            mov b, [d]
5206   28EB FD AB         swp b
5207   28ED D8            push b
5208   28EE 07 14 1D      call FROM_FIXED00
5209   28F1 51 02 00      add sp, 2
5210   28F4             ; START TERMS
5211   28F4 D7            push a
5212   28F5 11            mov a, b
5213   28F6 26 01 00      mov b, $1
5214   28F9 60            sub a, b
5215   28FA 27            mov b, a
5216   28FB E4            pop a
5217   28FC             ; END TERMS
5218   28FC E7            pop d
5219   28FD 5A            add d, b
5220   28FE E4            pop a
5221   28FF DA            push d
5222   2900 26 04 00      mov b, $4
5223   2903 E7            pop d
5224   2904 FD 3E         mov [d], bl
5225   2906 F9            leave
5226   2907 09            ret
5227   2908             
5228   2908             new_quadrant:
5229   2908 F8 00 00      enter 0 ; (push bp; mov bp, sp)
5230   290B             ; $i 
5231   290B             ; $tmp 
5232   290B             ; $k 
5233   290B 52 06 00      sub sp, 6
5234   290E             ;; k = &kdata; 
5235   290E FA FB FF      lea d, [bp + -5] ; $k
5236   2911 DA            push d
5237   2912 3B D5 62      mov d, _kdata_data ; $kdata
5238   2915 2D            mov b, d
5239   2916 E7            pop d
5240   2917 FD 43         mov [d], b
5241   2919             ;; klingons = 0; 
5242   2919 3B E1 62      mov d, _klingons ; $klingons
5243   291C DA            push d
5244   291D 26 00 00      mov b, $0
5245   2920 E7            pop d
5246   2921 FD 3E         mov [d], bl
5247   2923             ;; starbases = 0; 
5248   2923 3B 0B 62      mov d, _starbases ; $starbases
5249   2926 DA            push d
5250   2927 26 00 00      mov b, $0
5251   292A E7            pop d
5252   292B FD 3E         mov [d], bl
5253   292D             ;; stars = 0; 
5254   292D 3B EC 62      mov d, _stars ; $stars
5255   2930 DA            push d
5256   2931 26 00 00      mov b, $0
5257   2934 E7            pop d
5258   2935 FD 3E         mov [d], bl
5259   2937             ;; d4 = get_rand(50) - 1; 
5260   2937 3B 03 63      mov d, _d4 ; $d4
5261   293A DA            push d
5262   293B 26 32 00      mov b, $32
5263   293E FD AB         swp b
5264   2940 D8            push b
5265   2941 07 25 1D      call get_rand
5266   2944 51 02 00      add sp, 2
5267   2947             ; START TERMS
5268   2947 D7            push a
5269   2948 11            mov a, b
5270   2949 26 01 00      mov b, $1
5271   294C 60            sub a, b
5272   294D 27            mov b, a
5273   294E E4            pop a
5274   294F             ; END TERMS
5275   294F E7            pop d
5276   2950 FD 43         mov [d], b
5277   2952             ;; map[quad_y][quad_x] = map[quad_y][quad_x] |   0x1000		/* Set if this sector was mapped */          ; 
5278   2952 3B 33 62      mov d, _map_data ; $map
5279   2955 D7            push a
5280   2956 DA            push d
5281   2957 3B E6 62      mov d, _quad_y ; $quad_y
5282   295A 2A            mov b, [d]
5283   295B E7            pop d
5284   295C FD 13 12 00   mma 18 ; mov a, 18; mul a, b; add d, b
5285   2960 DA            push d
5286   2961 3B E8 62      mov d, _quad_x ; $quad_x
5287   2964 2A            mov b, [d]
5288   2965 E7            pop d
5289   2966 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
5290   296A E4            pop a
5291   296B DA            push d
5292   296C 3B 33 62      mov d, _map_data ; $map
5293   296F D7            push a
5294   2970 DA            push d
5295   2971 3B E6 62      mov d, _quad_y ; $quad_y
5296   2974 2A            mov b, [d]
5297   2975 E7            pop d
5298   2976 FD 13 12 00   mma 18 ; mov a, 18; mul a, b; add d, b
5299   297A DA            push d
5300   297B 3B E8 62      mov d, _quad_x ; $quad_x
5301   297E 2A            mov b, [d]
5302   297F E7            pop d
5303   2980 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
5304   2984 E4            pop a
5305   2985 2A            mov b, [d]
5306   2986 D7            push a
5307   2987 11            mov a, b
5308   2988 26 00 10      mov b, $1000
5309   298B FD 70         or b, a ; |
5310   298D E4            pop a
5311   298E E7            pop d
5312   298F FD 43         mov [d], b
5313   2991             ;; if (quad_y >= 1 && quad_y <= 8 && quad_x >= 1 && quad_x <= 8) { 
5314   2991             _if83_cond:
5315   2991 3B E6 62      mov d, _quad_y ; $quad_y
5316   2994 2A            mov b, [d]
5317   2995             ; START RELATIONAL
5318   2995 D7            push a
5319   2996 11            mov a, b
5320   2997 26 01 00      mov b, $1
5321   299A B0            cmp a, b
5322   299B FD 80         sge ; >=
5323   299D E4            pop a
5324   299E             ; END RELATIONAL
5325   299E D7            push a
5326   299F 11            mov a, b
5327   29A0 3B E6 62      mov d, _quad_y ; $quad_y
5328   29A3 2A            mov b, [d]
5329   29A4             ; START RELATIONAL
5330   29A4 D7            push a
5331   29A5 11            mov a, b
5332   29A6 26 08 00      mov b, $8
5333   29A9 B0            cmp a, b
5334   29AA FD 73         slt ; <= (signed)
5335   29AC E4            pop a
5336   29AD             ; END RELATIONAL
5337   29AD FD A7         sand a, b
5338   29AF 11            mov a, b
5339   29B0 3B E8 62      mov d, _quad_x ; $quad_x
5340   29B3 2A            mov b, [d]
5341   29B4             ; START RELATIONAL
5342   29B4 D7            push a
5343   29B5 11            mov a, b
5344   29B6 26 01 00      mov b, $1
5345   29B9 B0            cmp a, b
5346   29BA FD 80         sge ; >=
5347   29BC E4            pop a
5348   29BD             ; END RELATIONAL
5349   29BD FD A7         sand a, b
5350   29BF 11            mov a, b
5351   29C0 3B E8 62      mov d, _quad_x ; $quad_x
5352   29C3 2A            mov b, [d]
5353   29C4             ; START RELATIONAL
5354   29C4 D7            push a
5355   29C5 11            mov a, b
5356   29C6 26 08 00      mov b, $8
5357   29C9 B0            cmp a, b
5358   29CA FD 73         slt ; <= (signed)
5359   29CC E4            pop a
5360   29CD             ; END RELATIONAL
5361   29CD FD A7         sand a, b
5362   29CF E4            pop a
5363   29D0 C0 00 00      cmp b, 0
5364   29D3 C6 3F 2A      je _if83_exit
5365   29D6             _if83_true:
5366   29D6             ;; quadrant_name(0, quad_y, quad_x); 
5367   29D6 3B E8 62      mov d, _quad_x ; $quad_x
5368   29D9 2A            mov b, [d]
5369   29DA DD            push bl
5370   29DB 3B E6 62      mov d, _quad_y ; $quad_y
5371   29DE 2A            mov b, [d]
5372   29DF DD            push bl
5373   29E0 26 00 00      mov b, $0
5374   29E3 DD            push bl
5375   29E4 07 FB 5E      call quadrant_name
5376   29E7 51 03 00      add sp, 3
5377   29EA             ;; if (TO_FIXED(time_start) != stardate) 
5378   29EA             _if84_cond:
5379   29EA 3B ED 62      mov d, _time_start ; $time_start
5380   29ED 2A            mov b, [d]
5381   29EE FD AB         swp b
5382   29F0 D8            push b
5383   29F1 07 DF 1C      call TO_FIXED
5384   29F4 51 02 00      add sp, 2
5385   29F7             ; START RELATIONAL
5386   29F7 D7            push a
5387   29F8 11            mov a, b
5388   29F9 3B 09 63      mov d, _stardate ; $stardate
5389   29FC 2A            mov b, [d]
5390   29FD B0            cmp a, b
5391   29FE FD 72         sneq ; !=
5392   2A00 E4            pop a
5393   2A01             ; END RELATIONAL
5394   2A01 C0 00 00      cmp b, 0
5395   2A04 C6 1D 2A      je _if84_else
5396   2A07             _if84_true:
5397   2A07             ;; printf("Now entering %s quadrant...\n\n", quadname); 
5398   2A07 3B 4B 63      mov d, _quadname_data ; $quadname
5399   2A0A 2D            mov b, d
5400   2A0B FD AB         swp b
5401   2A0D D8            push b
5402   2A0E 26 CB 67      mov b, __s60 ; "Now entering %s quadrant...\n\n"
5403   2A11 FD AB         swp b
5404   2A13 D8            push b
5405   2A14 07 D1 05      call printf
5406   2A17 51 04 00      add sp, 4
5407   2A1A 0A 3C 2A      jmp _if84_exit
5408   2A1D             _if84_else:
5409   2A1D             ;; puts("\nYour mission begins with your starship located"); 
5410   2A1D 26 E9 67      mov b, __s61 ; "\nYour mission begins with your starship located"
5411   2A20 FD AB         swp b
5412   2A22 D8            push b
5413   2A23 07 37 13      call puts
5414   2A26 51 02 00      add sp, 2
5415   2A29             ;; printf("in the galactic quadrant %s.\n\n", quadname); 
5416   2A29 3B 4B 63      mov d, _quadname_data ; $quadname
5417   2A2C 2D            mov b, d
5418   2A2D FD AB         swp b
5419   2A2F D8            push b
5420   2A30 26 19 68      mov b, __s62 ; "in the galactic quadrant %s.\n\n"
5421   2A33 FD AB         swp b
5422   2A35 D8            push b
5423   2A36 07 D1 05      call printf
5424   2A39 51 04 00      add sp, 4
5425   2A3C             _if84_exit:
5426   2A3C 0A 3F 2A      jmp _if83_exit
5427   2A3F             _if83_exit:
5428   2A3F             ;; tmp = map[quad_y][quad_x]; 
5429   2A3F FA FD FF      lea d, [bp + -3] ; $tmp
5430   2A42 DA            push d
5431   2A43 3B 33 62      mov d, _map_data ; $map
5432   2A46 D7            push a
5433   2A47 DA            push d
5434   2A48 3B E6 62      mov d, _quad_y ; $quad_y
5435   2A4B 2A            mov b, [d]
5436   2A4C E7            pop d
5437   2A4D FD 13 12 00   mma 18 ; mov a, 18; mul a, b; add d, b
5438   2A51 DA            push d
5439   2A52 3B E8 62      mov d, _quad_x ; $quad_x
5440   2A55 2A            mov b, [d]
5441   2A56 E7            pop d
5442   2A57 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
5443   2A5B E4            pop a
5444   2A5C 2A            mov b, [d]
5445   2A5D E7            pop d
5446   2A5E FD 43         mov [d], b
5447   2A60             ;; klingons = (tmp >> 8) & 0x0F; 
5448   2A60 3B E1 62      mov d, _klingons ; $klingons
5449   2A63 DA            push d
5450   2A64 FA FD FF      lea d, [bp + -3] ; $tmp
5451   2A67 2A            mov b, [d]
5452   2A68             ; START SHIFT
5453   2A68 D7            push a
5454   2A69 11            mov a, b
5455   2A6A 26 08 00      mov b, $8
5456   2A6D FD 39         mov c, b
5457   2A6F A1            shr a, cl
5458   2A70 27            mov b, a
5459   2A71 E4            pop a
5460   2A72             ; END SHIFT
5461   2A72 D7            push a
5462   2A73 11            mov a, b
5463   2A74 26 0F 00      mov b, $f
5464   2A77 FD 92         and b, a ; &
5465   2A79 E4            pop a
5466   2A7A E7            pop d
5467   2A7B FD 3E         mov [d], bl
5468   2A7D             ;; starbases = (tmp >> 4) & 0x0F; 
5469   2A7D 3B 0B 62      mov d, _starbases ; $starbases
5470   2A80 DA            push d
5471   2A81 FA FD FF      lea d, [bp + -3] ; $tmp
5472   2A84 2A            mov b, [d]
5473   2A85             ; START SHIFT
5474   2A85 D7            push a
5475   2A86 11            mov a, b
5476   2A87 26 04 00      mov b, $4
5477   2A8A FD 39         mov c, b
5478   2A8C A1            shr a, cl
5479   2A8D 27            mov b, a
5480   2A8E E4            pop a
5481   2A8F             ; END SHIFT
5482   2A8F D7            push a
5483   2A90 11            mov a, b
5484   2A91 26 0F 00      mov b, $f
5485   2A94 FD 92         and b, a ; &
5486   2A96 E4            pop a
5487   2A97 E7            pop d
5488   2A98 FD 3E         mov [d], bl
5489   2A9A             ;; stars = tmp & 0x0F; 
5490   2A9A 3B EC 62      mov d, _stars ; $stars
5491   2A9D DA            push d
5492   2A9E FA FD FF      lea d, [bp + -3] ; $tmp
5493   2AA1 2A            mov b, [d]
5494   2AA2 D7            push a
5495   2AA3 11            mov a, b
5496   2AA4 26 0F 00      mov b, $f
5497   2AA7 FD 92         and b, a ; &
5498   2AA9 E4            pop a
5499   2AAA E7            pop d
5500   2AAB FD 3E         mov [d], bl
5501   2AAD             ;; if (klingons > 0) { 
5502   2AAD             _if85_cond:
5503   2AAD 3B E1 62      mov d, _klingons ; $klingons
5504   2AB0 32            mov bl, [d]
5505   2AB1 A7 00         mov bh, 0
5506   2AB3             ; START RELATIONAL
5507   2AB3 D7            push a
5508   2AB4 11            mov a, b
5509   2AB5 26 00 00      mov b, $0
5510   2AB8 B0            cmp a, b
5511   2AB9 FD 81         sgu ; > (unsigned)
5512   2ABB E4            pop a
5513   2ABC             ; END RELATIONAL
5514   2ABC C0 00 00      cmp b, 0
5515   2ABF C6 F3 2A      je _if85_exit
5516   2AC2             _if85_true:
5517   2AC2             ;; printf("Combat Area  Condition Red\n"); 
5518   2AC2 26 38 68      mov b, __s63 ; "Combat Area  Condition Red\n"
5519   2AC5 FD AB         swp b
5520   2AC7 D8            push b
5521   2AC8 07 D1 05      call printf
5522   2ACB 51 02 00      add sp, 2
5523   2ACE             ;; if (shield < 200) 
5524   2ACE             _if86_cond:
5525   2ACE 3B EA 62      mov d, _shield ; $shield
5526   2AD1 2A            mov b, [d]
5527   2AD2             ; START RELATIONAL
5528   2AD2 D7            push a
5529   2AD3 11            mov a, b
5530   2AD4 26 C8 00      mov b, $c8
5531   2AD7 B0            cmp a, b
5532   2AD8 FD 73         slt ; < (signed)
5533   2ADA E4            pop a
5534   2ADB             ; END RELATIONAL
5535   2ADB C0 00 00      cmp b, 0
5536   2ADE C6 F0 2A      je _if86_exit
5537   2AE1             _if86_true:
5538   2AE1             ;; printf("Shields Dangerously Low\n"); 
5539   2AE1 26 54 68      mov b, __s64 ; "Shields Dangerously Low\n"
5540   2AE4 FD AB         swp b
5541   2AE6 D8            push b
5542   2AE7 07 D1 05      call printf
5543   2AEA 51 02 00      add sp, 2
5544   2AED 0A F0 2A      jmp _if86_exit
5545   2AF0             _if86_exit:
5546   2AF0 0A F3 2A      jmp _if85_exit
5547   2AF3             _if85_exit:
5548   2AF3             ;; for (i = 1; i <= 3; i++) { 
5549   2AF3             _for87_init:
5550   2AF3 FA FF FF      lea d, [bp + -1] ; $i
5551   2AF6 DA            push d
5552   2AF7 26 01 00      mov b, $1
5553   2AFA E7            pop d
5554   2AFB FD 43         mov [d], b
5555   2AFD             _for87_cond:
5556   2AFD FA FF FF      lea d, [bp + -1] ; $i
5557   2B00 2A            mov b, [d]
5558   2B01             ; START RELATIONAL
5559   2B01 D7            push a
5560   2B02 11            mov a, b
5561   2B03 26 03 00      mov b, $3
5562   2B06 B0            cmp a, b
5563   2B07 FD 73         slt ; <= (signed)
5564   2B09 E4            pop a
5565   2B0A             ; END RELATIONAL
5566   2B0A C0 00 00      cmp b, 0
5567   2B0D C6 5A 2B      je _for87_exit
5568   2B10             _for87_block:
5569   2B10             ;; k->y = 0; 
5570   2B10 FA FB FF      lea d, [bp + -5] ; $k
5571   2B13 FD 2A         mov d, [d]
5572   2B15 58 00 00      add d, 0
5573   2B18 DA            push d
5574   2B19 26 00 00      mov b, $0
5575   2B1C E7            pop d
5576   2B1D FD 3E         mov [d], bl
5577   2B1F             ;; k->x = 0; 
5578   2B1F FA FB FF      lea d, [bp + -5] ; $k
5579   2B22 FD 2A         mov d, [d]
5580   2B24 58 01 00      add d, 1
5581   2B27 DA            push d
5582   2B28 26 00 00      mov b, $0
5583   2B2B E7            pop d
5584   2B2C FD 3E         mov [d], bl
5585   2B2E             ;; k->energy = 0; 
5586   2B2E FA FB FF      lea d, [bp + -5] ; $k
5587   2B31 FD 2A         mov d, [d]
5588   2B33 58 02 00      add d, 2
5589   2B36 DA            push d
5590   2B37 26 00 00      mov b, $0
5591   2B3A E7            pop d
5592   2B3B FD 43         mov [d], b
5593   2B3D             ;; k++; 
5594   2B3D FA FB FF      lea d, [bp + -5] ; $k
5595   2B40 2A            mov b, [d]
5596   2B41 D8            push b
5597   2B42 FD 77         inc b
5598   2B44 FA FB FF      lea d, [bp + -5] ; $k
5599   2B47 FD 43         mov [d], b
5600   2B49 E5            pop b
5601   2B4A             _for87_update:
5602   2B4A FA FF FF      lea d, [bp + -1] ; $i
5603   2B4D 2A            mov b, [d]
5604   2B4E D8            push b
5605   2B4F FD 77         inc b
5606   2B51 FA FF FF      lea d, [bp + -1] ; $i
5607   2B54 FD 43         mov [d], b
5608   2B56 E5            pop b
5609   2B57 0A FD 2A      jmp _for87_cond
5610   2B5A             _for87_exit:
5611   2B5A             ;; memset(quad,  		0      , 64); 
5612   2B5A 26 40 00      mov b, $40
5613   2B5D FD AB         swp b
5614   2B5F D8            push b
5615   2B60 26 00 00      mov b, $0
5616   2B63 DD            push bl
5617   2B64 3B 0B 63      mov d, _quad_data ; $quad
5618   2B67 2D            mov b, d
5619   2B68 FD AB         swp b
5620   2B6A D8            push b
5621   2B6B 07 3B 17      call memset
5622   2B6E 51 05 00      add sp, 5
5623   2B71             ;; place_ship(); 
5624   2B71 07 C4 28      call place_ship
5625   2B74             ;; if (klingons > 0) { 
5626   2B74             _if88_cond:
5627   2B74 3B E1 62      mov d, _klingons ; $klingons
5628   2B77 32            mov bl, [d]
5629   2B78 A7 00         mov bh, 0
5630   2B7A             ; START RELATIONAL
5631   2B7A D7            push a
5632   2B7B 11            mov a, b
5633   2B7C 26 00 00      mov b, $0
5634   2B7F B0            cmp a, b
5635   2B80 FD 81         sgu ; > (unsigned)
5636   2B82 E4            pop a
5637   2B83             ; END RELATIONAL
5638   2B83 C0 00 00      cmp b, 0
5639   2B86 C6 19 2C      je _if88_exit
5640   2B89             _if88_true:
5641   2B89             ;; k = kdata; 
5642   2B89 FA FB FF      lea d, [bp + -5] ; $k
5643   2B8C DA            push d
5644   2B8D 3B D5 62      mov d, _kdata_data ; $kdata
5645   2B90 2D            mov b, d
5646   2B91 E7            pop d
5647   2B92 FD 43         mov [d], b
5648   2B94             ;; for (i = 0; i < klingons; i++) { 
5649   2B94             _for89_init:
5650   2B94 FA FF FF      lea d, [bp + -1] ; $i
5651   2B97 DA            push d
5652   2B98 26 00 00      mov b, $0
5653   2B9B E7            pop d
5654   2B9C FD 43         mov [d], b
5655   2B9E             _for89_cond:
5656   2B9E FA FF FF      lea d, [bp + -1] ; $i
5657   2BA1 2A            mov b, [d]
5658   2BA2             ; START RELATIONAL
5659   2BA2 D7            push a
5660   2BA3 11            mov a, b
5661   2BA4 3B E1 62      mov d, _klingons ; $klingons
5662   2BA7 32            mov bl, [d]
5663   2BA8 A7 00         mov bh, 0
5664   2BAA B0            cmp a, b
5665   2BAB FD 73         slt ; < (signed)
5666   2BAD E4            pop a
5667   2BAE             ; END RELATIONAL
5668   2BAE C0 00 00      cmp b, 0
5669   2BB1 C6 16 2C      je _for89_exit
5670   2BB4             _for89_block:
5671   2BB4             ;; find_set_empty_place( 	3        , k->y, k->x); 
5672   2BB4 FA FB FF      lea d, [bp + -5] ; $k
5673   2BB7 FD 2A         mov d, [d]
5674   2BB9 58 01 00      add d, 1
5675   2BBC 32            mov bl, [d]
5676   2BBD A7 00         mov bh, 0
5677   2BBF FD AB         swp b
5678   2BC1 D8            push b
5679   2BC2 FA FB FF      lea d, [bp + -5] ; $k
5680   2BC5 FD 2A         mov d, [d]
5681   2BC7 58 00 00      add d, 0
5682   2BCA 32            mov bl, [d]
5683   2BCB A7 00         mov bh, 0
5684   2BCD FD AB         swp b
5685   2BCF D8            push b
5686   2BD0 26 03 00      mov b, $3
5687   2BD3 DD            push bl
5688   2BD4 07 CE 5D      call find_set_empty_place
5689   2BD7 51 05 00      add sp, 5
5690   2BDA             ;; k->energy = 100 + get_rand(200); 
5691   2BDA FA FB FF      lea d, [bp + -5] ; $k
5692   2BDD FD 2A         mov d, [d]
5693   2BDF 58 02 00      add d, 2
5694   2BE2 DA            push d
5695   2BE3 26 64 00      mov b, $64
5696   2BE6             ; START TERMS
5697   2BE6 D7            push a
5698   2BE7 11            mov a, b
5699   2BE8 26 C8 00      mov b, $c8
5700   2BEB FD AB         swp b
5701   2BED D8            push b
5702   2BEE 07 25 1D      call get_rand
5703   2BF1 51 02 00      add sp, 2
5704   2BF4 56            add b, a
5705   2BF5 E4            pop a
5706   2BF6             ; END TERMS
5707   2BF6 E7            pop d
5708   2BF7 FD 43         mov [d], b
5709   2BF9             ;; k++; 
5710   2BF9 FA FB FF      lea d, [bp + -5] ; $k
5711   2BFC 2A            mov b, [d]
5712   2BFD D8            push b
5713   2BFE FD 77         inc b
5714   2C00 FA FB FF      lea d, [bp + -5] ; $k
5715   2C03 FD 43         mov [d], b
5716   2C05 E5            pop b
5717   2C06             _for89_update:
5718   2C06 FA FF FF      lea d, [bp + -1] ; $i
5719   2C09 2A            mov b, [d]
5720   2C0A D8            push b
5721   2C0B FD 77         inc b
5722   2C0D FA FF FF      lea d, [bp + -1] ; $i
5723   2C10 FD 43         mov [d], b
5724   2C12 E5            pop b
5725   2C13 0A 9E 2B      jmp _for89_cond
5726   2C16             _for89_exit:
5727   2C16 0A 19 2C      jmp _if88_exit
5728   2C19             _if88_exit:
5729   2C19             ;; if (starbases > 0) 
5730   2C19             _if90_cond:
5731   2C19 3B 0B 62      mov d, _starbases ; $starbases
5732   2C1C 32            mov bl, [d]
5733   2C1D A7 00         mov bh, 0
5734   2C1F             ; START RELATIONAL
5735   2C1F D7            push a
5736   2C20 11            mov a, b
5737   2C21 26 00 00      mov b, $0
5738   2C24 B0            cmp a, b
5739   2C25 FD 7F         sgt ; >
5740   2C27 E4            pop a
5741   2C28             ; END RELATIONAL
5742   2C28 C0 00 00      cmp b, 0
5743   2C2B C6 49 2C      je _if90_exit
5744   2C2E             _if90_true:
5745   2C2E             ;; find_set_empty_place( 		2     , &base_y, &base_x); 
5746   2C2E 3B 0D 62      mov d, _base_x ; $base_x
5747   2C31 2D            mov b, d
5748   2C32 FD AB         swp b
5749   2C34 D8            push b
5750   2C35 3B 0C 62      mov d, _base_y ; $base_y
5751   2C38 2D            mov b, d
5752   2C39 FD AB         swp b
5753   2C3B D8            push b
5754   2C3C 26 02 00      mov b, $2
5755   2C3F DD            push bl
5756   2C40 07 CE 5D      call find_set_empty_place
5757   2C43 51 05 00      add sp, 5
5758   2C46 0A 49 2C      jmp _if90_exit
5759   2C49             _if90_exit:
5760   2C49             ;; for (i = 1; i <= stars; i++) 
5761   2C49             _for91_init:
5762   2C49 FA FF FF      lea d, [bp + -1] ; $i
5763   2C4C DA            push d
5764   2C4D 26 01 00      mov b, $1
5765   2C50 E7            pop d
5766   2C51 FD 43         mov [d], b
5767   2C53             _for91_cond:
5768   2C53 FA FF FF      lea d, [bp + -1] ; $i
5769   2C56 2A            mov b, [d]
5770   2C57             ; START RELATIONAL
5771   2C57 D7            push a
5772   2C58 11            mov a, b
5773   2C59 3B EC 62      mov d, _stars ; $stars
5774   2C5C 32            mov bl, [d]
5775   2C5D A7 00         mov bh, 0
5776   2C5F B0            cmp a, b
5777   2C60 FD 73         slt ; <= (signed)
5778   2C62 E4            pop a
5779   2C63             ; END RELATIONAL
5780   2C63 C0 00 00      cmp b, 0
5781   2C66 C6 8F 2C      je _for91_exit
5782   2C69             _for91_block:
5783   2C69             ;; find_set_empty_place( 		1     ,   0   ,   0   ); 
5784   2C69 26 00 00      mov b, $0
5785   2C6C FD AB         swp b
5786   2C6E D8            push b
5787   2C6F 26 00 00      mov b, $0
5788   2C72 FD AB         swp b
5789   2C74 D8            push b
5790   2C75 26 01 00      mov b, $1
5791   2C78 DD            push bl
5792   2C79 07 CE 5D      call find_set_empty_place
5793   2C7C 51 05 00      add sp, 5
5794   2C7F             _for91_update:
5795   2C7F FA FF FF      lea d, [bp + -1] ; $i
5796   2C82 2A            mov b, [d]
5797   2C83 D8            push b
5798   2C84 FD 77         inc b
5799   2C86 FA FF FF      lea d, [bp + -1] ; $i
5800   2C89 FD 43         mov [d], b
5801   2C8B E5            pop b
5802   2C8C 0A 53 2C      jmp _for91_cond
5803   2C8F             _for91_exit:
5804   2C8F F9            leave
5805   2C90 09            ret
5806   2C91             
5807   2C91             course_control:
5808   2C91 F8 00 00      enter 0 ; (push bp; mov bp, sp)
5809   2C94             ; $i 
5810   2C94             ; $c1 
5811   2C94             ; $warp 
5812   2C94             ; $n 
5813   2C94             ; $c2 
5814   2C94             ; $c3 
5815   2C94             ; $c4 
5816   2C94             ; $z1 
5817   2C94             ; $z2 
5818   2C94             ; $x1 
5819   2C94             ; $x2 
5820   2C94             ; $x 
5821   2C94             ; $y 
5822   2C94             ; $outside 
5823   2C94 19 00         mov al, $0
5824   2C96 40 E6 FF      mov [bp + -26], al
5825   2C99             ; $quad_y_old 
5826   2C99             ; $quad_x_old 
5827   2C99 52 1D 00      sub sp, 29
5828   2C9C             ;; puts("Course (0-9): " ); 
5829   2C9C 26 6D 68      mov b, __s65 ; "Course (0-9): "
5830   2C9F FD AB         swp b
5831   2CA1 D8            push b
5832   2CA2 07 37 13      call puts
5833   2CA5 51 02 00      add sp, 2
5834   2CA8             ;; c1 = input_f00(); 
5835   2CA8 FA FD FF      lea d, [bp + -3] ; $c1
5836   2CAB DA            push d
5837   2CAC 07 52 1F      call input_f00
5838   2CAF E7            pop d
5839   2CB0 FD 43         mov [d], b
5840   2CB2             ;; if (c1 == 900) 
5841   2CB2             _if92_cond:
5842   2CB2 FA FD FF      lea d, [bp + -3] ; $c1
5843   2CB5 2A            mov b, [d]
5844   2CB6             ; START RELATIONAL
5845   2CB6 D7            push a
5846   2CB7 11            mov a, b
5847   2CB8 26 84 03      mov b, $384
5848   2CBB B0            cmp a, b
5849   2CBC FD 71         seq ; ==
5850   2CBE E4            pop a
5851   2CBF             ; END RELATIONAL
5852   2CBF C0 00 00      cmp b, 0
5853   2CC2 C6 D2 2C      je _if92_exit
5854   2CC5             _if92_true:
5855   2CC5             ;; c1 = 100; 
5856   2CC5 FA FD FF      lea d, [bp + -3] ; $c1
5857   2CC8 DA            push d
5858   2CC9 26 64 00      mov b, $64
5859   2CCC E7            pop d
5860   2CCD FD 43         mov [d], b
5861   2CCF 0A D2 2C      jmp _if92_exit
5862   2CD2             _if92_exit:
5863   2CD2             ;; if (c1 < 0 || c1 > 900) { 
5864   2CD2             _if93_cond:
5865   2CD2 FA FD FF      lea d, [bp + -3] ; $c1
5866   2CD5 2A            mov b, [d]
5867   2CD6             ; START RELATIONAL
5868   2CD6 D7            push a
5869   2CD7 11            mov a, b
5870   2CD8 26 00 00      mov b, $0
5871   2CDB B0            cmp a, b
5872   2CDC FD 73         slt ; < (signed)
5873   2CDE E4            pop a
5874   2CDF             ; END RELATIONAL
5875   2CDF D7            push a
5876   2CE0 11            mov a, b
5877   2CE1 FA FD FF      lea d, [bp + -3] ; $c1
5878   2CE4 2A            mov b, [d]
5879   2CE5             ; START RELATIONAL
5880   2CE5 D7            push a
5881   2CE6 11            mov a, b
5882   2CE7 26 84 03      mov b, $384
5883   2CEA B0            cmp a, b
5884   2CEB FD 7F         sgt ; >
5885   2CED E4            pop a
5886   2CEE             ; END RELATIONAL
5887   2CEE FD A8         sor a, b ; ||
5888   2CF0 E4            pop a
5889   2CF1 C0 00 00      cmp b, 0
5890   2CF4 C6 0F 2D      je _if93_exit
5891   2CF7             _if93_true:
5892   2CF7             ;; printf("Lt. Sulu%s", inc_1); 
5893   2CF7 3B 7F 63      mov d, _inc_1 ; $inc_1
5894   2CFA 2A            mov b, [d]
5895   2CFB FD AB         swp b
5896   2CFD D8            push b
5897   2CFE 26 7C 68      mov b, __s66 ; "Lt. Sulu%s"
5898   2D01 FD AB         swp b
5899   2D03 D8            push b
5900   2D04 07 D1 05      call printf
5901   2D07 51 04 00      add sp, 4
5902   2D0A             ;; return; 
5903   2D0A F9            leave
5904   2D0B 09            ret
5905   2D0C 0A 0F 2D      jmp _if93_exit
5906   2D0F             _if93_exit:
5907   2D0F             ;; if (damage[1] < 0) 
5908   2D0F             _if94_cond:
5909   2D0F 3B F1 62      mov d, _damage_data ; $damage
5910   2D12 D7            push a
5911   2D13 DA            push d
5912   2D14 26 01 00      mov b, $1
5913   2D17 E7            pop d
5914   2D18 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
5915   2D1C E4            pop a
5916   2D1D 2A            mov b, [d]
5917   2D1E             ; START RELATIONAL
5918   2D1E D7            push a
5919   2D1F 11            mov a, b
5920   2D20 26 00 00      mov b, $0
5921   2D23 B0            cmp a, b
5922   2D24 FD 73         slt ; < (signed)
5923   2D26 E4            pop a
5924   2D27             ; END RELATIONAL
5925   2D27 C0 00 00      cmp b, 0
5926   2D2A C6 43 2D      je _if94_exit
5927   2D2D             _if94_true:
5928   2D2D             ;; strcpy(warpmax, "0.2"); 
5929   2D2D 26 87 68      mov b, __s67 ; "0.2"
5930   2D30 FD AB         swp b
5931   2D32 D8            push b
5932   2D33 3B 08 64      mov d, _warpmax_data ; $warpmax
5933   2D36 2D            mov b, d
5934   2D37 FD AB         swp b
5935   2D39 D8            push b
5936   2D3A 07 14 04      call strcpy
5937   2D3D 51 04 00      add sp, 4
5938   2D40 0A 43 2D      jmp _if94_exit
5939   2D43             _if94_exit:
5940   2D43             ;; printf("Warp Factor (0-%s): ", warpmax); 
5941   2D43 3B 08 64      mov d, _warpmax_data ; $warpmax
5942   2D46 2D            mov b, d
5943   2D47 FD AB         swp b
5944   2D49 D8            push b
5945   2D4A 26 8B 68      mov b, __s68 ; "Warp Factor (0-%s): "
5946   2D4D FD AB         swp b
5947   2D4F D8            push b
5948   2D50 07 D1 05      call printf
5949   2D53 51 04 00      add sp, 4
5950   2D56             ;; warp = input_f00(); 
5951   2D56 FA FB FF      lea d, [bp + -5] ; $warp
5952   2D59 DA            push d
5953   2D5A 07 52 1F      call input_f00
5954   2D5D E7            pop d
5955   2D5E FD 43         mov [d], b
5956   2D60             ;; if (damage[1] < 0 && warp > 20) { 
5957   2D60             _if95_cond:
5958   2D60 3B F1 62      mov d, _damage_data ; $damage
5959   2D63 D7            push a
5960   2D64 DA            push d
5961   2D65 26 01 00      mov b, $1
5962   2D68 E7            pop d
5963   2D69 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
5964   2D6D E4            pop a
5965   2D6E 2A            mov b, [d]
5966   2D6F             ; START RELATIONAL
5967   2D6F D7            push a
5968   2D70 11            mov a, b
5969   2D71 26 00 00      mov b, $0
5970   2D74 B0            cmp a, b
5971   2D75 FD 73         slt ; < (signed)
5972   2D77 E4            pop a
5973   2D78             ; END RELATIONAL
5974   2D78 D7            push a
5975   2D79 11            mov a, b
5976   2D7A FA FB FF      lea d, [bp + -5] ; $warp
5977   2D7D 2A            mov b, [d]
5978   2D7E             ; START RELATIONAL
5979   2D7E D7            push a
5980   2D7F 11            mov a, b
5981   2D80 26 14 00      mov b, $14
5982   2D83 B0            cmp a, b
5983   2D84 FD 7F         sgt ; >
5984   2D86 E4            pop a
5985   2D87             ; END RELATIONAL
5986   2D87 FD A7         sand a, b
5987   2D89 E4            pop a
5988   2D8A C0 00 00      cmp b, 0
5989   2D8D C6 A1 2D      je _if95_exit
5990   2D90             _if95_true:
5991   2D90             ;; printf("Warp Engines are damaged. Maximum speed = Warp 0.2.\n\n"); 
5992   2D90 26 A0 68      mov b, __s69 ; "Warp Engines are damaged. Maximum speed = Warp 0.2.\n\n"
5993   2D93 FD AB         swp b
5994   2D95 D8            push b
5995   2D96 07 D1 05      call printf
5996   2D99 51 02 00      add sp, 2
5997   2D9C             ;; return; 
5998   2D9C F9            leave
5999   2D9D 09            ret
6000   2D9E 0A A1 2D      jmp _if95_exit
6001   2DA1             _if95_exit:
6002   2DA1             ;; if (warp <= 0) 
6003   2DA1             _if96_cond:
6004   2DA1 FA FB FF      lea d, [bp + -5] ; $warp
6005   2DA4 2A            mov b, [d]
6006   2DA5             ; START RELATIONAL
6007   2DA5 D7            push a
6008   2DA6 11            mov a, b
6009   2DA7 26 00 00      mov b, $0
6010   2DAA B0            cmp a, b
6011   2DAB FD 73         slt ; <= (signed)
6012   2DAD E4            pop a
6013   2DAE             ; END RELATIONAL
6014   2DAE C0 00 00      cmp b, 0
6015   2DB1 C6 B9 2D      je _if96_exit
6016   2DB4             _if96_true:
6017   2DB4             ;; return; 
6018   2DB4 F9            leave
6019   2DB5 09            ret
6020   2DB6 0A B9 2D      jmp _if96_exit
6021   2DB9             _if96_exit:
6022   2DB9             ;; if (warp > 800) { 
6023   2DB9             _if97_cond:
6024   2DB9 FA FB FF      lea d, [bp + -5] ; $warp
6025   2DBC 2A            mov b, [d]
6026   2DBD             ; START RELATIONAL
6027   2DBD D7            push a
6028   2DBE 11            mov a, b
6029   2DBF 26 20 03      mov b, $320
6030   2DC2 B0            cmp a, b
6031   2DC3 FD 7F         sgt ; >
6032   2DC5 E4            pop a
6033   2DC6             ; END RELATIONAL
6034   2DC6 C0 00 00      cmp b, 0
6035   2DC9 C6 ED 2D      je _if97_exit
6036   2DCC             _if97_true:
6037   2DCC             ;; printf("Chief Engineer Scott reports:\n  The engines won't take warp %s!\n\n", print100(warp)); 
6038   2DCC FA FB FF      lea d, [bp + -5] ; $warp
6039   2DCF 2A            mov b, [d]
6040   2DD0 FD AB         swp b
6041   2DD2 D8            push b
6042   2DD3 07 1B 21      call print100
6043   2DD6 51 02 00      add sp, 2
6044   2DD9 FD AB         swp b
6045   2DDB D8            push b
6046   2DDC 26 D6 68      mov b, __s70 ; "Chief Engineer Scott reports:\n  The engines won't take warp %s!\n\n"
6047   2DDF FD AB         swp b
6048   2DE1 D8            push b
6049   2DE2 07 D1 05      call printf
6050   2DE5 51 04 00      add sp, 4
6051   2DE8             ;; return; 
6052   2DE8 F9            leave
6053   2DE9 09            ret
6054   2DEA 0A ED 2D      jmp _if97_exit
6055   2DED             _if97_exit:
6056   2DED             ;; n = warp * 8; 
6057   2DED FA F9 FF      lea d, [bp + -7] ; $n
6058   2DF0 DA            push d
6059   2DF1 FA FB FF      lea d, [bp + -5] ; $warp
6060   2DF4 2A            mov b, [d]
6061   2DF5             ; START FACTORS
6062   2DF5 D7            push a
6063   2DF6 11            mov a, b
6064   2DF7 26 08 00      mov b, $8
6065   2DFA AC            mul a, b ; *
6066   2DFB 11            mov a, b
6067   2DFC 27            mov b, a
6068   2DFD E4            pop a
6069   2DFE             ; END FACTORS
6070   2DFE E7            pop d
6071   2DFF FD 43         mov [d], b
6072   2E01             ;; n = cint100(n);	 
6073   2E01 FA F9 FF      lea d, [bp + -7] ; $n
6074   2E04 DA            push d
6075   2E05 FA F9 FF      lea d, [bp + -7] ; $n
6076   2E08 2A            mov b, [d]
6077   2E09 FD AB         swp b
6078   2E0B D8            push b
6079   2E0C 07 EE 61      call cint100
6080   2E0F 51 02 00      add sp, 2
6081   2E12 E7            pop d
6082   2E13 FD 43         mov [d], b
6083   2E15             ;; if (energy - n < 0) { 
6084   2E15             _if98_cond:
6085   2E15 3B 2F 62      mov d, _energy ; $energy
6086   2E18 2A            mov b, [d]
6087   2E19             ; START TERMS
6088   2E19 D7            push a
6089   2E1A 11            mov a, b
6090   2E1B FA F9 FF      lea d, [bp + -7] ; $n
6091   2E1E 2A            mov b, [d]
6092   2E1F 60            sub a, b
6093   2E20 27            mov b, a
6094   2E21 E4            pop a
6095   2E22             ; END TERMS
6096   2E22             ; START RELATIONAL
6097   2E22 D7            push a
6098   2E23 11            mov a, b
6099   2E24 26 00 00      mov b, $0
6100   2E27 B0            cmp a, b
6101   2E28 FD 75         slu ; < (unsigned)
6102   2E2A E4            pop a
6103   2E2B             ; END RELATIONAL
6104   2E2B C0 00 00      cmp b, 0
6105   2E2E C6 99 2E      je _if98_exit
6106   2E31             _if98_true:
6107   2E31             ;; printf("Engineering reports:\n  Insufficient energy available for maneuvering at warp %s!\n\n", print100(warp)); 
6108   2E31 FA FB FF      lea d, [bp + -5] ; $warp
6109   2E34 2A            mov b, [d]
6110   2E35 FD AB         swp b
6111   2E37 D8            push b
6112   2E38 07 1B 21      call print100
6113   2E3B 51 02 00      add sp, 2
6114   2E3E FD AB         swp b
6115   2E40 D8            push b
6116   2E41 26 17 69      mov b, __s71 ; "Engineering reports:\n  Insufficient energy available for maneuvering at warp %s!\n\n"
6117   2E44 FD AB         swp b
6118   2E46 D8            push b
6119   2E47 07 D1 05      call printf
6120   2E4A 51 04 00      add sp, 4
6121   2E4D             ;; if (shield >= n && damage[7] >= 0) { 
6122   2E4D             _if99_cond:
6123   2E4D 3B EA 62      mov d, _shield ; $shield
6124   2E50 2A            mov b, [d]
6125   2E51             ; START RELATIONAL
6126   2E51 D7            push a
6127   2E52 11            mov a, b
6128   2E53 FA F9 FF      lea d, [bp + -7] ; $n
6129   2E56 2A            mov b, [d]
6130   2E57 B0            cmp a, b
6131   2E58 FD 80         sge ; >=
6132   2E5A E4            pop a
6133   2E5B             ; END RELATIONAL
6134   2E5B D7            push a
6135   2E5C 11            mov a, b
6136   2E5D 3B F1 62      mov d, _damage_data ; $damage
6137   2E60 D7            push a
6138   2E61 DA            push d
6139   2E62 26 07 00      mov b, $7
6140   2E65 E7            pop d
6141   2E66 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
6142   2E6A E4            pop a
6143   2E6B 2A            mov b, [d]
6144   2E6C             ; START RELATIONAL
6145   2E6C D7            push a
6146   2E6D 11            mov a, b
6147   2E6E 26 00 00      mov b, $0
6148   2E71 B0            cmp a, b
6149   2E72 FD 80         sge ; >=
6150   2E74 E4            pop a
6151   2E75             ; END RELATIONAL
6152   2E75 FD A7         sand a, b
6153   2E77 E4            pop a
6154   2E78 C0 00 00      cmp b, 0
6155   2E7B C6 94 2E      je _if99_exit
6156   2E7E             _if99_true:
6157   2E7E             ;; printf("Deflector Control Room acknowledges:\n  %d units of energy presently deployed to shields.\n", shield); 
6158   2E7E 3B EA 62      mov d, _shield ; $shield
6159   2E81 2A            mov b, [d]
6160   2E82 FD AB         swp b
6161   2E84 D8            push b
6162   2E85 26 6A 69      mov b, __s72 ; "Deflector Control Room acknowledges:\n  %d units of energy presently deployed to shields.\n"
6163   2E88 FD AB         swp b
6164   2E8A D8            push b
6165   2E8B 07 D1 05      call printf
6166   2E8E 51 04 00      add sp, 4
6167   2E91 0A 94 2E      jmp _if99_exit
6168   2E94             _if99_exit:
6169   2E94             ;; return; 
6170   2E94 F9            leave
6171   2E95 09            ret
6172   2E96 0A 99 2E      jmp _if98_exit
6173   2E99             _if98_exit:
6174   2E99             ;; klingons_move(); 
6175   2E99 07 8B 57      call klingons_move
6176   2E9C             ;; repair_damage(warp); 
6177   2E9C FA FB FF      lea d, [bp + -5] ; $warp
6178   2E9F 2A            mov b, [d]
6179   2EA0 FD AB         swp b
6180   2EA2 D8            push b
6181   2EA3 07 12 5B      call repair_damage
6182   2EA6 51 02 00      add sp, 2
6183   2EA9             ;; z1 = FROM_FIXED00(ship_y); 
6184   2EA9 FA F1 FF      lea d, [bp + -15] ; $z1
6185   2EAC DA            push d
6186   2EAD 3B 05 63      mov d, _ship_y ; $ship_y
6187   2EB0 2A            mov b, [d]
6188   2EB1 FD AB         swp b
6189   2EB3 D8            push b
6190   2EB4 07 14 1D      call FROM_FIXED00
6191   2EB7 51 02 00      add sp, 2
6192   2EBA E7            pop d
6193   2EBB FD 43         mov [d], b
6194   2EBD             ;; z2 = FROM_FIXED00(ship_x); 
6195   2EBD FA EF FF      lea d, [bp + -17] ; $z2
6196   2EC0 DA            push d
6197   2EC1 3B 07 63      mov d, _ship_x ; $ship_x
6198   2EC4 2A            mov b, [d]
6199   2EC5 FD AB         swp b
6200   2EC7 D8            push b
6201   2EC8 07 14 1D      call FROM_FIXED00
6202   2ECB 51 02 00      add sp, 2
6203   2ECE E7            pop d
6204   2ECF FD 43         mov [d], b
6205   2ED1             ;; quad[z1+-1][z2+-1] =  		0      ; 
6206   2ED1 3B 0B 63      mov d, _quad_data ; $quad
6207   2ED4 D7            push a
6208   2ED5 DA            push d
6209   2ED6 FA F1 FF      lea d, [bp + -15] ; $z1
6210   2ED9 2A            mov b, [d]
6211   2EDA             ; START TERMS
6212   2EDA D7            push a
6213   2EDB 11            mov a, b
6214   2EDC 26 FF FF      mov b, 65535
6215   2EDF 38 FF FF      mov c, 65535
6216   2EE2 54            add a, b
6217   2EE3 D7            push a
6218   2EE4 FD 12         mov a, g
6219   2EE6 28            mov b, c
6220   2EE7 5C            adc a, b
6221   2EE8 39            mov c, a
6222   2EE9 E5            pop b
6223   2EEA E4            pop a
6224   2EEB             ; END TERMS
6225   2EEB E7            pop d
6226   2EEC FD 13 08 00   mma 8 ; mov a, 8; mul a, b; add d, b
6227   2EF0 DA            push d
6228   2EF1 FA EF FF      lea d, [bp + -17] ; $z2
6229   2EF4 2A            mov b, [d]
6230   2EF5             ; START TERMS
6231   2EF5 D7            push a
6232   2EF6 11            mov a, b
6233   2EF7 26 FF FF      mov b, 65535
6234   2EFA 38 FF FF      mov c, 65535
6235   2EFD 54            add a, b
6236   2EFE D7            push a
6237   2EFF FD 12         mov a, g
6238   2F01 28            mov b, c
6239   2F02 5C            adc a, b
6240   2F03 39            mov c, a
6241   2F04 E5            pop b
6242   2F05 E4            pop a
6243   2F06             ; END TERMS
6244   2F06 E7            pop d
6245   2F07 5A            add d, b
6246   2F08 E4            pop a
6247   2F09 DA            push d
6248   2F0A 26 00 00      mov b, $0
6249   2F0D E7            pop d
6250   2F0E FD 3E         mov [d], bl
6251   2F10             ;; c2 = FROM_FIXED00(c1);	/* Integer part */ 
6252   2F10 FA F7 FF      lea d, [bp + -9] ; $c2
6253   2F13 DA            push d
6254   2F14 FA FD FF      lea d, [bp + -3] ; $c1
6255   2F17 2A            mov b, [d]
6256   2F18 FD AB         swp b
6257   2F1A D8            push b
6258   2F1B 07 14 1D      call FROM_FIXED00
6259   2F1E 51 02 00      add sp, 2
6260   2F21 E7            pop d
6261   2F22 FD 43         mov [d], b
6262   2F24             ;; c3 = c2 + 1;		/* Next integer part */ 
6263   2F24 FA F5 FF      lea d, [bp + -11] ; $c3
6264   2F27 DA            push d
6265   2F28 FA F7 FF      lea d, [bp + -9] ; $c2
6266   2F2B 2A            mov b, [d]
6267   2F2C             ; START TERMS
6268   2F2C D7            push a
6269   2F2D 11            mov a, b
6270   2F2E 26 01 00      mov b, $1
6271   2F31 56            add b, a
6272   2F32 E4            pop a
6273   2F33             ; END TERMS
6274   2F33 E7            pop d
6275   2F34 FD 43         mov [d], b
6276   2F36             ;; c4 = (c1 - TO_FIXED00(c2));	/* Fractional element in fixed point */ 
6277   2F36 FA F3 FF      lea d, [bp + -13] ; $c4
6278   2F39 DA            push d
6279   2F3A FA FD FF      lea d, [bp + -3] ; $c1
6280   2F3D 2A            mov b, [d]
6281   2F3E             ; START TERMS
6282   2F3E D7            push a
6283   2F3F 11            mov a, b
6284   2F40 FA F7 FF      lea d, [bp + -9] ; $c2
6285   2F43 2A            mov b, [d]
6286   2F44 FD AB         swp b
6287   2F46 D8            push b
6288   2F47 07 02 1D      call TO_FIXED00
6289   2F4A 51 02 00      add sp, 2
6290   2F4D 60            sub a, b
6291   2F4E 27            mov b, a
6292   2F4F E4            pop a
6293   2F50             ; END TERMS
6294   2F50 E7            pop d
6295   2F51 FD 43         mov [d], b
6296   2F53             ;; x1 = 100 * c[1][c2] + (c[1][c3] - c[1][c2]) * c4; 
6297   2F53 FA ED FF      lea d, [bp + -19] ; $x1
6298   2F56 DA            push d
6299   2F57 26 64 00      mov b, $64
6300   2F5A             ; START FACTORS
6301   2F5A D7            push a
6302   2F5B 11            mov a, b
6303   2F5C 3B 0F 62      mov d, _c_data ; $c
6304   2F5F D7            push a
6305   2F60 DA            push d
6306   2F61 26 01 00      mov b, $1
6307   2F64 E7            pop d
6308   2F65 FD 13 0A 00   mma 10 ; mov a, 10; mul a, b; add d, b
6309   2F69 DA            push d
6310   2F6A FA F7 FF      lea d, [bp + -9] ; $c2
6311   2F6D 2A            mov b, [d]
6312   2F6E E7            pop d
6313   2F6F 5A            add d, b
6314   2F70 E4            pop a
6315   2F71 32            mov bl, [d]
6316   2F72 A7 00         mov bh, 0
6317   2F74 AC            mul a, b ; *
6318   2F75 11            mov a, b
6319   2F76 27            mov b, a
6320   2F77 E4            pop a
6321   2F78             ; END FACTORS
6322   2F78             ; START TERMS
6323   2F78 D7            push a
6324   2F79 11            mov a, b
6325   2F7A 3B 0F 62      mov d, _c_data ; $c
6326   2F7D D7            push a
6327   2F7E DA            push d
6328   2F7F 26 01 00      mov b, $1
6329   2F82 E7            pop d
6330   2F83 FD 13 0A 00   mma 10 ; mov a, 10; mul a, b; add d, b
6331   2F87 DA            push d
6332   2F88 FA F5 FF      lea d, [bp + -11] ; $c3
6333   2F8B 2A            mov b, [d]
6334   2F8C E7            pop d
6335   2F8D 5A            add d, b
6336   2F8E E4            pop a
6337   2F8F 32            mov bl, [d]
6338   2F90 A7 00         mov bh, 0
6339   2F92             ; START TERMS
6340   2F92 D7            push a
6341   2F93 11            mov a, b
6342   2F94 3B 0F 62      mov d, _c_data ; $c
6343   2F97 D7            push a
6344   2F98 DA            push d
6345   2F99 26 01 00      mov b, $1
6346   2F9C E7            pop d
6347   2F9D FD 13 0A 00   mma 10 ; mov a, 10; mul a, b; add d, b
6348   2FA1 DA            push d
6349   2FA2 FA F7 FF      lea d, [bp + -9] ; $c2
6350   2FA5 2A            mov b, [d]
6351   2FA6 E7            pop d
6352   2FA7 5A            add d, b
6353   2FA8 E4            pop a
6354   2FA9 32            mov bl, [d]
6355   2FAA A7 00         mov bh, 0
6356   2FAC 60            sub a, b
6357   2FAD 27            mov b, a
6358   2FAE E4            pop a
6359   2FAF             ; END TERMS
6360   2FAF             ; START FACTORS
6361   2FAF D7            push a
6362   2FB0 11            mov a, b
6363   2FB1 FA F3 FF      lea d, [bp + -13] ; $c4
6364   2FB4 2A            mov b, [d]
6365   2FB5 AC            mul a, b ; *
6366   2FB6 11            mov a, b
6367   2FB7 27            mov b, a
6368   2FB8 E4            pop a
6369   2FB9             ; END FACTORS
6370   2FB9 56            add b, a
6371   2FBA E4            pop a
6372   2FBB             ; END TERMS
6373   2FBB E7            pop d
6374   2FBC FD 43         mov [d], b
6375   2FBE             ;; x2 = 100 * c[2][c2] + (c[2][c3] - c[2][c2]) * c4; 
6376   2FBE FA EB FF      lea d, [bp + -21] ; $x2
6377   2FC1 DA            push d
6378   2FC2 26 64 00      mov b, $64
6379   2FC5             ; START FACTORS
6380   2FC5 D7            push a
6381   2FC6 11            mov a, b
6382   2FC7 3B 0F 62      mov d, _c_data ; $c
6383   2FCA D7            push a
6384   2FCB DA            push d
6385   2FCC 26 02 00      mov b, $2
6386   2FCF E7            pop d
6387   2FD0 FD 13 0A 00   mma 10 ; mov a, 10; mul a, b; add d, b
6388   2FD4 DA            push d
6389   2FD5 FA F7 FF      lea d, [bp + -9] ; $c2
6390   2FD8 2A            mov b, [d]
6391   2FD9 E7            pop d
6392   2FDA 5A            add d, b
6393   2FDB E4            pop a
6394   2FDC 32            mov bl, [d]
6395   2FDD A7 00         mov bh, 0
6396   2FDF AC            mul a, b ; *
6397   2FE0 11            mov a, b
6398   2FE1 27            mov b, a
6399   2FE2 E4            pop a
6400   2FE3             ; END FACTORS
6401   2FE3             ; START TERMS
6402   2FE3 D7            push a
6403   2FE4 11            mov a, b
6404   2FE5 3B 0F 62      mov d, _c_data ; $c
6405   2FE8 D7            push a
6406   2FE9 DA            push d
6407   2FEA 26 02 00      mov b, $2
6408   2FED E7            pop d
6409   2FEE FD 13 0A 00   mma 10 ; mov a, 10; mul a, b; add d, b
6410   2FF2 DA            push d
6411   2FF3 FA F5 FF      lea d, [bp + -11] ; $c3
6412   2FF6 2A            mov b, [d]
6413   2FF7 E7            pop d
6414   2FF8 5A            add d, b
6415   2FF9 E4            pop a
6416   2FFA 32            mov bl, [d]
6417   2FFB A7 00         mov bh, 0
6418   2FFD             ; START TERMS
6419   2FFD D7            push a
6420   2FFE 11            mov a, b
6421   2FFF 3B 0F 62      mov d, _c_data ; $c
6422   3002 D7            push a
6423   3003 DA            push d
6424   3004 26 02 00      mov b, $2
6425   3007 E7            pop d
6426   3008 FD 13 0A 00   mma 10 ; mov a, 10; mul a, b; add d, b
6427   300C DA            push d
6428   300D FA F7 FF      lea d, [bp + -9] ; $c2
6429   3010 2A            mov b, [d]
6430   3011 E7            pop d
6431   3012 5A            add d, b
6432   3013 E4            pop a
6433   3014 32            mov bl, [d]
6434   3015 A7 00         mov bh, 0
6435   3017 60            sub a, b
6436   3018 27            mov b, a
6437   3019 E4            pop a
6438   301A             ; END TERMS
6439   301A             ; START FACTORS
6440   301A D7            push a
6441   301B 11            mov a, b
6442   301C FA F3 FF      lea d, [bp + -13] ; $c4
6443   301F 2A            mov b, [d]
6444   3020 AC            mul a, b ; *
6445   3021 11            mov a, b
6446   3022 27            mov b, a
6447   3023 E4            pop a
6448   3024             ; END FACTORS
6449   3024 56            add b, a
6450   3025 E4            pop a
6451   3026             ; END TERMS
6452   3026 E7            pop d
6453   3027 FD 43         mov [d], b
6454   3029             ;; x = ship_y; 
6455   3029 FA E9 FF      lea d, [bp + -23] ; $x
6456   302C DA            push d
6457   302D 3B 05 63      mov d, _ship_y ; $ship_y
6458   3030 2A            mov b, [d]
6459   3031 E7            pop d
6460   3032 FD 43         mov [d], b
6461   3034             ;; y = ship_x; 
6462   3034 FA E7 FF      lea d, [bp + -25] ; $y
6463   3037 DA            push d
6464   3038 3B 07 63      mov d, _ship_x ; $ship_x
6465   303B 2A            mov b, [d]
6466   303C E7            pop d
6467   303D FD 43         mov [d], b
6468   303F             ;; for (i = 1; i <= n; i++) { 
6469   303F             _for100_init:
6470   303F FA FF FF      lea d, [bp + -1] ; $i
6471   3042 DA            push d
6472   3043 26 01 00      mov b, $1
6473   3046 E7            pop d
6474   3047 FD 43         mov [d], b
6475   3049             _for100_cond:
6476   3049 FA FF FF      lea d, [bp + -1] ; $i
6477   304C 2A            mov b, [d]
6478   304D             ; START RELATIONAL
6479   304D D7            push a
6480   304E 11            mov a, b
6481   304F FA F9 FF      lea d, [bp + -7] ; $n
6482   3052 2A            mov b, [d]
6483   3053 B0            cmp a, b
6484   3054 FD 73         slt ; <= (signed)
6485   3056 E4            pop a
6486   3057             ; END RELATIONAL
6487   3057 C0 00 00      cmp b, 0
6488   305A C6 AE 34      je _for100_exit
6489   305D             _for100_block:
6490   305D             ;; ship_y = ship_y + x1; 
6491   305D 3B 05 63      mov d, _ship_y ; $ship_y
6492   3060 DA            push d
6493   3061 3B 05 63      mov d, _ship_y ; $ship_y
6494   3064 2A            mov b, [d]
6495   3065             ; START TERMS
6496   3065 D7            push a
6497   3066 11            mov a, b
6498   3067 FA ED FF      lea d, [bp + -19] ; $x1
6499   306A 2A            mov b, [d]
6500   306B 56            add b, a
6501   306C E4            pop a
6502   306D             ; END TERMS
6503   306D E7            pop d
6504   306E FD 43         mov [d], b
6505   3070             ;; ship_x = ship_x + x2; 
6506   3070 3B 07 63      mov d, _ship_x ; $ship_x
6507   3073 DA            push d
6508   3074 3B 07 63      mov d, _ship_x ; $ship_x
6509   3077 2A            mov b, [d]
6510   3078             ; START TERMS
6511   3078 D7            push a
6512   3079 11            mov a, b
6513   307A FA EB FF      lea d, [bp + -21] ; $x2
6514   307D 2A            mov b, [d]
6515   307E 56            add b, a
6516   307F E4            pop a
6517   3080             ; END TERMS
6518   3080 E7            pop d
6519   3081 FD 43         mov [d], b
6520   3083             ;; z1 = FROM_FIXED00(ship_y); 
6521   3083 FA F1 FF      lea d, [bp + -15] ; $z1
6522   3086 DA            push d
6523   3087 3B 05 63      mov d, _ship_y ; $ship_y
6524   308A 2A            mov b, [d]
6525   308B FD AB         swp b
6526   308D D8            push b
6527   308E 07 14 1D      call FROM_FIXED00
6528   3091 51 02 00      add sp, 2
6529   3094 E7            pop d
6530   3095 FD 43         mov [d], b
6531   3097             ;; z2 = FROM_FIXED00(ship_x);	/* ?? cint100 ?? */ 
6532   3097 FA EF FF      lea d, [bp + -17] ; $z2
6533   309A DA            push d
6534   309B 3B 07 63      mov d, _ship_x ; $ship_x
6535   309E 2A            mov b, [d]
6536   309F FD AB         swp b
6537   30A1 D8            push b
6538   30A2 07 14 1D      call FROM_FIXED00
6539   30A5 51 02 00      add sp, 2
6540   30A8 E7            pop d
6541   30A9 FD 43         mov [d], b
6542   30AB             ;; if (z1 < 1 || z1 >= 9 || z2 < 1 || z2 >= 9) { 
6543   30AB             _if101_cond:
6544   30AB FA F1 FF      lea d, [bp + -15] ; $z1
6545   30AE 2A            mov b, [d]
6546   30AF             ; START RELATIONAL
6547   30AF D7            push a
6548   30B0 11            mov a, b
6549   30B1 26 01 00      mov b, $1
6550   30B4 B0            cmp a, b
6551   30B5 FD 73         slt ; < (signed)
6552   30B7 E4            pop a
6553   30B8             ; END RELATIONAL
6554   30B8 D7            push a
6555   30B9 11            mov a, b
6556   30BA FA F1 FF      lea d, [bp + -15] ; $z1
6557   30BD 2A            mov b, [d]
6558   30BE             ; START RELATIONAL
6559   30BE D7            push a
6560   30BF 11            mov a, b
6561   30C0 26 09 00      mov b, $9
6562   30C3 B0            cmp a, b
6563   30C4 FD 80         sge ; >=
6564   30C6 E4            pop a
6565   30C7             ; END RELATIONAL
6566   30C7 FD A8         sor a, b ; ||
6567   30C9 11            mov a, b
6568   30CA FA EF FF      lea d, [bp + -17] ; $z2
6569   30CD 2A            mov b, [d]
6570   30CE             ; START RELATIONAL
6571   30CE D7            push a
6572   30CF 11            mov a, b
6573   30D0 26 01 00      mov b, $1
6574   30D3 B0            cmp a, b
6575   30D4 FD 73         slt ; < (signed)
6576   30D6 E4            pop a
6577   30D7             ; END RELATIONAL
6578   30D7 FD A8         sor a, b ; ||
6579   30D9 11            mov a, b
6580   30DA FA EF FF      lea d, [bp + -17] ; $z2
6581   30DD 2A            mov b, [d]
6582   30DE             ; START RELATIONAL
6583   30DE D7            push a
6584   30DF 11            mov a, b
6585   30E0 26 09 00      mov b, $9
6586   30E3 B0            cmp a, b
6587   30E4 FD 80         sge ; >=
6588   30E6 E4            pop a
6589   30E7             ; END RELATIONAL
6590   30E7 FD A8         sor a, b ; ||
6591   30E9 E4            pop a
6592   30EA C0 00 00      cmp b, 0
6593   30ED C6 FD 33      je _if101_exit
6594   30F0             _if101_true:
6595   30F0             ;; outside = 0;		/* Outside galaxy flag */ 
6596   30F0 FA E6 FF      lea d, [bp + -26] ; $outside
6597   30F3 DA            push d
6598   30F4 26 00 00      mov b, $0
6599   30F7 E7            pop d
6600   30F8 FD 3E         mov [d], bl
6601   30FA             ;; quad_y_old = quad_y; 
6602   30FA FA E5 FF      lea d, [bp + -27] ; $quad_y_old
6603   30FD DA            push d
6604   30FE 3B E6 62      mov d, _quad_y ; $quad_y
6605   3101 2A            mov b, [d]
6606   3102 E7            pop d
6607   3103 FD 3E         mov [d], bl
6608   3105             ;; quad_x_old = quad_x; 
6609   3105 FA E4 FF      lea d, [bp + -28] ; $quad_x_old
6610   3108 DA            push d
6611   3109 3B E8 62      mov d, _quad_x ; $quad_x
6612   310C 2A            mov b, [d]
6613   310D E7            pop d
6614   310E FD 3E         mov [d], bl
6615   3110             ;; x = (800 * quad_y) + x + (n * x1); 
6616   3110 FA E9 FF      lea d, [bp + -23] ; $x
6617   3113 DA            push d
6618   3114 26 20 03      mov b, $320
6619   3117             ; START FACTORS
6620   3117 D7            push a
6621   3118 11            mov a, b
6622   3119 3B E6 62      mov d, _quad_y ; $quad_y
6623   311C 2A            mov b, [d]
6624   311D AC            mul a, b ; *
6625   311E 11            mov a, b
6626   311F 27            mov b, a
6627   3120 E4            pop a
6628   3121             ; END FACTORS
6629   3121             ; START TERMS
6630   3121 D7            push a
6631   3122 11            mov a, b
6632   3123 FA E9 FF      lea d, [bp + -23] ; $x
6633   3126 2A            mov b, [d]
6634   3127 56            add b, a
6635   3128 11            mov a, b
6636   3129 FA F9 FF      lea d, [bp + -7] ; $n
6637   312C 2A            mov b, [d]
6638   312D             ; START FACTORS
6639   312D D7            push a
6640   312E 11            mov a, b
6641   312F FA ED FF      lea d, [bp + -19] ; $x1
6642   3132 2A            mov b, [d]
6643   3133 AC            mul a, b ; *
6644   3134 11            mov a, b
6645   3135 27            mov b, a
6646   3136 E4            pop a
6647   3137             ; END FACTORS
6648   3137 56            add b, a
6649   3138 E4            pop a
6650   3139             ; END TERMS
6651   3139 E7            pop d
6652   313A FD 43         mov [d], b
6653   313C             ;; y = (800 * quad_x) + y + (n * x2); 
6654   313C FA E7 FF      lea d, [bp + -25] ; $y
6655   313F DA            push d
6656   3140 26 20 03      mov b, $320
6657   3143             ; START FACTORS
6658   3143 D7            push a
6659   3144 11            mov a, b
6660   3145 3B E8 62      mov d, _quad_x ; $quad_x
6661   3148 2A            mov b, [d]
6662   3149 AC            mul a, b ; *
6663   314A 11            mov a, b
6664   314B 27            mov b, a
6665   314C E4            pop a
6666   314D             ; END FACTORS
6667   314D             ; START TERMS
6668   314D D7            push a
6669   314E 11            mov a, b
6670   314F FA E7 FF      lea d, [bp + -25] ; $y
6671   3152 2A            mov b, [d]
6672   3153 56            add b, a
6673   3154 11            mov a, b
6674   3155 FA F9 FF      lea d, [bp + -7] ; $n
6675   3158 2A            mov b, [d]
6676   3159             ; START FACTORS
6677   3159 D7            push a
6678   315A 11            mov a, b
6679   315B FA EB FF      lea d, [bp + -21] ; $x2
6680   315E 2A            mov b, [d]
6681   315F AC            mul a, b ; *
6682   3160 11            mov a, b
6683   3161 27            mov b, a
6684   3162 E4            pop a
6685   3163             ; END FACTORS
6686   3163 56            add b, a
6687   3164 E4            pop a
6688   3165             ; END TERMS
6689   3165 E7            pop d
6690   3166 FD 43         mov [d], b
6691   3168             ;; quad_y = x / 800;	/* Fixed point to int and divide by 8 */ 
6692   3168 3B E6 62      mov d, _quad_y ; $quad_y
6693   316B DA            push d
6694   316C FA E9 FF      lea d, [bp + -23] ; $x
6695   316F 2A            mov b, [d]
6696   3170             ; START FACTORS
6697   3170 D7            push a
6698   3171 11            mov a, b
6699   3172 26 20 03      mov b, $320
6700   3175 AE            div a, b
6701   3176 27            mov b, a
6702   3177 E4            pop a
6703   3178             ; END FACTORS
6704   3178 E7            pop d
6705   3179 FD 43         mov [d], b
6706   317B             ;; quad_x = y / 800;	/* Ditto */ 
6707   317B 3B E8 62      mov d, _quad_x ; $quad_x
6708   317E DA            push d
6709   317F FA E7 FF      lea d, [bp + -25] ; $y
6710   3182 2A            mov b, [d]
6711   3183             ; START FACTORS
6712   3183 D7            push a
6713   3184 11            mov a, b
6714   3185 26 20 03      mov b, $320
6715   3188 AE            div a, b
6716   3189 27            mov b, a
6717   318A E4            pop a
6718   318B             ; END FACTORS
6719   318B E7            pop d
6720   318C FD 43         mov [d], b
6721   318E             ;; ship_y = x - (quad_y * 800); 
6722   318E 3B 05 63      mov d, _ship_y ; $ship_y
6723   3191 DA            push d
6724   3192 FA E9 FF      lea d, [bp + -23] ; $x
6725   3195 2A            mov b, [d]
6726   3196             ; START TERMS
6727   3196 D7            push a
6728   3197 11            mov a, b
6729   3198 3B E6 62      mov d, _quad_y ; $quad_y
6730   319B 2A            mov b, [d]
6731   319C             ; START FACTORS
6732   319C D7            push a
6733   319D 11            mov a, b
6734   319E 26 20 03      mov b, $320
6735   31A1 AC            mul a, b ; *
6736   31A2 11            mov a, b
6737   31A3 27            mov b, a
6738   31A4 E4            pop a
6739   31A5             ; END FACTORS
6740   31A5 60            sub a, b
6741   31A6 27            mov b, a
6742   31A7 E4            pop a
6743   31A8             ; END TERMS
6744   31A8 E7            pop d
6745   31A9 FD 43         mov [d], b
6746   31AB             ;; ship_x = y - (quad_x * 800); 
6747   31AB 3B 07 63      mov d, _ship_x ; $ship_x
6748   31AE DA            push d
6749   31AF FA E7 FF      lea d, [bp + -25] ; $y
6750   31B2 2A            mov b, [d]
6751   31B3             ; START TERMS
6752   31B3 D7            push a
6753   31B4 11            mov a, b
6754   31B5 3B E8 62      mov d, _quad_x ; $quad_x
6755   31B8 2A            mov b, [d]
6756   31B9             ; START FACTORS
6757   31B9 D7            push a
6758   31BA 11            mov a, b
6759   31BB 26 20 03      mov b, $320
6760   31BE AC            mul a, b ; *
6761   31BF 11            mov a, b
6762   31C0 27            mov b, a
6763   31C1 E4            pop a
6764   31C2             ; END FACTORS
6765   31C2 60            sub a, b
6766   31C3 27            mov b, a
6767   31C4 E4            pop a
6768   31C5             ; END TERMS
6769   31C5 E7            pop d
6770   31C6 FD 43         mov [d], b
6771   31C8             ;; if (ship_y < 100) { 
6772   31C8             _if102_cond:
6773   31C8 3B 05 63      mov d, _ship_y ; $ship_y
6774   31CB 2A            mov b, [d]
6775   31CC             ; START RELATIONAL
6776   31CC D7            push a
6777   31CD 11            mov a, b
6778   31CE 26 64 00      mov b, $64
6779   31D1 B0            cmp a, b
6780   31D2 FD 73         slt ; < (signed)
6781   31D4 E4            pop a
6782   31D5             ; END RELATIONAL
6783   31D5 C0 00 00      cmp b, 0
6784   31D8 C6 03 32      je _if102_exit
6785   31DB             _if102_true:
6786   31DB             ;; quad_y = quad_y - 1; 
6787   31DB 3B E6 62      mov d, _quad_y ; $quad_y
6788   31DE DA            push d
6789   31DF 3B E6 62      mov d, _quad_y ; $quad_y
6790   31E2 2A            mov b, [d]
6791   31E3             ; START TERMS
6792   31E3 D7            push a
6793   31E4 11            mov a, b
6794   31E5 26 01 00      mov b, $1
6795   31E8 60            sub a, b
6796   31E9 27            mov b, a
6797   31EA E4            pop a
6798   31EB             ; END TERMS
6799   31EB E7            pop d
6800   31EC FD 43         mov [d], b
6801   31EE             ;; ship_y = ship_y + 800; 
6802   31EE 3B 05 63      mov d, _ship_y ; $ship_y
6803   31F1 DA            push d
6804   31F2 3B 05 63      mov d, _ship_y ; $ship_y
6805   31F5 2A            mov b, [d]
6806   31F6             ; START TERMS
6807   31F6 D7            push a
6808   31F7 11            mov a, b
6809   31F8 26 20 03      mov b, $320
6810   31FB 56            add b, a
6811   31FC E4            pop a
6812   31FD             ; END TERMS
6813   31FD E7            pop d
6814   31FE FD 43         mov [d], b
6815   3200 0A 03 32      jmp _if102_exit
6816   3203             _if102_exit:
6817   3203             ;; if (ship_x < 100) { 
6818   3203             _if103_cond:
6819   3203 3B 07 63      mov d, _ship_x ; $ship_x
6820   3206 2A            mov b, [d]
6821   3207             ; START RELATIONAL
6822   3207 D7            push a
6823   3208 11            mov a, b
6824   3209 26 64 00      mov b, $64
6825   320C B0            cmp a, b
6826   320D FD 73         slt ; < (signed)
6827   320F E4            pop a
6828   3210             ; END RELATIONAL
6829   3210 C0 00 00      cmp b, 0
6830   3213 C6 3E 32      je _if103_exit
6831   3216             _if103_true:
6832   3216             ;; quad_x = quad_x - 1; 
6833   3216 3B E8 62      mov d, _quad_x ; $quad_x
6834   3219 DA            push d
6835   321A 3B E8 62      mov d, _quad_x ; $quad_x
6836   321D 2A            mov b, [d]
6837   321E             ; START TERMS
6838   321E D7            push a
6839   321F 11            mov a, b
6840   3220 26 01 00      mov b, $1
6841   3223 60            sub a, b
6842   3224 27            mov b, a
6843   3225 E4            pop a
6844   3226             ; END TERMS
6845   3226 E7            pop d
6846   3227 FD 43         mov [d], b
6847   3229             ;; ship_x = ship_x + 800; 
6848   3229 3B 07 63      mov d, _ship_x ; $ship_x
6849   322C DA            push d
6850   322D 3B 07 63      mov d, _ship_x ; $ship_x
6851   3230 2A            mov b, [d]
6852   3231             ; START TERMS
6853   3231 D7            push a
6854   3232 11            mov a, b
6855   3233 26 20 03      mov b, $320
6856   3236 56            add b, a
6857   3237 E4            pop a
6858   3238             ; END TERMS
6859   3238 E7            pop d
6860   3239 FD 43         mov [d], b
6861   323B 0A 3E 32      jmp _if103_exit
6862   323E             _if103_exit:
6863   323E             ;; if (quad_y < 1) { 
6864   323E             _if104_cond:
6865   323E 3B E6 62      mov d, _quad_y ; $quad_y
6866   3241 2A            mov b, [d]
6867   3242             ; START RELATIONAL
6868   3242 D7            push a
6869   3243 11            mov a, b
6870   3244 26 01 00      mov b, $1
6871   3247 B0            cmp a, b
6872   3248 FD 73         slt ; < (signed)
6873   324A E4            pop a
6874   324B             ; END RELATIONAL
6875   324B C0 00 00      cmp b, 0
6876   324E C6 72 32      je _if104_exit
6877   3251             _if104_true:
6878   3251             ;; outside = 1; 
6879   3251 FA E6 FF      lea d, [bp + -26] ; $outside
6880   3254 DA            push d
6881   3255 26 01 00      mov b, $1
6882   3258 E7            pop d
6883   3259 FD 3E         mov [d], bl
6884   325B             ;; quad_y = 1; 
6885   325B 3B E6 62      mov d, _quad_y ; $quad_y
6886   325E DA            push d
6887   325F 26 01 00      mov b, $1
6888   3262 E7            pop d
6889   3263 FD 43         mov [d], b
6890   3265             ;; ship_y = 100; 
6891   3265 3B 05 63      mov d, _ship_y ; $ship_y
6892   3268 DA            push d
6893   3269 26 64 00      mov b, $64
6894   326C E7            pop d
6895   326D FD 43         mov [d], b
6896   326F 0A 72 32      jmp _if104_exit
6897   3272             _if104_exit:
6898   3272             ;; if (quad_y > 8) { 
6899   3272             _if105_cond:
6900   3272 3B E6 62      mov d, _quad_y ; $quad_y
6901   3275 2A            mov b, [d]
6902   3276             ; START RELATIONAL
6903   3276 D7            push a
6904   3277 11            mov a, b
6905   3278 26 08 00      mov b, $8
6906   327B B0            cmp a, b
6907   327C FD 7F         sgt ; >
6908   327E E4            pop a
6909   327F             ; END RELATIONAL
6910   327F C0 00 00      cmp b, 0
6911   3282 C6 A6 32      je _if105_exit
6912   3285             _if105_true:
6913   3285             ;; outside = 1; 
6914   3285 FA E6 FF      lea d, [bp + -26] ; $outside
6915   3288 DA            push d
6916   3289 26 01 00      mov b, $1
6917   328C E7            pop d
6918   328D FD 3E         mov [d], bl
6919   328F             ;; quad_y = 8; 
6920   328F 3B E6 62      mov d, _quad_y ; $quad_y
6921   3292 DA            push d
6922   3293 26 08 00      mov b, $8
6923   3296 E7            pop d
6924   3297 FD 43         mov [d], b
6925   3299             ;; ship_y = 800; 
6926   3299 3B 05 63      mov d, _ship_y ; $ship_y
6927   329C DA            push d
6928   329D 26 20 03      mov b, $320
6929   32A0 E7            pop d
6930   32A1 FD 43         mov [d], b
6931   32A3 0A A6 32      jmp _if105_exit
6932   32A6             _if105_exit:
6933   32A6             ;; if (quad_x < 1) { 
6934   32A6             _if106_cond:
6935   32A6 3B E8 62      mov d, _quad_x ; $quad_x
6936   32A9 2A            mov b, [d]
6937   32AA             ; START RELATIONAL
6938   32AA D7            push a
6939   32AB 11            mov a, b
6940   32AC 26 01 00      mov b, $1
6941   32AF B0            cmp a, b
6942   32B0 FD 73         slt ; < (signed)
6943   32B2 E4            pop a
6944   32B3             ; END RELATIONAL
6945   32B3 C0 00 00      cmp b, 0
6946   32B6 C6 DA 32      je _if106_exit
6947   32B9             _if106_true:
6948   32B9             ;; outside = 1; 
6949   32B9 FA E6 FF      lea d, [bp + -26] ; $outside
6950   32BC DA            push d
6951   32BD 26 01 00      mov b, $1
6952   32C0 E7            pop d
6953   32C1 FD 3E         mov [d], bl
6954   32C3             ;; quad_x = 1; 
6955   32C3 3B E8 62      mov d, _quad_x ; $quad_x
6956   32C6 DA            push d
6957   32C7 26 01 00      mov b, $1
6958   32CA E7            pop d
6959   32CB FD 43         mov [d], b
6960   32CD             ;; ship_x = 100; 
6961   32CD 3B 07 63      mov d, _ship_x ; $ship_x
6962   32D0 DA            push d
6963   32D1 26 64 00      mov b, $64
6964   32D4 E7            pop d
6965   32D5 FD 43         mov [d], b
6966   32D7 0A DA 32      jmp _if106_exit
6967   32DA             _if106_exit:
6968   32DA             ;; if (quad_x > 8) { 
6969   32DA             _if107_cond:
6970   32DA 3B E8 62      mov d, _quad_x ; $quad_x
6971   32DD 2A            mov b, [d]
6972   32DE             ; START RELATIONAL
6973   32DE D7            push a
6974   32DF 11            mov a, b
6975   32E0 26 08 00      mov b, $8
6976   32E3 B0            cmp a, b
6977   32E4 FD 7F         sgt ; >
6978   32E6 E4            pop a
6979   32E7             ; END RELATIONAL
6980   32E7 C0 00 00      cmp b, 0
6981   32EA C6 0E 33      je _if107_exit
6982   32ED             _if107_true:
6983   32ED             ;; outside = 1; 
6984   32ED FA E6 FF      lea d, [bp + -26] ; $outside
6985   32F0 DA            push d
6986   32F1 26 01 00      mov b, $1
6987   32F4 E7            pop d
6988   32F5 FD 3E         mov [d], bl
6989   32F7             ;; quad_x = 8; 
6990   32F7 3B E8 62      mov d, _quad_x ; $quad_x
6991   32FA DA            push d
6992   32FB 26 08 00      mov b, $8
6993   32FE E7            pop d
6994   32FF FD 43         mov [d], b
6995   3301             ;; ship_x = 800; 
6996   3301 3B 07 63      mov d, _ship_x ; $ship_x
6997   3304 DA            push d
6998   3305 26 20 03      mov b, $320
6999   3308 E7            pop d
7000   3309 FD 43         mov [d], b
7001   330B 0A 0E 33      jmp _if107_exit
7002   330E             _if107_exit:
7003   330E             ;; if (outside == 1) { 
7004   330E             _if108_cond:
7005   330E FA E6 FF      lea d, [bp + -26] ; $outside
7006   3311 32            mov bl, [d]
7007   3312 A7 00         mov bh, 0
7008   3314             ; START RELATIONAL
7009   3314 D7            push a
7010   3315 11            mov a, b
7011   3316 26 01 00      mov b, $1
7012   3319 B0            cmp a, b
7013   331A FD 71         seq ; ==
7014   331C E4            pop a
7015   331D             ; END RELATIONAL
7016   331D C0 00 00      cmp b, 0
7017   3320 C6 60 33      je _if108_exit
7018   3323             _if108_true:
7019   3323             ;; printf("LT. Uhura reports:\n Message from Starfleet Command:\n\n Permission to attempt crossing of galactic perimeter\n is hereby *denied*. Shut down your engines.\n\n Chief Engineer Scott reports:\n Warp Engines shut down at sector %d, %d of quadrant %d, %d.\n\n", FROM_FIXED00(ship_y), 
7020   3323 3B E8 62      mov d, _quad_x ; $quad_x
7021   3326 2A            mov b, [d]
7022   3327 FD AB         swp b
7023   3329 D8            push b
7024   332A 3B E6 62      mov d, _quad_y ; $quad_y
7025   332D 2A            mov b, [d]
7026   332E FD AB         swp b
7027   3330 D8            push b
7028   3331 3B 07 63      mov d, _ship_x ; $ship_x
7029   3334 2A            mov b, [d]
7030   3335 FD AB         swp b
7031   3337 D8            push b
7032   3338 07 14 1D      call FROM_FIXED00
7033   333B 51 02 00      add sp, 2
7034   333E FD AB         swp b
7035   3340 D8            push b
7036   3341 3B 05 63      mov d, _ship_y ; $ship_y
7037   3344 2A            mov b, [d]
7038   3345 FD AB         swp b
7039   3347 D8            push b
7040   3348 07 14 1D      call FROM_FIXED00
7041   334B 51 02 00      add sp, 2
7042   334E FD AB         swp b
7043   3350 D8            push b
7044   3351 26 C4 69      mov b, __s73 ; "LT. Uhura reports:\n Message from Starfleet Command:\n\n Permission to attempt crossing of galactic perimeter\n is hereby *denied*. Shut down your engines.\n\n Chief Engineer Scott reports:\n Warp Engines shut down at sector %d, %d of quadrant %d, %d.\n\n"
7045   3354 FD AB         swp b
7046   3356 D8            push b
7047   3357 07 D1 05      call printf
7048   335A 51 0A 00      add sp, 10
7049   335D 0A 60 33      jmp _if108_exit
7050   3360             _if108_exit:
7051   3360             ;; maneuver_energy(n); 
7052   3360 FA F9 FF      lea d, [bp + -7] ; $n
7053   3363 2A            mov b, [d]
7054   3364 FD AB         swp b
7055   3366 D8            push b
7056   3367 07 63 35      call maneuver_energy
7057   336A 51 02 00      add sp, 2
7058   336D             ;; if (FROM_FIXED(stardate) > time_start + time_up) 
7059   336D             _if109_cond:
7060   336D 3B 09 63      mov d, _stardate ; $stardate
7061   3370 2A            mov b, [d]
7062   3371 FD AB         swp b
7063   3373 D8            push b
7064   3374 07 F1 1C      call FROM_FIXED
7065   3377 51 02 00      add sp, 2
7066   337A             ; START RELATIONAL
7067   337A D7            push a
7068   337B 11            mov a, b
7069   337C 3B ED 62      mov d, _time_start ; $time_start
7070   337F 2A            mov b, [d]
7071   3380             ; START TERMS
7072   3380 D7            push a
7073   3381 11            mov a, b
7074   3382 3B EF 62      mov d, _time_up ; $time_up
7075   3385 2A            mov b, [d]
7076   3386 56            add b, a
7077   3387 E4            pop a
7078   3388             ; END TERMS
7079   3388 B0            cmp a, b
7080   3389 FD 7F         sgt ; >
7081   338B E4            pop a
7082   338C             ; END RELATIONAL
7083   338C C0 00 00      cmp b, 0
7084   338F C6 98 33      je _if109_exit
7085   3392             _if109_true:
7086   3392             ;; end_of_time(); 
7087   3392 07 37 56      call end_of_time
7088   3395 0A 98 33      jmp _if109_exit
7089   3398             _if109_exit:
7090   3398             ;; if (quad_y != quad_y_old || quad_x != quad_x_old) { 
7091   3398             _if110_cond:
7092   3398 3B E6 62      mov d, _quad_y ; $quad_y
7093   339B 2A            mov b, [d]
7094   339C             ; START RELATIONAL
7095   339C D7            push a
7096   339D 11            mov a, b
7097   339E FA E5 FF      lea d, [bp + -27] ; $quad_y_old
7098   33A1 32            mov bl, [d]
7099   33A2 A7 00         mov bh, 0
7100   33A4 B0            cmp a, b
7101   33A5 FD 72         sneq ; !=
7102   33A7 E4            pop a
7103   33A8             ; END RELATIONAL
7104   33A8 D7            push a
7105   33A9 11            mov a, b
7106   33AA 3B E8 62      mov d, _quad_x ; $quad_x
7107   33AD 2A            mov b, [d]
7108   33AE             ; START RELATIONAL
7109   33AE D7            push a
7110   33AF 11            mov a, b
7111   33B0 FA E4 FF      lea d, [bp + -28] ; $quad_x_old
7112   33B3 32            mov bl, [d]
7113   33B4 A7 00         mov bh, 0
7114   33B6 B0            cmp a, b
7115   33B7 FD 72         sneq ; !=
7116   33B9 E4            pop a
7117   33BA             ; END RELATIONAL
7118   33BA FD A8         sor a, b ; ||
7119   33BC E4            pop a
7120   33BD C0 00 00      cmp b, 0
7121   33C0 C6 E4 33      je _if110_exit
7122   33C3             _if110_true:
7123   33C3             ;; stardate = stardate + TO_FIXED(1); 
7124   33C3 3B 09 63      mov d, _stardate ; $stardate
7125   33C6 DA            push d
7126   33C7 3B 09 63      mov d, _stardate ; $stardate
7127   33CA 2A            mov b, [d]
7128   33CB             ; START TERMS
7129   33CB D7            push a
7130   33CC 11            mov a, b
7131   33CD 26 01 00      mov b, $1
7132   33D0 FD AB         swp b
7133   33D2 D8            push b
7134   33D3 07 DF 1C      call TO_FIXED
7135   33D6 51 02 00      add sp, 2
7136   33D9 56            add b, a
7137   33DA E4            pop a
7138   33DB             ; END TERMS
7139   33DB E7            pop d
7140   33DC FD 43         mov [d], b
7141   33DE             ;; new_quadrant(); 
7142   33DE 07 08 29      call new_quadrant
7143   33E1 0A E4 33      jmp _if110_exit
7144   33E4             _if110_exit:
7145   33E4             ;; complete_maneuver(warp, n); 
7146   33E4 FA F9 FF      lea d, [bp + -7] ; $n
7147   33E7 2A            mov b, [d]
7148   33E8 FD AB         swp b
7149   33EA D8            push b
7150   33EB FA FB FF      lea d, [bp + -5] ; $warp
7151   33EE 2A            mov b, [d]
7152   33EF FD AB         swp b
7153   33F1 D8            push b
7154   33F2 07 C4 34      call complete_maneuver
7155   33F5 51 04 00      add sp, 4
7156   33F8             ;; return; 
7157   33F8 F9            leave
7158   33F9 09            ret
7159   33FA 0A FD 33      jmp _if101_exit
7160   33FD             _if101_exit:
7161   33FD             ;; if (quad[z1+-1][z2+-1] !=  		0      ) {	/* Sector not empty */ 
7162   33FD             _if111_cond:
7163   33FD 3B 0B 63      mov d, _quad_data ; $quad
7164   3400 D7            push a
7165   3401 DA            push d
7166   3402 FA F1 FF      lea d, [bp + -15] ; $z1
7167   3405 2A            mov b, [d]
7168   3406             ; START TERMS
7169   3406 D7            push a
7170   3407 11            mov a, b
7171   3408 26 FF FF      mov b, 65535
7172   340B 38 FF FF      mov c, 65535
7173   340E 54            add a, b
7174   340F D7            push a
7175   3410 FD 12         mov a, g
7176   3412 28            mov b, c
7177   3413 5C            adc a, b
7178   3414 39            mov c, a
7179   3415 E5            pop b
7180   3416 E4            pop a
7181   3417             ; END TERMS
7182   3417 E7            pop d
7183   3418 FD 13 08 00   mma 8 ; mov a, 8; mul a, b; add d, b
7184   341C DA            push d
7185   341D FA EF FF      lea d, [bp + -17] ; $z2
7186   3420 2A            mov b, [d]
7187   3421             ; START TERMS
7188   3421 D7            push a
7189   3422 11            mov a, b
7190   3423 26 FF FF      mov b, 65535
7191   3426 38 FF FF      mov c, 65535
7192   3429 54            add a, b
7193   342A D7            push a
7194   342B FD 12         mov a, g
7195   342D 28            mov b, c
7196   342E 5C            adc a, b
7197   342F 39            mov c, a
7198   3430 E5            pop b
7199   3431 E4            pop a
7200   3432             ; END TERMS
7201   3432 E7            pop d
7202   3433 5A            add d, b
7203   3434 E4            pop a
7204   3435 32            mov bl, [d]
7205   3436 A7 00         mov bh, 0
7206   3438             ; START RELATIONAL
7207   3438 D7            push a
7208   3439 11            mov a, b
7209   343A 26 00 00      mov b, $0
7210   343D B0            cmp a, b
7211   343E FD 72         sneq ; !=
7212   3440 E4            pop a
7213   3441             ; END RELATIONAL
7214   3441 C0 00 00      cmp b, 0
7215   3444 C6 9E 34      je _if111_exit
7216   3447             _if111_true:
7217   3447             ;; ship_y = ship_y - x1; 
7218   3447 3B 05 63      mov d, _ship_y ; $ship_y
7219   344A DA            push d
7220   344B 3B 05 63      mov d, _ship_y ; $ship_y
7221   344E 2A            mov b, [d]
7222   344F             ; START TERMS
7223   344F D7            push a
7224   3450 11            mov a, b
7225   3451 FA ED FF      lea d, [bp + -19] ; $x1
7226   3454 2A            mov b, [d]
7227   3455 60            sub a, b
7228   3456 27            mov b, a
7229   3457 E4            pop a
7230   3458             ; END TERMS
7231   3458 E7            pop d
7232   3459 FD 43         mov [d], b
7233   345B             ;; ship_x = ship_x - x2; 
7234   345B 3B 07 63      mov d, _ship_x ; $ship_x
7235   345E DA            push d
7236   345F 3B 07 63      mov d, _ship_x ; $ship_x
7237   3462 2A            mov b, [d]
7238   3463             ; START TERMS
7239   3463 D7            push a
7240   3464 11            mov a, b
7241   3465 FA EB FF      lea d, [bp + -21] ; $x2
7242   3468 2A            mov b, [d]
7243   3469 60            sub a, b
7244   346A 27            mov b, a
7245   346B E4            pop a
7246   346C             ; END TERMS
7247   346C E7            pop d
7248   346D FD 43         mov [d], b
7249   346F             ;; printf("Warp Engines shut down at sector %d, %d due to bad navigation.\n\n", z1, z2); 
7250   346F FA EF FF      lea d, [bp + -17] ; $z2
7251   3472 2A            mov b, [d]
7252   3473 FD AB         swp b
7253   3475 D8            push b
7254   3476 FA F1 FF      lea d, [bp + -15] ; $z1
7255   3479 2A            mov b, [d]
7256   347A FD AB         swp b
7257   347C D8            push b
7258   347D 26 C5 69      mov b, __s74 ; "Warp Engines shut down at sector %d, %d due to bad navigation.\n\n"
7259   3480 FD AB         swp b
7260   3482 D8            push b
7261   3483 07 D1 05      call printf
7262   3486 51 06 00      add sp, 6
7263   3489             ;; i = n + 1; 
7264   3489 FA FF FF      lea d, [bp + -1] ; $i
7265   348C DA            push d
7266   348D FA F9 FF      lea d, [bp + -7] ; $n
7267   3490 2A            mov b, [d]
7268   3491             ; START TERMS
7269   3491 D7            push a
7270   3492 11            mov a, b
7271   3493 26 01 00      mov b, $1
7272   3496 56            add b, a
7273   3497 E4            pop a
7274   3498             ; END TERMS
7275   3498 E7            pop d
7276   3499 FD 43         mov [d], b
7277   349B 0A 9E 34      jmp _if111_exit
7278   349E             _if111_exit:
7279   349E             _for100_update:
7280   349E FA FF FF      lea d, [bp + -1] ; $i
7281   34A1 2A            mov b, [d]
7282   34A2 D8            push b
7283   34A3 FD 77         inc b
7284   34A5 FA FF FF      lea d, [bp + -1] ; $i
7285   34A8 FD 43         mov [d], b
7286   34AA E5            pop b
7287   34AB 0A 49 30      jmp _for100_cond
7288   34AE             _for100_exit:
7289   34AE             ;; complete_maneuver(warp, n); 
7290   34AE FA F9 FF      lea d, [bp + -7] ; $n
7291   34B1 2A            mov b, [d]
7292   34B2 FD AB         swp b
7293   34B4 D8            push b
7294   34B5 FA FB FF      lea d, [bp + -5] ; $warp
7295   34B8 2A            mov b, [d]
7296   34B9 FD AB         swp b
7297   34BB D8            push b
7298   34BC 07 C4 34      call complete_maneuver
7299   34BF 51 04 00      add sp, 4
7300   34C2 F9            leave
7301   34C3 09            ret
7302   34C4             
7303   34C4             complete_maneuver:
7304   34C4 F8 00 00      enter 0 ; (push bp; mov bp, sp)
7305   34C7             ; $time_used 
7306   34C7 52 02 00      sub sp, 2
7307   34CA             ;; place_ship(); 
7308   34CA 07 C4 28      call place_ship
7309   34CD             ;; maneuver_energy(n); 
7310   34CD FA 07 00      lea d, [bp + 7] ; $n
7311   34D0 2A            mov b, [d]
7312   34D1 FD AB         swp b
7313   34D3 D8            push b
7314   34D4 07 63 35      call maneuver_energy
7315   34D7 51 02 00      add sp, 2
7316   34DA             ;; time_used = TO_FIXED(1); 
7317   34DA FA FF FF      lea d, [bp + -1] ; $time_used
7318   34DD DA            push d
7319   34DE 26 01 00      mov b, $1
7320   34E1 FD AB         swp b
7321   34E3 D8            push b
7322   34E4 07 DF 1C      call TO_FIXED
7323   34E7 51 02 00      add sp, 2
7324   34EA E7            pop d
7325   34EB FD 43         mov [d], b
7326   34ED             ;; if (warp < 100) 
7327   34ED             _if112_cond:
7328   34ED FA 05 00      lea d, [bp + 5] ; $warp
7329   34F0 2A            mov b, [d]
7330   34F1             ; START RELATIONAL
7331   34F1 D7            push a
7332   34F2 11            mov a, b
7333   34F3 26 64 00      mov b, $64
7334   34F6 B0            cmp a, b
7335   34F7 FD 75         slu ; < (unsigned)
7336   34F9 E4            pop a
7337   34FA             ; END RELATIONAL
7338   34FA C0 00 00      cmp b, 0
7339   34FD C6 20 35      je _if112_exit
7340   3500             _if112_true:
7341   3500             ;; time_used = TO_FIXED(FROM_FIXED00(warp)); 
7342   3500 FA FF FF      lea d, [bp + -1] ; $time_used
7343   3503 DA            push d
7344   3504 FA 05 00      lea d, [bp + 5] ; $warp
7345   3507 2A            mov b, [d]
7346   3508 FD AB         swp b
7347   350A D8            push b
7348   350B 07 14 1D      call FROM_FIXED00
7349   350E 51 02 00      add sp, 2
7350   3511 FD AB         swp b
7351   3513 D8            push b
7352   3514 07 DF 1C      call TO_FIXED
7353   3517 51 02 00      add sp, 2
7354   351A E7            pop d
7355   351B FD 43         mov [d], b
7356   351D 0A 20 35      jmp _if112_exit
7357   3520             _if112_exit:
7358   3520             ;; stardate = stardate + time_used; 
7359   3520 3B 09 63      mov d, _stardate ; $stardate
7360   3523 DA            push d
7361   3524 3B 09 63      mov d, _stardate ; $stardate
7362   3527 2A            mov b, [d]
7363   3528             ; START TERMS
7364   3528 D7            push a
7365   3529 11            mov a, b
7366   352A FA FF FF      lea d, [bp + -1] ; $time_used
7367   352D 2A            mov b, [d]
7368   352E 56            add b, a
7369   352F E4            pop a
7370   3530             ; END TERMS
7371   3530 E7            pop d
7372   3531 FD 43         mov [d], b
7373   3533             ;; if (FROM_FIXED(stardate) > time_start + time_up) 
7374   3533             _if113_cond:
7375   3533 3B 09 63      mov d, _stardate ; $stardate
7376   3536 2A            mov b, [d]
7377   3537 FD AB         swp b
7378   3539 D8            push b
7379   353A 07 F1 1C      call FROM_FIXED
7380   353D 51 02 00      add sp, 2
7381   3540             ; START RELATIONAL
7382   3540 D7            push a
7383   3541 11            mov a, b
7384   3542 3B ED 62      mov d, _time_start ; $time_start
7385   3545 2A            mov b, [d]
7386   3546             ; START TERMS
7387   3546 D7            push a
7388   3547 11            mov a, b
7389   3548 3B EF 62      mov d, _time_up ; $time_up
7390   354B 2A            mov b, [d]
7391   354C 56            add b, a
7392   354D E4            pop a
7393   354E             ; END TERMS
7394   354E B0            cmp a, b
7395   354F FD 7F         sgt ; >
7396   3551 E4            pop a
7397   3552             ; END RELATIONAL
7398   3552 C0 00 00      cmp b, 0
7399   3555 C6 5E 35      je _if113_exit
7400   3558             _if113_true:
7401   3558             ;; end_of_time(); 
7402   3558 07 37 56      call end_of_time
7403   355B 0A 5E 35      jmp _if113_exit
7404   355E             _if113_exit:
7405   355E             ;; short_range_scan(); 
7406   355E 07 E2 35      call short_range_scan
7407   3561 F9            leave
7408   3562 09            ret
7409   3563             
7410   3563             maneuver_energy:
7411   3563 F8 00 00      enter 0 ; (push bp; mov bp, sp)
7412   3566             ;; energy = energy - n + 10; 
7413   3566 3B 2F 62      mov d, _energy ; $energy
7414   3569 DA            push d
7415   356A 3B 2F 62      mov d, _energy ; $energy
7416   356D 2A            mov b, [d]
7417   356E             ; START TERMS
7418   356E D7            push a
7419   356F 11            mov a, b
7420   3570 FA 05 00      lea d, [bp + 5] ; $n
7421   3573 2A            mov b, [d]
7422   3574 60            sub a, b
7423   3575 27            mov b, a
7424   3576 11            mov a, b
7425   3577 26 0A 00      mov b, $a
7426   357A 56            add b, a
7427   357B E4            pop a
7428   357C             ; END TERMS
7429   357C E7            pop d
7430   357D FD 43         mov [d], b
7431   357F             ;; if (energy >= 0) 
7432   357F             _if114_cond:
7433   357F 3B 2F 62      mov d, _energy ; $energy
7434   3582 2A            mov b, [d]
7435   3583             ; START RELATIONAL
7436   3583 D7            push a
7437   3584 11            mov a, b
7438   3585 26 00 00      mov b, $0
7439   3588 B0            cmp a, b
7440   3589 FD 80         sge ; >=
7441   358B E4            pop a
7442   358C             ; END RELATIONAL
7443   358C C0 00 00      cmp b, 0
7444   358F C6 97 35      je _if114_exit
7445   3592             _if114_true:
7446   3592             ;; return; 
7447   3592 F9            leave
7448   3593 09            ret
7449   3594 0A 97 35      jmp _if114_exit
7450   3597             _if114_exit:
7451   3597             ;; puts("Shield Control supplies energy to complete maneuver.\n"); 
7452   3597 26 06 6A      mov b, __s75 ; "Shield Control supplies energy to complete maneuver.\n"
7453   359A FD AB         swp b
7454   359C D8            push b
7455   359D 07 37 13      call puts
7456   35A0 51 02 00      add sp, 2
7457   35A3             ;; shield = shield + energy; 
7458   35A3 3B EA 62      mov d, _shield ; $shield
7459   35A6 DA            push d
7460   35A7 3B EA 62      mov d, _shield ; $shield
7461   35AA 2A            mov b, [d]
7462   35AB             ; START TERMS
7463   35AB D7            push a
7464   35AC 11            mov a, b
7465   35AD 3B 2F 62      mov d, _energy ; $energy
7466   35B0 2A            mov b, [d]
7467   35B1 56            add b, a
7468   35B2 E4            pop a
7469   35B3             ; END TERMS
7470   35B3 E7            pop d
7471   35B4 FD 43         mov [d], b
7472   35B6             ;; energy = 0; 
7473   35B6 3B 2F 62      mov d, _energy ; $energy
7474   35B9 DA            push d
7475   35BA 26 00 00      mov b, $0
7476   35BD E7            pop d
7477   35BE FD 43         mov [d], b
7478   35C0             ;; if (shield <= 0) 
7479   35C0             _if115_cond:
7480   35C0 3B EA 62      mov d, _shield ; $shield
7481   35C3 2A            mov b, [d]
7482   35C4             ; START RELATIONAL
7483   35C4 D7            push a
7484   35C5 11            mov a, b
7485   35C6 26 00 00      mov b, $0
7486   35C9 B0            cmp a, b
7487   35CA FD 73         slt ; <= (signed)
7488   35CC E4            pop a
7489   35CD             ; END RELATIONAL
7490   35CD C0 00 00      cmp b, 0
7491   35D0 C6 E0 35      je _if115_exit
7492   35D3             _if115_true:
7493   35D3             ;; shield = 0; 
7494   35D3 3B EA 62      mov d, _shield ; $shield
7495   35D6 DA            push d
7496   35D7 26 00 00      mov b, $0
7497   35DA E7            pop d
7498   35DB FD 43         mov [d], b
7499   35DD 0A E0 35      jmp _if115_exit
7500   35E0             _if115_exit:
7501   35E0 F9            leave
7502   35E1 09            ret
7503   35E2             
7504   35E2             short_range_scan:
7505   35E2 F8 00 00      enter 0 ; (push bp; mov bp, sp)
7506   35E5             ; $i 
7507   35E5             ; $j 
7508   35E5             ; $sC 
7509   35E5 10 E9 64      mov a, _sC_data
7510   35E8 45 FB FF      mov [bp + -5], a
7511   35EB 52 06 00      sub sp, 6
7512   35EE             ;; if (energy < energy0 / 10) 
7513   35EE             _if116_cond:
7514   35EE 3B 2F 62      mov d, _energy ; $energy
7515   35F1 2A            mov b, [d]
7516   35F2             ; START RELATIONAL
7517   35F2 D7            push a
7518   35F3 11            mov a, b
7519   35F4 3B 31 62      mov d, _energy0 ; $energy0
7520   35F7 2A            mov b, [d]
7521   35F8             ; START FACTORS
7522   35F8 D7            push a
7523   35F9 11            mov a, b
7524   35FA 26 0A 00      mov b, $a
7525   35FD AE            div a, b
7526   35FE 27            mov b, a
7527   35FF E4            pop a
7528   3600             ; END FACTORS
7529   3600 B0            cmp a, b
7530   3601 FD 73         slt ; < (signed)
7531   3603 E4            pop a
7532   3604             ; END RELATIONAL
7533   3604 C0 00 00      cmp b, 0
7534   3607 C6 17 36      je _if116_exit
7535   360A             _if116_true:
7536   360A             ;; sC = "YELLOW"; 
7537   360A FA FB FF      lea d, [bp + -5] ; $sC
7538   360D DA            push d
7539   360E 26 3C 6A      mov b, __s76 ; "YELLOW"
7540   3611 E7            pop d
7541   3612 FD 43         mov [d], b
7542   3614 0A 17 36      jmp _if116_exit
7543   3617             _if116_exit:
7544   3617             ;; if (klingons > 0) 
7545   3617             _if117_cond:
7546   3617 3B E1 62      mov d, _klingons ; $klingons
7547   361A 32            mov bl, [d]
7548   361B A7 00         mov bh, 0
7549   361D             ; START RELATIONAL
7550   361D D7            push a
7551   361E 11            mov a, b
7552   361F 26 00 00      mov b, $0
7553   3622 B0            cmp a, b
7554   3623 FD 81         sgu ; > (unsigned)
7555   3625 E4            pop a
7556   3626             ; END RELATIONAL
7557   3626 C0 00 00      cmp b, 0
7558   3629 C6 39 36      je _if117_exit
7559   362C             _if117_true:
7560   362C             ;; sC = "*RED*"; 
7561   362C FA FB FF      lea d, [bp + -5] ; $sC
7562   362F DA            push d
7563   3630 26 43 6A      mov b, __s77 ; "*RED*"
7564   3633 E7            pop d
7565   3634 FD 43         mov [d], b
7566   3636 0A 39 36      jmp _if117_exit
7567   3639             _if117_exit:
7568   3639             ;; docked = 0; 
7569   3639 3B 2E 62      mov d, _docked ; $docked
7570   363C DA            push d
7571   363D 26 00 00      mov b, $0
7572   3640 E7            pop d
7573   3641 FD 3E         mov [d], bl
7574   3643             ;; for (i = (int) (FROM_FIXED00(ship_y) - 1); i <= (int) (FROM_FIXED00(ship_y) + 1); i++) 
7575   3643             _for118_init:
7576   3643 FA FF FF      lea d, [bp + -1] ; $i
7577   3646 DA            push d
7578   3647 3B 05 63      mov d, _ship_y ; $ship_y
7579   364A 2A            mov b, [d]
7580   364B FD AB         swp b
7581   364D D8            push b
7582   364E 07 14 1D      call FROM_FIXED00
7583   3651 51 02 00      add sp, 2
7584   3654             ; START TERMS
7585   3654 D7            push a
7586   3655 11            mov a, b
7587   3656 26 01 00      mov b, $1
7588   3659 60            sub a, b
7589   365A 27            mov b, a
7590   365B E4            pop a
7591   365C             ; END TERMS
7592   365C E7            pop d
7593   365D FD 43         mov [d], b
7594   365F             _for118_cond:
7595   365F FA FF FF      lea d, [bp + -1] ; $i
7596   3662 2A            mov b, [d]
7597   3663             ; START RELATIONAL
7598   3663 D7            push a
7599   3664 11            mov a, b
7600   3665 3B 05 63      mov d, _ship_y ; $ship_y
7601   3668 2A            mov b, [d]
7602   3669 FD AB         swp b
7603   366B D8            push b
7604   366C 07 14 1D      call FROM_FIXED00
7605   366F 51 02 00      add sp, 2
7606   3672             ; START TERMS
7607   3672 D7            push a
7608   3673 11            mov a, b
7609   3674 26 01 00      mov b, $1
7610   3677 56            add b, a
7611   3678 E4            pop a
7612   3679             ; END TERMS
7613   3679 B0            cmp a, b
7614   367A FD 73         slt ; <= (signed)
7615   367C E4            pop a
7616   367D             ; END RELATIONAL
7617   367D C0 00 00      cmp b, 0
7618   3680 C6 BA 37      je _for118_exit
7619   3683             _for118_block:
7620   3683             ;; for (j = (int) (FROM_FIXED00(ship_x) - 1); j <= (int) (FROM_FIXED00(ship_x) + 1); j++) 
7621   3683             _for119_init:
7622   3683 FA FD FF      lea d, [bp + -3] ; $j
7623   3686 DA            push d
7624   3687 3B 07 63      mov d, _ship_x ; $ship_x
7625   368A 2A            mov b, [d]
7626   368B FD AB         swp b
7627   368D D8            push b
7628   368E 07 14 1D      call FROM_FIXED00
7629   3691 51 02 00      add sp, 2
7630   3694             ; START TERMS
7631   3694 D7            push a
7632   3695 11            mov a, b
7633   3696 26 01 00      mov b, $1
7634   3699 60            sub a, b
7635   369A 27            mov b, a
7636   369B E4            pop a
7637   369C             ; END TERMS
7638   369C E7            pop d
7639   369D FD 43         mov [d], b
7640   369F             _for119_cond:
7641   369F FA FD FF      lea d, [bp + -3] ; $j
7642   36A2 2A            mov b, [d]
7643   36A3             ; START RELATIONAL
7644   36A3 D7            push a
7645   36A4 11            mov a, b
7646   36A5 3B 07 63      mov d, _ship_x ; $ship_x
7647   36A8 2A            mov b, [d]
7648   36A9 FD AB         swp b
7649   36AB D8            push b
7650   36AC 07 14 1D      call FROM_FIXED00
7651   36AF 51 02 00      add sp, 2
7652   36B2             ; START TERMS
7653   36B2 D7            push a
7654   36B3 11            mov a, b
7655   36B4 26 01 00      mov b, $1
7656   36B7 56            add b, a
7657   36B8 E4            pop a
7658   36B9             ; END TERMS
7659   36B9 B0            cmp a, b
7660   36BA FD 73         slt ; <= (signed)
7661   36BC E4            pop a
7662   36BD             ; END RELATIONAL
7663   36BD C0 00 00      cmp b, 0
7664   36C0 C6 AA 37      je _for119_exit
7665   36C3             _for119_block:
7666   36C3             ;; if (i >= 1 && i <= 8 && j >= 1 && j <= 8) { 
7667   36C3             _if120_cond:
7668   36C3 FA FF FF      lea d, [bp + -1] ; $i
7669   36C6 2A            mov b, [d]
7670   36C7             ; START RELATIONAL
7671   36C7 D7            push a
7672   36C8 11            mov a, b
7673   36C9 26 01 00      mov b, $1
7674   36CC B0            cmp a, b
7675   36CD FD 80         sge ; >=
7676   36CF E4            pop a
7677   36D0             ; END RELATIONAL
7678   36D0 D7            push a
7679   36D1 11            mov a, b
7680   36D2 FA FF FF      lea d, [bp + -1] ; $i
7681   36D5 2A            mov b, [d]
7682   36D6             ; START RELATIONAL
7683   36D6 D7            push a
7684   36D7 11            mov a, b
7685   36D8 26 08 00      mov b, $8
7686   36DB B0            cmp a, b
7687   36DC FD 73         slt ; <= (signed)
7688   36DE E4            pop a
7689   36DF             ; END RELATIONAL
7690   36DF FD A7         sand a, b
7691   36E1 11            mov a, b
7692   36E2 FA FD FF      lea d, [bp + -3] ; $j
7693   36E5 2A            mov b, [d]
7694   36E6             ; START RELATIONAL
7695   36E6 D7            push a
7696   36E7 11            mov a, b
7697   36E8 26 01 00      mov b, $1
7698   36EB B0            cmp a, b
7699   36EC FD 80         sge ; >=
7700   36EE E4            pop a
7701   36EF             ; END RELATIONAL
7702   36EF FD A7         sand a, b
7703   36F1 11            mov a, b
7704   36F2 FA FD FF      lea d, [bp + -3] ; $j
7705   36F5 2A            mov b, [d]
7706   36F6             ; START RELATIONAL
7707   36F6 D7            push a
7708   36F7 11            mov a, b
7709   36F8 26 08 00      mov b, $8
7710   36FB B0            cmp a, b
7711   36FC FD 73         slt ; <= (signed)
7712   36FE E4            pop a
7713   36FF             ; END RELATIONAL
7714   36FF FD A7         sand a, b
7715   3701 E4            pop a
7716   3702 C0 00 00      cmp b, 0
7717   3705 C6 9A 37      je _if120_exit
7718   3708             _if120_true:
7719   3708             ;; if (quad[i+-1][j+-1] ==  		2     ) { 
7720   3708             _if121_cond:
7721   3708 3B 0B 63      mov d, _quad_data ; $quad
7722   370B D7            push a
7723   370C DA            push d
7724   370D FA FF FF      lea d, [bp + -1] ; $i
7725   3710 2A            mov b, [d]
7726   3711             ; START TERMS
7727   3711 D7            push a
7728   3712 11            mov a, b
7729   3713 26 FF FF      mov b, 65535
7730   3716 38 FF FF      mov c, 65535
7731   3719 54            add a, b
7732   371A D7            push a
7733   371B FD 12         mov a, g
7734   371D 28            mov b, c
7735   371E 5C            adc a, b
7736   371F 39            mov c, a
7737   3720 E5            pop b
7738   3721 E4            pop a
7739   3722             ; END TERMS
7740   3722 E7            pop d
7741   3723 FD 13 08 00   mma 8 ; mov a, 8; mul a, b; add d, b
7742   3727 DA            push d
7743   3728 FA FD FF      lea d, [bp + -3] ; $j
7744   372B 2A            mov b, [d]
7745   372C             ; START TERMS
7746   372C D7            push a
7747   372D 11            mov a, b
7748   372E 26 FF FF      mov b, 65535
7749   3731 38 FF FF      mov c, 65535
7750   3734 54            add a, b
7751   3735 D7            push a
7752   3736 FD 12         mov a, g
7753   3738 28            mov b, c
7754   3739 5C            adc a, b
7755   373A 39            mov c, a
7756   373B E5            pop b
7757   373C E4            pop a
7758   373D             ; END TERMS
7759   373D E7            pop d
7760   373E 5A            add d, b
7761   373F E4            pop a
7762   3740 32            mov bl, [d]
7763   3741 A7 00         mov bh, 0
7764   3743             ; START RELATIONAL
7765   3743 D7            push a
7766   3744 11            mov a, b
7767   3745 26 02 00      mov b, $2
7768   3748 B0            cmp a, b
7769   3749 FD 71         seq ; ==
7770   374B E4            pop a
7771   374C             ; END RELATIONAL
7772   374C C0 00 00      cmp b, 0
7773   374F C6 97 37      je _if121_exit
7774   3752             _if121_true:
7775   3752             ;; docked = 1; 
7776   3752 3B 2E 62      mov d, _docked ; $docked
7777   3755 DA            push d
7778   3756 26 01 00      mov b, $1
7779   3759 E7            pop d
7780   375A FD 3E         mov [d], bl
7781   375C             ;; sC = "DOCKED"; 
7782   375C FA FB FF      lea d, [bp + -5] ; $sC
7783   375F DA            push d
7784   3760 26 49 6A      mov b, __s78 ; "DOCKED"
7785   3763 E7            pop d
7786   3764 FD 43         mov [d], b
7787   3766             ;; energy = energy0; 
7788   3766 3B 2F 62      mov d, _energy ; $energy
7789   3769 DA            push d
7790   376A 3B 31 62      mov d, _energy0 ; $energy0
7791   376D 2A            mov b, [d]
7792   376E E7            pop d
7793   376F FD 43         mov [d], b
7794   3771             ;; torps = torps0; 
7795   3771 3B E4 62      mov d, _torps ; $torps
7796   3774 DA            push d
7797   3775 3B E5 62      mov d, _torps0 ; $torps0
7798   3778 32            mov bl, [d]
7799   3779 A7 00         mov bh, 0
7800   377B E7            pop d
7801   377C FD 3E         mov [d], bl
7802   377E             ;; puts("Shields dropped for docking purposes."); 
7803   377E 26 50 6A      mov b, __s79 ; "Shields dropped for docking purposes."
7804   3781 FD AB         swp b
7805   3783 D8            push b
7806   3784 07 37 13      call puts
7807   3787 51 02 00      add sp, 2
7808   378A             ;; shield = 0; 
7809   378A 3B EA 62      mov d, _shield ; $shield
7810   378D DA            push d
7811   378E 26 00 00      mov b, $0
7812   3791 E7            pop d
7813   3792 FD 43         mov [d], b
7814   3794 0A 97 37      jmp _if121_exit
7815   3797             _if121_exit:
7816   3797 0A 9A 37      jmp _if120_exit
7817   379A             _if120_exit:
7818   379A             _for119_update:
7819   379A FA FD FF      lea d, [bp + -3] ; $j
7820   379D 2A            mov b, [d]
7821   379E D8            push b
7822   379F FD 77         inc b
7823   37A1 FA FD FF      lea d, [bp + -3] ; $j
7824   37A4 FD 43         mov [d], b
7825   37A6 E5            pop b
7826   37A7 0A 9F 36      jmp _for119_cond
7827   37AA             _for119_exit:
7828   37AA             _for118_update:
7829   37AA FA FF FF      lea d, [bp + -1] ; $i
7830   37AD 2A            mov b, [d]
7831   37AE D8            push b
7832   37AF FD 77         inc b
7833   37B1 FA FF FF      lea d, [bp + -1] ; $i
7834   37B4 FD 43         mov [d], b
7835   37B6 E5            pop b
7836   37B7 0A 5F 36      jmp _for118_cond
7837   37BA             _for118_exit:
7838   37BA             ;; if (damage[2] < 0) { 
7839   37BA             _if122_cond:
7840   37BA 3B F1 62      mov d, _damage_data ; $damage
7841   37BD D7            push a
7842   37BE DA            push d
7843   37BF 26 02 00      mov b, $2
7844   37C2 E7            pop d
7845   37C3 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
7846   37C7 E4            pop a
7847   37C8 2A            mov b, [d]
7848   37C9             ; START RELATIONAL
7849   37C9 D7            push a
7850   37CA 11            mov a, b
7851   37CB 26 00 00      mov b, $0
7852   37CE B0            cmp a, b
7853   37CF FD 73         slt ; < (signed)
7854   37D1 E4            pop a
7855   37D2             ; END RELATIONAL
7856   37D2 C0 00 00      cmp b, 0
7857   37D5 C6 E9 37      je _if122_exit
7858   37D8             _if122_true:
7859   37D8             ;; puts("\n*** Short Range Sensors are out ***"); 
7860   37D8 26 76 6A      mov b, __s80 ; "\n*** Short Range Sensors are out ***"
7861   37DB FD AB         swp b
7862   37DD D8            push b
7863   37DE 07 37 13      call puts
7864   37E1 51 02 00      add sp, 2
7865   37E4             ;; return; 
7866   37E4 F9            leave
7867   37E5 09            ret
7868   37E6 0A E9 37      jmp _if122_exit
7869   37E9             _if122_exit:
7870   37E9             ;; puts(srs_1); 
7871   37E9 3B 25 64      mov d, _srs_1 ; $srs_1
7872   37EC 2A            mov b, [d]
7873   37ED FD AB         swp b
7874   37EF D8            push b
7875   37F0 07 37 13      call puts
7876   37F3 51 02 00      add sp, 2
7877   37F6             ;; for (i = 0; i < 8; i++) { 
7878   37F6             _for123_init:
7879   37F6 FA FF FF      lea d, [bp + -1] ; $i
7880   37F9 DA            push d
7881   37FA 26 00 00      mov b, $0
7882   37FD E7            pop d
7883   37FE FD 43         mov [d], b
7884   3800             _for123_cond:
7885   3800 FA FF FF      lea d, [bp + -1] ; $i
7886   3803 2A            mov b, [d]
7887   3804             ; START RELATIONAL
7888   3804 D7            push a
7889   3805 11            mov a, b
7890   3806 26 08 00      mov b, $8
7891   3809 B0            cmp a, b
7892   380A FD 73         slt ; < (signed)
7893   380C E4            pop a
7894   380D             ; END RELATIONAL
7895   380D C0 00 00      cmp b, 0
7896   3810 C6 F7 39      je _for123_exit
7897   3813             _for123_block:
7898   3813             ;; for (j = 0; j < 8; j++) 
7899   3813             _for124_init:
7900   3813 FA FD FF      lea d, [bp + -3] ; $j
7901   3816 DA            push d
7902   3817 26 00 00      mov b, $0
7903   381A E7            pop d
7904   381B FD 43         mov [d], b
7905   381D             _for124_cond:
7906   381D FA FD FF      lea d, [bp + -3] ; $j
7907   3820 2A            mov b, [d]
7908   3821             ; START RELATIONAL
7909   3821 D7            push a
7910   3822 11            mov a, b
7911   3823 26 08 00      mov b, $8
7912   3826 B0            cmp a, b
7913   3827 FD 73         slt ; < (signed)
7914   3829 E4            pop a
7915   382A             ; END RELATIONAL
7916   382A C0 00 00      cmp b, 0
7917   382D C6 6E 38      je _for124_exit
7918   3830             _for124_block:
7919   3830             ;; puts(tilestr[quad[i][j]]); 
7920   3830 3B 27 64      mov d, _tilestr_data ; $tilestr
7921   3833 D7            push a
7922   3834 DA            push d
7923   3835 3B 0B 63      mov d, _quad_data ; $quad
7924   3838 D7            push a
7925   3839 DA            push d
7926   383A FA FF FF      lea d, [bp + -1] ; $i
7927   383D 2A            mov b, [d]
7928   383E E7            pop d
7929   383F FD 13 08 00   mma 8 ; mov a, 8; mul a, b; add d, b
7930   3843 DA            push d
7931   3844 FA FD FF      lea d, [bp + -3] ; $j
7932   3847 2A            mov b, [d]
7933   3848 E7            pop d
7934   3849 5A            add d, b
7935   384A E4            pop a
7936   384B 32            mov bl, [d]
7937   384C A7 00         mov bh, 0
7938   384E E7            pop d
7939   384F FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
7940   3853 E4            pop a
7941   3854 2A            mov b, [d]
7942   3855 FD AB         swp b
7943   3857 D8            push b
7944   3858 07 37 13      call puts
7945   385B 51 02 00      add sp, 2
7946   385E             _for124_update:
7947   385E FA FD FF      lea d, [bp + -3] ; $j
7948   3861 2A            mov b, [d]
7949   3862 D8            push b
7950   3863 FD 77         inc b
7951   3865 FA FD FF      lea d, [bp + -3] ; $j
7952   3868 FD 43         mov [d], b
7953   386A E5            pop b
7954   386B 0A 1D 38      jmp _for124_cond
7955   386E             _for124_exit:
7956   386E             ;; if (i == 0) 
7957   386E             _if125_cond:
7958   386E FA FF FF      lea d, [bp + -1] ; $i
7959   3871 2A            mov b, [d]
7960   3872             ; START RELATIONAL
7961   3872 D7            push a
7962   3873 11            mov a, b
7963   3874 26 00 00      mov b, $0
7964   3877 B0            cmp a, b
7965   3878 FD 71         seq ; ==
7966   387A E4            pop a
7967   387B             ; END RELATIONAL
7968   387B C0 00 00      cmp b, 0
7969   387E C6 A0 38      je _if125_exit
7970   3881             _if125_true:
7971   3881             ;; printf("    Stardate            %d\n", FROM_FIXED(stardate)); 
7972   3881 3B 09 63      mov d, _stardate ; $stardate
7973   3884 2A            mov b, [d]
7974   3885 FD AB         swp b
7975   3887 D8            push b
7976   3888 07 F1 1C      call FROM_FIXED
7977   388B 51 02 00      add sp, 2
7978   388E FD AB         swp b
7979   3890 D8            push b
7980   3891 26 9B 6A      mov b, __s81 ; "    Stardate            %d\n"
7981   3894 FD AB         swp b
7982   3896 D8            push b
7983   3897 07 D1 05      call printf
7984   389A 51 04 00      add sp, 4
7985   389D 0A A0 38      jmp _if125_exit
7986   38A0             _if125_exit:
7987   38A0             ;; if (i == 1) 
7988   38A0             _if126_cond:
7989   38A0 FA FF FF      lea d, [bp + -1] ; $i
7990   38A3 2A            mov b, [d]
7991   38A4             ; START RELATIONAL
7992   38A4 D7            push a
7993   38A5 11            mov a, b
7994   38A6 26 01 00      mov b, $1
7995   38A9 B0            cmp a, b
7996   38AA FD 71         seq ; ==
7997   38AC E4            pop a
7998   38AD             ; END RELATIONAL
7999   38AD C0 00 00      cmp b, 0
8000   38B0 C6 C9 38      je _if126_exit
8001   38B3             _if126_true:
8002   38B3             ;; printf("    Condition           %s\n", sC); 
8003   38B3 FA FB FF      lea d, [bp + -5] ; $sC
8004   38B6 2A            mov b, [d]
8005   38B7 FD AB         swp b
8006   38B9 D8            push b
8007   38BA 26 B7 6A      mov b, __s82 ; "    Condition           %s\n"
8008   38BD FD AB         swp b
8009   38BF D8            push b
8010   38C0 07 D1 05      call printf
8011   38C3 51 04 00      add sp, 4
8012   38C6 0A C9 38      jmp _if126_exit
8013   38C9             _if126_exit:
8014   38C9             ;; if (i == 2) 
8015   38C9             _if127_cond:
8016   38C9 FA FF FF      lea d, [bp + -1] ; $i
8017   38CC 2A            mov b, [d]
8018   38CD             ; START RELATIONAL
8019   38CD D7            push a
8020   38CE 11            mov a, b
8021   38CF 26 02 00      mov b, $2
8022   38D2 B0            cmp a, b
8023   38D3 FD 71         seq ; ==
8024   38D5 E4            pop a
8025   38D6             ; END RELATIONAL
8026   38D6 C0 00 00      cmp b, 0
8027   38D9 C6 F9 38      je _if127_exit
8028   38DC             _if127_true:
8029   38DC             ;; printf("    Quadrant            %d, %d\n", quad_y, quad_x); 
8030   38DC 3B E8 62      mov d, _quad_x ; $quad_x
8031   38DF 2A            mov b, [d]
8032   38E0 FD AB         swp b
8033   38E2 D8            push b
8034   38E3 3B E6 62      mov d, _quad_y ; $quad_y
8035   38E6 2A            mov b, [d]
8036   38E7 FD AB         swp b
8037   38E9 D8            push b
8038   38EA 26 D3 6A      mov b, __s83 ; "    Quadrant            %d, %d\n"
8039   38ED FD AB         swp b
8040   38EF D8            push b
8041   38F0 07 D1 05      call printf
8042   38F3 51 06 00      add sp, 6
8043   38F6 0A F9 38      jmp _if127_exit
8044   38F9             _if127_exit:
8045   38F9             ;; if (i == 3) 
8046   38F9             _if128_cond:
8047   38F9 FA FF FF      lea d, [bp + -1] ; $i
8048   38FC 2A            mov b, [d]
8049   38FD             ; START RELATIONAL
8050   38FD D7            push a
8051   38FE 11            mov a, b
8052   38FF 26 03 00      mov b, $3
8053   3902 B0            cmp a, b
8054   3903 FD 71         seq ; ==
8055   3905 E4            pop a
8056   3906             ; END RELATIONAL
8057   3906 C0 00 00      cmp b, 0
8058   3909 C6 3B 39      je _if128_exit
8059   390C             _if128_true:
8060   390C             ;; printf("    Sector              %d, %d\n", FROM_FIXED00(ship_y), FROM_FIXED00(ship_x)); 
8061   390C 3B 07 63      mov d, _ship_x ; $ship_x
8062   390F 2A            mov b, [d]
8063   3910 FD AB         swp b
8064   3912 D8            push b
8065   3913 07 14 1D      call FROM_FIXED00
8066   3916 51 02 00      add sp, 2
8067   3919 FD AB         swp b
8068   391B D8            push b
8069   391C 3B 05 63      mov d, _ship_y ; $ship_y
8070   391F 2A            mov b, [d]
8071   3920 FD AB         swp b
8072   3922 D8            push b
8073   3923 07 14 1D      call FROM_FIXED00
8074   3926 51 02 00      add sp, 2
8075   3929 FD AB         swp b
8076   392B D8            push b
8077   392C 26 F3 6A      mov b, __s84 ; "    Sector              %d, %d\n"
8078   392F FD AB         swp b
8079   3931 D8            push b
8080   3932 07 D1 05      call printf
8081   3935 51 06 00      add sp, 6
8082   3938 0A 3B 39      jmp _if128_exit
8083   393B             _if128_exit:
8084   393B             ;; if (i == 4) 
8085   393B             _if129_cond:
8086   393B FA FF FF      lea d, [bp + -1] ; $i
8087   393E 2A            mov b, [d]
8088   393F             ; START RELATIONAL
8089   393F D7            push a
8090   3940 11            mov a, b
8091   3941 26 04 00      mov b, $4
8092   3944 B0            cmp a, b
8093   3945 FD 71         seq ; ==
8094   3947 E4            pop a
8095   3948             ; END RELATIONAL
8096   3948 C0 00 00      cmp b, 0
8097   394B C6 64 39      je _if129_exit
8098   394E             _if129_true:
8099   394E             ;; printf("    Photon Torpedoes    %d\n", torps); 
8100   394E 3B E4 62      mov d, _torps ; $torps
8101   3951 32            mov bl, [d]
8102   3952 A7 00         mov bh, 0
8103   3954 DD            push bl
8104   3955 26 13 6B      mov b, __s85 ; "    Photon Torpedoes    %d\n"
8105   3958 FD AB         swp b
8106   395A D8            push b
8107   395B 07 D1 05      call printf
8108   395E 51 03 00      add sp, 3
8109   3961 0A 64 39      jmp _if129_exit
8110   3964             _if129_exit:
8111   3964             ;; if (i == 5) 
8112   3964             _if130_cond:
8113   3964 FA FF FF      lea d, [bp + -1] ; $i
8114   3967 2A            mov b, [d]
8115   3968             ; START RELATIONAL
8116   3968 D7            push a
8117   3969 11            mov a, b
8118   396A 26 05 00      mov b, $5
8119   396D B0            cmp a, b
8120   396E FD 71         seq ; ==
8121   3970 E4            pop a
8122   3971             ; END RELATIONAL
8123   3971 C0 00 00      cmp b, 0
8124   3974 C6 95 39      je _if130_exit
8125   3977             _if130_true:
8126   3977             ;; printf("    Total Energy        %d\n", energy + shield); 
8127   3977 3B 2F 62      mov d, _energy ; $energy
8128   397A 2A            mov b, [d]
8129   397B             ; START TERMS
8130   397B D7            push a
8131   397C 11            mov a, b
8132   397D 3B EA 62      mov d, _shield ; $shield
8133   3980 2A            mov b, [d]
8134   3981 56            add b, a
8135   3982 E4            pop a
8136   3983             ; END TERMS
8137   3983 FD AB         swp b
8138   3985 D8            push b
8139   3986 26 2F 6B      mov b, __s86 ; "    Total Energy        %d\n"
8140   3989 FD AB         swp b
8141   398B D8            push b
8142   398C 07 D1 05      call printf
8143   398F 51 04 00      add sp, 4
8144   3992 0A 95 39      jmp _if130_exit
8145   3995             _if130_exit:
8146   3995             ;; if (i == 6) 
8147   3995             _if131_cond:
8148   3995 FA FF FF      lea d, [bp + -1] ; $i
8149   3998 2A            mov b, [d]
8150   3999             ; START RELATIONAL
8151   3999 D7            push a
8152   399A 11            mov a, b
8153   399B 26 06 00      mov b, $6
8154   399E B0            cmp a, b
8155   399F FD 71         seq ; ==
8156   39A1 E4            pop a
8157   39A2             ; END RELATIONAL
8158   39A2 C0 00 00      cmp b, 0
8159   39A5 C6 BE 39      je _if131_exit
8160   39A8             _if131_true:
8161   39A8             ;; printf("    Shields             %d\n", shield); 
8162   39A8 3B EA 62      mov d, _shield ; $shield
8163   39AB 2A            mov b, [d]
8164   39AC FD AB         swp b
8165   39AE D8            push b
8166   39AF 26 4B 6B      mov b, __s87 ; "    Shields             %d\n"
8167   39B2 FD AB         swp b
8168   39B4 D8            push b
8169   39B5 07 D1 05      call printf
8170   39B8 51 04 00      add sp, 4
8171   39BB 0A BE 39      jmp _if131_exit
8172   39BE             _if131_exit:
8173   39BE             ;; if (i == 7) 
8174   39BE             _if132_cond:
8175   39BE FA FF FF      lea d, [bp + -1] ; $i
8176   39C1 2A            mov b, [d]
8177   39C2             ; START RELATIONAL
8178   39C2 D7            push a
8179   39C3 11            mov a, b
8180   39C4 26 07 00      mov b, $7
8181   39C7 B0            cmp a, b
8182   39C8 FD 71         seq ; ==
8183   39CA E4            pop a
8184   39CB             ; END RELATIONAL
8185   39CB C0 00 00      cmp b, 0
8186   39CE C6 E7 39      je _if132_exit
8187   39D1             _if132_true:
8188   39D1             ;; printf("    Klingons Remaining  %d\n", klingons_left); 
8189   39D1 3B E3 62      mov d, _klingons_left ; $klingons_left
8190   39D4 32            mov bl, [d]
8191   39D5 A7 00         mov bh, 0
8192   39D7 DD            push bl
8193   39D8 26 67 6B      mov b, __s88 ; "    Klingons Remaining  %d\n"
8194   39DB FD AB         swp b
8195   39DD D8            push b
8196   39DE 07 D1 05      call printf
8197   39E1 51 03 00      add sp, 3
8198   39E4 0A E7 39      jmp _if132_exit
8199   39E7             _if132_exit:
8200   39E7             _for123_update:
8201   39E7 FA FF FF      lea d, [bp + -1] ; $i
8202   39EA 2A            mov b, [d]
8203   39EB D8            push b
8204   39EC FD 77         inc b
8205   39EE FA FF FF      lea d, [bp + -1] ; $i
8206   39F1 FD 43         mov [d], b
8207   39F3 E5            pop b
8208   39F4 0A 00 38      jmp _for123_cond
8209   39F7             _for123_exit:
8210   39F7             ;; puts(srs_1); 
8211   39F7 3B 25 64      mov d, _srs_1 ; $srs_1
8212   39FA 2A            mov b, [d]
8213   39FB FD AB         swp b
8214   39FD D8            push b
8215   39FE 07 37 13      call puts
8216   3A01 51 02 00      add sp, 2
8217   3A04             ;; putchar('\n'); 
8218   3A04 26 0A 00      mov b, $a
8219   3A07 DD            push bl
8220   3A08 07 01 13      call putchar
8221   3A0B 51 01 00      add sp, 1
8222   3A0E             ;; return; 
8223   3A0E F9            leave
8224   3A0F 09            ret
8225   3A10             
8226   3A10             put1bcd:
8227   3A10 F8 00 00      enter 0 ; (push bp; mov bp, sp)
8228   3A13             ;; v = v & 0x0F; 
8229   3A13 FA 05 00      lea d, [bp + 5] ; $v
8230   3A16 DA            push d
8231   3A17 FA 05 00      lea d, [bp + 5] ; $v
8232   3A1A 32            mov bl, [d]
8233   3A1B A7 00         mov bh, 0
8234   3A1D D7            push a
8235   3A1E 11            mov a, b
8236   3A1F 26 0F 00      mov b, $f
8237   3A22 FD 92         and b, a ; &
8238   3A24 E4            pop a
8239   3A25 E7            pop d
8240   3A26 FD 3E         mov [d], bl
8241   3A28             ;; putchar('0' + v); 
8242   3A28 26 30 00      mov b, $30
8243   3A2B             ; START TERMS
8244   3A2B D7            push a
8245   3A2C 11            mov a, b
8246   3A2D FA 05 00      lea d, [bp + 5] ; $v
8247   3A30 32            mov bl, [d]
8248   3A31 A7 00         mov bh, 0
8249   3A33 56            add b, a
8250   3A34 E4            pop a
8251   3A35             ; END TERMS
8252   3A35 DD            push bl
8253   3A36 07 01 13      call putchar
8254   3A39 51 01 00      add sp, 1
8255   3A3C F9            leave
8256   3A3D 09            ret
8257   3A3E             
8258   3A3E             putbcd:
8259   3A3E F8 00 00      enter 0 ; (push bp; mov bp, sp)
8260   3A41             ;; put1bcd(x >> 8); 
8261   3A41 FA 05 00      lea d, [bp + 5] ; $x
8262   3A44 2A            mov b, [d]
8263   3A45             ; START SHIFT
8264   3A45 D7            push a
8265   3A46 11            mov a, b
8266   3A47 26 08 00      mov b, $8
8267   3A4A FD 39         mov c, b
8268   3A4C A1            shr a, cl
8269   3A4D 27            mov b, a
8270   3A4E E4            pop a
8271   3A4F             ; END SHIFT
8272   3A4F DD            push bl
8273   3A50 07 10 3A      call put1bcd
8274   3A53 51 01 00      add sp, 1
8275   3A56             ;; put1bcd(x >> 4); 
8276   3A56 FA 05 00      lea d, [bp + 5] ; $x
8277   3A59 2A            mov b, [d]
8278   3A5A             ; START SHIFT
8279   3A5A D7            push a
8280   3A5B 11            mov a, b
8281   3A5C 26 04 00      mov b, $4
8282   3A5F FD 39         mov c, b
8283   3A61 A1            shr a, cl
8284   3A62 27            mov b, a
8285   3A63 E4            pop a
8286   3A64             ; END SHIFT
8287   3A64 DD            push bl
8288   3A65 07 10 3A      call put1bcd
8289   3A68 51 01 00      add sp, 1
8290   3A6B             ;; put1bcd(x); 
8291   3A6B FA 05 00      lea d, [bp + 5] ; $x
8292   3A6E 2A            mov b, [d]
8293   3A6F DD            push bl
8294   3A70 07 10 3A      call put1bcd
8295   3A73 51 01 00      add sp, 1
8296   3A76 F9            leave
8297   3A77 09            ret
8298   3A78             
8299   3A78             long_range_scan:
8300   3A78 F8 00 00      enter 0 ; (push bp; mov bp, sp)
8301   3A7B             ; $i 
8302   3A7B             ; $j 
8303   3A7B 52 04 00      sub sp, 4
8304   3A7E             ;; if (inoperable(3)) 
8305   3A7E             _if133_cond:
8306   3A7E 26 03 00      mov b, $3
8307   3A81 DD            push bl
8308   3A82 07 6A 21      call inoperable
8309   3A85 51 01 00      add sp, 1
8310   3A88 C0 00 00      cmp b, 0
8311   3A8B C6 93 3A      je _if133_exit
8312   3A8E             _if133_true:
8313   3A8E             ;; return; 
8314   3A8E F9            leave
8315   3A8F 09            ret
8316   3A90 0A 93 3A      jmp _if133_exit
8317   3A93             _if133_exit:
8318   3A93             ;; printf("Long Range Scan for Quadrant %d, %d\n\n", quad_y, quad_x); 
8319   3A93 3B E8 62      mov d, _quad_x ; $quad_x
8320   3A96 2A            mov b, [d]
8321   3A97 FD AB         swp b
8322   3A99 D8            push b
8323   3A9A 3B E6 62      mov d, _quad_y ; $quad_y
8324   3A9D 2A            mov b, [d]
8325   3A9E FD AB         swp b
8326   3AA0 D8            push b
8327   3AA1 26 83 6B      mov b, __s89 ; "Long Range Scan for Quadrant %d, %d\n\n"
8328   3AA4 FD AB         swp b
8329   3AA6 D8            push b
8330   3AA7 07 D1 05      call printf
8331   3AAA 51 06 00      add sp, 6
8332   3AAD             ;; for (i = quad_y - 1; i <= quad_y + 1; i++) { 
8333   3AAD             _for134_init:
8334   3AAD FA FF FF      lea d, [bp + -1] ; $i
8335   3AB0 DA            push d
8336   3AB1 3B E6 62      mov d, _quad_y ; $quad_y
8337   3AB4 2A            mov b, [d]
8338   3AB5             ; START TERMS
8339   3AB5 D7            push a
8340   3AB6 11            mov a, b
8341   3AB7 26 01 00      mov b, $1
8342   3ABA 60            sub a, b
8343   3ABB 27            mov b, a
8344   3ABC E4            pop a
8345   3ABD             ; END TERMS
8346   3ABD E7            pop d
8347   3ABE FD 43         mov [d], b
8348   3AC0             _for134_cond:
8349   3AC0 FA FF FF      lea d, [bp + -1] ; $i
8350   3AC3 2A            mov b, [d]
8351   3AC4             ; START RELATIONAL
8352   3AC4 D7            push a
8353   3AC5 11            mov a, b
8354   3AC6 3B E6 62      mov d, _quad_y ; $quad_y
8355   3AC9 2A            mov b, [d]
8356   3ACA             ; START TERMS
8357   3ACA D7            push a
8358   3ACB 11            mov a, b
8359   3ACC 26 01 00      mov b, $1
8360   3ACF 56            add b, a
8361   3AD0 E4            pop a
8362   3AD1             ; END TERMS
8363   3AD1 B0            cmp a, b
8364   3AD2 FD 73         slt ; <= (signed)
8365   3AD4 E4            pop a
8366   3AD5             ; END RELATIONAL
8367   3AD5 C0 00 00      cmp b, 0
8368   3AD8 C6 12 3C      je _for134_exit
8369   3ADB             _for134_block:
8370   3ADB             ;; printf("%s:", lrs_1); 
8371   3ADB 3B 50 64      mov d, _lrs_1 ; $lrs_1
8372   3ADE 2A            mov b, [d]
8373   3ADF FD AB         swp b
8374   3AE1 D8            push b
8375   3AE2 26 A9 6B      mov b, __s90 ; "%s:"
8376   3AE5 FD AB         swp b
8377   3AE7 D8            push b
8378   3AE8 07 D1 05      call printf
8379   3AEB 51 04 00      add sp, 4
8380   3AEE             ;; for (j = quad_x - 1; j <= quad_x + 1; j++) { 
8381   3AEE             _for135_init:
8382   3AEE FA FD FF      lea d, [bp + -3] ; $j
8383   3AF1 DA            push d
8384   3AF2 3B E8 62      mov d, _quad_x ; $quad_x
8385   3AF5 2A            mov b, [d]
8386   3AF6             ; START TERMS
8387   3AF6 D7            push a
8388   3AF7 11            mov a, b
8389   3AF8 26 01 00      mov b, $1
8390   3AFB 60            sub a, b
8391   3AFC 27            mov b, a
8392   3AFD E4            pop a
8393   3AFE             ; END TERMS
8394   3AFE E7            pop d
8395   3AFF FD 43         mov [d], b
8396   3B01             _for135_cond:
8397   3B01 FA FD FF      lea d, [bp + -3] ; $j
8398   3B04 2A            mov b, [d]
8399   3B05             ; START RELATIONAL
8400   3B05 D7            push a
8401   3B06 11            mov a, b
8402   3B07 3B E8 62      mov d, _quad_x ; $quad_x
8403   3B0A 2A            mov b, [d]
8404   3B0B             ; START TERMS
8405   3B0B D7            push a
8406   3B0C 11            mov a, b
8407   3B0D 26 01 00      mov b, $1
8408   3B10 56            add b, a
8409   3B11 E4            pop a
8410   3B12             ; END TERMS
8411   3B12 B0            cmp a, b
8412   3B13 FD 73         slt ; <= (signed)
8413   3B15 E4            pop a
8414   3B16             ; END RELATIONAL
8415   3B16 C0 00 00      cmp b, 0
8416   3B19 C6 F8 3B      je _for135_exit
8417   3B1C             _for135_block:
8418   3B1C             ;; putchar(' '); 
8419   3B1C 26 20 00      mov b, $20
8420   3B1F DD            push bl
8421   3B20 07 01 13      call putchar
8422   3B23 51 01 00      add sp, 1
8423   3B26             ;; if (i > 0 && i <= 8 && j > 0 && j <= 8) { 
8424   3B26             _if136_cond:
8425   3B26 FA FF FF      lea d, [bp + -1] ; $i
8426   3B29 2A            mov b, [d]
8427   3B2A             ; START RELATIONAL
8428   3B2A D7            push a
8429   3B2B 11            mov a, b
8430   3B2C 26 00 00      mov b, $0
8431   3B2F B0            cmp a, b
8432   3B30 FD 7F         sgt ; >
8433   3B32 E4            pop a
8434   3B33             ; END RELATIONAL
8435   3B33 D7            push a
8436   3B34 11            mov a, b
8437   3B35 FA FF FF      lea d, [bp + -1] ; $i
8438   3B38 2A            mov b, [d]
8439   3B39             ; START RELATIONAL
8440   3B39 D7            push a
8441   3B3A 11            mov a, b
8442   3B3B 26 08 00      mov b, $8
8443   3B3E B0            cmp a, b
8444   3B3F FD 73         slt ; <= (signed)
8445   3B41 E4            pop a
8446   3B42             ; END RELATIONAL
8447   3B42 FD A7         sand a, b
8448   3B44 11            mov a, b
8449   3B45 FA FD FF      lea d, [bp + -3] ; $j
8450   3B48 2A            mov b, [d]
8451   3B49             ; START RELATIONAL
8452   3B49 D7            push a
8453   3B4A 11            mov a, b
8454   3B4B 26 00 00      mov b, $0
8455   3B4E B0            cmp a, b
8456   3B4F FD 7F         sgt ; >
8457   3B51 E4            pop a
8458   3B52             ; END RELATIONAL
8459   3B52 FD A7         sand a, b
8460   3B54 11            mov a, b
8461   3B55 FA FD FF      lea d, [bp + -3] ; $j
8462   3B58 2A            mov b, [d]
8463   3B59             ; START RELATIONAL
8464   3B59 D7            push a
8465   3B5A 11            mov a, b
8466   3B5B 26 08 00      mov b, $8
8467   3B5E B0            cmp a, b
8468   3B5F FD 73         slt ; <= (signed)
8469   3B61 E4            pop a
8470   3B62             ; END RELATIONAL
8471   3B62 FD A7         sand a, b
8472   3B64 E4            pop a
8473   3B65 C0 00 00      cmp b, 0
8474   3B68 C6 D0 3B      je _if136_else
8475   3B6B             _if136_true:
8476   3B6B             ;; map[i][j] = map[i][j] |   0x1000		/* Set if this sector was mapped */          ; 
8477   3B6B 3B 33 62      mov d, _map_data ; $map
8478   3B6E D7            push a
8479   3B6F DA            push d
8480   3B70 FA FF FF      lea d, [bp + -1] ; $i
8481   3B73 2A            mov b, [d]
8482   3B74 E7            pop d
8483   3B75 FD 13 12 00   mma 18 ; mov a, 18; mul a, b; add d, b
8484   3B79 DA            push d
8485   3B7A FA FD FF      lea d, [bp + -3] ; $j
8486   3B7D 2A            mov b, [d]
8487   3B7E E7            pop d
8488   3B7F FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
8489   3B83 E4            pop a
8490   3B84 DA            push d
8491   3B85 3B 33 62      mov d, _map_data ; $map
8492   3B88 D7            push a
8493   3B89 DA            push d
8494   3B8A FA FF FF      lea d, [bp + -1] ; $i
8495   3B8D 2A            mov b, [d]
8496   3B8E E7            pop d
8497   3B8F FD 13 12 00   mma 18 ; mov a, 18; mul a, b; add d, b
8498   3B93 DA            push d
8499   3B94 FA FD FF      lea d, [bp + -3] ; $j
8500   3B97 2A            mov b, [d]
8501   3B98 E7            pop d
8502   3B99 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
8503   3B9D E4            pop a
8504   3B9E 2A            mov b, [d]
8505   3B9F D7            push a
8506   3BA0 11            mov a, b
8507   3BA1 26 00 10      mov b, $1000
8508   3BA4 FD 70         or b, a ; |
8509   3BA6 E4            pop a
8510   3BA7 E7            pop d
8511   3BA8 FD 43         mov [d], b
8512   3BAA             ;; putbcd(map[i][j]); 
8513   3BAA 3B 33 62      mov d, _map_data ; $map
8514   3BAD D7            push a
8515   3BAE DA            push d
8516   3BAF FA FF FF      lea d, [bp + -1] ; $i
8517   3BB2 2A            mov b, [d]
8518   3BB3 E7            pop d
8519   3BB4 FD 13 12 00   mma 18 ; mov a, 18; mul a, b; add d, b
8520   3BB8 DA            push d
8521   3BB9 FA FD FF      lea d, [bp + -3] ; $j
8522   3BBC 2A            mov b, [d]
8523   3BBD E7            pop d
8524   3BBE FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
8525   3BC2 E4            pop a
8526   3BC3 2A            mov b, [d]
8527   3BC4 FD AB         swp b
8528   3BC6 D8            push b
8529   3BC7 07 3E 3A      call putbcd
8530   3BCA 51 02 00      add sp, 2
8531   3BCD 0A DC 3B      jmp _if136_exit
8532   3BD0             _if136_else:
8533   3BD0             ;; puts("***"); 
8534   3BD0 26 AD 6B      mov b, __s91 ; "***"
8535   3BD3 FD AB         swp b
8536   3BD5 D8            push b
8537   3BD6 07 37 13      call puts
8538   3BD9 51 02 00      add sp, 2
8539   3BDC             _if136_exit:
8540   3BDC             ;; puts(" :"); 
8541   3BDC 26 B1 6B      mov b, __s92 ; " :"
8542   3BDF FD AB         swp b
8543   3BE1 D8            push b
8544   3BE2 07 37 13      call puts
8545   3BE5 51 02 00      add sp, 2
8546   3BE8             _for135_update:
8547   3BE8 FA FD FF      lea d, [bp + -3] ; $j
8548   3BEB 2A            mov b, [d]
8549   3BEC D8            push b
8550   3BED FD 77         inc b
8551   3BEF FA FD FF      lea d, [bp + -3] ; $j
8552   3BF2 FD 43         mov [d], b
8553   3BF4 E5            pop b
8554   3BF5 0A 01 3B      jmp _for135_cond
8555   3BF8             _for135_exit:
8556   3BF8             ;; putchar('\n'); 
8557   3BF8 26 0A 00      mov b, $a
8558   3BFB DD            push bl
8559   3BFC 07 01 13      call putchar
8560   3BFF 51 01 00      add sp, 1
8561   3C02             _for134_update:
8562   3C02 FA FF FF      lea d, [bp + -1] ; $i
8563   3C05 2A            mov b, [d]
8564   3C06 D8            push b
8565   3C07 FD 77         inc b
8566   3C09 FA FF FF      lea d, [bp + -1] ; $i
8567   3C0C FD 43         mov [d], b
8568   3C0E E5            pop b
8569   3C0F 0A C0 3A      jmp _for134_cond
8570   3C12             _for134_exit:
8571   3C12             ;; printf("%s\n", lrs_1); 
8572   3C12 3B 50 64      mov d, _lrs_1 ; $lrs_1
8573   3C15 2A            mov b, [d]
8574   3C16 FD AB         swp b
8575   3C18 D8            push b
8576   3C19 26 B4 6B      mov b, __s93 ; "%s\n"
8577   3C1C FD AB         swp b
8578   3C1E D8            push b
8579   3C1F 07 D1 05      call printf
8580   3C22 51 04 00      add sp, 4
8581   3C25 F9            leave
8582   3C26 09            ret
8583   3C27             
8584   3C27             no_klingon:
8585   3C27 F8 00 00      enter 0 ; (push bp; mov bp, sp)
8586   3C2A             ;; if (klingons <= 0) { 
8587   3C2A             _if137_cond:
8588   3C2A 3B E1 62      mov d, _klingons ; $klingons
8589   3C2D 32            mov bl, [d]
8590   3C2E A7 00         mov bh, 0
8591   3C30             ; START RELATIONAL
8592   3C30 D7            push a
8593   3C31 11            mov a, b
8594   3C32 26 00 00      mov b, $0
8595   3C35 B0            cmp a, b
8596   3C36 FD 75         slu ; <= (unsigned)
8597   3C38 E4            pop a
8598   3C39             ; END RELATIONAL
8599   3C39 C0 00 00      cmp b, 0
8600   3C3C C6 53 3C      je _if137_exit
8601   3C3F             _if137_true:
8602   3C3F             ;; puts("Science Officer Spock reports:\n  'Sensors show no enemy ships in this quadrant'\n"); 
8603   3C3F 26 B8 6B      mov b, __s94 ; "Science Officer Spock reports:\n  'Sensors show no enemy ships in this quadrant'\n"
8604   3C42 FD AB         swp b
8605   3C44 D8            push b
8606   3C45 07 37 13      call puts
8607   3C48 51 02 00      add sp, 2
8608   3C4B             ;; return 1; 
8609   3C4B 26 01 00      mov b, $1
8610   3C4E F9            leave
8611   3C4F 09            ret
8612   3C50 0A 53 3C      jmp _if137_exit
8613   3C53             _if137_exit:
8614   3C53             ;; return 0; 
8615   3C53 26 00 00      mov b, $0
8616   3C56 F9            leave
8617   3C57 09            ret
8618   3C58             
8619   3C58             wipe_klingon:
8620   3C58 F8 00 00      enter 0 ; (push bp; mov bp, sp)
8621   3C5B             ;; quad[k->y+-1][k->x+-1] =  		0      ; 
8622   3C5B 3B 0B 63      mov d, _quad_data ; $quad
8623   3C5E D7            push a
8624   3C5F DA            push d
8625   3C60 FA 05 00      lea d, [bp + 5] ; $k
8626   3C63 FD 2A         mov d, [d]
8627   3C65 58 00 00      add d, 0
8628   3C68 32            mov bl, [d]
8629   3C69 A7 00         mov bh, 0
8630   3C6B             ; START TERMS
8631   3C6B D7            push a
8632   3C6C 11            mov a, b
8633   3C6D 26 FF FF      mov b, 65535
8634   3C70 38 FF FF      mov c, 65535
8635   3C73 54            add a, b
8636   3C74 D7            push a
8637   3C75 FD 12         mov a, g
8638   3C77 28            mov b, c
8639   3C78 5C            adc a, b
8640   3C79 39            mov c, a
8641   3C7A E5            pop b
8642   3C7B E4            pop a
8643   3C7C             ; END TERMS
8644   3C7C E7            pop d
8645   3C7D FD 13 08 00   mma 8 ; mov a, 8; mul a, b; add d, b
8646   3C81 DA            push d
8647   3C82 FA 05 00      lea d, [bp + 5] ; $k
8648   3C85 FD 2A         mov d, [d]
8649   3C87 58 01 00      add d, 1
8650   3C8A 32            mov bl, [d]
8651   3C8B A7 00         mov bh, 0
8652   3C8D             ; START TERMS
8653   3C8D D7            push a
8654   3C8E 11            mov a, b
8655   3C8F 26 FF FF      mov b, 65535
8656   3C92 38 FF FF      mov c, 65535
8657   3C95 54            add a, b
8658   3C96 D7            push a
8659   3C97 FD 12         mov a, g
8660   3C99 28            mov b, c
8661   3C9A 5C            adc a, b
8662   3C9B 39            mov c, a
8663   3C9C E5            pop b
8664   3C9D E4            pop a
8665   3C9E             ; END TERMS
8666   3C9E E7            pop d
8667   3C9F 5A            add d, b
8668   3CA0 E4            pop a
8669   3CA1 DA            push d
8670   3CA2 26 00 00      mov b, $0
8671   3CA5 E7            pop d
8672   3CA6 FD 3E         mov [d], bl
8673   3CA8 F9            leave
8674   3CA9 09            ret
8675   3CAA             
8676   3CAA             phaser_control:
8677   3CAA F8 00 00      enter 0 ; (push bp; mov bp, sp)
8678   3CAD             ; $i 
8679   3CAD             ; $phaser_energy 
8680   3CAD             ; $h1 
8681   3CAD             ; $h 
8682   3CAD             ; $k 
8683   3CAD 52 0E 00      sub sp, 14
8684   3CB0             ;; k = &kdata; 
8685   3CB0 FA F3 FF      lea d, [bp + -13] ; $k
8686   3CB3 DA            push d
8687   3CB4 3B D5 62      mov d, _kdata_data ; $kdata
8688   3CB7 2D            mov b, d
8689   3CB8 E7            pop d
8690   3CB9 FD 43         mov [d], b
8691   3CBB             ;; if (inoperable(4)) 
8692   3CBB             _if138_cond:
8693   3CBB 26 04 00      mov b, $4
8694   3CBE DD            push bl
8695   3CBF 07 6A 21      call inoperable
8696   3CC2 51 01 00      add sp, 1
8697   3CC5 C0 00 00      cmp b, 0
8698   3CC8 C6 D0 3C      je _if138_exit
8699   3CCB             _if138_true:
8700   3CCB             ;; return; 
8701   3CCB F9            leave
8702   3CCC 09            ret
8703   3CCD 0A D0 3C      jmp _if138_exit
8704   3CD0             _if138_exit:
8705   3CD0             ;; if (no_klingon()) 
8706   3CD0             _if139_cond:
8707   3CD0 07 27 3C      call no_klingon
8708   3CD3 C0 00 00      cmp b, 0
8709   3CD6 C6 DE 3C      je _if139_exit
8710   3CD9             _if139_true:
8711   3CD9             ;; return; 
8712   3CD9 F9            leave
8713   3CDA 09            ret
8714   3CDB 0A DE 3C      jmp _if139_exit
8715   3CDE             _if139_exit:
8716   3CDE             ;; if (damage[8] < 0) 
8717   3CDE             _if140_cond:
8718   3CDE 3B F1 62      mov d, _damage_data ; $damage
8719   3CE1 D7            push a
8720   3CE2 DA            push d
8721   3CE3 26 08 00      mov b, $8
8722   3CE6 E7            pop d
8723   3CE7 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
8724   3CEB E4            pop a
8725   3CEC 2A            mov b, [d]
8726   3CED             ; START RELATIONAL
8727   3CED D7            push a
8728   3CEE 11            mov a, b
8729   3CEF 26 00 00      mov b, $0
8730   3CF2 B0            cmp a, b
8731   3CF3 FD 73         slt ; < (signed)
8732   3CF5 E4            pop a
8733   3CF6             ; END RELATIONAL
8734   3CF6 C0 00 00      cmp b, 0
8735   3CF9 C6 0B 3D      je _if140_exit
8736   3CFC             _if140_true:
8737   3CFC             ;; puts("Computer failure hampers accuracy."); 
8738   3CFC 26 09 6C      mov b, __s95 ; "Computer failure hampers accuracy."
8739   3CFF FD AB         swp b
8740   3D01 D8            push b
8741   3D02 07 37 13      call puts
8742   3D05 51 02 00      add sp, 2
8743   3D08 0A 0B 3D      jmp _if140_exit
8744   3D0B             _if140_exit:
8745   3D0B             ;; printf("Phasers locked on target;\n Energy available = %d units\n\n Number of units to fire: ", energy); 
8746   3D0B 3B 2F 62      mov d, _energy ; $energy
8747   3D0E 2A            mov b, [d]
8748   3D0F FD AB         swp b
8749   3D11 D8            push b
8750   3D12 26 2C 6C      mov b, __s96 ; "Phasers locked on target;\n Energy available = %d units\n\n Number of units to fire: "
8751   3D15 FD AB         swp b
8752   3D17 D8            push b
8753   3D18 07 D1 05      call printf
8754   3D1B 51 04 00      add sp, 4
8755   3D1E             ;; phaser_energy = input_int(); 
8756   3D1E FA FB FF      lea d, [bp + -5] ; $phaser_energy
8757   3D21 DA            push d
8758   3D22 07 D0 20      call input_int
8759   3D25 E7            pop d
8760   3D26 FD 43         mov [d], b
8761   3D28 28            mov b, c
8762   3D29 FD 44 02 00   mov [d + 2], b
8763   3D2D             ;; if (phaser_energy <= 0) 
8764   3D2D             _if141_cond:
8765   3D2D FA FB FF      lea d, [bp + -5] ; $phaser_energy
8766   3D30 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
8767   3D33 FD 39         mov c, b ; And place it into C
8768   3D35 2A            mov b, [d] ; Lower Word in B
8769   3D36             ; START RELATIONAL
8770   3D36 D7            push a
8771   3D37 FD D8         push g
8772   3D39 11            mov a, b
out/startrek.asm line 8773: Label not found: (c)
out/startrek.asm line 8773: Unused data in MS byte of argument. (2)
8773   3D3A FD 22 00 00   mov g, c
8774   3D3E 26 00 00      mov b, $0
8775   3D41 38 00 00      mov c, 0
8776   3D44 FD 74         sle
8777   3D46 FD F1         pop g
8778   3D48 E4            pop a
8779   3D49             ; END RELATIONAL
8780   3D49 C0 00 00      cmp b, 0
8781   3D4C C6 54 3D      je _if141_exit
8782   3D4F             _if141_true:
8783   3D4F             ;; return; 
8784   3D4F F9            leave
8785   3D50 09            ret
8786   3D51 0A 54 3D      jmp _if141_exit
8787   3D54             _if141_exit:
8788   3D54             ;; if (energy - phaser_energy < 0) { 
8789   3D54             _if142_cond:
8790   3D54 3B 2F 62      mov d, _energy ; $energy
8791   3D57 2A            mov b, [d]
8792   3D58             ; START TERMS
8793   3D58 D7            push a
8794   3D59 11            mov a, b
8795   3D5A FA FB FF      lea d, [bp + -5] ; $phaser_energy
8796   3D5D 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
8797   3D60 FD 39         mov c, b ; And place it into C
8798   3D62 2A            mov b, [d] ; Lower Word in B
8799   3D63 60            sub a, b
8800   3D64 27            mov b, a
8801   3D65 E4            pop a
8802   3D66             ; END TERMS
8803   3D66             ; START RELATIONAL
8804   3D66 D7            push a
8805   3D67 FD D8         push g
8806   3D69 11            mov a, b
out/startrek.asm line 8807: Label not found: (c)
out/startrek.asm line 8807: Unused data in MS byte of argument. (2)
8807   3D6A FD 22 00 00   mov g, c
8808   3D6E 26 00 00      mov b, $0
8809   3D71 38 00 00      mov c, 0
8810   3D74 FD AF 00 00   cmp32 ga, cb
8810   3D78 00 00 00 00 
8810   3D7C 00 00 00 00 
8810   3D80 00 00 00 00 
8810   3D84 00 00 00 00 
8810   3D88 00 00 00 00 
8810   3D8C 00 00 00 00 
8810   3D90 00 00 00 00 
8810   3D94 00 00 00 00 
8810   3D98 00 00 00 00 
8810   3D9C 00 00 00 00 
8810   3DA0 00 00 00 00 
8810   3DA4 00 00 00 00 
8810   3DA8 00 00 00 00 
8810   3DAC 00 00 00 00 
8810   3DB0 00 00 00 00 
8810   3DB4 00 00 00 00 
8810   3DB8 00 00 00 00 
8810   3DBC 00 00 00 00 
8810   3DC0 00 00 00 00 
8810   3DC4 00 00 00 00 
8810   3DC8 00 00 00 00 
8810   3DCC 00 00 00 00 
8810   3DD0 00 00 00 00 
8810   3DD4 00 00 00 00 
8810   3DD8 00 00 00 00 
8810   3DDC 00 00 00 00 
8810   3DE0 00 00 00 00 
8810   3DE4 00 00 00 00 
8810   3DE8 00 00 00 00 
8810   3DEC 00 00 00 00 
8810   3DF0 00 00 00 00 
8810   3DF4 00 00 00 00 
8810   3DF8 00 00 00 00 
8810   3DFC 00 00 00 00 
8810   3E00 00 00 00 00 
8810   3E04 00 00 00 00 
8810   3E08 00 00 00 00 
8810   3E0C 00 00 00 00 
8810   3E10 00 00 00 00 
8810   3E14 00 00 00 00 
8810   3E18 00 00 00 00 
8810   3E1C 00 00 00 00 
8810   3E20 00 00 00 00 
8810   3E24 00 00 00 00 
8810   3E28 00 00 00 00 
8810   3E2C 00 00 00 00 
8810   3E30 00 00 00 00 
8810   3E34 00 00 00 00 
8810   3E38 00 00 00 00 
8810   3E3C 00 00 00 00 
8810   3E40 00 00 00 00 
8810   3E44 00 00 00 00 
8810   3E48 00 00 00 00 
8810   3E4C 00 00 00 00 
8810   3E50 00 00 00 00 
8810   3E54 00 00 00 00 
8810   3E58 00 00 00 00 
8810   3E5C 00 00 00 00 
8810   3E60 00 00 00 00 
8810   3E64 00 00 00 00 
8810   3E68 00 00 00 00 
8810   3E6C 00 00 00 00 
8810   3E70 00 00 00 00 
8810   3E74 00 
8811   3E75 FD 73         slt ; <
8812   3E77 FD F1         pop g
8813   3E79 E4            pop a
8814   3E7A             ; END RELATIONAL
8815   3E7A C0 00 00      cmp b, 0
8816   3E7D C6 91 3E      je _if142_exit
8817   3E80             _if142_true:
8818   3E80             ;; puts("Not enough energy available.\n"); 
8819   3E80 26 7F 6C      mov b, __s97 ; "Not enough energy available.\n"
8820   3E83 FD AB         swp b
8821   3E85 D8            push b
8822   3E86 07 37 13      call puts
8823   3E89 51 02 00      add sp, 2
8824   3E8C             ;; return; 
8825   3E8C F9            leave
8826   3E8D 09            ret
8827   3E8E 0A 91 3E      jmp _if142_exit
8828   3E91             _if142_exit:
8829   3E91             ;; energy = energy -  phaser_energy; 
8830   3E91 3B 2F 62      mov d, _energy ; $energy
8831   3E94 DA            push d
8832   3E95 3B 2F 62      mov d, _energy ; $energy
8833   3E98 2A            mov b, [d]
8834   3E99             ; START TERMS
8835   3E99 D7            push a
8836   3E9A 11            mov a, b
8837   3E9B FA FB FF      lea d, [bp + -5] ; $phaser_energy
8838   3E9E 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
8839   3EA1 FD 39         mov c, b ; And place it into C
8840   3EA3 2A            mov b, [d] ; Lower Word in B
8841   3EA4 60            sub a, b
8842   3EA5 27            mov b, a
8843   3EA6 E4            pop a
8844   3EA7             ; END TERMS
8845   3EA7 E7            pop d
8846   3EA8 FD 43         mov [d], b
8847   3EAA             ;; if (damage[8] < 0) 
8848   3EAA             _if143_cond:
8849   3EAA 3B F1 62      mov d, _damage_data ; $damage
8850   3EAD D7            push a
8851   3EAE DA            push d
8852   3EAF 26 08 00      mov b, $8
8853   3EB2 E7            pop d
8854   3EB3 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
8855   3EB7 E4            pop a
8856   3EB8 2A            mov b, [d]
8857   3EB9             ; START RELATIONAL
8858   3EB9 D7            push a
8859   3EBA 11            mov a, b
8860   3EBB 26 00 00      mov b, $0
8861   3EBE B0            cmp a, b
8862   3EBF FD 73         slt ; < (signed)
8863   3EC1 E4            pop a
8864   3EC2             ; END RELATIONAL
8865   3EC2 C0 00 00      cmp b, 0
8866   3EC5 C6 F2 3E      je _if143_else
8867   3EC8             _if143_true:
8868   3EC8             ;; phaser_energy =phaser_energy * get_rand(100); 
8869   3EC8 FA FB FF      lea d, [bp + -5] ; $phaser_energy
8870   3ECB DA            push d
8871   3ECC FA FB FF      lea d, [bp + -5] ; $phaser_energy
8872   3ECF 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
8873   3ED2 FD 39         mov c, b ; And place it into C
8874   3ED4 2A            mov b, [d] ; Lower Word in B
8875   3ED5             ; START FACTORS
8876   3ED5 D7            push a
8877   3ED6 11            mov a, b
8878   3ED7 26 64 00      mov b, $64
8879   3EDA FD AB         swp b
8880   3EDC D8            push b
8881   3EDD 07 25 1D      call get_rand
8882   3EE0 51 02 00      add sp, 2
8883   3EE3 AC            mul a, b ; *
8884   3EE4 11            mov a, b
8885   3EE5 27            mov b, a
8886   3EE6 E4            pop a
8887   3EE7             ; END FACTORS
8888   3EE7 E7            pop d
8889   3EE8 FD 43         mov [d], b
8890   3EEA 28            mov b, c
8891   3EEB FD 44 02 00   mov [d + 2], b
8892   3EEF 0A 10 3F      jmp _if143_exit
8893   3EF2             _if143_else:
8894   3EF2             ;; phaser_energy = phaser_energy* 100; 
8895   3EF2 FA FB FF      lea d, [bp + -5] ; $phaser_energy
8896   3EF5 DA            push d
8897   3EF6 FA FB FF      lea d, [bp + -5] ; $phaser_energy
8898   3EF9 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
8899   3EFC FD 39         mov c, b ; And place it into C
8900   3EFE 2A            mov b, [d] ; Lower Word in B
8901   3EFF             ; START FACTORS
8902   3EFF D7            push a
8903   3F00 11            mov a, b
8904   3F01 26 64 00      mov b, $64
8905   3F04 AC            mul a, b ; *
8906   3F05 11            mov a, b
8907   3F06 27            mov b, a
8908   3F07 E4            pop a
8909   3F08             ; END FACTORS
8910   3F08 E7            pop d
8911   3F09 FD 43         mov [d], b
8912   3F0B 28            mov b, c
8913   3F0C FD 44 02 00   mov [d + 2], b
8914   3F10             _if143_exit:
8915   3F10             ;; h1 = phaser_energy / klingons; 
8916   3F10 FA F7 FF      lea d, [bp + -9] ; $h1
8917   3F13 DA            push d
8918   3F14 FA FB FF      lea d, [bp + -5] ; $phaser_energy
8919   3F17 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
8920   3F1A FD 39         mov c, b ; And place it into C
8921   3F1C 2A            mov b, [d] ; Lower Word in B
8922   3F1D             ; START FACTORS
8923   3F1D D7            push a
8924   3F1E 11            mov a, b
8925   3F1F 3B E1 62      mov d, _klingons ; $klingons
8926   3F22 32            mov bl, [d]
8927   3F23 A7 00         mov bh, 0
8928   3F25 AE            div a, b
8929   3F26 27            mov b, a
8930   3F27 E4            pop a
8931   3F28             ; END FACTORS
8932   3F28 E7            pop d
8933   3F29 FD 43         mov [d], b
8934   3F2B 28            mov b, c
8935   3F2C FD 44 02 00   mov [d + 2], b
8936   3F30             ;; for (i = 0; i <= 2; i++) { 
8937   3F30             _for144_init:
8938   3F30 FA FF FF      lea d, [bp + -1] ; $i
8939   3F33 DA            push d
8940   3F34 26 00 00      mov b, $0
8941   3F37 E7            pop d
8942   3F38 FD 43         mov [d], b
8943   3F3A             _for144_cond:
8944   3F3A FA FF FF      lea d, [bp + -1] ; $i
8945   3F3D 2A            mov b, [d]
8946   3F3E             ; START RELATIONAL
8947   3F3E D7            push a
8948   3F3F 11            mov a, b
8949   3F40 26 02 00      mov b, $2
8950   3F43 B0            cmp a, b
8951   3F44 FD 73         slt ; <= (signed)
8952   3F46 E4            pop a
8953   3F47             ; END RELATIONAL
8954   3F47 C0 00 00      cmp b, 0
8955   3F4A C6 67 41      je _for144_exit
8956   3F4D             _for144_block:
8957   3F4D             ;; if (k->energy > 0) { 
8958   3F4D             _if145_cond:
8959   3F4D FA F3 FF      lea d, [bp + -13] ; $k
8960   3F50 FD 2A         mov d, [d]
8961   3F52 58 02 00      add d, 2
8962   3F55 2A            mov b, [d]
8963   3F56             ; START RELATIONAL
8964   3F56 D7            push a
8965   3F57 11            mov a, b
8966   3F58 26 00 00      mov b, $0
8967   3F5B B0            cmp a, b
8968   3F5C FD 7F         sgt ; >
8969   3F5E E4            pop a
8970   3F5F             ; END RELATIONAL
8971   3F5F C0 00 00      cmp b, 0
8972   3F62 C6 4A 41      je _if145_exit
8973   3F65             _if145_true:
8974   3F65             ;; h1 = h1 * (get_rand(100) + 200); 
8975   3F65 FA F7 FF      lea d, [bp + -9] ; $h1
8976   3F68 DA            push d
8977   3F69 FA F7 FF      lea d, [bp + -9] ; $h1
8978   3F6C 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
8979   3F6F FD 39         mov c, b ; And place it into C
8980   3F71 2A            mov b, [d] ; Lower Word in B
8981   3F72             ; START FACTORS
8982   3F72 D7            push a
8983   3F73 11            mov a, b
8984   3F74 26 64 00      mov b, $64
8985   3F77 FD AB         swp b
8986   3F79 D8            push b
8987   3F7A 07 25 1D      call get_rand
8988   3F7D 51 02 00      add sp, 2
8989   3F80             ; START TERMS
8990   3F80 D7            push a
8991   3F81 11            mov a, b
8992   3F82 26 C8 00      mov b, $c8
8993   3F85 56            add b, a
8994   3F86 E4            pop a
8995   3F87             ; END TERMS
8996   3F87 AC            mul a, b ; *
8997   3F88 11            mov a, b
8998   3F89 27            mov b, a
8999   3F8A E4            pop a
9000   3F8B             ; END FACTORS
9001   3F8B E7            pop d
9002   3F8C FD 43         mov [d], b
9003   3F8E 28            mov b, c
9004   3F8F FD 44 02 00   mov [d + 2], b
9005   3F93             ;; h1 =h1/ distance_to(k); 
9006   3F93 FA F7 FF      lea d, [bp + -9] ; $h1
9007   3F96 DA            push d
9008   3F97 FA F7 FF      lea d, [bp + -9] ; $h1
9009   3F9A 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
9010   3F9D FD 39         mov c, b ; And place it into C
9011   3F9F 2A            mov b, [d] ; Lower Word in B
9012   3FA0             ; START FACTORS
9013   3FA0 D7            push a
9014   3FA1 11            mov a, b
9015   3FA2 FA F3 FF      lea d, [bp + -13] ; $k
9016   3FA5 2A            mov b, [d]
9017   3FA6 FD AB         swp b
9018   3FA8 D8            push b
9019   3FA9 07 58 61      call distance_to
9020   3FAC 51 02 00      add sp, 2
9021   3FAF AE            div a, b
9022   3FB0 27            mov b, a
9023   3FB1 E4            pop a
9024   3FB2             ; END FACTORS
9025   3FB2 E7            pop d
9026   3FB3 FD 43         mov [d], b
9027   3FB5 28            mov b, c
9028   3FB6 FD 44 02 00   mov [d + 2], b
9029   3FBA             ;; if (h1 <= 15 * k->energy) {	/* was 0.15 */ 
9030   3FBA             _if146_cond:
9031   3FBA FA F7 FF      lea d, [bp + -9] ; $h1
9032   3FBD 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
9033   3FC0 FD 39         mov c, b ; And place it into C
9034   3FC2 2A            mov b, [d] ; Lower Word in B
9035   3FC3             ; START RELATIONAL
9036   3FC3 D7            push a
9037   3FC4 FD D8         push g
9038   3FC6 11            mov a, b
out/startrek.asm line 9039: Label not found: (c)
out/startrek.asm line 9039: Unused data in MS byte of argument. (2)
9039   3FC7 FD 22 00 00   mov g, c
9040   3FCB 26 0F 00      mov b, $f
9041   3FCE             ; START FACTORS
9042   3FCE D7            push a
9043   3FCF 11            mov a, b
9044   3FD0 FA F3 FF      lea d, [bp + -13] ; $k
9045   3FD3 FD 2A         mov d, [d]
9046   3FD5 58 02 00      add d, 2
9047   3FD8 2A            mov b, [d]
9048   3FD9 AC            mul a, b ; *
9049   3FDA 11            mov a, b
9050   3FDB 27            mov b, a
9051   3FDC E4            pop a
9052   3FDD             ; END FACTORS
9053   3FDD 38 00 00      mov c, 0
9054   3FE0 FD 76         sleu
9055   3FE2 FD F1         pop g
9056   3FE4 E4            pop a
9057   3FE5             ; END RELATIONAL
9058   3FE5 C0 00 00      cmp b, 0
9059   3FE8 C6 12 40      je _if146_else
9060   3FEB             _if146_true:
9061   3FEB             ;; printf("Sensors show no damage to enemy at %d, %d\n\n", k->y, k->x); 
9062   3FEB FA F3 FF      lea d, [bp + -13] ; $k
9063   3FEE FD 2A         mov d, [d]
9064   3FF0 58 01 00      add d, 1
9065   3FF3 32            mov bl, [d]
9066   3FF4 A7 00         mov bh, 0
9067   3FF6 DD            push bl
9068   3FF7 FA F3 FF      lea d, [bp + -13] ; $k
9069   3FFA FD 2A         mov d, [d]
9070   3FFC 58 00 00      add d, 0
9071   3FFF 32            mov bl, [d]
9072   4000 A7 00         mov bh, 0
9073   4002 DD            push bl
9074   4003 26 9D 6C      mov b, __s98 ; "Sensors show no damage to enemy at %d, %d\n\n"
9075   4006 FD AB         swp b
9076   4008 D8            push b
9077   4009 07 D1 05      call printf
9078   400C 51 04 00      add sp, 4
9079   400F 0A 47 41      jmp _if146_exit
9080   4012             _if146_else:
9081   4012             ;; h = FROM_FIXED00(h1); 
9082   4012 FA F5 FF      lea d, [bp + -11] ; $h
9083   4015 DA            push d
9084   4016 FA F7 FF      lea d, [bp + -9] ; $h1
9085   4019 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
9086   401C FD 39         mov c, b ; And place it into C
9087   401E 2A            mov b, [d] ; Lower Word in B
9088   401F FD AB         swp b
9089   4021 D8            push b
9090   4022 07 14 1D      call FROM_FIXED00
9091   4025 51 02 00      add sp, 2
9092   4028 E7            pop d
9093   4029 FD 43         mov [d], b
9094   402B             ;; k->energy = k->energy - h; 
9095   402B FA F3 FF      lea d, [bp + -13] ; $k
9096   402E FD 2A         mov d, [d]
9097   4030 58 02 00      add d, 2
9098   4033 DA            push d
9099   4034 FA F3 FF      lea d, [bp + -13] ; $k
9100   4037 FD 2A         mov d, [d]
9101   4039 58 02 00      add d, 2
9102   403C 2A            mov b, [d]
9103   403D             ; START TERMS
9104   403D D7            push a
9105   403E 11            mov a, b
9106   403F FA F5 FF      lea d, [bp + -11] ; $h
9107   4042 2A            mov b, [d]
9108   4043 60            sub a, b
9109   4044 27            mov b, a
9110   4045 E4            pop a
9111   4046             ; END TERMS
9112   4046 E7            pop d
9113   4047 FD 43         mov [d], b
9114   4049             ;; printf("%d unit hit on Klingon at sector %d, %d\n", 
9115   4049 FA F3 FF      lea d, [bp + -13] ; $k
9116   404C FD 2A         mov d, [d]
9117   404E 58 01 00      add d, 1
9118   4051 32            mov bl, [d]
9119   4052 A7 00         mov bh, 0
9120   4054 DD            push bl
9121   4055 FA F3 FF      lea d, [bp + -13] ; $k
9122   4058 FD 2A         mov d, [d]
9123   405A 58 00 00      add d, 0
9124   405D 32            mov bl, [d]
9125   405E A7 00         mov bh, 0
9126   4060 DD            push bl
9127   4061 FA F5 FF      lea d, [bp + -11] ; $h
9128   4064 2A            mov b, [d]
9129   4065 FD AB         swp b
9130   4067 D8            push b
9131   4068 26 C9 6C      mov b, __s99 ; "%d unit hit on Klingon at sector %d, %d\n"
9132   406B FD AB         swp b
9133   406D D8            push b
9134   406E 07 D1 05      call printf
9135   4071 51 06 00      add sp, 6
9136   4074             ;; if (k->energy <= 0) { 
9137   4074             _if147_cond:
9138   4074 FA F3 FF      lea d, [bp + -13] ; $k
9139   4077 FD 2A         mov d, [d]
9140   4079 58 02 00      add d, 2
9141   407C 2A            mov b, [d]
9142   407D             ; START RELATIONAL
9143   407D D7            push a
9144   407E 11            mov a, b
9145   407F 26 00 00      mov b, $0
9146   4082 B0            cmp a, b
9147   4083 FD 73         slt ; <= (signed)
9148   4085 E4            pop a
9149   4086             ; END RELATIONAL
9150   4086 C0 00 00      cmp b, 0
9151   4089 C6 2F 41      je _if147_else
9152   408C             _if147_true:
9153   408C             ;; puts("*** Klingon Destroyed ***\n"); 
9154   408C 26 F2 6C      mov b, __s100 ; "*** Klingon Destroyed ***\n"
9155   408F FD AB         swp b
9156   4091 D8            push b
9157   4092 07 37 13      call puts
9158   4095 51 02 00      add sp, 2
9159   4098             ;; klingons--; 
9160   4098 3B E1 62      mov d, _klingons ; $klingons
9161   409B 32            mov bl, [d]
9162   409C A7 00         mov bh, 0
9163   409E D8            push b
9164   409F FD 7D         dec b
9165   40A1 3B E1 62      mov d, _klingons ; $klingons
9166   40A4 FD 43         mov [d], b
9167   40A6 E5            pop b
9168   40A7             ;; klingons_left--; 
9169   40A7 3B E3 62      mov d, _klingons_left ; $klingons_left
9170   40AA 32            mov bl, [d]
9171   40AB A7 00         mov bh, 0
9172   40AD D8            push b
9173   40AE FD 7D         dec b
9174   40B0 3B E3 62      mov d, _klingons_left ; $klingons_left
9175   40B3 FD 43         mov [d], b
9176   40B5 E5            pop b
9177   40B6             ;; wipe_klingon(k); 
9178   40B6 FA F3 FF      lea d, [bp + -13] ; $k
9179   40B9 2A            mov b, [d]
9180   40BA FD AB         swp b
9181   40BC D8            push b
9182   40BD 07 58 3C      call wipe_klingon
9183   40C0 51 02 00      add sp, 2
9184   40C3             ;; k->energy = 0; 
9185   40C3 FA F3 FF      lea d, [bp + -13] ; $k
9186   40C6 FD 2A         mov d, [d]
9187   40C8 58 02 00      add d, 2
9188   40CB DA            push d
9189   40CC 26 00 00      mov b, $0
9190   40CF E7            pop d
9191   40D0 FD 43         mov [d], b
9192   40D2             ;; map[quad_y][quad_x] = map[quad_y][quad_x] - 0x100; 
9193   40D2 3B 33 62      mov d, _map_data ; $map
9194   40D5 D7            push a
9195   40D6 DA            push d
9196   40D7 3B E6 62      mov d, _quad_y ; $quad_y
9197   40DA 2A            mov b, [d]
9198   40DB E7            pop d
9199   40DC FD 13 12 00   mma 18 ; mov a, 18; mul a, b; add d, b
9200   40E0 DA            push d
9201   40E1 3B E8 62      mov d, _quad_x ; $quad_x
9202   40E4 2A            mov b, [d]
9203   40E5 E7            pop d
9204   40E6 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
9205   40EA E4            pop a
9206   40EB DA            push d
9207   40EC 3B 33 62      mov d, _map_data ; $map
9208   40EF D7            push a
9209   40F0 DA            push d
9210   40F1 3B E6 62      mov d, _quad_y ; $quad_y
9211   40F4 2A            mov b, [d]
9212   40F5 E7            pop d
9213   40F6 FD 13 12 00   mma 18 ; mov a, 18; mul a, b; add d, b
9214   40FA DA            push d
9215   40FB 3B E8 62      mov d, _quad_x ; $quad_x
9216   40FE 2A            mov b, [d]
9217   40FF E7            pop d
9218   4100 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
9219   4104 E4            pop a
9220   4105 2A            mov b, [d]
9221   4106             ; START TERMS
9222   4106 D7            push a
9223   4107 11            mov a, b
9224   4108 26 00 01      mov b, $100
9225   410B 60            sub a, b
9226   410C 27            mov b, a
9227   410D E4            pop a
9228   410E             ; END TERMS
9229   410E E7            pop d
9230   410F FD 43         mov [d], b
9231   4111             ;; if (klingons_left <= 0) 
9232   4111             _if148_cond:
9233   4111 3B E3 62      mov d, _klingons_left ; $klingons_left
9234   4114 32            mov bl, [d]
9235   4115 A7 00         mov bh, 0
9236   4117             ; START RELATIONAL
9237   4117 D7            push a
9238   4118 11            mov a, b
9239   4119 26 00 00      mov b, $0
9240   411C B0            cmp a, b
9241   411D FD 75         slu ; <= (unsigned)
9242   411F E4            pop a
9243   4120             ; END RELATIONAL
9244   4120 C0 00 00      cmp b, 0
9245   4123 C6 2C 41      je _if148_exit
9246   4126             _if148_true:
9247   4126             ;; won_game(); 
9248   4126 07 76 56      call won_game
9249   4129 0A 2C 41      jmp _if148_exit
9250   412C             _if148_exit:
9251   412C 0A 47 41      jmp _if147_exit
9252   412F             _if147_else:
9253   412F             ;; printf("   (Sensors show %d units remaining.)\n\n", k->energy); 
9254   412F FA F3 FF      lea d, [bp + -13] ; $k
9255   4132 FD 2A         mov d, [d]
9256   4134 58 02 00      add d, 2
9257   4137 2A            mov b, [d]
9258   4138 FD AB         swp b
9259   413A D8            push b
9260   413B 26 0D 6D      mov b, __s101 ; "   (Sensors show %d units remaining.)\n\n"
9261   413E FD AB         swp b
9262   4140 D8            push b
9263   4141 07 D1 05      call printf
9264   4144 51 04 00      add sp, 4
9265   4147             _if147_exit:
9266   4147             _if146_exit:
9267   4147 0A 4A 41      jmp _if145_exit
9268   414A             _if145_exit:
9269   414A             ;; k++; 
9270   414A FA F3 FF      lea d, [bp + -13] ; $k
9271   414D 2A            mov b, [d]
9272   414E D8            push b
9273   414F FD 77         inc b
9274   4151 FA F3 FF      lea d, [bp + -13] ; $k
9275   4154 FD 43         mov [d], b
9276   4156 E5            pop b
9277   4157             _for144_update:
9278   4157 FA FF FF      lea d, [bp + -1] ; $i
9279   415A 2A            mov b, [d]
9280   415B D8            push b
9281   415C FD 77         inc b
9282   415E FA FF FF      lea d, [bp + -1] ; $i
9283   4161 FD 43         mov [d], b
9284   4163 E5            pop b
9285   4164 0A 3A 3F      jmp _for144_cond
9286   4167             _for144_exit:
9287   4167             ;; klingons_shoot(); 
9288   4167 07 29 58      call klingons_shoot
9289   416A F9            leave
9290   416B 09            ret
9291   416C             
9292   416C             photon_torpedoes:
9293   416C F8 00 00      enter 0 ; (push bp; mov bp, sp)
9294   416F             ; $x3 
9295   416F             ; $y3 
9296   416F             ; $c1 
9297   416F             ; $c2 
9298   416F             ; $c3 
9299   416F             ; $c4 
9300   416F             ; $x 
9301   416F             ; $y 
9302   416F             ; $x1 
9303   416F             ; $x2 
9304   416F             ; $p 
9305   416F 52 15 00      sub sp, 21
9306   4172             ;; if (torps <= 0) { 
9307   4172             _if149_cond:
9308   4172 3B E4 62      mov d, _torps ; $torps
9309   4175 32            mov bl, [d]
9310   4176 A7 00         mov bh, 0
9311   4178             ; START RELATIONAL
9312   4178 D7            push a
9313   4179 11            mov a, b
9314   417A 26 00 00      mov b, $0
9315   417D B0            cmp a, b
9316   417E FD 75         slu ; <= (unsigned)
9317   4180 E4            pop a
9318   4181             ; END RELATIONAL
9319   4181 C0 00 00      cmp b, 0
9320   4184 C6 98 41      je _if149_exit
9321   4187             _if149_true:
9322   4187             ;; puts("All photon torpedoes expended"); 
9323   4187 26 35 6D      mov b, __s102 ; "All photon torpedoes expended"
9324   418A FD AB         swp b
9325   418C D8            push b
9326   418D 07 37 13      call puts
9327   4190 51 02 00      add sp, 2
9328   4193             ;; return; 
9329   4193 F9            leave
9330   4194 09            ret
9331   4195 0A 98 41      jmp _if149_exit
9332   4198             _if149_exit:
9333   4198             ;; if (inoperable(5)) 
9334   4198             _if150_cond:
9335   4198 26 05 00      mov b, $5
9336   419B DD            push bl
9337   419C 07 6A 21      call inoperable
9338   419F 51 01 00      add sp, 1
9339   41A2 C0 00 00      cmp b, 0
9340   41A5 C6 AD 41      je _if150_exit
9341   41A8             _if150_true:
9342   41A8             ;; return; 
9343   41A8 F9            leave
9344   41A9 09            ret
9345   41AA 0A AD 41      jmp _if150_exit
9346   41AD             _if150_exit:
9347   41AD             ;; puts("Course (0-9): "); 
9348   41AD 26 6D 68      mov b, __s65 ; "Course (0-9): "
9349   41B0 FD AB         swp b
9350   41B2 D8            push b
9351   41B3 07 37 13      call puts
9352   41B6 51 02 00      add sp, 2
9353   41B9             ;; c1 = input_f00(); 
9354   41B9 FA FB FF      lea d, [bp + -5] ; $c1
9355   41BC DA            push d
9356   41BD 07 52 1F      call input_f00
9357   41C0 E7            pop d
9358   41C1 FD 43         mov [d], b
9359   41C3             ;; if (c1 == 900) 
9360   41C3             _if151_cond:
9361   41C3 FA FB FF      lea d, [bp + -5] ; $c1
9362   41C6 2A            mov b, [d]
9363   41C7             ; START RELATIONAL
9364   41C7 D7            push a
9365   41C8 11            mov a, b
9366   41C9 26 84 03      mov b, $384
9367   41CC B0            cmp a, b
9368   41CD FD 71         seq ; ==
9369   41CF E4            pop a
9370   41D0             ; END RELATIONAL
9371   41D0 C0 00 00      cmp b, 0
9372   41D3 C6 E3 41      je _if151_exit
9373   41D6             _if151_true:
9374   41D6             ;; c1 = 100; 
9375   41D6 FA FB FF      lea d, [bp + -5] ; $c1
9376   41D9 DA            push d
9377   41DA 26 64 00      mov b, $64
9378   41DD E7            pop d
9379   41DE FD 43         mov [d], b
9380   41E0 0A E3 41      jmp _if151_exit
9381   41E3             _if151_exit:
9382   41E3             ;; if (c1 < 100 || c1 >= 900) { 
9383   41E3             _if152_cond:
9384   41E3 FA FB FF      lea d, [bp + -5] ; $c1
9385   41E6 2A            mov b, [d]
9386   41E7             ; START RELATIONAL
9387   41E7 D7            push a
9388   41E8 11            mov a, b
9389   41E9 26 64 00      mov b, $64
9390   41EC B0            cmp a, b
9391   41ED FD 73         slt ; < (signed)
9392   41EF E4            pop a
9393   41F0             ; END RELATIONAL
9394   41F0 D7            push a
9395   41F1 11            mov a, b
9396   41F2 FA FB FF      lea d, [bp + -5] ; $c1
9397   41F5 2A            mov b, [d]
9398   41F6             ; START RELATIONAL
9399   41F6 D7            push a
9400   41F7 11            mov a, b
9401   41F8 26 84 03      mov b, $384
9402   41FB B0            cmp a, b
9403   41FC FD 80         sge ; >=
9404   41FE E4            pop a
9405   41FF             ; END RELATIONAL
9406   41FF FD A8         sor a, b ; ||
9407   4201 E4            pop a
9408   4202 C0 00 00      cmp b, 0
9409   4205 C6 20 42      je _if152_exit
9410   4208             _if152_true:
9411   4208             ;; printf("Ensign Chekov%s", inc_1); 
9412   4208 3B 7F 63      mov d, _inc_1 ; $inc_1
9413   420B 2A            mov b, [d]
9414   420C FD AB         swp b
9415   420E D8            push b
9416   420F 26 53 6D      mov b, __s103 ; "Ensign Chekov%s"
9417   4212 FD AB         swp b
9418   4214 D8            push b
9419   4215 07 D1 05      call printf
9420   4218 51 04 00      add sp, 4
9421   421B             ;; return; 
9422   421B F9            leave
9423   421C 09            ret
9424   421D 0A 20 42      jmp _if152_exit
9425   4220             _if152_exit:
9426   4220             ;; energy = energy - 2; 
9427   4220 3B 2F 62      mov d, _energy ; $energy
9428   4223 DA            push d
9429   4224 3B 2F 62      mov d, _energy ; $energy
9430   4227 2A            mov b, [d]
9431   4228             ; START TERMS
9432   4228 D7            push a
9433   4229 11            mov a, b
9434   422A 26 02 00      mov b, $2
9435   422D 60            sub a, b
9436   422E 27            mov b, a
9437   422F E4            pop a
9438   4230             ; END TERMS
9439   4230 E7            pop d
9440   4231 FD 43         mov [d], b
9441   4233             ;; torps--; 
9442   4233 3B E4 62      mov d, _torps ; $torps
9443   4236 32            mov bl, [d]
9444   4237 A7 00         mov bh, 0
9445   4239 D8            push b
9446   423A FD 7D         dec b
9447   423C 3B E4 62      mov d, _torps ; $torps
9448   423F FD 43         mov [d], b
9449   4241 E5            pop b
9450   4242             ;; c2 = FROM_FIXED00(c1);	/* Integer part */ 
9451   4242 FA F9 FF      lea d, [bp + -7] ; $c2
9452   4245 DA            push d
9453   4246 FA FB FF      lea d, [bp + -5] ; $c1
9454   4249 2A            mov b, [d]
9455   424A FD AB         swp b
9456   424C D8            push b
9457   424D 07 14 1D      call FROM_FIXED00
9458   4250 51 02 00      add sp, 2
9459   4253 E7            pop d
9460   4254 FD 43         mov [d], b
9461   4256             ;; c3 = c2 + 1;		/* Next integer part */ 
9462   4256 FA F7 FF      lea d, [bp + -9] ; $c3
9463   4259 DA            push d
9464   425A FA F9 FF      lea d, [bp + -7] ; $c2
9465   425D 2A            mov b, [d]
9466   425E             ; START TERMS
9467   425E D7            push a
9468   425F 11            mov a, b
9469   4260 26 01 00      mov b, $1
9470   4263 56            add b, a
9471   4264 E4            pop a
9472   4265             ; END TERMS
9473   4265 E7            pop d
9474   4266 FD 43         mov [d], b
9475   4268             ;; c4 = (c1 - TO_FIXED00(c2));	/* Fractional element in fixed point */ 
9476   4268 FA F5 FF      lea d, [bp + -11] ; $c4
9477   426B DA            push d
9478   426C FA FB FF      lea d, [bp + -5] ; $c1
9479   426F 2A            mov b, [d]
9480   4270             ; START TERMS
9481   4270 D7            push a
9482   4271 11            mov a, b
9483   4272 FA F9 FF      lea d, [bp + -7] ; $c2
9484   4275 2A            mov b, [d]
9485   4276 FD AB         swp b
9486   4278 D8            push b
9487   4279 07 02 1D      call TO_FIXED00
9488   427C 51 02 00      add sp, 2
9489   427F 60            sub a, b
9490   4280 27            mov b, a
9491   4281 E4            pop a
9492   4282             ; END TERMS
9493   4282 E7            pop d
9494   4283 FD 43         mov [d], b
9495   4285             ;; x1 = 100 * c[1][c2] + (c[1][c3] - c[1][c2]) * c4; 
9496   4285 FA EF FF      lea d, [bp + -17] ; $x1
9497   4288 DA            push d
9498   4289 26 64 00      mov b, $64
9499   428C             ; START FACTORS
9500   428C D7            push a
9501   428D 11            mov a, b
9502   428E 3B 0F 62      mov d, _c_data ; $c
9503   4291 D7            push a
9504   4292 DA            push d
9505   4293 26 01 00      mov b, $1
9506   4296 E7            pop d
9507   4297 FD 13 0A 00   mma 10 ; mov a, 10; mul a, b; add d, b
9508   429B DA            push d
9509   429C FA F9 FF      lea d, [bp + -7] ; $c2
9510   429F 2A            mov b, [d]
9511   42A0 E7            pop d
9512   42A1 5A            add d, b
9513   42A2 E4            pop a
9514   42A3 32            mov bl, [d]
9515   42A4 A7 00         mov bh, 0
9516   42A6 AC            mul a, b ; *
9517   42A7 11            mov a, b
9518   42A8 27            mov b, a
9519   42A9 E4            pop a
9520   42AA             ; END FACTORS
9521   42AA             ; START TERMS
9522   42AA D7            push a
9523   42AB 11            mov a, b
9524   42AC 3B 0F 62      mov d, _c_data ; $c
9525   42AF D7            push a
9526   42B0 DA            push d
9527   42B1 26 01 00      mov b, $1
9528   42B4 E7            pop d
9529   42B5 FD 13 0A 00   mma 10 ; mov a, 10; mul a, b; add d, b
9530   42B9 DA            push d
9531   42BA FA F7 FF      lea d, [bp + -9] ; $c3
9532   42BD 2A            mov b, [d]
9533   42BE E7            pop d
9534   42BF 5A            add d, b
9535   42C0 E4            pop a
9536   42C1 32            mov bl, [d]
9537   42C2 A7 00         mov bh, 0
9538   42C4             ; START TERMS
9539   42C4 D7            push a
9540   42C5 11            mov a, b
9541   42C6 3B 0F 62      mov d, _c_data ; $c
9542   42C9 D7            push a
9543   42CA DA            push d
9544   42CB 26 01 00      mov b, $1
9545   42CE E7            pop d
9546   42CF FD 13 0A 00   mma 10 ; mov a, 10; mul a, b; add d, b
9547   42D3 DA            push d
9548   42D4 FA F9 FF      lea d, [bp + -7] ; $c2
9549   42D7 2A            mov b, [d]
9550   42D8 E7            pop d
9551   42D9 5A            add d, b
9552   42DA E4            pop a
9553   42DB 32            mov bl, [d]
9554   42DC A7 00         mov bh, 0
9555   42DE 60            sub a, b
9556   42DF 27            mov b, a
9557   42E0 E4            pop a
9558   42E1             ; END TERMS
9559   42E1             ; START FACTORS
9560   42E1 D7            push a
9561   42E2 11            mov a, b
9562   42E3 FA F5 FF      lea d, [bp + -11] ; $c4
9563   42E6 2A            mov b, [d]
9564   42E7 AC            mul a, b ; *
9565   42E8 11            mov a, b
9566   42E9 27            mov b, a
9567   42EA E4            pop a
9568   42EB             ; END FACTORS
9569   42EB 56            add b, a
9570   42EC E4            pop a
9571   42ED             ; END TERMS
9572   42ED E7            pop d
9573   42EE FD 43         mov [d], b
9574   42F0             ;; x2 = 100 * c[2][c2] + (c[2][c3] - c[2][c2]) * c4; 
9575   42F0 FA ED FF      lea d, [bp + -19] ; $x2
9576   42F3 DA            push d
9577   42F4 26 64 00      mov b, $64
9578   42F7             ; START FACTORS
9579   42F7 D7            push a
9580   42F8 11            mov a, b
9581   42F9 3B 0F 62      mov d, _c_data ; $c
9582   42FC D7            push a
9583   42FD DA            push d
9584   42FE 26 02 00      mov b, $2
9585   4301 E7            pop d
9586   4302 FD 13 0A 00   mma 10 ; mov a, 10; mul a, b; add d, b
9587   4306 DA            push d
9588   4307 FA F9 FF      lea d, [bp + -7] ; $c2
9589   430A 2A            mov b, [d]
9590   430B E7            pop d
9591   430C 5A            add d, b
9592   430D E4            pop a
9593   430E 32            mov bl, [d]
9594   430F A7 00         mov bh, 0
9595   4311 AC            mul a, b ; *
9596   4312 11            mov a, b
9597   4313 27            mov b, a
9598   4314 E4            pop a
9599   4315             ; END FACTORS
9600   4315             ; START TERMS
9601   4315 D7            push a
9602   4316 11            mov a, b
9603   4317 3B 0F 62      mov d, _c_data ; $c
9604   431A D7            push a
9605   431B DA            push d
9606   431C 26 02 00      mov b, $2
9607   431F E7            pop d
9608   4320 FD 13 0A 00   mma 10 ; mov a, 10; mul a, b; add d, b
9609   4324 DA            push d
9610   4325 FA F7 FF      lea d, [bp + -9] ; $c3
9611   4328 2A            mov b, [d]
9612   4329 E7            pop d
9613   432A 5A            add d, b
9614   432B E4            pop a
9615   432C 32            mov bl, [d]
9616   432D A7 00         mov bh, 0
9617   432F             ; START TERMS
9618   432F D7            push a
9619   4330 11            mov a, b
9620   4331 3B 0F 62      mov d, _c_data ; $c
9621   4334 D7            push a
9622   4335 DA            push d
9623   4336 26 02 00      mov b, $2
9624   4339 E7            pop d
9625   433A FD 13 0A 00   mma 10 ; mov a, 10; mul a, b; add d, b
9626   433E DA            push d
9627   433F FA F9 FF      lea d, [bp + -7] ; $c2
9628   4342 2A            mov b, [d]
9629   4343 E7            pop d
9630   4344 5A            add d, b
9631   4345 E4            pop a
9632   4346 32            mov bl, [d]
9633   4347 A7 00         mov bh, 0
9634   4349 60            sub a, b
9635   434A 27            mov b, a
9636   434B E4            pop a
9637   434C             ; END TERMS
9638   434C             ; START FACTORS
9639   434C D7            push a
9640   434D 11            mov a, b
9641   434E FA F5 FF      lea d, [bp + -11] ; $c4
9642   4351 2A            mov b, [d]
9643   4352 AC            mul a, b ; *
9644   4353 11            mov a, b
9645   4354 27            mov b, a
9646   4355 E4            pop a
9647   4356             ; END FACTORS
9648   4356 56            add b, a
9649   4357 E4            pop a
9650   4358             ; END TERMS
9651   4358 E7            pop d
9652   4359 FD 43         mov [d], b
9653   435B             ;; x = ship_y + x1; 
9654   435B FA F3 FF      lea d, [bp + -13] ; $x
9655   435E DA            push d
9656   435F 3B 05 63      mov d, _ship_y ; $ship_y
9657   4362 2A            mov b, [d]
9658   4363             ; START TERMS
9659   4363 D7            push a
9660   4364 11            mov a, b
9661   4365 FA EF FF      lea d, [bp + -17] ; $x1
9662   4368 2A            mov b, [d]
9663   4369 56            add b, a
9664   436A E4            pop a
9665   436B             ; END TERMS
9666   436B E7            pop d
9667   436C FD 43         mov [d], b
9668   436E             ;; y = ship_x + x2; 
9669   436E FA F1 FF      lea d, [bp + -15] ; $y
9670   4371 DA            push d
9671   4372 3B 07 63      mov d, _ship_x ; $ship_x
9672   4375 2A            mov b, [d]
9673   4376             ; START TERMS
9674   4376 D7            push a
9675   4377 11            mov a, b
9676   4378 FA ED FF      lea d, [bp + -19] ; $x2
9677   437B 2A            mov b, [d]
9678   437C 56            add b, a
9679   437D E4            pop a
9680   437E             ; END TERMS
9681   437E E7            pop d
9682   437F FD 43         mov [d], b
9683   4381             ;; x3 = FROM_FIXED00(x); 
9684   4381 FA FF FF      lea d, [bp + -1] ; $x3
9685   4384 DA            push d
9686   4385 FA F3 FF      lea d, [bp + -13] ; $x
9687   4388 2A            mov b, [d]
9688   4389 FD AB         swp b
9689   438B D8            push b
9690   438C 07 14 1D      call FROM_FIXED00
9691   438F 51 02 00      add sp, 2
9692   4392 E7            pop d
9693   4393 FD 43         mov [d], b
9694   4395             ;; y3 = FROM_FIXED00(y); 
9695   4395 FA FD FF      lea d, [bp + -3] ; $y3
9696   4398 DA            push d
9697   4399 FA F1 FF      lea d, [bp + -15] ; $y
9698   439C 2A            mov b, [d]
9699   439D FD AB         swp b
9700   439F D8            push b
9701   43A0 07 14 1D      call FROM_FIXED00
9702   43A3 51 02 00      add sp, 2
9703   43A6 E7            pop d
9704   43A7 FD 43         mov [d], b
9705   43A9             ;; puts("Torpedo Track:"); 
9706   43A9 26 63 6D      mov b, __s104 ; "Torpedo Track:"
9707   43AC FD AB         swp b
9708   43AE D8            push b
9709   43AF 07 37 13      call puts
9710   43B2 51 02 00      add sp, 2
9711   43B5             ;; while (x3 >= 1 && x3 <= 8 && y3 >= 1 && y3 <= 8) { 
9712   43B5             _while153_cond:
9713   43B5 FA FF FF      lea d, [bp + -1] ; $x3
9714   43B8 2A            mov b, [d]
9715   43B9             ; START RELATIONAL
9716   43B9 D7            push a
9717   43BA 11            mov a, b
9718   43BB 26 01 00      mov b, $1
9719   43BE B0            cmp a, b
9720   43BF FD 80         sge ; >=
9721   43C1 E4            pop a
9722   43C2             ; END RELATIONAL
9723   43C2 D7            push a
9724   43C3 11            mov a, b
9725   43C4 FA FF FF      lea d, [bp + -1] ; $x3
9726   43C7 2A            mov b, [d]
9727   43C8             ; START RELATIONAL
9728   43C8 D7            push a
9729   43C9 11            mov a, b
9730   43CA 26 08 00      mov b, $8
9731   43CD B0            cmp a, b
9732   43CE FD 73         slt ; <= (signed)
9733   43D0 E4            pop a
9734   43D1             ; END RELATIONAL
9735   43D1 FD A7         sand a, b
9736   43D3 11            mov a, b
9737   43D4 FA FD FF      lea d, [bp + -3] ; $y3
9738   43D7 2A            mov b, [d]
9739   43D8             ; START RELATIONAL
9740   43D8 D7            push a
9741   43D9 11            mov a, b
9742   43DA 26 01 00      mov b, $1
9743   43DD B0            cmp a, b
9744   43DE FD 80         sge ; >=
9745   43E0 E4            pop a
9746   43E1             ; END RELATIONAL
9747   43E1 FD A7         sand a, b
9748   43E3 11            mov a, b
9749   43E4 FA FD FF      lea d, [bp + -3] ; $y3
9750   43E7 2A            mov b, [d]
9751   43E8             ; START RELATIONAL
9752   43E8 D7            push a
9753   43E9 11            mov a, b
9754   43EA 26 08 00      mov b, $8
9755   43ED B0            cmp a, b
9756   43EE FD 73         slt ; <= (signed)
9757   43F0 E4            pop a
9758   43F1             ; END RELATIONAL
9759   43F1 FD A7         sand a, b
9760   43F3 E4            pop a
9761   43F4 C0 00 00      cmp b, 0
9762   43F7 C6 E8 44      je _while153_exit
9763   43FA             _while153_block:
9764   43FA             ;; printf("    %d, %d\n", x3, y3); 
9765   43FA FA FD FF      lea d, [bp + -3] ; $y3
9766   43FD 2A            mov b, [d]
9767   43FE FD AB         swp b
9768   4400 D8            push b
9769   4401 FA FF FF      lea d, [bp + -1] ; $x3
9770   4404 2A            mov b, [d]
9771   4405 FD AB         swp b
9772   4407 D8            push b
9773   4408 26 72 6D      mov b, __s105 ; "    %d, %d\n"
9774   440B FD AB         swp b
9775   440D D8            push b
9776   440E 07 D1 05      call printf
9777   4411 51 06 00      add sp, 6
9778   4414             ;; p = quad[x3+-1][y3+-1]; 
9779   4414 FA EC FF      lea d, [bp + -20] ; $p
9780   4417 DA            push d
9781   4418 3B 0B 63      mov d, _quad_data ; $quad
9782   441B D7            push a
9783   441C DA            push d
9784   441D FA FF FF      lea d, [bp + -1] ; $x3
9785   4420 2A            mov b, [d]
9786   4421             ; START TERMS
9787   4421 D7            push a
9788   4422 11            mov a, b
9789   4423 26 FF FF      mov b, 65535
9790   4426 38 FF FF      mov c, 65535
9791   4429 54            add a, b
9792   442A D7            push a
9793   442B FD 12         mov a, g
9794   442D 28            mov b, c
9795   442E 5C            adc a, b
9796   442F 39            mov c, a
9797   4430 E5            pop b
9798   4431 E4            pop a
9799   4432             ; END TERMS
9800   4432 E7            pop d
9801   4433 FD 13 08 00   mma 8 ; mov a, 8; mul a, b; add d, b
9802   4437 DA            push d
9803   4438 FA FD FF      lea d, [bp + -3] ; $y3
9804   443B 2A            mov b, [d]
9805   443C             ; START TERMS
9806   443C D7            push a
9807   443D 11            mov a, b
9808   443E 26 FF FF      mov b, 65535
9809   4441 38 FF FF      mov c, 65535
9810   4444 54            add a, b
9811   4445 D7            push a
9812   4446 FD 12         mov a, g
9813   4448 28            mov b, c
9814   4449 5C            adc a, b
9815   444A 39            mov c, a
9816   444B E5            pop b
9817   444C E4            pop a
9818   444D             ; END TERMS
9819   444D E7            pop d
9820   444E 5A            add d, b
9821   444F E4            pop a
9822   4450 32            mov bl, [d]
9823   4451 A7 00         mov bh, 0
9824   4453 E7            pop d
9825   4454 FD 3E         mov [d], bl
9826   4456             ;; if (p !=  		0       && p !=  		4     ) { 
9827   4456             _if154_cond:
9828   4456 FA EC FF      lea d, [bp + -20] ; $p
9829   4459 32            mov bl, [d]
9830   445A A7 00         mov bh, 0
9831   445C             ; START RELATIONAL
9832   445C D7            push a
9833   445D 11            mov a, b
9834   445E 26 00 00      mov b, $0
9835   4461 B0            cmp a, b
9836   4462 FD 72         sneq ; !=
9837   4464 E4            pop a
9838   4465             ; END RELATIONAL
9839   4465 D7            push a
9840   4466 11            mov a, b
9841   4467 FA EC FF      lea d, [bp + -20] ; $p
9842   446A 32            mov bl, [d]
9843   446B A7 00         mov bh, 0
9844   446D             ; START RELATIONAL
9845   446D D7            push a
9846   446E 11            mov a, b
9847   446F 26 04 00      mov b, $4
9848   4472 B0            cmp a, b
9849   4473 FD 72         sneq ; !=
9850   4475 E4            pop a
9851   4476             ; END RELATIONAL
9852   4476 FD A7         sand a, b
9853   4478 E4            pop a
9854   4479 C0 00 00      cmp b, 0
9855   447C C6 97 44      je _if154_exit
9856   447F             _if154_true:
9857   447F             ;; torpedo_hit(x3, y3); 
9858   447F FA FD FF      lea d, [bp + -3] ; $y3
9859   4482 2A            mov b, [d]
9860   4483 DD            push bl
9861   4484 FA FF FF      lea d, [bp + -1] ; $x3
9862   4487 2A            mov b, [d]
9863   4488 DD            push bl
9864   4489 07 F9 44      call torpedo_hit
9865   448C 51 02 00      add sp, 2
9866   448F             ;; klingons_shoot(); 
9867   448F 07 29 58      call klingons_shoot
9868   4492             ;; return; 
9869   4492 F9            leave
9870   4493 09            ret
9871   4494 0A 97 44      jmp _if154_exit
9872   4497             _if154_exit:
9873   4497             ;; x = x + x1; 
9874   4497 FA F3 FF      lea d, [bp + -13] ; $x
9875   449A DA            push d
9876   449B FA F3 FF      lea d, [bp + -13] ; $x
9877   449E 2A            mov b, [d]
9878   449F             ; START TERMS
9879   449F D7            push a
9880   44A0 11            mov a, b
9881   44A1 FA EF FF      lea d, [bp + -17] ; $x1
9882   44A4 2A            mov b, [d]
9883   44A5 56            add b, a
9884   44A6 E4            pop a
9885   44A7             ; END TERMS
9886   44A7 E7            pop d
9887   44A8 FD 43         mov [d], b
9888   44AA             ;; y = y + x2; 
9889   44AA FA F1 FF      lea d, [bp + -15] ; $y
9890   44AD DA            push d
9891   44AE FA F1 FF      lea d, [bp + -15] ; $y
9892   44B1 2A            mov b, [d]
9893   44B2             ; START TERMS
9894   44B2 D7            push a
9895   44B3 11            mov a, b
9896   44B4 FA ED FF      lea d, [bp + -19] ; $x2
9897   44B7 2A            mov b, [d]
9898   44B8 56            add b, a
9899   44B9 E4            pop a
9900   44BA             ; END TERMS
9901   44BA E7            pop d
9902   44BB FD 43         mov [d], b
9903   44BD             ;; x3 = FROM_FIXED00(x); 
9904   44BD FA FF FF      lea d, [bp + -1] ; $x3
9905   44C0 DA            push d
9906   44C1 FA F3 FF      lea d, [bp + -13] ; $x
9907   44C4 2A            mov b, [d]
9908   44C5 FD AB         swp b
9909   44C7 D8            push b
9910   44C8 07 14 1D      call FROM_FIXED00
9911   44CB 51 02 00      add sp, 2
9912   44CE E7            pop d
9913   44CF FD 43         mov [d], b
9914   44D1             ;; y3 = FROM_FIXED00(y); 
9915   44D1 FA FD FF      lea d, [bp + -3] ; $y3
9916   44D4 DA            push d
9917   44D5 FA F1 FF      lea d, [bp + -15] ; $y
9918   44D8 2A            mov b, [d]
9919   44D9 FD AB         swp b
9920   44DB D8            push b
9921   44DC 07 14 1D      call FROM_FIXED00
9922   44DF 51 02 00      add sp, 2
9923   44E2 E7            pop d
9924   44E3 FD 43         mov [d], b
9925   44E5 0A B5 43      jmp _while153_cond
9926   44E8             _while153_exit:
9927   44E8             ;; puts("Torpedo Missed\n"); 
9928   44E8 26 7E 6D      mov b, __s106 ; "Torpedo Missed\n"
9929   44EB FD AB         swp b
9930   44ED D8            push b
9931   44EE 07 37 13      call puts
9932   44F1 51 02 00      add sp, 2
9933   44F4             ;; klingons_shoot(); 
9934   44F4 07 29 58      call klingons_shoot
9935   44F7 F9            leave
9936   44F8 09            ret
9937   44F9             
9938   44F9             torpedo_hit:
9939   44F9 F8 00 00      enter 0 ; (push bp; mov bp, sp)
9940   44FC             ; $i 
9941   44FC             ; $k 
9942   44FC 52 04 00      sub sp, 4
9943   44FF             ;; switch(quad[yp+-1][xp+-1]) { 
9944   44FF             _switch155_expr:
9945   44FF 3B 0B 63      mov d, _quad_data ; $quad
9946   4502 D7            push a
9947   4503 DA            push d
9948   4504 FA 05 00      lea d, [bp + 5] ; $yp
9949   4507 32            mov bl, [d]
9950   4508 A7 00         mov bh, 0
9951   450A             ; START TERMS
9952   450A D7            push a
9953   450B 11            mov a, b
9954   450C 26 FF FF      mov b, 65535
9955   450F 38 FF FF      mov c, 65535
9956   4512 54            add a, b
9957   4513 D7            push a
9958   4514 FD 12         mov a, g
9959   4516 28            mov b, c
9960   4517 5C            adc a, b
9961   4518 39            mov c, a
9962   4519 E5            pop b
9963   451A E4            pop a
9964   451B             ; END TERMS
9965   451B E7            pop d
9966   451C FD 13 08 00   mma 8 ; mov a, 8; mul a, b; add d, b
9967   4520 DA            push d
9968   4521 FA 06 00      lea d, [bp + 6] ; $xp
9969   4524 32            mov bl, [d]
9970   4525 A7 00         mov bh, 0
9971   4527             ; START TERMS
9972   4527 D7            push a
9973   4528 11            mov a, b
9974   4529 26 FF FF      mov b, 65535
9975   452C 38 FF FF      mov c, 65535
9976   452F 54            add a, b
9977   4530 D7            push a
9978   4531 FD 12         mov a, g
9979   4533 28            mov b, c
9980   4534 5C            adc a, b
9981   4535 39            mov c, a
9982   4536 E5            pop b
9983   4537 E4            pop a
9984   4538             ; END TERMS
9985   4538 E7            pop d
9986   4539 5A            add d, b
9987   453A E4            pop a
9988   453B 32            mov bl, [d]
9989   453C A7 00         mov bh, 0
9990   453E             _switch155_comparisons:
9991   453E C0 01 00      cmp b, 1
9992   4541 C6 53 45      je _switch155_case0
9993   4544 C0 03 00      cmp b, 3
9994   4547 C6 6F 45      je _switch155_case1
9995   454A C0 02 00      cmp b, 2
9996   454D C6 86 46      je _switch155_case2
9997   4550 0A 81 47      jmp _switch155_exit
9998   4553             _switch155_case0:
9999   4553             ;; printf("Star at %d, %d absorbed torpedo energy.\n\n", yp, xp); 
10000  4553 FA 06 00      lea d, [bp + 6] ; $xp
10001  4556 32            mov bl, [d]
10002  4557 A7 00         mov bh, 0
10003  4559 DD            push bl
10004  455A FA 05 00      lea d, [bp + 5] ; $yp
10005  455D 32            mov bl, [d]
10006  455E A7 00         mov bh, 0
10007  4560 DD            push bl
10008  4561 26 8E 6D      mov b, __s107 ; "Star at %d, %d absorbed torpedo energy.\n\n"
10009  4564 FD AB         swp b
10010  4566 D8            push b
10011  4567 07 D1 05      call printf
10012  456A 51 04 00      add sp, 4
10013  456D             ;; return; 
10014  456D F9            leave
10015  456E 09            ret
10016  456F             _switch155_case1:
10017  456F             ;; puts("*** Klingon Destroyed ***\n"); 
10018  456F 26 F2 6C      mov b, __s100 ; "*** Klingon Destroyed ***\n"
10019  4572 FD AB         swp b
10020  4574 D8            push b
10021  4575 07 37 13      call puts
10022  4578 51 02 00      add sp, 2
10023  457B             ;; klingons--; 
10024  457B 3B E1 62      mov d, _klingons ; $klingons
10025  457E 32            mov bl, [d]
10026  457F A7 00         mov bh, 0
10027  4581 D8            push b
10028  4582 FD 7D         dec b
10029  4584 3B E1 62      mov d, _klingons ; $klingons
10030  4587 FD 43         mov [d], b
10031  4589 E5            pop b
10032  458A             ;; klingons_left--; 
10033  458A 3B E3 62      mov d, _klingons_left ; $klingons_left
10034  458D 32            mov bl, [d]
10035  458E A7 00         mov bh, 0
10036  4590 D8            push b
10037  4591 FD 7D         dec b
10038  4593 3B E3 62      mov d, _klingons_left ; $klingons_left
10039  4596 FD 43         mov [d], b
10040  4598 E5            pop b
10041  4599             ;; if (klingons_left <= 0) 
10042  4599             _if156_cond:
10043  4599 3B E3 62      mov d, _klingons_left ; $klingons_left
10044  459C 32            mov bl, [d]
10045  459D A7 00         mov bh, 0
10046  459F             ; START RELATIONAL
10047  459F D7            push a
10048  45A0 11            mov a, b
10049  45A1 26 00 00      mov b, $0
10050  45A4 B0            cmp a, b
10051  45A5 FD 75         slu ; <= (unsigned)
10052  45A7 E4            pop a
10053  45A8             ; END RELATIONAL
10054  45A8 C0 00 00      cmp b, 0
10055  45AB C6 B4 45      je _if156_exit
10056  45AE             _if156_true:
10057  45AE             ;; won_game(); 
10058  45AE 07 76 56      call won_game
10059  45B1 0A B4 45      jmp _if156_exit
10060  45B4             _if156_exit:
10061  45B4             ;; k = kdata; 
10062  45B4 FA FD FF      lea d, [bp + -3] ; $k
10063  45B7 DA            push d
10064  45B8 3B D5 62      mov d, _kdata_data ; $kdata
10065  45BB 2D            mov b, d
10066  45BC E7            pop d
10067  45BD FD 43         mov [d], b
10068  45BF             ;; for (i = 0; i <= 2; i++) { 
10069  45BF             _for157_init:
10070  45BF FA FF FF      lea d, [bp + -1] ; $i
10071  45C2 DA            push d
10072  45C3 26 00 00      mov b, $0
10073  45C6 E7            pop d
10074  45C7 FD 43         mov [d], b
10075  45C9             _for157_cond:
10076  45C9 FA FF FF      lea d, [bp + -1] ; $i
10077  45CC 2A            mov b, [d]
10078  45CD             ; START RELATIONAL
10079  45CD D7            push a
10080  45CE 11            mov a, b
10081  45CF 26 02 00      mov b, $2
10082  45D2 B0            cmp a, b
10083  45D3 FD 73         slt ; <= (signed)
10084  45D5 E4            pop a
10085  45D6             ; END RELATIONAL
10086  45D6 C0 00 00      cmp b, 0
10087  45D9 C6 44 46      je _for157_exit
10088  45DC             _for157_block:
10089  45DC             ;; if (yp == k->y && xp == k->x) 
10090  45DC             _if158_cond:
10091  45DC FA 05 00      lea d, [bp + 5] ; $yp
10092  45DF 32            mov bl, [d]
10093  45E0 A7 00         mov bh, 0
10094  45E2             ; START RELATIONAL
10095  45E2 D7            push a
10096  45E3 11            mov a, b
10097  45E4 FA FD FF      lea d, [bp + -3] ; $k
10098  45E7 FD 2A         mov d, [d]
10099  45E9 58 00 00      add d, 0
10100  45EC 32            mov bl, [d]
10101  45ED A7 00         mov bh, 0
10102  45EF B0            cmp a, b
10103  45F0 FD 71         seq ; ==
10104  45F2 E4            pop a
10105  45F3             ; END RELATIONAL
10106  45F3 D7            push a
10107  45F4 11            mov a, b
10108  45F5 FA 06 00      lea d, [bp + 6] ; $xp
10109  45F8 32            mov bl, [d]
10110  45F9 A7 00         mov bh, 0
10111  45FB             ; START RELATIONAL
10112  45FB D7            push a
10113  45FC 11            mov a, b
10114  45FD FA FD FF      lea d, [bp + -3] ; $k
10115  4600 FD 2A         mov d, [d]
10116  4602 58 01 00      add d, 1
10117  4605 32            mov bl, [d]
10118  4606 A7 00         mov bh, 0
10119  4608 B0            cmp a, b
10120  4609 FD 71         seq ; ==
10121  460B E4            pop a
10122  460C             ; END RELATIONAL
10123  460C FD A7         sand a, b
10124  460E E4            pop a
10125  460F C0 00 00      cmp b, 0
10126  4612 C6 27 46      je _if158_exit
10127  4615             _if158_true:
10128  4615             ;; k->energy = 0; 
10129  4615 FA FD FF      lea d, [bp + -3] ; $k
10130  4618 FD 2A         mov d, [d]
10131  461A 58 02 00      add d, 2
10132  461D DA            push d
10133  461E 26 00 00      mov b, $0
10134  4621 E7            pop d
10135  4622 FD 43         mov [d], b
10136  4624 0A 27 46      jmp _if158_exit
10137  4627             _if158_exit:
10138  4627             ;; k++; 
10139  4627 FA FD FF      lea d, [bp + -3] ; $k
10140  462A 2A            mov b, [d]
10141  462B D8            push b
10142  462C FD 77         inc b
10143  462E FA FD FF      lea d, [bp + -3] ; $k
10144  4631 FD 43         mov [d], b
10145  4633 E5            pop b
10146  4634             _for157_update:
10147  4634 FA FF FF      lea d, [bp + -1] ; $i
10148  4637 2A            mov b, [d]
10149  4638 D8            push b
10150  4639 FD 77         inc b
10151  463B FA FF FF      lea d, [bp + -1] ; $i
10152  463E FD 43         mov [d], b
10153  4640 E5            pop b
10154  4641 0A C9 45      jmp _for157_cond
10155  4644             _for157_exit:
10156  4644             ;; map[quad_y][quad_x] =map[quad_y][quad_x] - 0x100; 
10157  4644 3B 33 62      mov d, _map_data ; $map
10158  4647 D7            push a
10159  4648 DA            push d
10160  4649 3B E6 62      mov d, _quad_y ; $quad_y
10161  464C 2A            mov b, [d]
10162  464D E7            pop d
10163  464E FD 13 12 00   mma 18 ; mov a, 18; mul a, b; add d, b
10164  4652 DA            push d
10165  4653 3B E8 62      mov d, _quad_x ; $quad_x
10166  4656 2A            mov b, [d]
10167  4657 E7            pop d
10168  4658 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
10169  465C E4            pop a
10170  465D DA            push d
10171  465E 3B 33 62      mov d, _map_data ; $map
10172  4661 D7            push a
10173  4662 DA            push d
10174  4663 3B E6 62      mov d, _quad_y ; $quad_y
10175  4666 2A            mov b, [d]
10176  4667 E7            pop d
10177  4668 FD 13 12 00   mma 18 ; mov a, 18; mul a, b; add d, b
10178  466C DA            push d
10179  466D 3B E8 62      mov d, _quad_x ; $quad_x
10180  4670 2A            mov b, [d]
10181  4671 E7            pop d
10182  4672 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
10183  4676 E4            pop a
10184  4677 2A            mov b, [d]
10185  4678             ; START TERMS
10186  4678 D7            push a
10187  4679 11            mov a, b
10188  467A 26 00 01      mov b, $100
10189  467D 60            sub a, b
10190  467E 27            mov b, a
10191  467F E4            pop a
10192  4680             ; END TERMS
10193  4680 E7            pop d
10194  4681 FD 43         mov [d], b
10195  4683             ;; break; 
10196  4683 0A 81 47      jmp _switch155_exit ; case break
10197  4686             _switch155_case2:
10198  4686             ;; puts("*** Starbase Destroyed ***"); 
10199  4686 26 B8 6D      mov b, __s108 ; "*** Starbase Destroyed ***"
10200  4689 FD AB         swp b
10201  468B D8            push b
10202  468C 07 37 13      call puts
10203  468F 51 02 00      add sp, 2
10204  4692             ;; starbases--; 
10205  4692 3B 0B 62      mov d, _starbases ; $starbases
10206  4695 32            mov bl, [d]
10207  4696 A7 00         mov bh, 0
10208  4698 D8            push b
10209  4699 FD 7D         dec b
10210  469B 3B 0B 62      mov d, _starbases ; $starbases
10211  469E FD 43         mov [d], b
10212  46A0 E5            pop b
10213  46A1             ;; starbases_left--; 
10214  46A1 3B 0E 62      mov d, _starbases_left ; $starbases_left
10215  46A4 32            mov bl, [d]
10216  46A5 A7 00         mov bh, 0
10217  46A7 D8            push b
10218  46A8 FD 7D         dec b
10219  46AA 3B 0E 62      mov d, _starbases_left ; $starbases_left
10220  46AD FD 43         mov [d], b
10221  46AF E5            pop b
10222  46B0             ;; if (starbases_left <= 0 && klingons_left <= FROM_FIXED(stardate) - time_start - time_up) { 
10223  46B0             _if159_cond:
10224  46B0 3B 0E 62      mov d, _starbases_left ; $starbases_left
10225  46B3 32            mov bl, [d]
10226  46B4 A7 00         mov bh, 0
10227  46B6             ; START RELATIONAL
10228  46B6 D7            push a
10229  46B7 11            mov a, b
10230  46B8 26 00 00      mov b, $0
10231  46BB B0            cmp a, b
10232  46BC FD 73         slt ; <= (signed)
10233  46BE E4            pop a
10234  46BF             ; END RELATIONAL
10235  46BF D7            push a
10236  46C0 11            mov a, b
10237  46C1 3B E3 62      mov d, _klingons_left ; $klingons_left
10238  46C4 32            mov bl, [d]
10239  46C5 A7 00         mov bh, 0
10240  46C7             ; START RELATIONAL
10241  46C7 D7            push a
10242  46C8 11            mov a, b
10243  46C9 3B 09 63      mov d, _stardate ; $stardate
10244  46CC 2A            mov b, [d]
10245  46CD FD AB         swp b
10246  46CF D8            push b
10247  46D0 07 F1 1C      call FROM_FIXED
10248  46D3 51 02 00      add sp, 2
10249  46D6             ; START TERMS
10250  46D6 D7            push a
10251  46D7 11            mov a, b
10252  46D8 3B ED 62      mov d, _time_start ; $time_start
10253  46DB 2A            mov b, [d]
10254  46DC 60            sub a, b
10255  46DD 27            mov b, a
10256  46DE 11            mov a, b
10257  46DF 3B EF 62      mov d, _time_up ; $time_up
10258  46E2 2A            mov b, [d]
10259  46E3 60            sub a, b
10260  46E4 27            mov b, a
10261  46E5 E4            pop a
10262  46E6             ; END TERMS
10263  46E6 B0            cmp a, b
10264  46E7 FD 75         slu ; <= (unsigned)
10265  46E9 E4            pop a
10266  46EA             ; END RELATIONAL
10267  46EA FD A7         sand a, b
10268  46EC E4            pop a
10269  46ED C0 00 00      cmp b, 0
10270  46F0 C6 29 47      je _if159_exit
10271  46F3             _if159_true:
10272  46F3             ;; puts("That does it, Captain!!"); 
10273  46F3 26 D3 6D      mov b, __s109 ; "That does it, Captain!!"
10274  46F6 FD AB         swp b
10275  46F8 D8            push b
10276  46F9 07 37 13      call puts
10277  46FC 51 02 00      add sp, 2
10278  46FF             ;; puts("You are hereby relieved of command\n"); 
10279  46FF 26 EB 6D      mov b, __s110 ; "You are hereby relieved of command\n"
10280  4702 FD AB         swp b
10281  4704 D8            push b
10282  4705 07 37 13      call puts
10283  4708 51 02 00      add sp, 2
10284  470B             ;; puts("and sentenced to 99 stardates of hard"); 
10285  470B 26 0F 6E      mov b, __s111 ; "and sentenced to 99 stardates of hard"
10286  470E FD AB         swp b
10287  4710 D8            push b
10288  4711 07 37 13      call puts
10289  4714 51 02 00      add sp, 2
10290  4717             ;; puts("labor on Cygnus 12!!\n"); 
10291  4717 26 35 6E      mov b, __s112 ; "labor on Cygnus 12!!\n"
10292  471A FD AB         swp b
10293  471C D8            push b
10294  471D 07 37 13      call puts
10295  4720 51 02 00      add sp, 2
10296  4723             ;; resign_commision(); 
10297  4723 07 5B 56      call resign_commision
10298  4726 0A 29 47      jmp _if159_exit
10299  4729             _if159_exit:
10300  4729             ;; puts("Starfleet Command reviewing your record to consider\n court martial!\n"); 
10301  4729 26 4B 6E      mov b, __s113 ; "Starfleet Command reviewing your record to consider\n court martial!\n"
10302  472C FD AB         swp b
10303  472E D8            push b
10304  472F 07 37 13      call puts
10305  4732 51 02 00      add sp, 2
10306  4735             ;; docked = 0;		/* Undock */ 
10307  4735 3B 2E 62      mov d, _docked ; $docked
10308  4738 DA            push d
10309  4739 26 00 00      mov b, $0
10310  473C E7            pop d
10311  473D FD 3E         mov [d], bl
10312  473F             ;; map[quad_y][quad_x] =map[quad_y][quad_x] - 0x10; 
10313  473F 3B 33 62      mov d, _map_data ; $map
10314  4742 D7            push a
10315  4743 DA            push d
10316  4744 3B E6 62      mov d, _quad_y ; $quad_y
10317  4747 2A            mov b, [d]
10318  4748 E7            pop d
10319  4749 FD 13 12 00   mma 18 ; mov a, 18; mul a, b; add d, b
10320  474D DA            push d
10321  474E 3B E8 62      mov d, _quad_x ; $quad_x
10322  4751 2A            mov b, [d]
10323  4752 E7            pop d
10324  4753 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
10325  4757 E4            pop a
10326  4758 DA            push d
10327  4759 3B 33 62      mov d, _map_data ; $map
10328  475C D7            push a
10329  475D DA            push d
10330  475E 3B E6 62      mov d, _quad_y ; $quad_y
10331  4761 2A            mov b, [d]
10332  4762 E7            pop d
10333  4763 FD 13 12 00   mma 18 ; mov a, 18; mul a, b; add d, b
10334  4767 DA            push d
10335  4768 3B E8 62      mov d, _quad_x ; $quad_x
10336  476B 2A            mov b, [d]
10337  476C E7            pop d
10338  476D FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
10339  4771 E4            pop a
10340  4772 2A            mov b, [d]
10341  4773             ; START TERMS
10342  4773 D7            push a
10343  4774 11            mov a, b
10344  4775 26 10 00      mov b, $10
10345  4778 60            sub a, b
10346  4779 27            mov b, a
10347  477A E4            pop a
10348  477B             ; END TERMS
10349  477B E7            pop d
10350  477C FD 43         mov [d], b
10351  477E             ;; break; 
10352  477E 0A 81 47      jmp _switch155_exit ; case break
10353  4781             _switch155_exit:
10354  4781             ;; quad[yp+-1][xp+-1] =  		0      ; 
10355  4781 3B 0B 63      mov d, _quad_data ; $quad
10356  4784 D7            push a
10357  4785 DA            push d
10358  4786 FA 05 00      lea d, [bp + 5] ; $yp
10359  4789 32            mov bl, [d]
10360  478A A7 00         mov bh, 0
10361  478C             ; START TERMS
10362  478C D7            push a
10363  478D 11            mov a, b
10364  478E 26 FF FF      mov b, 65535
10365  4791 38 FF FF      mov c, 65535
10366  4794 54            add a, b
10367  4795 D7            push a
10368  4796 FD 12         mov a, g
10369  4798 28            mov b, c
10370  4799 5C            adc a, b
10371  479A 39            mov c, a
10372  479B E5            pop b
10373  479C E4            pop a
10374  479D             ; END TERMS
10375  479D E7            pop d
10376  479E FD 13 08 00   mma 8 ; mov a, 8; mul a, b; add d, b
10377  47A2 DA            push d
10378  47A3 FA 06 00      lea d, [bp + 6] ; $xp
10379  47A6 32            mov bl, [d]
10380  47A7 A7 00         mov bh, 0
10381  47A9             ; START TERMS
10382  47A9 D7            push a
10383  47AA 11            mov a, b
10384  47AB 26 FF FF      mov b, 65535
10385  47AE 38 FF FF      mov c, 65535
10386  47B1 54            add a, b
10387  47B2 D7            push a
10388  47B3 FD 12         mov a, g
10389  47B5 28            mov b, c
10390  47B6 5C            adc a, b
10391  47B7 39            mov c, a
10392  47B8 E5            pop b
10393  47B9 E4            pop a
10394  47BA             ; END TERMS
10395  47BA E7            pop d
10396  47BB 5A            add d, b
10397  47BC E4            pop a
10398  47BD DA            push d
10399  47BE 26 00 00      mov b, $0
10400  47C1 E7            pop d
10401  47C2 FD 3E         mov [d], bl
10402  47C4 F9            leave
10403  47C5 09            ret
10404  47C6             
10405  47C6             damage_control:
10406  47C6 F8 00 00      enter 0 ; (push bp; mov bp, sp)
10407  47C9             ; $repair_cost 
10408  47C9 10 00 00      mov a, $0
10409  47CC 45 FF FF      mov [bp + -1], a
10410  47CF             ; $i 
10411  47CF 52 04 00      sub sp, 4
10412  47D2             ;; if (damage[6] < 0) 
10413  47D2             _if160_cond:
10414  47D2 3B F1 62      mov d, _damage_data ; $damage
10415  47D5 D7            push a
10416  47D6 DA            push d
10417  47D7 26 06 00      mov b, $6
10418  47DA E7            pop d
10419  47DB FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
10420  47DF E4            pop a
10421  47E0 2A            mov b, [d]
10422  47E1             ; START RELATIONAL
10423  47E1 D7            push a
10424  47E2 11            mov a, b
10425  47E3 26 00 00      mov b, $0
10426  47E6 B0            cmp a, b
10427  47E7 FD 73         slt ; < (signed)
10428  47E9 E4            pop a
10429  47EA             ; END RELATIONAL
10430  47EA C0 00 00      cmp b, 0
10431  47ED C6 FF 47      je _if160_exit
10432  47F0             _if160_true:
10433  47F0             ;; puts("Damage Control report not available."); 
10434  47F0 26 90 6E      mov b, __s114 ; "Damage Control report not available."
10435  47F3 FD AB         swp b
10436  47F5 D8            push b
10437  47F6 07 37 13      call puts
10438  47F9 51 02 00      add sp, 2
10439  47FC 0A FF 47      jmp _if160_exit
10440  47FF             _if160_exit:
10441  47FF             ;; if (docked) { 
10442  47FF             _if161_cond:
10443  47FF 3B 2E 62      mov d, _docked ; $docked
10444  4802 32            mov bl, [d]
10445  4803 A7 00         mov bh, 0
10446  4805 C0 00 00      cmp b, 0
10447  4808 C6 6F 49      je _if161_exit
10448  480B             _if161_true:
10449  480B             ;; repair_cost = 0; 
10450  480B FA FF FF      lea d, [bp + -1] ; $repair_cost
10451  480E DA            push d
10452  480F 26 00 00      mov b, $0
10453  4812 E7            pop d
10454  4813 FD 43         mov [d], b
10455  4815             ;; for (i = 1; i <= 8; i++) 
10456  4815             _for162_init:
10457  4815 FA FD FF      lea d, [bp + -3] ; $i
10458  4818 DA            push d
10459  4819 26 01 00      mov b, $1
10460  481C E7            pop d
10461  481D FD 43         mov [d], b
10462  481F             _for162_cond:
10463  481F FA FD FF      lea d, [bp + -3] ; $i
10464  4822 2A            mov b, [d]
10465  4823             ; START RELATIONAL
10466  4823 D7            push a
10467  4824 11            mov a, b
10468  4825 26 08 00      mov b, $8
10469  4828 B0            cmp a, b
10470  4829 FD 73         slt ; <= (signed)
10471  482B E4            pop a
10472  482C             ; END RELATIONAL
10473  482C C0 00 00      cmp b, 0
10474  482F C6 76 48      je _for162_exit
10475  4832             _for162_block:
10476  4832             ;; if (damage[i] < 0) 
10477  4832             _if163_cond:
10478  4832 3B F1 62      mov d, _damage_data ; $damage
10479  4835 D7            push a
10480  4836 DA            push d
10481  4837 FA FD FF      lea d, [bp + -3] ; $i
10482  483A 2A            mov b, [d]
10483  483B E7            pop d
10484  483C FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
10485  4840 E4            pop a
10486  4841 2A            mov b, [d]
10487  4842             ; START RELATIONAL
10488  4842 D7            push a
10489  4843 11            mov a, b
10490  4844 26 00 00      mov b, $0
10491  4847 B0            cmp a, b
10492  4848 FD 73         slt ; < (signed)
10493  484A E4            pop a
10494  484B             ; END RELATIONAL
10495  484B C0 00 00      cmp b, 0
10496  484E C6 66 48      je _if163_exit
10497  4851             _if163_true:
10498  4851             ;; repair_cost = repair_cost + 10; 
10499  4851 FA FF FF      lea d, [bp + -1] ; $repair_cost
10500  4854 DA            push d
10501  4855 FA FF FF      lea d, [bp + -1] ; $repair_cost
10502  4858 2A            mov b, [d]
10503  4859             ; START TERMS
10504  4859 D7            push a
10505  485A 11            mov a, b
10506  485B 26 0A 00      mov b, $a
10507  485E 56            add b, a
10508  485F E4            pop a
10509  4860             ; END TERMS
10510  4860 E7            pop d
10511  4861 FD 43         mov [d], b
10512  4863 0A 66 48      jmp _if163_exit
10513  4866             _if163_exit:
10514  4866             _for162_update:
10515  4866 FA FD FF      lea d, [bp + -3] ; $i
10516  4869 2A            mov b, [d]
10517  486A D8            push b
10518  486B FD 77         inc b
10519  486D FA FD FF      lea d, [bp + -3] ; $i
10520  4870 FD 43         mov [d], b
10521  4872 E5            pop b
10522  4873 0A 1F 48      jmp _for162_cond
10523  4876             _for162_exit:
10524  4876             ;; if (repair_cost) { 
10525  4876             _if164_cond:
10526  4876 FA FF FF      lea d, [bp + -1] ; $repair_cost
10527  4879 2A            mov b, [d]
10528  487A C0 00 00      cmp b, 0
10529  487D C6 6C 49      je _if164_exit
10530  4880             _if164_true:
10531  4880             ;; repair_cost = repair_cost + d4; 
10532  4880 FA FF FF      lea d, [bp + -1] ; $repair_cost
10533  4883 DA            push d
10534  4884 FA FF FF      lea d, [bp + -1] ; $repair_cost
10535  4887 2A            mov b, [d]
10536  4888             ; START TERMS
10537  4888 D7            push a
10538  4889 11            mov a, b
10539  488A 3B 03 63      mov d, _d4 ; $d4
10540  488D 2A            mov b, [d]
10541  488E 56            add b, a
10542  488F E4            pop a
10543  4890             ; END TERMS
10544  4890 E7            pop d
10545  4891 FD 43         mov [d], b
10546  4893             ;; if (repair_cost >= 100) 
10547  4893             _if165_cond:
10548  4893 FA FF FF      lea d, [bp + -1] ; $repair_cost
10549  4896 2A            mov b, [d]
10550  4897             ; START RELATIONAL
10551  4897 D7            push a
10552  4898 11            mov a, b
10553  4899 26 64 00      mov b, $64
10554  489C B0            cmp a, b
10555  489D FD 80         sge ; >=
10556  489F E4            pop a
10557  48A0             ; END RELATIONAL
10558  48A0 C0 00 00      cmp b, 0
10559  48A3 C6 B3 48      je _if165_exit
10560  48A6             _if165_true:
10561  48A6             ;; repair_cost = 90;	/* 0.9 */ 
10562  48A6 FA FF FF      lea d, [bp + -1] ; $repair_cost
10563  48A9 DA            push d
10564  48AA 26 5A 00      mov b, $5a
10565  48AD E7            pop d
10566  48AE FD 43         mov [d], b
10567  48B0 0A B3 48      jmp _if165_exit
10568  48B3             _if165_exit:
10569  48B3             ;; printf("\nTechnicians standing by to effect repairs to your ship;\nEstimated time to repair: %s stardates.\n Will you authorize the repair order (y/N)? ", print100(repair_cost)); 
10570  48B3 FA FF FF      lea d, [bp + -1] ; $repair_cost
10571  48B6 2A            mov b, [d]
10572  48B7 FD AB         swp b
10573  48B9 D8            push b
10574  48BA 07 1B 21      call print100
10575  48BD 51 02 00      add sp, 2
10576  48C0 FD AB         swp b
10577  48C2 D8            push b
10578  48C3 26 B5 6E      mov b, __s115 ; "\nTechnicians standing by to effect repairs to your ship;\nEstimated time to repair: %s stardates.\n Will you authorize the repair order (y/N)? "
10579  48C6 FD AB         swp b
10580  48C8 D8            push b
10581  48C9 07 D1 05      call printf
10582  48CC 51 04 00      add sp, 4
10583  48CF             ;; if (yesno()) { 
10584  48CF             _if166_cond:
10585  48CF 07 10 1F      call yesno
10586  48D2 C0 00 00      cmp b, 0
10587  48D5 C6 67 49      je _if166_exit
10588  48D8             _if166_true:
10589  48D8             ;; for (i = 1; i <= 8; i++) 
10590  48D8             _for167_init:
10591  48D8 FA FD FF      lea d, [bp + -3] ; $i
10592  48DB DA            push d
10593  48DC 26 01 00      mov b, $1
10594  48DF E7            pop d
10595  48E0 FD 43         mov [d], b
10596  48E2             _for167_cond:
10597  48E2 FA FD FF      lea d, [bp + -3] ; $i
10598  48E5 2A            mov b, [d]
10599  48E6             ; START RELATIONAL
10600  48E6 D7            push a
10601  48E7 11            mov a, b
10602  48E8 26 08 00      mov b, $8
10603  48EB B0            cmp a, b
10604  48EC FD 73         slt ; <= (signed)
10605  48EE E4            pop a
10606  48EF             ; END RELATIONAL
10607  48EF C0 00 00      cmp b, 0
10608  48F2 C6 3D 49      je _for167_exit
10609  48F5             _for167_block:
10610  48F5             ;; if (damage[i] < 0) 
10611  48F5             _if168_cond:
10612  48F5 3B F1 62      mov d, _damage_data ; $damage
10613  48F8 D7            push a
10614  48F9 DA            push d
10615  48FA FA FD FF      lea d, [bp + -3] ; $i
10616  48FD 2A            mov b, [d]
10617  48FE E7            pop d
10618  48FF FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
10619  4903 E4            pop a
10620  4904 2A            mov b, [d]
10621  4905             ; START RELATIONAL
10622  4905 D7            push a
10623  4906 11            mov a, b
10624  4907 26 00 00      mov b, $0
10625  490A B0            cmp a, b
10626  490B FD 73         slt ; < (signed)
10627  490D E4            pop a
10628  490E             ; END RELATIONAL
10629  490E C0 00 00      cmp b, 0
10630  4911 C6 2D 49      je _if168_exit
10631  4914             _if168_true:
10632  4914             ;; damage[i] = 0; 
10633  4914 3B F1 62      mov d, _damage_data ; $damage
10634  4917 D7            push a
10635  4918 DA            push d
10636  4919 FA FD FF      lea d, [bp + -3] ; $i
10637  491C 2A            mov b, [d]
10638  491D E7            pop d
10639  491E FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
10640  4922 E4            pop a
10641  4923 DA            push d
10642  4924 26 00 00      mov b, $0
10643  4927 E7            pop d
10644  4928 FD 43         mov [d], b
10645  492A 0A 2D 49      jmp _if168_exit
10646  492D             _if168_exit:
10647  492D             _for167_update:
10648  492D FA FD FF      lea d, [bp + -3] ; $i
10649  4930 2A            mov b, [d]
10650  4931 D8            push b
10651  4932 FD 77         inc b
10652  4934 FA FD FF      lea d, [bp + -3] ; $i
10653  4937 FD 43         mov [d], b
10654  4939 E5            pop b
10655  493A 0A E2 48      jmp _for167_cond
10656  493D             _for167_exit:
10657  493D             ;; stardate = stardate + (repair_cost + 5)/10 + 1; 
10658  493D 3B 09 63      mov d, _stardate ; $stardate
10659  4940 DA            push d
10660  4941 3B 09 63      mov d, _stardate ; $stardate
10661  4944 2A            mov b, [d]
10662  4945             ; START TERMS
10663  4945 D7            push a
10664  4946 11            mov a, b
10665  4947 FA FF FF      lea d, [bp + -1] ; $repair_cost
10666  494A 2A            mov b, [d]
10667  494B             ; START TERMS
10668  494B D7            push a
10669  494C 11            mov a, b
10670  494D 26 05 00      mov b, $5
10671  4950 56            add b, a
10672  4951 E4            pop a
10673  4952             ; END TERMS
10674  4952             ; START FACTORS
10675  4952 D7            push a
10676  4953 11            mov a, b
10677  4954 26 0A 00      mov b, $a
10678  4957 AE            div a, b
10679  4958 27            mov b, a
10680  4959 E4            pop a
10681  495A             ; END FACTORS
10682  495A 56            add b, a
10683  495B 11            mov a, b
10684  495C 26 01 00      mov b, $1
10685  495F 56            add b, a
10686  4960 E4            pop a
10687  4961             ; END TERMS
10688  4961 E7            pop d
10689  4962 FD 43         mov [d], b
10690  4964 0A 67 49      jmp _if166_exit
10691  4967             _if166_exit:
10692  4967             ;; return; 
10693  4967 F9            leave
10694  4968 09            ret
10695  4969 0A 6C 49      jmp _if164_exit
10696  496C             _if164_exit:
10697  496C 0A 6F 49      jmp _if161_exit
10698  496F             _if161_exit:
10699  496F             ;; if (damage[6] < 0) 
10700  496F             _if169_cond:
10701  496F 3B F1 62      mov d, _damage_data ; $damage
10702  4972 D7            push a
10703  4973 DA            push d
10704  4974 26 06 00      mov b, $6
10705  4977 E7            pop d
10706  4978 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
10707  497C E4            pop a
10708  497D 2A            mov b, [d]
10709  497E             ; START RELATIONAL
10710  497E D7            push a
10711  497F 11            mov a, b
10712  4980 26 00 00      mov b, $0
10713  4983 B0            cmp a, b
10714  4984 FD 73         slt ; < (signed)
10715  4986 E4            pop a
10716  4987             ; END RELATIONAL
10717  4987 C0 00 00      cmp b, 0
10718  498A C6 92 49      je _if169_exit
10719  498D             _if169_true:
10720  498D             ;; return; 
10721  498D F9            leave
10722  498E 09            ret
10723  498F 0A 92 49      jmp _if169_exit
10724  4992             _if169_exit:
10725  4992             ;; puts("Device            State of Repair"); 
10726  4992 26 B6 6E      mov b, __s116 ; "Device            State of Repair"
10727  4995 FD AB         swp b
10728  4997 D8            push b
10729  4998 07 37 13      call puts
10730  499B 51 02 00      add sp, 2
10731  499E             ;; for (i = 1; i <= 8; i++) 
10732  499E             _for170_init:
10733  499E FA FD FF      lea d, [bp + -3] ; $i
10734  49A1 DA            push d
10735  49A2 26 01 00      mov b, $1
10736  49A5 E7            pop d
10737  49A6 FD 43         mov [d], b
10738  49A8             _for170_cond:
10739  49A8 FA FD FF      lea d, [bp + -3] ; $i
10740  49AB 2A            mov b, [d]
10741  49AC             ; START RELATIONAL
10742  49AC D7            push a
10743  49AD 11            mov a, b
10744  49AE 26 08 00      mov b, $8
10745  49B1 B0            cmp a, b
10746  49B2 FD 73         slt ; <= (signed)
10747  49B4 E4            pop a
10748  49B5             ; END RELATIONAL
10749  49B5 C0 00 00      cmp b, 0
10750  49B8 C6 03 4A      je _for170_exit
10751  49BB             _for170_block:
10752  49BB             ;; printf("%-25s%6s\n", get_device_name(i), print100(damage[i])); 
10753  49BB 3B F1 62      mov d, _damage_data ; $damage
10754  49BE D7            push a
10755  49BF DA            push d
10756  49C0 FA FD FF      lea d, [bp + -3] ; $i
10757  49C3 2A            mov b, [d]
10758  49C4 E7            pop d
10759  49C5 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
10760  49C9 E4            pop a
10761  49CA 2A            mov b, [d]
10762  49CB FD AB         swp b
10763  49CD D8            push b
10764  49CE 07 1B 21      call print100
10765  49D1 51 02 00      add sp, 2
10766  49D4 FD AB         swp b
10767  49D6 D8            push b
10768  49D7 FA FD FF      lea d, [bp + -3] ; $i
10769  49DA 2A            mov b, [d]
10770  49DB FD AB         swp b
10771  49DD D8            push b
10772  49DE 07 B4 5E      call get_device_name
10773  49E1 51 02 00      add sp, 2
10774  49E4 FD AB         swp b
10775  49E6 D8            push b
10776  49E7 26 D8 6E      mov b, __s117 ; "%-25s%6s\n"
10777  49EA FD AB         swp b
10778  49EC D8            push b
10779  49ED 07 D1 05      call printf
10780  49F0 51 06 00      add sp, 6
10781  49F3             _for170_update:
10782  49F3 FA FD FF      lea d, [bp + -3] ; $i
10783  49F6 2A            mov b, [d]
10784  49F7 D8            push b
10785  49F8 FD 77         inc b
10786  49FA FA FD FF      lea d, [bp + -3] ; $i
10787  49FD FD 43         mov [d], b
10788  49FF E5            pop b
10789  4A00 0A A8 49      jmp _for170_cond
10790  4A03             _for170_exit:
10791  4A03             ;; printf("\n"); 
10792  4A03 26 E2 6E      mov b, __s118 ; "\n"
10793  4A06 FD AB         swp b
10794  4A08 D8            push b
10795  4A09 07 D1 05      call printf
10796  4A0C 51 02 00      add sp, 2
10797  4A0F F9            leave
10798  4A10 09            ret
10799  4A11             
10800  4A11             shield_control:
10801  4A11 F8 00 00      enter 0 ; (push bp; mov bp, sp)
10802  4A14             ; $i 
10803  4A14 52 02 00      sub sp, 2
10804  4A17             ;; if (inoperable(7)) 
10805  4A17             _if171_cond:
10806  4A17 26 07 00      mov b, $7
10807  4A1A DD            push bl
10808  4A1B 07 6A 21      call inoperable
10809  4A1E 51 01 00      add sp, 1
10810  4A21 C0 00 00      cmp b, 0
10811  4A24 C6 2C 4A      je _if171_exit
10812  4A27             _if171_true:
10813  4A27             ;; return; 
10814  4A27 F9            leave
10815  4A28 09            ret
10816  4A29 0A 2C 4A      jmp _if171_exit
10817  4A2C             _if171_exit:
10818  4A2C             ;; printf("Energy available = %d\n\n Input number of units to shields: ", energy + shield); 
10819  4A2C 3B 2F 62      mov d, _energy ; $energy
10820  4A2F 2A            mov b, [d]
10821  4A30             ; START TERMS
10822  4A30 D7            push a
10823  4A31 11            mov a, b
10824  4A32 3B EA 62      mov d, _shield ; $shield
10825  4A35 2A            mov b, [d]
10826  4A36 56            add b, a
10827  4A37 E4            pop a
10828  4A38             ; END TERMS
10829  4A38 FD AB         swp b
10830  4A3A D8            push b
10831  4A3B 26 E4 6E      mov b, __s119 ; "Energy available = %d\n\n Input number of units to shields: "
10832  4A3E FD AB         swp b
10833  4A40 D8            push b
10834  4A41 07 D1 05      call printf
10835  4A44 51 04 00      add sp, 4
10836  4A47             ;; i = input_int(); 
10837  4A47 FA FF FF      lea d, [bp + -1] ; $i
10838  4A4A DA            push d
10839  4A4B 07 D0 20      call input_int
10840  4A4E E7            pop d
10841  4A4F FD 43         mov [d], b
10842  4A51             ;; if (i < 0 || shield == i) { 
10843  4A51             _if172_cond:
10844  4A51 FA FF FF      lea d, [bp + -1] ; $i
10845  4A54 2A            mov b, [d]
10846  4A55             ; START RELATIONAL
10847  4A55 D7            push a
10848  4A56 11            mov a, b
10849  4A57 26 00 00      mov b, $0
10850  4A5A B0            cmp a, b
10851  4A5B FD 73         slt ; < (signed)
10852  4A5D E4            pop a
10853  4A5E             ; END RELATIONAL
10854  4A5E D7            push a
10855  4A5F 11            mov a, b
10856  4A60 3B EA 62      mov d, _shield ; $shield
10857  4A63 2A            mov b, [d]
10858  4A64             ; START RELATIONAL
10859  4A64 D7            push a
10860  4A65 11            mov a, b
10861  4A66 FA FF FF      lea d, [bp + -1] ; $i
10862  4A69 2A            mov b, [d]
10863  4A6A B0            cmp a, b
10864  4A6B FD 71         seq ; ==
10865  4A6D E4            pop a
10866  4A6E             ; END RELATIONAL
10867  4A6E FD A8         sor a, b ; ||
10868  4A70 E4            pop a
10869  4A71 C0 00 00      cmp b, 0
10870  4A74 C6 88 4A      je _if172_exit
10871  4A77             _if172_true:
10872  4A77             ;; unchanged: 
10873  4A77             shield_control_unchanged:
10874  4A77             ;; puts("<Shields Unchanged>\n"); 
10875  4A77 26 1F 6F      mov b, __s120 ; "<Shields Unchanged>\n"
10876  4A7A FD AB         swp b
10877  4A7C D8            push b
10878  4A7D 07 37 13      call puts
10879  4A80 51 02 00      add sp, 2
10880  4A83             ;; return; 
10881  4A83 F9            leave
10882  4A84 09            ret
10883  4A85 0A 88 4A      jmp _if172_exit
10884  4A88             _if172_exit:
10885  4A88             ;; if (i >= energy + shield) { 
10886  4A88             _if173_cond:
10887  4A88 FA FF FF      lea d, [bp + -1] ; $i
10888  4A8B 2A            mov b, [d]
10889  4A8C             ; START RELATIONAL
10890  4A8C D7            push a
10891  4A8D 11            mov a, b
10892  4A8E 3B 2F 62      mov d, _energy ; $energy
10893  4A91 2A            mov b, [d]
10894  4A92             ; START TERMS
10895  4A92 D7            push a
10896  4A93 11            mov a, b
10897  4A94 3B EA 62      mov d, _shield ; $shield
10898  4A97 2A            mov b, [d]
10899  4A98 56            add b, a
10900  4A99 E4            pop a
10901  4A9A             ; END TERMS
10902  4A9A B0            cmp a, b
10903  4A9B FD 80         sge ; >=
10904  4A9D E4            pop a
10905  4A9E             ; END RELATIONAL
10906  4A9E C0 00 00      cmp b, 0
10907  4AA1 C6 B6 4A      je _if173_exit
10908  4AA4             _if173_true:
10909  4AA4             ;; puts("Shield Control Reports:\n  'This is not the Federation Treasury.'"); 
10910  4AA4 26 34 6F      mov b, __s121 ; "Shield Control Reports:\n  'This is not the Federation Treasury.'"
10911  4AA7 FD AB         swp b
10912  4AA9 D8            push b
10913  4AAA 07 37 13      call puts
10914  4AAD 51 02 00      add sp, 2
10915  4AB0             ;; goto unchanged; 
10916  4AB0 0A 77 4A      jmp shield_control_unchanged
10917  4AB3 0A B6 4A      jmp _if173_exit
10918  4AB6             _if173_exit:
10919  4AB6             ;; energy = energy + shield - i; 
10920  4AB6 3B 2F 62      mov d, _energy ; $energy
10921  4AB9 DA            push d
10922  4ABA 3B 2F 62      mov d, _energy ; $energy
10923  4ABD 2A            mov b, [d]
10924  4ABE             ; START TERMS
10925  4ABE D7            push a
10926  4ABF 11            mov a, b
10927  4AC0 3B EA 62      mov d, _shield ; $shield
10928  4AC3 2A            mov b, [d]
10929  4AC4 56            add b, a
10930  4AC5 11            mov a, b
10931  4AC6 FA FF FF      lea d, [bp + -1] ; $i
10932  4AC9 2A            mov b, [d]
10933  4ACA 60            sub a, b
10934  4ACB 27            mov b, a
10935  4ACC E4            pop a
10936  4ACD             ; END TERMS
10937  4ACD E7            pop d
10938  4ACE FD 43         mov [d], b
10939  4AD0             ;; shield = i; 
10940  4AD0 3B EA 62      mov d, _shield ; $shield
10941  4AD3 DA            push d
10942  4AD4 FA FF FF      lea d, [bp + -1] ; $i
10943  4AD7 2A            mov b, [d]
10944  4AD8 E7            pop d
10945  4AD9 FD 43         mov [d], b
10946  4ADB             ;; printf("Deflector Control Room report:\n  'Shields now at %d units per your command.'\n\n", shield); 
10947  4ADB 3B EA 62      mov d, _shield ; $shield
10948  4ADE 2A            mov b, [d]
10949  4ADF FD AB         swp b
10950  4AE1 D8            push b
10951  4AE2 26 75 6F      mov b, __s122 ; "Deflector Control Room report:\n  'Shields now at %d units per your command.'\n\n"
10952  4AE5 FD AB         swp b
10953  4AE7 D8            push b
10954  4AE8 07 D1 05      call printf
10955  4AEB 51 04 00      add sp, 4
10956  4AEE F9            leave
10957  4AEF 09            ret
10958  4AF0             
10959  4AF0             library_computer:
10960  4AF0 F8 00 00      enter 0 ; (push bp; mov bp, sp)
10961  4AF3             ;; if (inoperable(8)) 
10962  4AF3             _if174_cond:
10963  4AF3 26 08 00      mov b, $8
10964  4AF6 DD            push bl
10965  4AF7 07 6A 21      call inoperable
10966  4AFA 51 01 00      add sp, 1
10967  4AFD C0 00 00      cmp b, 0
10968  4B00 C6 08 4B      je _if174_exit
10969  4B03             _if174_true:
10970  4B03             ;; return; 
10971  4B03 F9            leave
10972  4B04 09            ret
10973  4B05 0A 08 4B      jmp _if174_exit
10974  4B08             _if174_exit:
10975  4B08             ;; puts("Computer active and awating command: "); 
10976  4B08 26 C4 6F      mov b, __s123 ; "Computer active and awating command: "
10977  4B0B FD AB         swp b
10978  4B0D D8            push b
10979  4B0E 07 37 13      call puts
10980  4B11 51 02 00      add sp, 2
10981  4B14             ;; switch(input_int()) { 
10982  4B14             _switch175_expr:
10983  4B14 07 D0 20      call input_int
10984  4B17             _switch175_comparisons:
10985  4B17 C0 FF FF      cmp b, -1
10986  4B1A C6 47 4B      je _switch175_case0
10987  4B1D C0 00 00      cmp b, 0
10988  4B20 C6 4A 4B      je _switch175_case1
10989  4B23 C0 01 00      cmp b, 1
10990  4B26 C6 50 4B      je _switch175_case2
10991  4B29 C0 02 00      cmp b, 2
10992  4B2C C6 56 4B      je _switch175_case3
10993  4B2F C0 03 00      cmp b, 3
10994  4B32 C6 5C 4B      je _switch175_case4
10995  4B35 C0 04 00      cmp b, 4
10996  4B38 C6 62 4B      je _switch175_case5
10997  4B3B C0 05 00      cmp b, 5
10998  4B3E C6 68 4B      je _switch175_case6
10999  4B41 0A 6E 4B      jmp _switch175_default
11000  4B44 0A C2 4B      jmp _switch175_exit
11001  4B47             _switch175_case0:
11002  4B47             ;; break; 
11003  4B47 0A C2 4B      jmp _switch175_exit ; case break
11004  4B4A             _switch175_case1:
11005  4B4A             ;; galactic_record(); 
11006  4B4A 07 C4 4B      call galactic_record
11007  4B4D             ;; break; 
11008  4B4D 0A C2 4B      jmp _switch175_exit ; case break
11009  4B50             _switch175_case2:
11010  4B50             ;; status_report(); 
11011  4B50 07 E9 4C      call status_report
11012  4B53             ;; break; 
11013  4B53 0A C2 4B      jmp _switch175_exit ; case break
11014  4B56             _switch175_case3:
11015  4B56             ;; torpedo_data(); 
11016  4B56 07 FF 4D      call torpedo_data
11017  4B59             ;; break; 
11018  4B59 0A C2 4B      jmp _switch175_exit ; case break
11019  4B5C             _switch175_case4:
11020  4B5C             ;; nav_data(); 
11021  4B5C 07 01 4F      call nav_data
11022  4B5F             ;; break; 
11023  4B5F 0A C2 4B      jmp _switch175_exit ; case break
11024  4B62             _switch175_case5:
11025  4B62             ;; dirdist_calc(); 
11026  4B62 07 64 4F      call dirdist_calc
11027  4B65             ;; break; 
11028  4B65 0A C2 4B      jmp _switch175_exit ; case break
11029  4B68             _switch175_case6:
11030  4B68             ;; galaxy_map(); 
11031  4B68 07 E0 50      call galaxy_map
11032  4B6B             ;; break; 
11033  4B6B 0A C2 4B      jmp _switch175_exit ; case break
11034  4B6E             _switch175_default:
11035  4B6E             ;; puts("Functions available from Library-Computer:\n\n"); 
11036  4B6E 26 EA 6F      mov b, __s124 ; "Functions available from Library-Computer:\n\n"
11037  4B71 FD AB         swp b
11038  4B73 D8            push b
11039  4B74 07 37 13      call puts
11040  4B77 51 02 00      add sp, 2
11041  4B7A             ;; puts("   0 = Cumulative Galactic Record\n"); 
11042  4B7A 26 17 70      mov b, __s125 ; "   0 = Cumulative Galactic Record\n"
11043  4B7D FD AB         swp b
11044  4B7F D8            push b
11045  4B80 07 37 13      call puts
11046  4B83 51 02 00      add sp, 2
11047  4B86             ;; puts("   1 = Status Report\n"); 
11048  4B86 26 3A 70      mov b, __s126 ; "   1 = Status Report\n"
11049  4B89 FD AB         swp b
11050  4B8B D8            push b
11051  4B8C 07 37 13      call puts
11052  4B8F 51 02 00      add sp, 2
11053  4B92             ;; puts("   2 = Photon Torpedo Data\n"); 
11054  4B92 26 50 70      mov b, __s127 ; "   2 = Photon Torpedo Data\n"
11055  4B95 FD AB         swp b
11056  4B97 D8            push b
11057  4B98 07 37 13      call puts
11058  4B9B 51 02 00      add sp, 2
11059  4B9E             ;; puts("   3 = Starbase Nav Data\n"); 
11060  4B9E 26 6C 70      mov b, __s128 ; "   3 = Starbase Nav Data\n"
11061  4BA1 FD AB         swp b
11062  4BA3 D8            push b
11063  4BA4 07 37 13      call puts
11064  4BA7 51 02 00      add sp, 2
11065  4BAA             ;; puts("   4 = Direction/Distance Calculator\n"); 
11066  4BAA 26 86 70      mov b, __s129 ; "   4 = Direction/Distance Calculator\n"
11067  4BAD FD AB         swp b
11068  4BAF D8            push b
11069  4BB0 07 37 13      call puts
11070  4BB3 51 02 00      add sp, 2
11071  4BB6             ;; puts("   5 = Galaxy 'Region Name' Map\n"); 
11072  4BB6 26 AC 70      mov b, __s130 ; "   5 = Galaxy 'Region Name' Map\n"
11073  4BB9 FD AB         swp b
11074  4BBB D8            push b
11075  4BBC 07 37 13      call puts
11076  4BBF 51 02 00      add sp, 2
11077  4BC2             _switch175_exit:
11078  4BC2 F9            leave
11079  4BC3 09            ret
11080  4BC4             
11081  4BC4             galactic_record:
11082  4BC4 F8 00 00      enter 0 ; (push bp; mov bp, sp)
11083  4BC7             ; $i 
11084  4BC7             ; $j 
11085  4BC7 52 04 00      sub sp, 4
11086  4BCA             ;; printf("\n     Computer Record of Galaxy for Quadrant %d,%d\n\n", quad_y, quad_x); 
11087  4BCA 3B E8 62      mov d, _quad_x ; $quad_x
11088  4BCD 2A            mov b, [d]
11089  4BCE FD AB         swp b
11090  4BD0 D8            push b
11091  4BD1 3B E6 62      mov d, _quad_y ; $quad_y
11092  4BD4 2A            mov b, [d]
11093  4BD5 FD AB         swp b
11094  4BD7 D8            push b
11095  4BD8 26 CD 70      mov b, __s131 ; "\n     Computer Record of Galaxy for Quadrant %d,%d\n\n"
11096  4BDB FD AB         swp b
11097  4BDD D8            push b
11098  4BDE 07 D1 05      call printf
11099  4BE1 51 06 00      add sp, 6
11100  4BE4             ;; puts("     1     2     3     4     5     6     7     8"); 
11101  4BE4 26 02 71      mov b, __s132 ; "     1     2     3     4     5     6     7     8"
11102  4BE7 FD AB         swp b
11103  4BE9 D8            push b
11104  4BEA 07 37 13      call puts
11105  4BED 51 02 00      add sp, 2
11106  4BF0             ;; for (i = 1; i <= 8; i++) { 
11107  4BF0             _for176_init:
11108  4BF0 FA FF FF      lea d, [bp + -1] ; $i
11109  4BF3 DA            push d
11110  4BF4 26 01 00      mov b, $1
11111  4BF7 E7            pop d
11112  4BF8 FD 43         mov [d], b
11113  4BFA             _for176_cond:
11114  4BFA FA FF FF      lea d, [bp + -1] ; $i
11115  4BFD 2A            mov b, [d]
11116  4BFE             ; START RELATIONAL
11117  4BFE D7            push a
11118  4BFF 11            mov a, b
11119  4C00 26 08 00      mov b, $8
11120  4C03 B0            cmp a, b
11121  4C04 FD 73         slt ; <= (signed)
11122  4C06 E4            pop a
11123  4C07             ; END RELATIONAL
11124  4C07 C0 00 00      cmp b, 0
11125  4C0A C6 D4 4C      je _for176_exit
11126  4C0D             _for176_block:
11127  4C0D             ;; printf("%s%d", gr_1, i); 
11128  4C0D FA FF FF      lea d, [bp + -1] ; $i
11129  4C10 2A            mov b, [d]
11130  4C11 FD AB         swp b
11131  4C13 D8            push b
11132  4C14 3B 86 64      mov d, _gr_1 ; $gr_1
11133  4C17 2A            mov b, [d]
11134  4C18 FD AB         swp b
11135  4C1A D8            push b
11136  4C1B 26 33 71      mov b, __s133 ; "%s%d"
11137  4C1E FD AB         swp b
11138  4C20 D8            push b
11139  4C21 07 D1 05      call printf
11140  4C24 51 06 00      add sp, 6
11141  4C27             ;; for (j = 1; j <= 8; j++) { 
11142  4C27             _for177_init:
11143  4C27 FA FD FF      lea d, [bp + -3] ; $j
11144  4C2A DA            push d
11145  4C2B 26 01 00      mov b, $1
11146  4C2E E7            pop d
11147  4C2F FD 43         mov [d], b
11148  4C31             _for177_cond:
11149  4C31 FA FD FF      lea d, [bp + -3] ; $j
11150  4C34 2A            mov b, [d]
11151  4C35             ; START RELATIONAL
11152  4C35 D7            push a
11153  4C36 11            mov a, b
11154  4C37 26 08 00      mov b, $8
11155  4C3A B0            cmp a, b
11156  4C3B FD 73         slt ; <= (signed)
11157  4C3D E4            pop a
11158  4C3E             ; END RELATIONAL
11159  4C3E C0 00 00      cmp b, 0
11160  4C41 C6 BA 4C      je _for177_exit
11161  4C44             _for177_block:
11162  4C44             ;; printf("   "); 
11163  4C44 26 FE 65      mov b, __s24 ; "   "
11164  4C47 FD AB         swp b
11165  4C49 D8            push b
11166  4C4A 07 D1 05      call printf
11167  4C4D 51 02 00      add sp, 2
11168  4C50             ;; if (map[i][j] &   0x1000		/* Set if this sector was mapped */          ) 
11169  4C50             _if178_cond:
11170  4C50 3B 33 62      mov d, _map_data ; $map
11171  4C53 D7            push a
11172  4C54 DA            push d
11173  4C55 FA FF FF      lea d, [bp + -1] ; $i
11174  4C58 2A            mov b, [d]
11175  4C59 E7            pop d
11176  4C5A FD 13 12 00   mma 18 ; mov a, 18; mul a, b; add d, b
11177  4C5E DA            push d
11178  4C5F FA FD FF      lea d, [bp + -3] ; $j
11179  4C62 2A            mov b, [d]
11180  4C63 E7            pop d
11181  4C64 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
11182  4C68 E4            pop a
11183  4C69 2A            mov b, [d]
11184  4C6A D7            push a
11185  4C6B 11            mov a, b
11186  4C6C 26 00 10      mov b, $1000
11187  4C6F FD 92         and b, a ; &
11188  4C71 E4            pop a
11189  4C72 C0 00 00      cmp b, 0
11190  4C75 C6 9E 4C      je _if178_else
11191  4C78             _if178_true:
11192  4C78             ;; putbcd(map[i][j]); 
11193  4C78 3B 33 62      mov d, _map_data ; $map
11194  4C7B D7            push a
11195  4C7C DA            push d
11196  4C7D FA FF FF      lea d, [bp + -1] ; $i
11197  4C80 2A            mov b, [d]
11198  4C81 E7            pop d
11199  4C82 FD 13 12 00   mma 18 ; mov a, 18; mul a, b; add d, b
11200  4C86 DA            push d
11201  4C87 FA FD FF      lea d, [bp + -3] ; $j
11202  4C8A 2A            mov b, [d]
11203  4C8B E7            pop d
11204  4C8C FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
11205  4C90 E4            pop a
11206  4C91 2A            mov b, [d]
11207  4C92 FD AB         swp b
11208  4C94 D8            push b
11209  4C95 07 3E 3A      call putbcd
11210  4C98 51 02 00      add sp, 2
11211  4C9B 0A AA 4C      jmp _if178_exit
11212  4C9E             _if178_else:
11213  4C9E             ;; printf("***"); 
11214  4C9E 26 AD 6B      mov b, __s91 ; "***"
11215  4CA1 FD AB         swp b
11216  4CA3 D8            push b
11217  4CA4 07 D1 05      call printf
11218  4CA7 51 02 00      add sp, 2
11219  4CAA             _if178_exit:
11220  4CAA             _for177_update:
11221  4CAA FA FD FF      lea d, [bp + -3] ; $j
11222  4CAD 2A            mov b, [d]
11223  4CAE D8            push b
11224  4CAF FD 77         inc b
11225  4CB1 FA FD FF      lea d, [bp + -3] ; $j
11226  4CB4 FD 43         mov [d], b
11227  4CB6 E5            pop b
11228  4CB7 0A 31 4C      jmp _for177_cond
11229  4CBA             _for177_exit:
11230  4CBA             ;; putchar('\n'); 
11231  4CBA 26 0A 00      mov b, $a
11232  4CBD DD            push bl
11233  4CBE 07 01 13      call putchar
11234  4CC1 51 01 00      add sp, 1
11235  4CC4             _for176_update:
11236  4CC4 FA FF FF      lea d, [bp + -1] ; $i
11237  4CC7 2A            mov b, [d]
11238  4CC8 D8            push b
11239  4CC9 FD 77         inc b
11240  4CCB FA FF FF      lea d, [bp + -1] ; $i
11241  4CCE FD 43         mov [d], b
11242  4CD0 E5            pop b
11243  4CD1 0A FA 4B      jmp _for176_cond
11244  4CD4             _for176_exit:
11245  4CD4             ;; printf("%s\n", gr_1); 
11246  4CD4 3B 86 64      mov d, _gr_1 ; $gr_1
11247  4CD7 2A            mov b, [d]
11248  4CD8 FD AB         swp b
11249  4CDA D8            push b
11250  4CDB 26 B4 6B      mov b, __s93 ; "%s\n"
11251  4CDE FD AB         swp b
11252  4CE0 D8            push b
11253  4CE1 07 D1 05      call printf
11254  4CE4 51 04 00      add sp, 4
11255  4CE7 F9            leave
11256  4CE8 09            ret
11257  4CE9             
11258  4CE9             status_report:
11259  4CE9 F8 00 00      enter 0 ; (push bp; mov bp, sp)
11260  4CEC             ; $plural 
11261  4CEC             ; $left 
11262  4CEC 52 04 00      sub sp, 4
11263  4CEF             ;; plural = str_s + 1; 
11264  4CEF FA FF FF      lea d, [bp + -1] ; $plural
11265  4CF2 DA            push d
11266  4CF3 3B 8A 64      mov d, _str_s ; $str_s
11267  4CF6 2A            mov b, [d]
11268  4CF7             ; START TERMS
11269  4CF7 D7            push a
11270  4CF8 11            mov a, b
11271  4CF9 26 01 00      mov b, $1
11272  4CFC 56            add b, a
11273  4CFD E4            pop a
11274  4CFE             ; END TERMS
11275  4CFE E7            pop d
11276  4CFF FD 43         mov [d], b
11277  4D01             ;; left = TO_FIXED(time_start + time_up) - stardate; 
11278  4D01 FA FD FF      lea d, [bp + -3] ; $left
11279  4D04 DA            push d
11280  4D05 3B ED 62      mov d, _time_start ; $time_start
11281  4D08 2A            mov b, [d]
11282  4D09             ; START TERMS
11283  4D09 D7            push a
11284  4D0A 11            mov a, b
11285  4D0B 3B EF 62      mov d, _time_up ; $time_up
11286  4D0E 2A            mov b, [d]
11287  4D0F 56            add b, a
11288  4D10 E4            pop a
11289  4D11             ; END TERMS
11290  4D11 FD AB         swp b
11291  4D13 D8            push b
11292  4D14 07 DF 1C      call TO_FIXED
11293  4D17 51 02 00      add sp, 2
11294  4D1A             ; START TERMS
11295  4D1A D7            push a
11296  4D1B 11            mov a, b
11297  4D1C 3B 09 63      mov d, _stardate ; $stardate
11298  4D1F 2A            mov b, [d]
11299  4D20 60            sub a, b
11300  4D21 27            mov b, a
11301  4D22 E4            pop a
11302  4D23             ; END TERMS
11303  4D23 E7            pop d
11304  4D24 FD 43         mov [d], b
11305  4D26             ;; puts("   Status Report:\n"); 
11306  4D26 26 38 71      mov b, __s134 ; "   Status Report:\n"
11307  4D29 FD AB         swp b
11308  4D2B D8            push b
11309  4D2C 07 37 13      call puts
11310  4D2F 51 02 00      add sp, 2
11311  4D32             ;; if (klingons_left > 1) 
11312  4D32             _if179_cond:
11313  4D32 3B E3 62      mov d, _klingons_left ; $klingons_left
11314  4D35 32            mov bl, [d]
11315  4D36 A7 00         mov bh, 0
11316  4D38             ; START RELATIONAL
11317  4D38 D7            push a
11318  4D39 11            mov a, b
11319  4D3A 26 01 00      mov b, $1
11320  4D3D B0            cmp a, b
11321  4D3E FD 81         sgu ; > (unsigned)
11322  4D40 E4            pop a
11323  4D41             ; END RELATIONAL
11324  4D41 C0 00 00      cmp b, 0
11325  4D44 C6 55 4D      je _if179_exit
11326  4D47             _if179_true:
11327  4D47             ;; plural = str_s; 
11328  4D47 FA FF FF      lea d, [bp + -1] ; $plural
11329  4D4A DA            push d
11330  4D4B 3B 8A 64      mov d, _str_s ; $str_s
11331  4D4E 2A            mov b, [d]
11332  4D4F E7            pop d
11333  4D50 FD 43         mov [d], b
11334  4D52 0A 55 4D      jmp _if179_exit
11335  4D55             _if179_exit:
11336  4D55             ;; printf("Klingon%s Left: %d\n Mission must be completed in %d.%d stardates\n", 
11337  4D55 FA FD FF      lea d, [bp + -3] ; $left
11338  4D58 2A            mov b, [d]
11339  4D59             ; START FACTORS
11340  4D59 D7            push a
11341  4D5A 11            mov a, b
11342  4D5B 26 0A 00      mov b, $a
11343  4D5E AE            div a, b ; 
11344  4D5F 11            mov a, b
11345  4D60 27            mov b, a
11346  4D61 E4            pop a
11347  4D62             ; END FACTORS
11348  4D62 FD AB         swp b
11349  4D64 D8            push b
11350  4D65 FA FD FF      lea d, [bp + -3] ; $left
11351  4D68 2A            mov b, [d]
11352  4D69 FD AB         swp b
11353  4D6B D8            push b
11354  4D6C 07 F1 1C      call FROM_FIXED
11355  4D6F 51 02 00      add sp, 2
11356  4D72 FD AB         swp b
11357  4D74 D8            push b
11358  4D75 3B E3 62      mov d, _klingons_left ; $klingons_left
11359  4D78 32            mov bl, [d]
11360  4D79 A7 00         mov bh, 0
11361  4D7B DD            push bl
11362  4D7C FA FF FF      lea d, [bp + -1] ; $plural
11363  4D7F 2A            mov b, [d]
11364  4D80 FD AB         swp b
11365  4D82 D8            push b
11366  4D83 26 4B 71      mov b, __s135 ; "Klingon%s Left: %d\n Mission must be completed in %d.%d stardates\n"
11367  4D86 FD AB         swp b
11368  4D88 D8            push b
11369  4D89 07 D1 05      call printf
11370  4D8C 51 09 00      add sp, 9
11371  4D8F             ;; if (starbases_left < 1) { 
11372  4D8F             _if180_cond:
11373  4D8F 3B 0E 62      mov d, _starbases_left ; $starbases_left
11374  4D92 32            mov bl, [d]
11375  4D93 A7 00         mov bh, 0
11376  4D95             ; START RELATIONAL
11377  4D95 D7            push a
11378  4D96 11            mov a, b
11379  4D97 26 01 00      mov b, $1
11380  4D9A B0            cmp a, b
11381  4D9B FD 73         slt ; < (signed)
11382  4D9D E4            pop a
11383  4D9E             ; END RELATIONAL
11384  4D9E C0 00 00      cmp b, 0
11385  4DA1 C6 B3 4D      je _if180_else
11386  4DA4             _if180_true:
11387  4DA4             ;; puts("Your stupidity has left you on your own in the galaxy\n -- you have no starbases left!\n"); 
11388  4DA4 26 8D 71      mov b, __s136 ; "Your stupidity has left you on your own in the galaxy\n -- you have no starbases left!\n"
11389  4DA7 FD AB         swp b
11390  4DA9 D8            push b
11391  4DAA 07 37 13      call puts
11392  4DAD 51 02 00      add sp, 2
11393  4DB0 0A FD 4D      jmp _if180_exit
11394  4DB3             _if180_else:
11395  4DB3             ;; plural = str_s; 
11396  4DB3 FA FF FF      lea d, [bp + -1] ; $plural
11397  4DB6 DA            push d
11398  4DB7 3B 8A 64      mov d, _str_s ; $str_s
11399  4DBA 2A            mov b, [d]
11400  4DBB E7            pop d
11401  4DBC FD 43         mov [d], b
11402  4DBE             ;; if (starbases_left < 2) 
11403  4DBE             _if181_cond:
11404  4DBE 3B 0E 62      mov d, _starbases_left ; $starbases_left
11405  4DC1 32            mov bl, [d]
11406  4DC2 A7 00         mov bh, 0
11407  4DC4             ; START RELATIONAL
11408  4DC4 D7            push a
11409  4DC5 11            mov a, b
11410  4DC6 26 02 00      mov b, $2
11411  4DC9 B0            cmp a, b
11412  4DCA FD 73         slt ; < (signed)
11413  4DCC E4            pop a
11414  4DCD             ; END RELATIONAL
11415  4DCD C0 00 00      cmp b, 0
11416  4DD0 C6 E3 4D      je _if181_exit
11417  4DD3             _if181_true:
11418  4DD3             ;; plural++; 
11419  4DD3 FA FF FF      lea d, [bp + -1] ; $plural
11420  4DD6 2A            mov b, [d]
11421  4DD7 D8            push b
11422  4DD8 FD 77         inc b
11423  4DDA FA FF FF      lea d, [bp + -1] ; $plural
11424  4DDD FD 43         mov [d], b
11425  4DDF E5            pop b
11426  4DE0 0A E3 4D      jmp _if181_exit
11427  4DE3             _if181_exit:
11428  4DE3             ;; printf("The Federation is maintaining %d starbase%s in the galaxy\n\n", starbases_left, plural); 
11429  4DE3 FA FF FF      lea d, [bp + -1] ; $plural
11430  4DE6 2A            mov b, [d]
11431  4DE7 FD AB         swp b
11432  4DE9 D8            push b
11433  4DEA 3B 0E 62      mov d, _starbases_left ; $starbases_left
11434  4DED 32            mov bl, [d]
11435  4DEE A7 00         mov bh, 0
11436  4DF0 DD            push bl
11437  4DF1 26 E4 71      mov b, __s137 ; "The Federation is maintaining %d starbase%s in the galaxy\n\n"
11438  4DF4 FD AB         swp b
11439  4DF6 D8            push b
11440  4DF7 07 D1 05      call printf
11441  4DFA 51 05 00      add sp, 5
11442  4DFD             _if180_exit:
11443  4DFD F9            leave
11444  4DFE 09            ret
11445  4DFF             
11446  4DFF             torpedo_data:
11447  4DFF F8 00 00      enter 0 ; (push bp; mov bp, sp)
11448  4E02             ; $i 
11449  4E02             ; $plural 
11450  4E02             ; $k 
11451  4E02 52 06 00      sub sp, 6
11452  4E05             ;; plural = str_s + 1; 
11453  4E05 FA FD FF      lea d, [bp + -3] ; $plural
11454  4E08 DA            push d
11455  4E09 3B 8A 64      mov d, _str_s ; $str_s
11456  4E0C 2A            mov b, [d]
11457  4E0D             ; START TERMS
11458  4E0D D7            push a
11459  4E0E 11            mov a, b
11460  4E0F 26 01 00      mov b, $1
11461  4E12 56            add b, a
11462  4E13 E4            pop a
11463  4E14             ; END TERMS
11464  4E14 E7            pop d
11465  4E15 FD 43         mov [d], b
11466  4E17             ;; if (no_klingon()) 
11467  4E17             _if182_cond:
11468  4E17 07 27 3C      call no_klingon
11469  4E1A C0 00 00      cmp b, 0
11470  4E1D C6 25 4E      je _if182_exit
11471  4E20             _if182_true:
11472  4E20             ;; return; 
11473  4E20 F9            leave
11474  4E21 09            ret
11475  4E22 0A 25 4E      jmp _if182_exit
11476  4E25             _if182_exit:
11477  4E25             ;; if (klingons > 1) 
11478  4E25             _if183_cond:
11479  4E25 3B E1 62      mov d, _klingons ; $klingons
11480  4E28 32            mov bl, [d]
11481  4E29 A7 00         mov bh, 0
11482  4E2B             ; START RELATIONAL
11483  4E2B D7            push a
11484  4E2C 11            mov a, b
11485  4E2D 26 01 00      mov b, $1
11486  4E30 B0            cmp a, b
11487  4E31 FD 81         sgu ; > (unsigned)
11488  4E33 E4            pop a
11489  4E34             ; END RELATIONAL
11490  4E34 C0 00 00      cmp b, 0
11491  4E37 C6 4A 4E      je _if183_exit
11492  4E3A             _if183_true:
11493  4E3A             ;; plural--; 
11494  4E3A FA FD FF      lea d, [bp + -3] ; $plural
11495  4E3D 2A            mov b, [d]
11496  4E3E D8            push b
11497  4E3F FD 7D         dec b
11498  4E41 FA FD FF      lea d, [bp + -3] ; $plural
11499  4E44 FD 43         mov [d], b
11500  4E46 E5            pop b
11501  4E47 0A 4A 4E      jmp _if183_exit
11502  4E4A             _if183_exit:
11503  4E4A             ;; printf("From Enterprise to Klingon battlecriuser%s:\n\n", plural); 
11504  4E4A FA FD FF      lea d, [bp + -3] ; $plural
11505  4E4D 2A            mov b, [d]
11506  4E4E FD AB         swp b
11507  4E50 D8            push b
11508  4E51 26 20 72      mov b, __s138 ; "From Enterprise to Klingon battlecriuser%s:\n\n"
11509  4E54 FD AB         swp b
11510  4E56 D8            push b
11511  4E57 07 D1 05      call printf
11512  4E5A 51 04 00      add sp, 4
11513  4E5D             ;; k = kdata; 
11514  4E5D FA FB FF      lea d, [bp + -5] ; $k
11515  4E60 DA            push d
11516  4E61 3B D5 62      mov d, _kdata_data ; $kdata
11517  4E64 2D            mov b, d
11518  4E65 E7            pop d
11519  4E66 FD 43         mov [d], b
11520  4E68             ;; for (i = 0; i <= 2; i++) { 
11521  4E68             _for184_init:
11522  4E68 FA FF FF      lea d, [bp + -1] ; $i
11523  4E6B DA            push d
11524  4E6C 26 00 00      mov b, $0
11525  4E6F E7            pop d
11526  4E70 FD 43         mov [d], b
11527  4E72             _for184_cond:
11528  4E72 FA FF FF      lea d, [bp + -1] ; $i
11529  4E75 2A            mov b, [d]
11530  4E76             ; START RELATIONAL
11531  4E76 D7            push a
11532  4E77 11            mov a, b
11533  4E78 26 02 00      mov b, $2
11534  4E7B B0            cmp a, b
11535  4E7C FD 73         slt ; <= (signed)
11536  4E7E E4            pop a
11537  4E7F             ; END RELATIONAL
11538  4E7F C0 00 00      cmp b, 0
11539  4E82 C6 FF 4E      je _for184_exit
11540  4E85             _for184_block:
11541  4E85             ;; if (k->energy > 0) { 
11542  4E85             _if185_cond:
11543  4E85 FA FB FF      lea d, [bp + -5] ; $k
11544  4E88 FD 2A         mov d, [d]
11545  4E8A 58 02 00      add d, 2
11546  4E8D 2A            mov b, [d]
11547  4E8E             ; START RELATIONAL
11548  4E8E D7            push a
11549  4E8F 11            mov a, b
11550  4E90 26 00 00      mov b, $0
11551  4E93 B0            cmp a, b
11552  4E94 FD 7F         sgt ; >
11553  4E96 E4            pop a
11554  4E97             ; END RELATIONAL
11555  4E97 C0 00 00      cmp b, 0
11556  4E9A C6 E2 4E      je _if185_exit
11557  4E9D             _if185_true:
11558  4E9D             ;; compute_vector(TO_FIXED00(k->y), 
11559  4E9D 3B 07 63      mov d, _ship_x ; $ship_x
11560  4EA0 2A            mov b, [d]
11561  4EA1 FD AB         swp b
11562  4EA3 D8            push b
11563  4EA4 3B 05 63      mov d, _ship_y ; $ship_y
11564  4EA7 2A            mov b, [d]
11565  4EA8 FD AB         swp b
11566  4EAA D8            push b
11567  4EAB FA FB FF      lea d, [bp + -5] ; $k
11568  4EAE FD 2A         mov d, [d]
11569  4EB0 58 01 00      add d, 1
11570  4EB3 32            mov bl, [d]
11571  4EB4 A7 00         mov bh, 0
11572  4EB6 FD AB         swp b
11573  4EB8 D8            push b
11574  4EB9 07 02 1D      call TO_FIXED00
11575  4EBC 51 02 00      add sp, 2
11576  4EBF FD AB         swp b
11577  4EC1 D8            push b
11578  4EC2 FA FB FF      lea d, [bp + -5] ; $k
11579  4EC5 FD 2A         mov d, [d]
11580  4EC7 58 00 00      add d, 0
11581  4ECA 32            mov bl, [d]
11582  4ECB A7 00         mov bh, 0
11583  4ECD FD AB         swp b
11584  4ECF D8            push b
11585  4ED0 07 02 1D      call TO_FIXED00
11586  4ED3 51 02 00      add sp, 2
11587  4ED6 FD AB         swp b
11588  4ED8 D8            push b
11589  4ED9 07 B2 52      call compute_vector
11590  4EDC 51 08 00      add sp, 8
11591  4EDF 0A E2 4E      jmp _if185_exit
11592  4EE2             _if185_exit:
11593  4EE2             ;; k++; 
11594  4EE2 FA FB FF      lea d, [bp + -5] ; $k
11595  4EE5 2A            mov b, [d]
11596  4EE6 D8            push b
11597  4EE7 FD 77         inc b
11598  4EE9 FA FB FF      lea d, [bp + -5] ; $k
11599  4EEC FD 43         mov [d], b
11600  4EEE E5            pop b
11601  4EEF             _for184_update:
11602  4EEF FA FF FF      lea d, [bp + -1] ; $i
11603  4EF2 2A            mov b, [d]
11604  4EF3 D8            push b
11605  4EF4 FD 77         inc b
11606  4EF6 FA FF FF      lea d, [bp + -1] ; $i
11607  4EF9 FD 43         mov [d], b
11608  4EFB E5            pop b
11609  4EFC 0A 72 4E      jmp _for184_cond
11610  4EFF             _for184_exit:
11611  4EFF F9            leave
11612  4F00 09            ret
11613  4F01             
11614  4F01             nav_data:
11615  4F01 F8 00 00      enter 0 ; (push bp; mov bp, sp)
11616  4F04             ;; if (starbases <= 0) { 
11617  4F04             _if186_cond:
11618  4F04 3B 0B 62      mov d, _starbases ; $starbases
11619  4F07 32            mov bl, [d]
11620  4F08 A7 00         mov bh, 0
11621  4F0A             ; START RELATIONAL
11622  4F0A D7            push a
11623  4F0B 11            mov a, b
11624  4F0C 26 00 00      mov b, $0
11625  4F0F B0            cmp a, b
11626  4F10 FD 73         slt ; <= (signed)
11627  4F12 E4            pop a
11628  4F13             ; END RELATIONAL
11629  4F13 C0 00 00      cmp b, 0
11630  4F16 C6 2A 4F      je _if186_exit
11631  4F19             _if186_true:
11632  4F19             ;; puts("Mr. Spock reports,\n  'Sensors show no starbases in this quadrant.'\n"); 
11633  4F19 26 4E 72      mov b, __s139 ; "Mr. Spock reports,\n  'Sensors show no starbases in this quadrant.'\n"
11634  4F1C FD AB         swp b
11635  4F1E D8            push b
11636  4F1F 07 37 13      call puts
11637  4F22 51 02 00      add sp, 2
11638  4F25             ;; return; 
11639  4F25 F9            leave
11640  4F26 09            ret
11641  4F27 0A 2A 4F      jmp _if186_exit
11642  4F2A             _if186_exit:
11643  4F2A             ;; compute_vector(TO_FIXED00(base_y), TO_FIXED00(base_x), ship_y, ship_x); 
11644  4F2A 3B 07 63      mov d, _ship_x ; $ship_x
11645  4F2D 2A            mov b, [d]
11646  4F2E FD AB         swp b
11647  4F30 D8            push b
11648  4F31 3B 05 63      mov d, _ship_y ; $ship_y
11649  4F34 2A            mov b, [d]
11650  4F35 FD AB         swp b
11651  4F37 D8            push b
11652  4F38 3B 0D 62      mov d, _base_x ; $base_x
11653  4F3B 32            mov bl, [d]
11654  4F3C A7 00         mov bh, 0
11655  4F3E FD AB         swp b
11656  4F40 D8            push b
11657  4F41 07 02 1D      call TO_FIXED00
11658  4F44 51 02 00      add sp, 2
11659  4F47 FD AB         swp b
11660  4F49 D8            push b
11661  4F4A 3B 0C 62      mov d, _base_y ; $base_y
11662  4F4D 32            mov bl, [d]
11663  4F4E A7 00         mov bh, 0
11664  4F50 FD AB         swp b
11665  4F52 D8            push b
11666  4F53 07 02 1D      call TO_FIXED00
11667  4F56 51 02 00      add sp, 2
11668  4F59 FD AB         swp b
11669  4F5B D8            push b
11670  4F5C 07 B2 52      call compute_vector
11671  4F5F 51 08 00      add sp, 8
11672  4F62 F9            leave
11673  4F63 09            ret
11674  4F64             
11675  4F64             dirdist_calc:
11676  4F64 F8 00 00      enter 0 ; (push bp; mov bp, sp)
11677  4F67             ; $c1 
11678  4F67             ; $a 
11679  4F67             ; $w1 
11680  4F67             ; $x 
11681  4F67 52 08 00      sub sp, 8
11682  4F6A             ;; printf("Direction/Distance Calculator\n You are at quadrant %d,%d sector %d,%d\n\n Please enter initial X coordinate: ", 
11683  4F6A 3B 07 63      mov d, _ship_x ; $ship_x
11684  4F6D 2A            mov b, [d]
11685  4F6E FD AB         swp b
11686  4F70 D8            push b
11687  4F71 07 14 1D      call FROM_FIXED00
11688  4F74 51 02 00      add sp, 2
11689  4F77 FD AB         swp b
11690  4F79 D8            push b
11691  4F7A 3B 05 63      mov d, _ship_y ; $ship_y
11692  4F7D 2A            mov b, [d]
11693  4F7E FD AB         swp b
11694  4F80 D8            push b
11695  4F81 07 14 1D      call FROM_FIXED00
11696  4F84 51 02 00      add sp, 2
11697  4F87 FD AB         swp b
11698  4F89 D8            push b
11699  4F8A 3B E8 62      mov d, _quad_x ; $quad_x
11700  4F8D 2A            mov b, [d]
11701  4F8E FD AB         swp b
11702  4F90 D8            push b
11703  4F91 3B E6 62      mov d, _quad_y ; $quad_y
11704  4F94 2A            mov b, [d]
11705  4F95 FD AB         swp b
11706  4F97 D8            push b
11707  4F98 26 92 72      mov b, __s140 ; "Direction/Distance Calculator\n You are at quadrant %d,%d sector %d,%d\n\n Please enter initial X coordinate: "
11708  4F9B FD AB         swp b
11709  4F9D D8            push b
11710  4F9E 07 D1 05      call printf
11711  4FA1 51 0A 00      add sp, 10
11712  4FA4             ;; c1 = TO_FIXED00(input_int()); 
11713  4FA4 FA FF FF      lea d, [bp + -1] ; $c1
11714  4FA7 DA            push d
11715  4FA8 07 D0 20      call input_int
11716  4FAB FD AB         swp b
11717  4FAD D8            push b
11718  4FAE 07 02 1D      call TO_FIXED00
11719  4FB1 51 02 00      add sp, 2
11720  4FB4 E7            pop d
11721  4FB5 FD 43         mov [d], b
11722  4FB7             ;; if (c1 < 0 || c1 > 900 ) 
11723  4FB7             _if187_cond:
11724  4FB7 FA FF FF      lea d, [bp + -1] ; $c1
11725  4FBA 2A            mov b, [d]
11726  4FBB             ; START RELATIONAL
11727  4FBB D7            push a
11728  4FBC 11            mov a, b
11729  4FBD 26 00 00      mov b, $0
11730  4FC0 B0            cmp a, b
11731  4FC1 FD 73         slt ; < (signed)
11732  4FC3 E4            pop a
11733  4FC4             ; END RELATIONAL
11734  4FC4 D7            push a
11735  4FC5 11            mov a, b
11736  4FC6 FA FF FF      lea d, [bp + -1] ; $c1
11737  4FC9 2A            mov b, [d]
11738  4FCA             ; START RELATIONAL
11739  4FCA D7            push a
11740  4FCB 11            mov a, b
11741  4FCC 26 84 03      mov b, $384
11742  4FCF B0            cmp a, b
11743  4FD0 FD 7F         sgt ; >
11744  4FD2 E4            pop a
11745  4FD3             ; END RELATIONAL
11746  4FD3 FD A8         sor a, b ; ||
11747  4FD5 E4            pop a
11748  4FD6 C0 00 00      cmp b, 0
11749  4FD9 C6 E1 4F      je _if187_exit
11750  4FDC             _if187_true:
11751  4FDC             ;; return; 
11752  4FDC F9            leave
11753  4FDD 09            ret
11754  4FDE 0A E1 4F      jmp _if187_exit
11755  4FE1             _if187_exit:
11756  4FE1             ;; puts("Please enter initial Y coordinate: "); 
11757  4FE1 26 FE 72      mov b, __s141 ; "Please enter initial Y coordinate: "
11758  4FE4 FD AB         swp b
11759  4FE6 D8            push b
11760  4FE7 07 37 13      call puts
11761  4FEA 51 02 00      add sp, 2
11762  4FED             ;; a = TO_FIXED00(input_int()); 
11763  4FED FA FD FF      lea d, [bp + -3] ; $a
11764  4FF0 DA            push d
11765  4FF1 07 D0 20      call input_int
11766  4FF4 FD AB         swp b
11767  4FF6 D8            push b
11768  4FF7 07 02 1D      call TO_FIXED00
11769  4FFA 51 02 00      add sp, 2
11770  4FFD E7            pop d
11771  4FFE FD 43         mov [d], b
11772  5000             ;; if (a < 0 || a > 900) 
11773  5000             _if188_cond:
11774  5000 FA FD FF      lea d, [bp + -3] ; $a
11775  5003 2A            mov b, [d]
11776  5004             ; START RELATIONAL
11777  5004 D7            push a
11778  5005 11            mov a, b
11779  5006 26 00 00      mov b, $0
11780  5009 B0            cmp a, b
11781  500A FD 73         slt ; < (signed)
11782  500C E4            pop a
11783  500D             ; END RELATIONAL
11784  500D D7            push a
11785  500E 11            mov a, b
11786  500F FA FD FF      lea d, [bp + -3] ; $a
11787  5012 2A            mov b, [d]
11788  5013             ; START RELATIONAL
11789  5013 D7            push a
11790  5014 11            mov a, b
11791  5015 26 84 03      mov b, $384
11792  5018 B0            cmp a, b
11793  5019 FD 7F         sgt ; >
11794  501B E4            pop a
11795  501C             ; END RELATIONAL
11796  501C FD A8         sor a, b ; ||
11797  501E E4            pop a
11798  501F C0 00 00      cmp b, 0
11799  5022 C6 2A 50      je _if188_exit
11800  5025             _if188_true:
11801  5025             ;; return; 
11802  5025 F9            leave
11803  5026 09            ret
11804  5027 0A 2A 50      jmp _if188_exit
11805  502A             _if188_exit:
11806  502A             ;; puts("Please enter final X coordinate: "); 
11807  502A 26 22 73      mov b, __s142 ; "Please enter final X coordinate: "
11808  502D FD AB         swp b
11809  502F D8            push b
11810  5030 07 37 13      call puts
11811  5033 51 02 00      add sp, 2
11812  5036             ;; w1 = TO_FIXED00(input_int()); 
11813  5036 FA FB FF      lea d, [bp + -5] ; $w1
11814  5039 DA            push d
11815  503A 07 D0 20      call input_int
11816  503D FD AB         swp b
11817  503F D8            push b
11818  5040 07 02 1D      call TO_FIXED00
11819  5043 51 02 00      add sp, 2
11820  5046 E7            pop d
11821  5047 FD 43         mov [d], b
11822  5049             ;; if (w1 < 0 || w1 > 900) 
11823  5049             _if189_cond:
11824  5049 FA FB FF      lea d, [bp + -5] ; $w1
11825  504C 2A            mov b, [d]
11826  504D             ; START RELATIONAL
11827  504D D7            push a
11828  504E 11            mov a, b
11829  504F 26 00 00      mov b, $0
11830  5052 B0            cmp a, b
11831  5053 FD 73         slt ; < (signed)
11832  5055 E4            pop a
11833  5056             ; END RELATIONAL
11834  5056 D7            push a
11835  5057 11            mov a, b
11836  5058 FA FB FF      lea d, [bp + -5] ; $w1
11837  505B 2A            mov b, [d]
11838  505C             ; START RELATIONAL
11839  505C D7            push a
11840  505D 11            mov a, b
11841  505E 26 84 03      mov b, $384
11842  5061 B0            cmp a, b
11843  5062 FD 7F         sgt ; >
11844  5064 E4            pop a
11845  5065             ; END RELATIONAL
11846  5065 FD A8         sor a, b ; ||
11847  5067 E4            pop a
11848  5068 C0 00 00      cmp b, 0
11849  506B C6 73 50      je _if189_exit
11850  506E             _if189_true:
11851  506E             ;; return; 
11852  506E F9            leave
11853  506F 09            ret
11854  5070 0A 73 50      jmp _if189_exit
11855  5073             _if189_exit:
11856  5073             ;; puts("Please enter final Y coordinate: "); 
11857  5073 26 44 73      mov b, __s143 ; "Please enter final Y coordinate: "
11858  5076 FD AB         swp b
11859  5078 D8            push b
11860  5079 07 37 13      call puts
11861  507C 51 02 00      add sp, 2
11862  507F             ;; x = TO_FIXED00(input_int()); 
11863  507F FA F9 FF      lea d, [bp + -7] ; $x
11864  5082 DA            push d
11865  5083 07 D0 20      call input_int
11866  5086 FD AB         swp b
11867  5088 D8            push b
11868  5089 07 02 1D      call TO_FIXED00
11869  508C 51 02 00      add sp, 2
11870  508F E7            pop d
11871  5090 FD 43         mov [d], b
11872  5092             ;; if (x < 0 || x > 900) 
11873  5092             _if190_cond:
11874  5092 FA F9 FF      lea d, [bp + -7] ; $x
11875  5095 2A            mov b, [d]
11876  5096             ; START RELATIONAL
11877  5096 D7            push a
11878  5097 11            mov a, b
11879  5098 26 00 00      mov b, $0
11880  509B B0            cmp a, b
11881  509C FD 73         slt ; < (signed)
11882  509E E4            pop a
11883  509F             ; END RELATIONAL
11884  509F D7            push a
11885  50A0 11            mov a, b
11886  50A1 FA F9 FF      lea d, [bp + -7] ; $x
11887  50A4 2A            mov b, [d]
11888  50A5             ; START RELATIONAL
11889  50A5 D7            push a
11890  50A6 11            mov a, b
11891  50A7 26 84 03      mov b, $384
11892  50AA B0            cmp a, b
11893  50AB FD 7F         sgt ; >
11894  50AD E4            pop a
11895  50AE             ; END RELATIONAL
11896  50AE FD A8         sor a, b ; ||
11897  50B0 E4            pop a
11898  50B1 C0 00 00      cmp b, 0
11899  50B4 C6 BC 50      je _if190_exit
11900  50B7             _if190_true:
11901  50B7             ;; return; 
11902  50B7 F9            leave
11903  50B8 09            ret
11904  50B9 0A BC 50      jmp _if190_exit
11905  50BC             _if190_exit:
11906  50BC             ;; compute_vector(w1, x, c1, a); 
11907  50BC FA FD FF      lea d, [bp + -3] ; $a
11908  50BF 2A            mov b, [d]
11909  50C0 FD AB         swp b
11910  50C2 D8            push b
11911  50C3 FA FF FF      lea d, [bp + -1] ; $c1
11912  50C6 2A            mov b, [d]
11913  50C7 FD AB         swp b
11914  50C9 D8            push b
11915  50CA FA F9 FF      lea d, [bp + -7] ; $x
11916  50CD 2A            mov b, [d]
11917  50CE FD AB         swp b
11918  50D0 D8            push b
11919  50D1 FA FB FF      lea d, [bp + -5] ; $w1
11920  50D4 2A            mov b, [d]
11921  50D5 FD AB         swp b
11922  50D7 D8            push b
11923  50D8 07 B2 52      call compute_vector
11924  50DB 51 08 00      add sp, 8
11925  50DE F9            leave
11926  50DF 09            ret
11927  50E0             
11928  50E0             galaxy_map:
11929  50E0 F8 00 00      enter 0 ; (push bp; mov bp, sp)
11930  50E3             ; $i 
11931  50E3             ; $j 
11932  50E3             ; $j0 
11933  50E3 52 06 00      sub sp, 6
11934  50E6             ;; printf("\n                   The Galaxy\n\n"); 
11935  50E6 26 66 73      mov b, __s144 ; "\n                   The Galaxy\n\n"
11936  50E9 FD AB         swp b
11937  50EB D8            push b
11938  50EC 07 D1 05      call printf
11939  50EF 51 02 00      add sp, 2
11940  50F2             ;; printf("    1     2     3     4     5     6     7     8\n"); 
11941  50F2 26 87 73      mov b, __s145 ; "    1     2     3     4     5     6     7     8\n"
11942  50F5 FD AB         swp b
11943  50F7 D8            push b
11944  50F8 07 D1 05      call printf
11945  50FB 51 02 00      add sp, 2
11946  50FE             ;; for (i = 1; i <= 8; i++) { 
11947  50FE             _for191_init:
11948  50FE FA FF FF      lea d, [bp + -1] ; $i
11949  5101 DA            push d
11950  5102 26 01 00      mov b, $1
11951  5105 E7            pop d
11952  5106 FD 43         mov [d], b
11953  5108             _for191_cond:
11954  5108 FA FF FF      lea d, [bp + -1] ; $i
11955  510B 2A            mov b, [d]
11956  510C             ; START RELATIONAL
11957  510C D7            push a
11958  510D 11            mov a, b
11959  510E 26 08 00      mov b, $8
11960  5111 B0            cmp a, b
11961  5112 FD 73         slt ; <= (signed)
11962  5114 E4            pop a
11963  5115             ; END RELATIONAL
11964  5115 C0 00 00      cmp b, 0
11965  5118 C6 A3 52      je _for191_exit
11966  511B             _for191_block:
11967  511B             ;; printf("%s%d ", gm_1, i); 
11968  511B FA FF FF      lea d, [bp + -1] ; $i
11969  511E 2A            mov b, [d]
11970  511F FD AB         swp b
11971  5121 D8            push b
11972  5122 3B BF 64      mov d, _gm_1 ; $gm_1
11973  5125 2A            mov b, [d]
11974  5126 FD AB         swp b
11975  5128 D8            push b
11976  5129 26 B8 73      mov b, __s146 ; "%s%d "
11977  512C FD AB         swp b
11978  512E D8            push b
11979  512F 07 D1 05      call printf
11980  5132 51 06 00      add sp, 6
11981  5135             ;; quadrant_name(1, i, 1); 
11982  5135 26 01 00      mov b, $1
11983  5138 DD            push bl
11984  5139 FA FF FF      lea d, [bp + -1] ; $i
11985  513C 2A            mov b, [d]
11986  513D DD            push bl
11987  513E 26 01 00      mov b, $1
11988  5141 DD            push bl
11989  5142 07 FB 5E      call quadrant_name
11990  5145 51 03 00      add sp, 3
11991  5148             ;; j0 = (int) (11 - (strlen(quadname) / 2)); 
11992  5148 FA FB FF      lea d, [bp + -5] ; $j0
11993  514B DA            push d
11994  514C 26 0B 00      mov b, $b
11995  514F             ; START TERMS
11996  514F D7            push a
11997  5150 11            mov a, b
11998  5151 3B 4B 63      mov d, _quadname_data ; $quadname
11999  5154 2D            mov b, d
12000  5155 FD AB         swp b
12001  5157 D8            push b
12002  5158 07 88 05      call strlen
12003  515B 51 02 00      add sp, 2
12004  515E             ; START FACTORS
12005  515E D7            push a
12006  515F 11            mov a, b
12007  5160 26 02 00      mov b, $2
12008  5163 AE            div a, b
12009  5164 27            mov b, a
12010  5165 E4            pop a
12011  5166             ; END FACTORS
12012  5166 60            sub a, b
12013  5167 27            mov b, a
12014  5168 E4            pop a
12015  5169             ; END TERMS
12016  5169 E7            pop d
12017  516A FD 43         mov [d], b
12018  516C             ;; for (j = 0; j < j0; j++) 
12019  516C             _for192_init:
12020  516C FA FD FF      lea d, [bp + -3] ; $j
12021  516F DA            push d
12022  5170 26 00 00      mov b, $0
12023  5173 E7            pop d
12024  5174 FD 43         mov [d], b
12025  5176             _for192_cond:
12026  5176 FA FD FF      lea d, [bp + -3] ; $j
12027  5179 2A            mov b, [d]
12028  517A             ; START RELATIONAL
12029  517A D7            push a
12030  517B 11            mov a, b
12031  517C FA FB FF      lea d, [bp + -5] ; $j0
12032  517F 2A            mov b, [d]
12033  5180 B0            cmp a, b
12034  5181 FD 73         slt ; < (signed)
12035  5183 E4            pop a
12036  5184             ; END RELATIONAL
12037  5184 C0 00 00      cmp b, 0
12038  5187 C6 A4 51      je _for192_exit
12039  518A             _for192_block:
12040  518A             ;; putchar(' '); 
12041  518A 26 20 00      mov b, $20
12042  518D DD            push bl
12043  518E 07 01 13      call putchar
12044  5191 51 01 00      add sp, 1
12045  5194             _for192_update:
12046  5194 FA FD FF      lea d, [bp + -3] ; $j
12047  5197 2A            mov b, [d]
12048  5198 D8            push b
12049  5199 FD 77         inc b
12050  519B FA FD FF      lea d, [bp + -3] ; $j
12051  519E FD 43         mov [d], b
12052  51A0 E5            pop b
12053  51A1 0A 76 51      jmp _for192_cond
12054  51A4             _for192_exit:
12055  51A4             ;; puts(quadname); 
12056  51A4 3B 4B 63      mov d, _quadname_data ; $quadname
12057  51A7 2D            mov b, d
12058  51A8 FD AB         swp b
12059  51AA D8            push b
12060  51AB 07 37 13      call puts
12061  51AE 51 02 00      add sp, 2
12062  51B1             ;; for (j = 0; j < j0; j++) 
12063  51B1             _for193_init:
12064  51B1 FA FD FF      lea d, [bp + -3] ; $j
12065  51B4 DA            push d
12066  51B5 26 00 00      mov b, $0
12067  51B8 E7            pop d
12068  51B9 FD 43         mov [d], b
12069  51BB             _for193_cond:
12070  51BB FA FD FF      lea d, [bp + -3] ; $j
12071  51BE 2A            mov b, [d]
12072  51BF             ; START RELATIONAL
12073  51BF D7            push a
12074  51C0 11            mov a, b
12075  51C1 FA FB FF      lea d, [bp + -5] ; $j0
12076  51C4 2A            mov b, [d]
12077  51C5 B0            cmp a, b
12078  51C6 FD 73         slt ; < (signed)
12079  51C8 E4            pop a
12080  51C9             ; END RELATIONAL
12081  51C9 C0 00 00      cmp b, 0
12082  51CC C6 E9 51      je _for193_exit
12083  51CF             _for193_block:
12084  51CF             ;; putchar(' '); 
12085  51CF 26 20 00      mov b, $20
12086  51D2 DD            push bl
12087  51D3 07 01 13      call putchar
12088  51D6 51 01 00      add sp, 1
12089  51D9             _for193_update:
12090  51D9 FA FD FF      lea d, [bp + -3] ; $j
12091  51DC 2A            mov b, [d]
12092  51DD D8            push b
12093  51DE FD 77         inc b
12094  51E0 FA FD FF      lea d, [bp + -3] ; $j
12095  51E3 FD 43         mov [d], b
12096  51E5 E5            pop b
12097  51E6 0A BB 51      jmp _for193_cond
12098  51E9             _for193_exit:
12099  51E9             ;; if (!(strlen(quadname) % 2)) 
12100  51E9             _if194_cond:
12101  51E9 3B 4B 63      mov d, _quadname_data ; $quadname
12102  51EC 2D            mov b, d
12103  51ED FD AB         swp b
12104  51EF D8            push b
12105  51F0 07 88 05      call strlen
12106  51F3 51 02 00      add sp, 2
12107  51F6             ; START FACTORS
12108  51F6 D7            push a
12109  51F7 11            mov a, b
12110  51F8 26 02 00      mov b, $2
12111  51FB AE            div a, b ; 
12112  51FC 11            mov a, b
12113  51FD 27            mov b, a
12114  51FE E4            pop a
12115  51FF             ; END FACTORS
12116  51FF C0 00 00      cmp b, 0
12117  5202 FD 71         seq ; !
12118  5204 C0 00 00      cmp b, 0
12119  5207 C6 17 52      je _if194_exit
12120  520A             _if194_true:
12121  520A             ;; putchar(' '); 
12122  520A 26 20 00      mov b, $20
12123  520D DD            push bl
12124  520E 07 01 13      call putchar
12125  5211 51 01 00      add sp, 1
12126  5214 0A 17 52      jmp _if194_exit
12127  5217             _if194_exit:
12128  5217             ;; quadrant_name(1, i, 5); 
12129  5217 26 05 00      mov b, $5
12130  521A DD            push bl
12131  521B FA FF FF      lea d, [bp + -1] ; $i
12132  521E 2A            mov b, [d]
12133  521F DD            push bl
12134  5220 26 01 00      mov b, $1
12135  5223 DD            push bl
12136  5224 07 FB 5E      call quadrant_name
12137  5227 51 03 00      add sp, 3
12138  522A             ;; j0 = (int) (12 - (strlen(quadname) / 2)); 
12139  522A FA FB FF      lea d, [bp + -5] ; $j0
12140  522D DA            push d
12141  522E 26 0C 00      mov b, $c
12142  5231             ; START TERMS
12143  5231 D7            push a
12144  5232 11            mov a, b
12145  5233 3B 4B 63      mov d, _quadname_data ; $quadname
12146  5236 2D            mov b, d
12147  5237 FD AB         swp b
12148  5239 D8            push b
12149  523A 07 88 05      call strlen
12150  523D 51 02 00      add sp, 2
12151  5240             ; START FACTORS
12152  5240 D7            push a
12153  5241 11            mov a, b
12154  5242 26 02 00      mov b, $2
12155  5245 AE            div a, b
12156  5246 27            mov b, a
12157  5247 E4            pop a
12158  5248             ; END FACTORS
12159  5248 60            sub a, b
12160  5249 27            mov b, a
12161  524A E4            pop a
12162  524B             ; END TERMS
12163  524B E7            pop d
12164  524C FD 43         mov [d], b
12165  524E             ;; for (j = 0; j < j0; j++) 
12166  524E             _for195_init:
12167  524E FA FD FF      lea d, [bp + -3] ; $j
12168  5251 DA            push d
12169  5252 26 00 00      mov b, $0
12170  5255 E7            pop d
12171  5256 FD 43         mov [d], b
12172  5258             _for195_cond:
12173  5258 FA FD FF      lea d, [bp + -3] ; $j
12174  525B 2A            mov b, [d]
12175  525C             ; START RELATIONAL
12176  525C D7            push a
12177  525D 11            mov a, b
12178  525E FA FB FF      lea d, [bp + -5] ; $j0
12179  5261 2A            mov b, [d]
12180  5262 B0            cmp a, b
12181  5263 FD 73         slt ; < (signed)
12182  5265 E4            pop a
12183  5266             ; END RELATIONAL
12184  5266 C0 00 00      cmp b, 0
12185  5269 C6 86 52      je _for195_exit
12186  526C             _for195_block:
12187  526C             ;; putchar(' '); 
12188  526C 26 20 00      mov b, $20
12189  526F DD            push bl
12190  5270 07 01 13      call putchar
12191  5273 51 01 00      add sp, 1
12192  5276             _for195_update:
12193  5276 FA FD FF      lea d, [bp + -3] ; $j
12194  5279 2A            mov b, [d]
12195  527A D8            push b
12196  527B FD 77         inc b
12197  527D FA FD FF      lea d, [bp + -3] ; $j
12198  5280 FD 43         mov [d], b
12199  5282 E5            pop b
12200  5283 0A 58 52      jmp _for195_cond
12201  5286             _for195_exit:
12202  5286             ;; puts(quadname); 
12203  5286 3B 4B 63      mov d, _quadname_data ; $quadname
12204  5289 2D            mov b, d
12205  528A FD AB         swp b
12206  528C D8            push b
12207  528D 07 37 13      call puts
12208  5290 51 02 00      add sp, 2
12209  5293             _for191_update:
12210  5293 FA FF FF      lea d, [bp + -1] ; $i
12211  5296 2A            mov b, [d]
12212  5297 D8            push b
12213  5298 FD 77         inc b
12214  529A FA FF FF      lea d, [bp + -1] ; $i
12215  529D FD 43         mov [d], b
12216  529F E5            pop b
12217  52A0 0A 08 51      jmp _for191_cond
12218  52A3             _for191_exit:
12219  52A3             ;; puts(gm_1); 
12220  52A3 3B BF 64      mov d, _gm_1 ; $gm_1
12221  52A6 2A            mov b, [d]
12222  52A7 FD AB         swp b
12223  52A9 D8            push b
12224  52AA 07 37 13      call puts
12225  52AD 51 02 00      add sp, 2
12226  52B0 F9            leave
12227  52B1 09            ret
12228  52B2             
12229  52B2             compute_vector:
12230  52B2 F8 00 00      enter 0 ; (push bp; mov bp, sp)
12231  52B5             ; $xl 
12232  52B5             ; $al 
12233  52B5 52 08 00      sub sp, 8
12234  52B8             ;; puts("  DIRECTION = "); 
12235  52B8 26 BE 73      mov b, __s147 ; "  DIRECTION = "
12236  52BB FD AB         swp b
12237  52BD D8            push b
12238  52BE 07 37 13      call puts
12239  52C1 51 02 00      add sp, 2
12240  52C4             ;; x = x - a; 
12241  52C4 FA 07 00      lea d, [bp + 7] ; $x
12242  52C7 DA            push d
12243  52C8 FA 07 00      lea d, [bp + 7] ; $x
12244  52CB 2A            mov b, [d]
12245  52CC             ; START TERMS
12246  52CC D7            push a
12247  52CD 11            mov a, b
12248  52CE FA 0B 00      lea d, [bp + 11] ; $a
12249  52D1 2A            mov b, [d]
12250  52D2 60            sub a, b
12251  52D3 27            mov b, a
12252  52D4 E4            pop a
12253  52D5             ; END TERMS
12254  52D5 E7            pop d
12255  52D6 FD 43         mov [d], b
12256  52D8             ;; a = c1 - w1; 
12257  52D8 FA 0B 00      lea d, [bp + 11] ; $a
12258  52DB DA            push d
12259  52DC FA 09 00      lea d, [bp + 9] ; $c1
12260  52DF 2A            mov b, [d]
12261  52E0             ; START TERMS
12262  52E0 D7            push a
12263  52E1 11            mov a, b
12264  52E2 FA 05 00      lea d, [bp + 5] ; $w1
12265  52E5 2A            mov b, [d]
12266  52E6 60            sub a, b
12267  52E7 27            mov b, a
12268  52E8 E4            pop a
12269  52E9             ; END TERMS
12270  52E9 E7            pop d
12271  52EA FD 43         mov [d], b
12272  52EC             ;; xl = abs(x); 
12273  52EC FA FD FF      lea d, [bp + -3] ; $xl
12274  52EF DA            push d
12275  52F0 FA 07 00      lea d, [bp + 7] ; $x
12276  52F3 2A            mov b, [d]
12277  52F4 FD AB         swp b
12278  52F6 D8            push b
12279  52F7 07 83 13      call abs
12280  52FA 51 02 00      add sp, 2
12281  52FD E7            pop d
12282  52FE FD 43         mov [d], b
12283  5300 28            mov b, c
12284  5301 FD 44 02 00   mov [d + 2], b
12285  5305             ;; al = abs(a); 
12286  5305 FA F9 FF      lea d, [bp + -7] ; $al
12287  5308 DA            push d
12288  5309 FA 0B 00      lea d, [bp + 11] ; $a
12289  530C 2A            mov b, [d]
12290  530D FD AB         swp b
12291  530F D8            push b
12292  5310 07 83 13      call abs
12293  5313 51 02 00      add sp, 2
12294  5316 E7            pop d
12295  5317 FD 43         mov [d], b
12296  5319 28            mov b, c
12297  531A FD 44 02 00   mov [d + 2], b
12298  531E             ;; if (x < 0) { 
12299  531E             _if196_cond:
12300  531E FA 07 00      lea d, [bp + 7] ; $x
12301  5321 2A            mov b, [d]
12302  5322             ; START RELATIONAL
12303  5322 D7            push a
12304  5323 11            mov a, b
12305  5324 26 00 00      mov b, $0
12306  5327 B0            cmp a, b
12307  5328 FD 73         slt ; < (signed)
12308  532A E4            pop a
12309  532B             ; END RELATIONAL
12310  532B C0 00 00      cmp b, 0
12311  532E C6 8F 54      je _if196_else
12312  5331             _if196_true:
12313  5331             ;; if (a > 0) { 
12314  5331             _if197_cond:
12315  5331 FA 0B 00      lea d, [bp + 11] ; $a
12316  5334 2A            mov b, [d]
12317  5335             ; START RELATIONAL
12318  5335 D7            push a
12319  5336 11            mov a, b
12320  5337 26 00 00      mov b, $0
12321  533A B0            cmp a, b
12322  533B FD 7F         sgt ; >
12323  533D E4            pop a
12324  533E             ; END RELATIONAL
12325  533E C0 00 00      cmp b, 0
12326  5341 C6 60 54      je _if197_else
12327  5344             _if197_true:
12328  5344             ;; c1 = 300; 
12329  5344 FA 09 00      lea d, [bp + 9] ; $c1
12330  5347 DA            push d
12331  5348 26 2C 01      mov b, $12c
12332  534B E7            pop d
12333  534C FD 43         mov [d], b
12334  534E             ;; estimate2: 
12335  534E             compute_vector_estimate2:
12336  534E             ;; if (al >= xl) 
12337  534E             _if198_cond:
12338  534E FA F9 FF      lea d, [bp + -7] ; $al
12339  5351 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
12340  5354 FD 39         mov c, b ; And place it into C
12341  5356 2A            mov b, [d] ; Lower Word in B
12342  5357             ; START RELATIONAL
12343  5357 D7            push a
12344  5358 FD D8         push g
12345  535A 11            mov a, b
out/startrek.asm line 12346: Label not found: (c)
out/startrek.asm line 12346: Unused data in MS byte of argument. (2)
12346  535B FD 22 00 00   mov g, c
12347  535F FA FD FF      lea d, [bp + -3] ; $xl
12348  5362 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
12349  5365 FD 39         mov c, b ; And place it into C
12350  5367 2A            mov b, [d] ; Lower Word in B
12351  5368 FD 82         sgeu
12352  536A FD F1         pop g
12353  536C E4            pop a
12354  536D             ; END RELATIONAL
12355  536D C0 00 00      cmp b, 0
12356  5370 C6 BD 53      je _if198_else
12357  5373             _if198_true:
12358  5373             ;; printf("%s", print100(c1 + ((xl * 100) / al))); 
12359  5373 FA 09 00      lea d, [bp + 9] ; $c1
12360  5376 2A            mov b, [d]
12361  5377             ; START TERMS
12362  5377 D7            push a
12363  5378 11            mov a, b
12364  5379 FA FD FF      lea d, [bp + -3] ; $xl
12365  537C 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
12366  537F FD 39         mov c, b ; And place it into C
12367  5381 2A            mov b, [d] ; Lower Word in B
12368  5382             ; START FACTORS
12369  5382 D7            push a
12370  5383 11            mov a, b
12371  5384 26 64 00      mov b, $64
12372  5387 AC            mul a, b ; *
12373  5388 11            mov a, b
12374  5389 27            mov b, a
12375  538A E4            pop a
12376  538B             ; END FACTORS
12377  538B             ; START FACTORS
12378  538B D7            push a
12379  538C 11            mov a, b
12380  538D FA F9 FF      lea d, [bp + -7] ; $al
12381  5390 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
12382  5393 FD 39         mov c, b ; And place it into C
12383  5395 2A            mov b, [d] ; Lower Word in B
12384  5396 AE            div a, b
12385  5397 27            mov b, a
12386  5398 E4            pop a
12387  5399             ; END FACTORS
12388  5399 54            add a, b
12389  539A D7            push a
12390  539B FD 12         mov a, g
12391  539D 28            mov b, c
12392  539E 5C            adc a, b
12393  539F 39            mov c, a
12394  53A0 E5            pop b
12395  53A1 E4            pop a
12396  53A2             ; END TERMS
12397  53A2 FD AB         swp b
12398  53A4 D8            push b
12399  53A5 07 1B 21      call print100
12400  53A8 51 02 00      add sp, 2
12401  53AB FD AB         swp b
12402  53AD D8            push b
12403  53AE 26 CD 73      mov b, __s148 ; "%s"
12404  53B1 FD AB         swp b
12405  53B3 D8            push b
12406  53B4 07 D1 05      call printf
12407  53B7 51 04 00      add sp, 4
12408  53BA 0A 23 54      jmp _if198_exit
12409  53BD             _if198_else:
12410  53BD             ;; printf("%s", print100(c1 + ((((xl * 2) - al) * 100)  / xl))); 
12411  53BD FA 09 00      lea d, [bp + 9] ; $c1
12412  53C0 2A            mov b, [d]
12413  53C1             ; START TERMS
12414  53C1 D7            push a
12415  53C2 11            mov a, b
12416  53C3 FA FD FF      lea d, [bp + -3] ; $xl
12417  53C6 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
12418  53C9 FD 39         mov c, b ; And place it into C
12419  53CB 2A            mov b, [d] ; Lower Word in B
12420  53CC             ; START FACTORS
12421  53CC D7            push a
12422  53CD 11            mov a, b
12423  53CE 26 02 00      mov b, $2
12424  53D1 AC            mul a, b ; *
12425  53D2 11            mov a, b
12426  53D3 27            mov b, a
12427  53D4 E4            pop a
12428  53D5             ; END FACTORS
12429  53D5             ; START TERMS
12430  53D5 D7            push a
12431  53D6 FD D8         push g
12432  53D8 11            mov a, b
out/startrek.asm line 12433: Label not found: (c)
out/startrek.asm line 12433: Unused data in MS byte of argument. (2)
12433  53D9 FD 22 00 00   mov g, c
12434  53DD FA F9 FF      lea d, [bp + -7] ; $al
12435  53E0 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
12436  53E3 FD 39         mov c, b ; And place it into C
12437  53E5 2A            mov b, [d] ; Lower Word in B
12438  53E6 60            sub a, b
12439  53E7 27            mov b, a
12440  53E8 FD F1         pop g
12441  53EA E4            pop a
12442  53EB             ; END TERMS
12443  53EB             ; START FACTORS
12444  53EB D7            push a
12445  53EC 11            mov a, b
12446  53ED 26 64 00      mov b, $64
12447  53F0 AC            mul a, b ; *
12448  53F1 11            mov a, b
12449  53F2 27            mov b, a
12450  53F3 E4            pop a
12451  53F4             ; END FACTORS
12452  53F4             ; START FACTORS
12453  53F4 D7            push a
12454  53F5 11            mov a, b
12455  53F6 FA FD FF      lea d, [bp + -3] ; $xl
12456  53F9 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
12457  53FC FD 39         mov c, b ; And place it into C
12458  53FE 2A            mov b, [d] ; Lower Word in B
12459  53FF AE            div a, b
12460  5400 27            mov b, a
12461  5401 E4            pop a
12462  5402             ; END FACTORS
12463  5402 54            add a, b
12464  5403 D7            push a
12465  5404 FD 12         mov a, g
12466  5406 28            mov b, c
12467  5407 5C            adc a, b
12468  5408 39            mov c, a
12469  5409 E5            pop b
12470  540A E4            pop a
12471  540B             ; END TERMS
12472  540B FD AB         swp b
12473  540D D8            push b
12474  540E 07 1B 21      call print100
12475  5411 51 02 00      add sp, 2
12476  5414 FD AB         swp b
12477  5416 D8            push b
12478  5417 26 CD 73      mov b, __s148 ; "%s"
12479  541A FD AB         swp b
12480  541C D8            push b
12481  541D 07 D1 05      call printf
12482  5420 51 04 00      add sp, 4
12483  5423             _if198_exit:
12484  5423             ;; printf(dist_1, print100((x > a) ? x : a)); 
12485  5423             _ternary202_cond:
12486  5423 FA 07 00      lea d, [bp + 7] ; $x
12487  5426 2A            mov b, [d]
12488  5427             ; START RELATIONAL
12489  5427 D7            push a
12490  5428 11            mov a, b
12491  5429 FA 0B 00      lea d, [bp + 11] ; $a
12492  542C 2A            mov b, [d]
12493  542D B0            cmp a, b
12494  542E FD 7F         sgt ; >
12495  5430 E4            pop a
12496  5431             ; END RELATIONAL
12497  5431 C0 00 00      cmp b, 0
12498  5434 C6 3E 54      je _ternary202_false
12499  5437             _ternary202_true:
12500  5437 FA 07 00      lea d, [bp + 7] ; $x
12501  543A 2A            mov b, [d]
12502  543B 0A 42 54      jmp _ternary202_exit
12503  543E             _ternary202_false:
12504  543E FA 0B 00      lea d, [bp + 11] ; $a
12505  5441 2A            mov b, [d]
12506  5442             _ternary202_exit:
12507  5442 FD AB         swp b
12508  5444 D8            push b
12509  5445 07 1B 21      call print100
12510  5448 51 02 00      add sp, 2
12511  544B FD AB         swp b
12512  544D D8            push b
12513  544E 3B D7 64      mov d, _dist_1 ; $dist_1
12514  5451 2A            mov b, [d]
12515  5452 FD AB         swp b
12516  5454 D8            push b
12517  5455 07 D1 05      call printf
12518  5458 51 04 00      add sp, 4
12519  545B             ;; return; 
12520  545B F9            leave
12521  545C 09            ret
12522  545D 0A 8C 54      jmp _if197_exit
12523  5460             _if197_else:
12524  5460             ;; if (x != 0){ 
12525  5460             _if203_cond:
12526  5460 FA 07 00      lea d, [bp + 7] ; $x
12527  5463 2A            mov b, [d]
12528  5464             ; START RELATIONAL
12529  5464 D7            push a
12530  5465 11            mov a, b
12531  5466 26 00 00      mov b, $0
12532  5469 B0            cmp a, b
12533  546A FD 72         sneq ; !=
12534  546C E4            pop a
12535  546D             ; END RELATIONAL
12536  546D C0 00 00      cmp b, 0
12537  5470 C6 82 54      je _if203_else
12538  5473             _if203_true:
12539  5473             ;; c1 = 500; 
12540  5473 FA 09 00      lea d, [bp + 9] ; $c1
12541  5476 DA            push d
12542  5477 26 F4 01      mov b, $1f4
12543  547A E7            pop d
12544  547B FD 43         mov [d], b
12545  547D             ;; return; 
12546  547D F9            leave
12547  547E 09            ret
12548  547F 0A 8C 54      jmp _if203_exit
12549  5482             _if203_else:
12550  5482             ;; c1 = 700; 
12551  5482 FA 09 00      lea d, [bp + 9] ; $c1
12552  5485 DA            push d
12553  5486 26 BC 02      mov b, $2bc
12554  5489 E7            pop d
12555  548A FD 43         mov [d], b
12556  548C             _if203_exit:
12557  548C             _if197_exit:
12558  548C 0A 21 56      jmp _if196_exit
12559  548F             _if196_else:
12560  548F             ;; if (a < 0) { 
12561  548F             _if204_cond:
12562  548F FA 0B 00      lea d, [bp + 11] ; $a
12563  5492 2A            mov b, [d]
12564  5493             ; START RELATIONAL
12565  5493 D7            push a
12566  5494 11            mov a, b
12567  5495 26 00 00      mov b, $0
12568  5498 B0            cmp a, b
12569  5499 FD 73         slt ; < (signed)
12570  549B E4            pop a
12571  549C             ; END RELATIONAL
12572  549C C0 00 00      cmp b, 0
12573  549F C6 AF 54      je _if204_else
12574  54A2             _if204_true:
12575  54A2             ;; c1 = 700; 
12576  54A2 FA 09 00      lea d, [bp + 9] ; $c1
12577  54A5 DA            push d
12578  54A6 26 BC 02      mov b, $2bc
12579  54A9 E7            pop d
12580  54AA FD 43         mov [d], b
12581  54AC 0A 21 56      jmp _if204_exit
12582  54AF             _if204_else:
12583  54AF             ;; if (x > 0) { 
12584  54AF             _if205_cond:
12585  54AF FA 07 00      lea d, [bp + 7] ; $x
12586  54B2 2A            mov b, [d]
12587  54B3             ; START RELATIONAL
12588  54B3 D7            push a
12589  54B4 11            mov a, b
12590  54B5 26 00 00      mov b, $0
12591  54B8 B0            cmp a, b
12592  54B9 FD 7F         sgt ; >
12593  54BB E4            pop a
12594  54BC             ; END RELATIONAL
12595  54BC C0 00 00      cmp b, 0
12596  54BF C6 CF 54      je _if205_else
12597  54C2             _if205_true:
12598  54C2             ;; c1 = 100; 
12599  54C2 FA 09 00      lea d, [bp + 9] ; $c1
12600  54C5 DA            push d
12601  54C6 26 64 00      mov b, $64
12602  54C9 E7            pop d
12603  54CA FD 43         mov [d], b
12604  54CC 0A 21 56      jmp _if205_exit
12605  54CF             _if205_else:
12606  54CF             ;; if (a == 0) { 
12607  54CF             _if206_cond:
12608  54CF FA 0B 00      lea d, [bp + 11] ; $a
12609  54D2 2A            mov b, [d]
12610  54D3             ; START RELATIONAL
12611  54D3 D7            push a
12612  54D4 11            mov a, b
12613  54D5 26 00 00      mov b, $0
12614  54D8 B0            cmp a, b
12615  54D9 FD 71         seq ; ==
12616  54DB E4            pop a
12617  54DC             ; END RELATIONAL
12618  54DC C0 00 00      cmp b, 0
12619  54DF C6 EF 54      je _if206_else
12620  54E2             _if206_true:
12621  54E2             ;; c1 = 500; 
12622  54E2 FA 09 00      lea d, [bp + 9] ; $c1
12623  54E5 DA            push d
12624  54E6 26 F4 01      mov b, $1f4
12625  54E9 E7            pop d
12626  54EA FD 43         mov [d], b
12627  54EC 0A 21 56      jmp _if206_exit
12628  54EF             _if206_else:
12629  54EF             ;; c1 = 100; 
12630  54EF FA 09 00      lea d, [bp + 9] ; $c1
12631  54F2 DA            push d
12632  54F3 26 64 00      mov b, $64
12633  54F6 E7            pop d
12634  54F7 FD 43         mov [d], b
12635  54F9             ;; estimate1: 
12636  54F9             compute_vector_estimate1:
12637  54F9             ;; if (al <= xl) 
12638  54F9             _if207_cond:
12639  54F9 FA F9 FF      lea d, [bp + -7] ; $al
12640  54FC 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
12641  54FF FD 39         mov c, b ; And place it into C
12642  5501 2A            mov b, [d] ; Lower Word in B
12643  5502             ; START RELATIONAL
12644  5502 D7            push a
12645  5503 FD D8         push g
12646  5505 11            mov a, b
out/startrek.asm line 12647: Label not found: (c)
out/startrek.asm line 12647: Unused data in MS byte of argument. (2)
12647  5506 FD 22 00 00   mov g, c
12648  550A FA FD FF      lea d, [bp + -3] ; $xl
12649  550D 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
12650  5510 FD 39         mov c, b ; And place it into C
12651  5512 2A            mov b, [d] ; Lower Word in B
12652  5513 FD 76         sleu
12653  5515 FD F1         pop g
12654  5517 E4            pop a
12655  5518             ; END RELATIONAL
12656  5518 C0 00 00      cmp b, 0
12657  551B C6 68 55      je _if207_else
12658  551E             _if207_true:
12659  551E             ;; printf("%s", print100(c1 + ((al * 100) / xl))); 
12660  551E FA 09 00      lea d, [bp + 9] ; $c1
12661  5521 2A            mov b, [d]
12662  5522             ; START TERMS
12663  5522 D7            push a
12664  5523 11            mov a, b
12665  5524 FA F9 FF      lea d, [bp + -7] ; $al
12666  5527 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
12667  552A FD 39         mov c, b ; And place it into C
12668  552C 2A            mov b, [d] ; Lower Word in B
12669  552D             ; START FACTORS
12670  552D D7            push a
12671  552E 11            mov a, b
12672  552F 26 64 00      mov b, $64
12673  5532 AC            mul a, b ; *
12674  5533 11            mov a, b
12675  5534 27            mov b, a
12676  5535 E4            pop a
12677  5536             ; END FACTORS
12678  5536             ; START FACTORS
12679  5536 D7            push a
12680  5537 11            mov a, b
12681  5538 FA FD FF      lea d, [bp + -3] ; $xl
12682  553B 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
12683  553E FD 39         mov c, b ; And place it into C
12684  5540 2A            mov b, [d] ; Lower Word in B
12685  5541 AE            div a, b
12686  5542 27            mov b, a
12687  5543 E4            pop a
12688  5544             ; END FACTORS
12689  5544 54            add a, b
12690  5545 D7            push a
12691  5546 FD 12         mov a, g
12692  5548 28            mov b, c
12693  5549 5C            adc a, b
12694  554A 39            mov c, a
12695  554B E5            pop b
12696  554C E4            pop a
12697  554D             ; END TERMS
12698  554D FD AB         swp b
12699  554F D8            push b
12700  5550 07 1B 21      call print100
12701  5553 51 02 00      add sp, 2
12702  5556 FD AB         swp b
12703  5558 D8            push b
12704  5559 26 CD 73      mov b, __s148 ; "%s"
12705  555C FD AB         swp b
12706  555E D8            push b
12707  555F 07 D1 05      call printf
12708  5562 51 04 00      add sp, 4
12709  5565 0A CE 55      jmp _if207_exit
12710  5568             _if207_else:
12711  5568             ;; printf("%s", print100(c1 + ((((al * 2) - xl) * 100) / al))); 
12712  5568 FA 09 00      lea d, [bp + 9] ; $c1
12713  556B 2A            mov b, [d]
12714  556C             ; START TERMS
12715  556C D7            push a
12716  556D 11            mov a, b
12717  556E FA F9 FF      lea d, [bp + -7] ; $al
12718  5571 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
12719  5574 FD 39         mov c, b ; And place it into C
12720  5576 2A            mov b, [d] ; Lower Word in B
12721  5577             ; START FACTORS
12722  5577 D7            push a
12723  5578 11            mov a, b
12724  5579 26 02 00      mov b, $2
12725  557C AC            mul a, b ; *
12726  557D 11            mov a, b
12727  557E 27            mov b, a
12728  557F E4            pop a
12729  5580             ; END FACTORS
12730  5580             ; START TERMS
12731  5580 D7            push a
12732  5581 FD D8         push g
12733  5583 11            mov a, b
out/startrek.asm line 12734: Label not found: (c)
out/startrek.asm line 12734: Unused data in MS byte of argument. (2)
12734  5584 FD 22 00 00   mov g, c
12735  5588 FA FD FF      lea d, [bp + -3] ; $xl
12736  558B 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
12737  558E FD 39         mov c, b ; And place it into C
12738  5590 2A            mov b, [d] ; Lower Word in B
12739  5591 60            sub a, b
12740  5592 27            mov b, a
12741  5593 FD F1         pop g
12742  5595 E4            pop a
12743  5596             ; END TERMS
12744  5596             ; START FACTORS
12745  5596 D7            push a
12746  5597 11            mov a, b
12747  5598 26 64 00      mov b, $64
12748  559B AC            mul a, b ; *
12749  559C 11            mov a, b
12750  559D 27            mov b, a
12751  559E E4            pop a
12752  559F             ; END FACTORS
12753  559F             ; START FACTORS
12754  559F D7            push a
12755  55A0 11            mov a, b
12756  55A1 FA F9 FF      lea d, [bp + -7] ; $al
12757  55A4 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
12758  55A7 FD 39         mov c, b ; And place it into C
12759  55A9 2A            mov b, [d] ; Lower Word in B
12760  55AA AE            div a, b
12761  55AB 27            mov b, a
12762  55AC E4            pop a
12763  55AD             ; END FACTORS
12764  55AD 54            add a, b
12765  55AE D7            push a
12766  55AF FD 12         mov a, g
12767  55B1 28            mov b, c
12768  55B2 5C            adc a, b
12769  55B3 39            mov c, a
12770  55B4 E5            pop b
12771  55B5 E4            pop a
12772  55B6             ; END TERMS
12773  55B6 FD AB         swp b
12774  55B8 D8            push b
12775  55B9 07 1B 21      call print100
12776  55BC 51 02 00      add sp, 2
12777  55BF FD AB         swp b
12778  55C1 D8            push b
12779  55C2 26 CD 73      mov b, __s148 ; "%s"
12780  55C5 FD AB         swp b
12781  55C7 D8            push b
12782  55C8 07 D1 05      call printf
12783  55CB 51 04 00      add sp, 4
12784  55CE             _if207_exit:
12785  55CE             ;; printf(dist_1, print100((xl > al) ? xl : al)); 
12786  55CE             _ternary211_cond:
12787  55CE FA FD FF      lea d, [bp + -3] ; $xl
12788  55D1 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
12789  55D4 FD 39         mov c, b ; And place it into C
12790  55D6 2A            mov b, [d] ; Lower Word in B
12791  55D7             ; START RELATIONAL
12792  55D7 D7            push a
12793  55D8 FD D8         push g
12794  55DA 11            mov a, b
out/startrek.asm line 12795: Label not found: (c)
out/startrek.asm line 12795: Unused data in MS byte of argument. (2)
12795  55DB FD 22 00 00   mov g, c
12796  55DF FA F9 FF      lea d, [bp + -7] ; $al
12797  55E2 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
12798  55E5 FD 39         mov c, b ; And place it into C
12799  55E7 2A            mov b, [d] ; Lower Word in B
12800  55E8 FD 81         sgu
12801  55EA FD F1         pop g
12802  55EC E4            pop a
12803  55ED             ; END RELATIONAL
12804  55ED C0 00 00      cmp b, 0
12805  55F0 C6 FF 55      je _ternary211_false
12806  55F3             _ternary211_true:
12807  55F3 FA FD FF      lea d, [bp + -3] ; $xl
12808  55F6 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
12809  55F9 FD 39         mov c, b ; And place it into C
12810  55FB 2A            mov b, [d] ; Lower Word in B
12811  55FC 0A 08 56      jmp _ternary211_exit
12812  55FF             _ternary211_false:
12813  55FF FA F9 FF      lea d, [bp + -7] ; $al
12814  5602 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
12815  5605 FD 39         mov c, b ; And place it into C
12816  5607 2A            mov b, [d] ; Lower Word in B
12817  5608             _ternary211_exit:
12818  5608 FD AB         swp b
12819  560A D8            push b
12820  560B 07 1B 21      call print100
12821  560E 51 02 00      add sp, 2
12822  5611 FD AB         swp b
12823  5613 D8            push b
12824  5614 3B D7 64      mov d, _dist_1 ; $dist_1
12825  5617 2A            mov b, [d]
12826  5618 FD AB         swp b
12827  561A D8            push b
12828  561B 07 D1 05      call printf
12829  561E 51 04 00      add sp, 4
12830  5621             _if206_exit:
12831  5621             _if205_exit:
12832  5621             _if204_exit:
12833  5621             _if196_exit:
12834  5621 F9            leave
12835  5622 09            ret
12836  5623             
12837  5623             ship_destroyed:
12838  5623 F8 00 00      enter 0 ; (push bp; mov bp, sp)
12839  5626             ;; puts("The Enterprise has been destroyed. The Federation will be conquered.\n"); 
12840  5626 26 D0 73      mov b, __s149 ; "The Enterprise has been destroyed. The Federation will be conquered.\n"
12841  5629 FD AB         swp b
12842  562B D8            push b
12843  562C 07 37 13      call puts
12844  562F 51 02 00      add sp, 2
12845  5632             ;; end_of_time(); 
12846  5632 07 37 56      call end_of_time
12847  5635 F9            leave
12848  5636 09            ret
12849  5637             
12850  5637             end_of_time:
12851  5637 F8 00 00      enter 0 ; (push bp; mov bp, sp)
12852  563A             ;; printf("It is stardate %d.\n\n",  FROM_FIXED(stardate)); 
12853  563A 3B 09 63      mov d, _stardate ; $stardate
12854  563D 2A            mov b, [d]
12855  563E FD AB         swp b
12856  5640 D8            push b
12857  5641 07 F1 1C      call FROM_FIXED
12858  5644 51 02 00      add sp, 2
12859  5647 FD AB         swp b
12860  5649 D8            push b
12861  564A 26 16 74      mov b, __s150 ; "It is stardate %d.\n\n"
12862  564D FD AB         swp b
12863  564F D8            push b
12864  5650 07 D1 05      call printf
12865  5653 51 04 00      add sp, 4
12866  5656             ;; resign_commision(); 
12867  5656 07 5B 56      call resign_commision
12868  5659 F9            leave
12869  565A 09            ret
12870  565B             
12871  565B             resign_commision:
12872  565B F8 00 00      enter 0 ; (push bp; mov bp, sp)
12873  565E             ;; printf("There were %d Klingon Battlecruisers left at the end of your mission.\n\n", klingons_left); 
12874  565E 3B E3 62      mov d, _klingons_left ; $klingons_left
12875  5661 32            mov bl, [d]
12876  5662 A7 00         mov bh, 0
12877  5664 DD            push bl
12878  5665 26 2B 74      mov b, __s151 ; "There were %d Klingon Battlecruisers left at the end of your mission.\n\n"
12879  5668 FD AB         swp b
12880  566A D8            push b
12881  566B 07 D1 05      call printf
12882  566E 51 03 00      add sp, 3
12883  5671             ;; end_of_game(); 
12884  5671 07 FD 56      call end_of_game
12885  5674 F9            leave
12886  5675 09            ret
12887  5676             
12888  5676             won_game:
12889  5676 F8 00 00      enter 0 ; (push bp; mov bp, sp)
12890  5679             ;; puts("Congratulations, Captain!  The last Klingon Battle Cruiser\n menacing the Federation has been destoyed.\n"); 
12891  5679 26 73 74      mov b, __s152 ; "Congratulations, Captain!  The last Klingon Battle Cruiser\n menacing the Federation has been destoyed.\n"
12892  567C FD AB         swp b
12893  567E D8            push b
12894  567F 07 37 13      call puts
12895  5682 51 02 00      add sp, 2
12896  5685             ;; if (FROM_FIXED(stardate) - time_start > 0) 
12897  5685             _if212_cond:
12898  5685 3B 09 63      mov d, _stardate ; $stardate
12899  5688 2A            mov b, [d]
12900  5689 FD AB         swp b
12901  568B D8            push b
12902  568C 07 F1 1C      call FROM_FIXED
12903  568F 51 02 00      add sp, 2
12904  5692             ; START TERMS
12905  5692 D7            push a
12906  5693 11            mov a, b
12907  5694 3B ED 62      mov d, _time_start ; $time_start
12908  5697 2A            mov b, [d]
12909  5698 60            sub a, b
12910  5699 27            mov b, a
12911  569A E4            pop a
12912  569B             ; END TERMS
12913  569B             ; START RELATIONAL
12914  569B D7            push a
12915  569C 11            mov a, b
12916  569D 26 00 00      mov b, $0
12917  56A0 B0            cmp a, b
12918  56A1 FD 81         sgu ; > (unsigned)
12919  56A3 E4            pop a
12920  56A4             ; END RELATIONAL
12921  56A4 C0 00 00      cmp b, 0
12922  56A7 C6 F8 56      je _if212_exit
12923  56AA             _if212_true:
12924  56AA             ;; printf("Your efficiency rating is %s\n", 
12925  56AA 3B E2 62      mov d, _total_klingons ; $total_klingons
12926  56AD 32            mov bl, [d]
12927  56AE A7 00         mov bh, 0
12928  56B0 FD AB         swp b
12929  56B2 D8            push b
12930  56B3 07 02 1D      call TO_FIXED00
12931  56B6 51 02 00      add sp, 2
12932  56B9             ; START FACTORS
12933  56B9 D7            push a
12934  56BA 11            mov a, b
12935  56BB 3B 09 63      mov d, _stardate ; $stardate
12936  56BE 2A            mov b, [d]
12937  56BF FD AB         swp b
12938  56C1 D8            push b
12939  56C2 07 F1 1C      call FROM_FIXED
12940  56C5 51 02 00      add sp, 2
12941  56C8             ; START TERMS
12942  56C8 D7            push a
12943  56C9 11            mov a, b
12944  56CA 3B ED 62      mov d, _time_start ; $time_start
12945  56CD 2A            mov b, [d]
12946  56CE 60            sub a, b
12947  56CF 27            mov b, a
12948  56D0 E4            pop a
12949  56D1             ; END TERMS
12950  56D1 AE            div a, b
12951  56D2 27            mov b, a
12952  56D3 E4            pop a
12953  56D4             ; END FACTORS
12954  56D4 FD AB         swp b
12955  56D6 D8            push b
12956  56D7 07 E0 60      call square00
12957  56DA 51 02 00      add sp, 2
12958  56DD FD AB         swp b
12959  56DF D8            push b
12960  56E0 07 1B 21      call print100
12961  56E3 51 02 00      add sp, 2
12962  56E6 FD AB         swp b
12963  56E8 D8            push b
12964  56E9 26 DB 74      mov b, __s153 ; "Your efficiency rating is %s\n"
12965  56EC FD AB         swp b
12966  56EE D8            push b
12967  56EF 07 D1 05      call printf
12968  56F2 51 04 00      add sp, 4
12969  56F5 0A F8 56      jmp _if212_exit
12970  56F8             _if212_exit:
12971  56F8             ;; end_of_game(); 
12972  56F8 07 FD 56      call end_of_game
12973  56FB F9            leave
12974  56FC 09            ret
12975  56FD             
12976  56FD             end_of_game:
12977  56FD F8 00 00      enter 0 ; (push bp; mov bp, sp)
12978  5700             ; $x 
12979  5700 52 04 00      sub sp, 4
12980  5703             ;; if (starbases_left > 0) { 
12981  5703             _if213_cond:
12982  5703 3B 0E 62      mov d, _starbases_left ; $starbases_left
12983  5706 32            mov bl, [d]
12984  5707 A7 00         mov bh, 0
12985  5709             ; START RELATIONAL
12986  5709 D7            push a
12987  570A 11            mov a, b
12988  570B 26 00 00      mov b, $0
12989  570E B0            cmp a, b
12990  570F FD 7F         sgt ; >
12991  5711 E4            pop a
12992  5712             ; END RELATIONAL
12993  5712 C0 00 00      cmp b, 0
12994  5715 C6 86 57      je _if213_exit
12995  5718             _if213_true:
12996  5718             ;; puts("The Federation is in need of a new starship commander"); 
12997  5718 26 F9 74      mov b, __s154 ; "The Federation is in need of a new starship commander"
12998  571B FD AB         swp b
12999  571D D8            push b
13000  571E 07 37 13      call puts
13001  5721 51 02 00      add sp, 2
13002  5724             ;; puts(" for a similar mission.\n"); 
13003  5724 26 2F 75      mov b, __s155 ; " for a similar mission.\n"
13004  5727 FD AB         swp b
13005  5729 D8            push b
13006  572A 07 37 13      call puts
13007  572D 51 02 00      add sp, 2
13008  5730             ;; puts("If there is a volunteer, let him step forward and"); 
13009  5730 26 48 75      mov b, __s156 ; "If there is a volunteer, let him step forward and"
13010  5733 FD AB         swp b
13011  5735 D8            push b
13012  5736 07 37 13      call puts
13013  5739 51 02 00      add sp, 2
13014  573C             ;; puts(" enter 'aye': "); 
13015  573C 26 7A 75      mov b, __s157 ; " enter 'aye': "
13016  573F FD AB         swp b
13017  5741 D8            push b
13018  5742 07 37 13      call puts
13019  5745 51 02 00      add sp, 2
13020  5748             ;; input(x,4); 
13021  5748 26 04 00      mov b, $4
13022  574B DD            push bl
13023  574C FA FD FF      lea d, [bp + -3] ; $x
13024  574F 2D            mov b, d
13025  5750 FD AB         swp b
13026  5752 D8            push b
13027  5753 07 85 1D      call input
13028  5756 51 03 00      add sp, 3
13029  5759             ;; if (!strncmp(x, "aye", 3)) 
13030  5759             _if214_cond:
13031  5759 26 03 00      mov b, $3
13032  575C FD AB         swp b
13033  575E D8            push b
13034  575F 26 89 75      mov b, __s158 ; "aye"
13035  5762 FD AB         swp b
13036  5764 D8            push b
13037  5765 FA FD FF      lea d, [bp + -3] ; $x
13038  5768 2D            mov b, d
13039  5769 FD AB         swp b
13040  576B D8            push b
13041  576C 07 D0 04      call strncmp
13042  576F 51 06 00      add sp, 6
13043  5772 C0 00 00      cmp b, 0
13044  5775 FD 71         seq ; !
13045  5777 C0 00 00      cmp b, 0
13046  577A C6 83 57      je _if214_exit
13047  577D             _if214_true:
13048  577D             ;; new_game(); 
13049  577D 07 3B 22      call new_game
13050  5780 0A 83 57      jmp _if214_exit
13051  5783             _if214_exit:
13052  5783 0A 86 57      jmp _if213_exit
13053  5786             _if213_exit:
13054  5786             ;; exit(); 
13055  5786 07 34 17      call exit
13056  5789 F9            leave
13057  578A 09            ret
13058  578B             
13059  578B             klingons_move:
13060  578B F8 00 00      enter 0 ; (push bp; mov bp, sp)
13061  578E             ; $i 
13062  578E             ; $k 
13063  578E 52 04 00      sub sp, 4
13064  5791             ;; k = &kdata; 
13065  5791 FA FD FF      lea d, [bp + -3] ; $k
13066  5794 DA            push d
13067  5795 3B D5 62      mov d, _kdata_data ; $kdata
13068  5798 2D            mov b, d
13069  5799 E7            pop d
13070  579A FD 43         mov [d], b
13071  579C             ;; for (i = 0; i <= 2; i++) { 
13072  579C             _for215_init:
13073  579C FA FF FF      lea d, [bp + -1] ; $i
13074  579F DA            push d
13075  57A0 26 00 00      mov b, $0
13076  57A3 E7            pop d
13077  57A4 FD 43         mov [d], b
13078  57A6             _for215_cond:
13079  57A6 FA FF FF      lea d, [bp + -1] ; $i
13080  57A9 2A            mov b, [d]
13081  57AA             ; START RELATIONAL
13082  57AA D7            push a
13083  57AB 11            mov a, b
13084  57AC 26 02 00      mov b, $2
13085  57AF B0            cmp a, b
13086  57B0 FD 73         slt ; <= (signed)
13087  57B2 E4            pop a
13088  57B3             ; END RELATIONAL
13089  57B3 C0 00 00      cmp b, 0
13090  57B6 C6 24 58      je _for215_exit
13091  57B9             _for215_block:
13092  57B9             ;; if (k->energy > 0) { 
13093  57B9             _if216_cond:
13094  57B9 FA FD FF      lea d, [bp + -3] ; $k
13095  57BC FD 2A         mov d, [d]
13096  57BE 58 02 00      add d, 2
13097  57C1 2A            mov b, [d]
13098  57C2             ; START RELATIONAL
13099  57C2 D7            push a
13100  57C3 11            mov a, b
13101  57C4 26 00 00      mov b, $0
13102  57C7 B0            cmp a, b
13103  57C8 FD 7F         sgt ; >
13104  57CA E4            pop a
13105  57CB             ; END RELATIONAL
13106  57CB C0 00 00      cmp b, 0
13107  57CE C6 07 58      je _if216_exit
13108  57D1             _if216_true:
13109  57D1             ;; wipe_klingon(k); 
13110  57D1 FA FD FF      lea d, [bp + -3] ; $k
13111  57D4 2A            mov b, [d]
13112  57D5 FD AB         swp b
13113  57D7 D8            push b
13114  57D8 07 58 3C      call wipe_klingon
13115  57DB 51 02 00      add sp, 2
13116  57DE             ;; find_set_empty_place( 	3        , k->y, k->x); 
13117  57DE FA FD FF      lea d, [bp + -3] ; $k
13118  57E1 FD 2A         mov d, [d]
13119  57E3 58 01 00      add d, 1
13120  57E6 32            mov bl, [d]
13121  57E7 A7 00         mov bh, 0
13122  57E9 FD AB         swp b
13123  57EB D8            push b
13124  57EC FA FD FF      lea d, [bp + -3] ; $k
13125  57EF FD 2A         mov d, [d]
13126  57F1 58 00 00      add d, 0
13127  57F4 32            mov bl, [d]
13128  57F5 A7 00         mov bh, 0
13129  57F7 FD AB         swp b
13130  57F9 D8            push b
13131  57FA 26 03 00      mov b, $3
13132  57FD DD            push bl
13133  57FE 07 CE 5D      call find_set_empty_place
13134  5801 51 05 00      add sp, 5
13135  5804 0A 07 58      jmp _if216_exit
13136  5807             _if216_exit:
13137  5807             ;; k++; 
13138  5807 FA FD FF      lea d, [bp + -3] ; $k
13139  580A 2A            mov b, [d]
13140  580B D8            push b
13141  580C FD 77         inc b
13142  580E FA FD FF      lea d, [bp + -3] ; $k
13143  5811 FD 43         mov [d], b
13144  5813 E5            pop b
13145  5814             _for215_update:
13146  5814 FA FF FF      lea d, [bp + -1] ; $i
13147  5817 2A            mov b, [d]
13148  5818 D8            push b
13149  5819 FD 77         inc b
13150  581B FA FF FF      lea d, [bp + -1] ; $i
13151  581E FD 43         mov [d], b
13152  5820 E5            pop b
13153  5821 0A A6 57      jmp _for215_cond
13154  5824             _for215_exit:
13155  5824             ;; klingons_shoot(); 
13156  5824 07 29 58      call klingons_shoot
13157  5827 F9            leave
13158  5828 09            ret
13159  5829             
13160  5829             klingons_shoot:
13161  5829 F8 00 00      enter 0 ; (push bp; mov bp, sp)
13162  582C             ; $r 
13163  582C             ; $h 
13164  582C             ; $i 
13165  582C             ; $k 
13166  582C             ; $ratio 
13167  582C 52 0C 00      sub sp, 12
13168  582F             ;; k = &kdata; 
13169  582F FA F9 FF      lea d, [bp + -7] ; $k
13170  5832 DA            push d
13171  5833 3B D5 62      mov d, _kdata_data ; $kdata
13172  5836 2D            mov b, d
13173  5837 E7            pop d
13174  5838 FD 43         mov [d], b
13175  583A             ;; if (klingons <= 0) 
13176  583A             _if217_cond:
13177  583A 3B E1 62      mov d, _klingons ; $klingons
13178  583D 32            mov bl, [d]
13179  583E A7 00         mov bh, 0
13180  5840             ; START RELATIONAL
13181  5840 D7            push a
13182  5841 11            mov a, b
13183  5842 26 00 00      mov b, $0
13184  5845 B0            cmp a, b
13185  5846 FD 75         slu ; <= (unsigned)
13186  5848 E4            pop a
13187  5849             ; END RELATIONAL
13188  5849 C0 00 00      cmp b, 0
13189  584C C6 54 58      je _if217_exit
13190  584F             _if217_true:
13191  584F             ;; return; 
13192  584F F9            leave
13193  5850 09            ret
13194  5851 0A 54 58      jmp _if217_exit
13195  5854             _if217_exit:
13196  5854             ;; if (docked) { 
13197  5854             _if218_cond:
13198  5854 3B 2E 62      mov d, _docked ; $docked
13199  5857 32            mov bl, [d]
13200  5858 A7 00         mov bh, 0
13201  585A C0 00 00      cmp b, 0
13202  585D C6 71 58      je _if218_exit
13203  5860             _if218_true:
13204  5860             ;; puts("Starbase shields protect the Enterprise\n"); 
13205  5860 26 8D 75      mov b, __s159 ; "Starbase shields protect the Enterprise\n"
13206  5863 FD AB         swp b
13207  5865 D8            push b
13208  5866 07 37 13      call puts
13209  5869 51 02 00      add sp, 2
13210  586C             ;; return; 
13211  586C F9            leave
13212  586D 09            ret
13213  586E 0A 71 58      jmp _if218_exit
13214  5871             _if218_exit:
13215  5871             ;; for (i = 0; i <= 2; i++) { 
13216  5871             _for219_init:
13217  5871 FA FB FF      lea d, [bp + -5] ; $i
13218  5874 DA            push d
13219  5875 26 00 00      mov b, $0
13220  5878 E7            pop d
13221  5879 FD 3E         mov [d], bl
13222  587B             _for219_cond:
13223  587B FA FB FF      lea d, [bp + -5] ; $i
13224  587E 32            mov bl, [d]
13225  587F A7 00         mov bh, 0
13226  5881             ; START RELATIONAL
13227  5881 D7            push a
13228  5882 11            mov a, b
13229  5883 26 02 00      mov b, $2
13230  5886 B0            cmp a, b
13231  5887 FD 75         slu ; <= (unsigned)
13232  5889 E4            pop a
13233  588A             ; END RELATIONAL
13234  588A C0 00 00      cmp b, 0
13235  588D C6 10 5B      je _for219_exit
13236  5890             _for219_block:
13237  5890             ;; if (k->energy > 0) { 
13238  5890             _if220_cond:
13239  5890 FA F9 FF      lea d, [bp + -7] ; $k
13240  5893 FD 2A         mov d, [d]
13241  5895 58 02 00      add d, 2
13242  5898 2A            mov b, [d]
13243  5899             ; START RELATIONAL
13244  5899 D7            push a
13245  589A 11            mov a, b
13246  589B 26 00 00      mov b, $0
13247  589E B0            cmp a, b
13248  589F FD 7F         sgt ; >
13249  58A1 E4            pop a
13250  58A2             ; END RELATIONAL
13251  58A2 C0 00 00      cmp b, 0
13252  58A5 C6 F1 5A      je _if220_exit
13253  58A8             _if220_true:
13254  58A8             ;; h = k->energy * (200UL + get_rand(100)); 
13255  58A8 FA FC FF      lea d, [bp + -4] ; $h
13256  58AB DA            push d
13257  58AC FA F9 FF      lea d, [bp + -7] ; $k
13258  58AF FD 2A         mov d, [d]
13259  58B1 58 02 00      add d, 2
13260  58B4 2A            mov b, [d]
13261  58B5             ; START FACTORS
13262  58B5 D7            push a
13263  58B6 11            mov a, b
13264  58B7 26 C8 00      mov b, 200
13265  58BA 38 00 00      mov c, 0
13266  58BD             ; START TERMS
13267  58BD D7            push a
13268  58BE FD D8         push g
13269  58C0 11            mov a, b
out/startrek.asm line 13270: Label not found: (c)
out/startrek.asm line 13270: Unused data in MS byte of argument. (2)
13270  58C1 FD 22 00 00   mov g, c
13271  58C5 26 64 00      mov b, $64
13272  58C8 FD AB         swp b
13273  58CA D8            push b
13274  58CB 07 25 1D      call get_rand
13275  58CE 51 02 00      add sp, 2
13276  58D1 54            add a, b
13277  58D2 D7            push a
13278  58D3 FD 12         mov a, g
13279  58D5 28            mov b, c
13280  58D6 5C            adc a, b
13281  58D7 39            mov c, a
13282  58D8 E5            pop b
13283  58D9 FD F1         pop g
13284  58DB E4            pop a
13285  58DC             ; END TERMS
13286  58DC AC            mul a, b ; *
13287  58DD 11            mov a, b
13288  58DE 27            mov b, a
13289  58DF E4            pop a
13290  58E0             ; END FACTORS
13291  58E0 E7            pop d
13292  58E1 FD 43         mov [d], b
13293  58E3 28            mov b, c
13294  58E4 FD 44 02 00   mov [d + 2], b
13295  58E8             ;; h =h* 100;	/* Ready for division in fixed */ 
13296  58E8 FA FC FF      lea d, [bp + -4] ; $h
13297  58EB DA            push d
13298  58EC FA FC FF      lea d, [bp + -4] ; $h
13299  58EF 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
13300  58F2 FD 39         mov c, b ; And place it into C
13301  58F4 2A            mov b, [d] ; Lower Word in B
13302  58F5             ; START FACTORS
13303  58F5 D7            push a
13304  58F6 11            mov a, b
13305  58F7 26 64 00      mov b, $64
13306  58FA AC            mul a, b ; *
13307  58FB 11            mov a, b
13308  58FC 27            mov b, a
13309  58FD E4            pop a
13310  58FE             ; END FACTORS
13311  58FE E7            pop d
13312  58FF FD 43         mov [d], b
13313  5901 28            mov b, c
13314  5902 FD 44 02 00   mov [d + 2], b
13315  5906             ;; h =h/ distance_to(k); 
13316  5906 FA FC FF      lea d, [bp + -4] ; $h
13317  5909 DA            push d
13318  590A FA FC FF      lea d, [bp + -4] ; $h
13319  590D 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
13320  5910 FD 39         mov c, b ; And place it into C
13321  5912 2A            mov b, [d] ; Lower Word in B
13322  5913             ; START FACTORS
13323  5913 D7            push a
13324  5914 11            mov a, b
13325  5915 FA F9 FF      lea d, [bp + -7] ; $k
13326  5918 2A            mov b, [d]
13327  5919 FD AB         swp b
13328  591B D8            push b
13329  591C 07 58 61      call distance_to
13330  591F 51 02 00      add sp, 2
13331  5922 AE            div a, b
13332  5923 27            mov b, a
13333  5924 E4            pop a
13334  5925             ; END FACTORS
13335  5925 E7            pop d
13336  5926 FD 43         mov [d], b
13337  5928 28            mov b, c
13338  5929 FD 44 02 00   mov [d + 2], b
13339  592D             ;; shield = shield - FROM_FIXED00(h); 
13340  592D 3B EA 62      mov d, _shield ; $shield
13341  5930 DA            push d
13342  5931 3B EA 62      mov d, _shield ; $shield
13343  5934 2A            mov b, [d]
13344  5935             ; START TERMS
13345  5935 D7            push a
13346  5936 11            mov a, b
13347  5937 FA FC FF      lea d, [bp + -4] ; $h
13348  593A 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
13349  593D FD 39         mov c, b ; And place it into C
13350  593F 2A            mov b, [d] ; Lower Word in B
13351  5940 FD AB         swp b
13352  5942 D8            push b
13353  5943 07 14 1D      call FROM_FIXED00
13354  5946 51 02 00      add sp, 2
13355  5949 60            sub a, b
13356  594A 27            mov b, a
13357  594B E4            pop a
13358  594C             ; END TERMS
13359  594C E7            pop d
13360  594D FD 43         mov [d], b
13361  594F             ;; k->energy = (k->energy * 100) / (300 + get_rand(100)); 
13362  594F FA F9 FF      lea d, [bp + -7] ; $k
13363  5952 FD 2A         mov d, [d]
13364  5954 58 02 00      add d, 2
13365  5957 DA            push d
13366  5958 FA F9 FF      lea d, [bp + -7] ; $k
13367  595B FD 2A         mov d, [d]
13368  595D 58 02 00      add d, 2
13369  5960 2A            mov b, [d]
13370  5961             ; START FACTORS
13371  5961 D7            push a
13372  5962 11            mov a, b
13373  5963 26 64 00      mov b, $64
13374  5966 AC            mul a, b ; *
13375  5967 11            mov a, b
13376  5968 27            mov b, a
13377  5969 E4            pop a
13378  596A             ; END FACTORS
13379  596A             ; START FACTORS
13380  596A D7            push a
13381  596B 11            mov a, b
13382  596C 26 2C 01      mov b, $12c
13383  596F             ; START TERMS
13384  596F D7            push a
13385  5970 11            mov a, b
13386  5971 26 64 00      mov b, $64
13387  5974 FD AB         swp b
13388  5976 D8            push b
13389  5977 07 25 1D      call get_rand
13390  597A 51 02 00      add sp, 2
13391  597D 56            add b, a
13392  597E E4            pop a
13393  597F             ; END TERMS
13394  597F AE            div a, b
13395  5980 27            mov b, a
13396  5981 E4            pop a
13397  5982             ; END FACTORS
13398  5982 E7            pop d
13399  5983 FD 43         mov [d], b
13400  5985             ;; printf("%d unit hit on Enterprise from sector %d, %d\n", (unsigned)FROM_FIXED00(h), k->y, k->x); 
13401  5985 FA F9 FF      lea d, [bp + -7] ; $k
13402  5988 FD 2A         mov d, [d]
13403  598A 58 01 00      add d, 1
13404  598D 32            mov bl, [d]
13405  598E A7 00         mov bh, 0
13406  5990 DD            push bl
13407  5991 FA F9 FF      lea d, [bp + -7] ; $k
13408  5994 FD 2A         mov d, [d]
13409  5996 58 00 00      add d, 0
13410  5999 32            mov bl, [d]
13411  599A A7 00         mov bh, 0
13412  599C DD            push bl
13413  599D FA FC FF      lea d, [bp + -4] ; $h
13414  59A0 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
13415  59A3 FD 39         mov c, b ; And place it into C
13416  59A5 2A            mov b, [d] ; Lower Word in B
13417  59A6 A7 00         mov bh, 0
13418  59A8 38 00 00      mov c, 0
13419  59AB DD            push bl
13420  59AC 26 B6 75      mov b, __s160 ; "%d unit hit on Enterprise from sector %d, %d\n"
13421  59AF FD AB         swp b
13422  59B1 D8            push b
13423  59B2 07 D1 05      call printf
13424  59B5 51 05 00      add sp, 5
13425  59B8             ;; if (shield <= 0) { 
13426  59B8             _if221_cond:
13427  59B8 3B EA 62      mov d, _shield ; $shield
13428  59BB 2A            mov b, [d]
13429  59BC             ; START RELATIONAL
13430  59BC D7            push a
13431  59BD 11            mov a, b
13432  59BE 26 00 00      mov b, $0
13433  59C1 B0            cmp a, b
13434  59C2 FD 73         slt ; <= (signed)
13435  59C4 E4            pop a
13436  59C5             ; END RELATIONAL
13437  59C5 C0 00 00      cmp b, 0
13438  59C8 C6 DB 59      je _if221_exit
13439  59CB             _if221_true:
13440  59CB             ;; putchar('\n'); 
13441  59CB 26 0A 00      mov b, $a
13442  59CE DD            push bl
13443  59CF 07 01 13      call putchar
13444  59D2 51 01 00      add sp, 1
13445  59D5             ;; ship_destroyed(); 
13446  59D5 07 23 56      call ship_destroyed
13447  59D8 0A DB 59      jmp _if221_exit
13448  59DB             _if221_exit:
13449  59DB             ;; printf("    <Shields down to %d units>\n\n", shield); 
13450  59DB 3B EA 62      mov d, _shield ; $shield
13451  59DE 2A            mov b, [d]
13452  59DF FD AB         swp b
13453  59E1 D8            push b
13454  59E2 26 E4 75      mov b, __s161 ; "    <Shields down to %d units>\n\n"
13455  59E5 FD AB         swp b
13456  59E7 D8            push b
13457  59E8 07 D1 05      call printf
13458  59EB 51 04 00      add sp, 4
13459  59EE             ;; if (h >= 20) { 
13460  59EE             _if222_cond:
13461  59EE FA FC FF      lea d, [bp + -4] ; $h
13462  59F1 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
13463  59F4 FD 39         mov c, b ; And place it into C
13464  59F6 2A            mov b, [d] ; Lower Word in B
13465  59F7             ; START RELATIONAL
13466  59F7 D7            push a
13467  59F8 FD D8         push g
13468  59FA 11            mov a, b
out/startrek.asm line 13469: Label not found: (c)
out/startrek.asm line 13469: Unused data in MS byte of argument. (2)
13469  59FB FD 22 00 00   mov g, c
13470  59FF 26 14 00      mov b, $14
13471  5A02 38 00 00      mov c, 0
13472  5A05 FD 82         sgeu
13473  5A07 FD F1         pop g
13474  5A09 E4            pop a
13475  5A0A             ; END RELATIONAL
13476  5A0A C0 00 00      cmp b, 0
13477  5A0D C6 EE 5A      je _if222_exit
13478  5A10             _if222_true:
13479  5A10             ;; ratio = ((int)h)/shield; 
13480  5A10 FA F5 FF      lea d, [bp + -11] ; $ratio
13481  5A13 DA            push d
13482  5A14 FA FC FF      lea d, [bp + -4] ; $h
13483  5A17 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
13484  5A1A FD 39         mov c, b ; And place it into C
13485  5A1C 2A            mov b, [d] ; Lower Word in B
13486  5A1D             ; START FACTORS
13487  5A1D D7            push a
13488  5A1E 11            mov a, b
13489  5A1F 3B EA 62      mov d, _shield ; $shield
13490  5A22 2A            mov b, [d]
13491  5A23 AE            div a, b
13492  5A24 27            mov b, a
13493  5A25 E4            pop a
13494  5A26             ; END FACTORS
13495  5A26 E7            pop d
13496  5A27 FD 43         mov [d], b
13497  5A29 28            mov b, c
13498  5A2A FD 44 02 00   mov [d + 2], b
13499  5A2E             ;; if (get_rand(10) <= 6 && ratio > 2) { 
13500  5A2E             _if223_cond:
13501  5A2E 26 0A 00      mov b, $a
13502  5A31 FD AB         swp b
13503  5A33 D8            push b
13504  5A34 07 25 1D      call get_rand
13505  5A37 51 02 00      add sp, 2
13506  5A3A             ; START RELATIONAL
13507  5A3A D7            push a
13508  5A3B 11            mov a, b
13509  5A3C 26 06 00      mov b, $6
13510  5A3F B0            cmp a, b
13511  5A40 FD 73         slt ; <= (signed)
13512  5A42 E4            pop a
13513  5A43             ; END RELATIONAL
13514  5A43 D7            push a
13515  5A44 11            mov a, b
13516  5A45 FA F5 FF      lea d, [bp + -11] ; $ratio
13517  5A48 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
13518  5A4B FD 39         mov c, b ; And place it into C
13519  5A4D 2A            mov b, [d] ; Lower Word in B
13520  5A4E             ; START RELATIONAL
13521  5A4E D7            push a
13522  5A4F FD D8         push g
13523  5A51 11            mov a, b
out/startrek.asm line 13524: Label not found: (c)
out/startrek.asm line 13524: Unused data in MS byte of argument. (2)
13524  5A52 FD 22 00 00   mov g, c
13525  5A56 26 02 00      mov b, $2
13526  5A59 38 00 00      mov c, 0
13527  5A5C FD 81         sgu
13528  5A5E FD F1         pop g
13529  5A60 E4            pop a
13530  5A61             ; END RELATIONAL
13531  5A61 FD 22 00 00   mov g, 0
13532  5A65 FD B1 00 00   sand32 ga, cb
13532  5A69 00 00 
13533  5A6B E4            pop a
13534  5A6C C0 00 00      cmp b, 0
13535  5A6F C6 EB 5A      je _if223_exit
13536  5A72             _if223_true:
13537  5A72             ;; r = rand8(); 
13538  5A72 FA 00 00      lea d, [bp + 0] ; $r
13539  5A75 DA            push d
13540  5A76 07 74 1D      call rand8
13541  5A79 E7            pop d
13542  5A7A FD 3E         mov [d], bl
13543  5A7C             ;; damage[r] =damage[r] - ratio + get_rand(50); 
13544  5A7C 3B F1 62      mov d, _damage_data ; $damage
13545  5A7F D7            push a
13546  5A80 DA            push d
13547  5A81 FA 00 00      lea d, [bp + 0] ; $r
13548  5A84 32            mov bl, [d]
13549  5A85 A7 00         mov bh, 0
13550  5A87 E7            pop d
13551  5A88 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
13552  5A8C E4            pop a
13553  5A8D DA            push d
13554  5A8E 3B F1 62      mov d, _damage_data ; $damage
13555  5A91 D7            push a
13556  5A92 DA            push d
13557  5A93 FA 00 00      lea d, [bp + 0] ; $r
13558  5A96 32            mov bl, [d]
13559  5A97 A7 00         mov bh, 0
13560  5A99 E7            pop d
13561  5A9A FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
13562  5A9E E4            pop a
13563  5A9F 2A            mov b, [d]
13564  5AA0             ; START TERMS
13565  5AA0 D7            push a
13566  5AA1 11            mov a, b
13567  5AA2 FA F5 FF      lea d, [bp + -11] ; $ratio
13568  5AA5 2B 02 00      mov b, [d + 2] ; Upper Word of the Long Int
13569  5AA8 FD 39         mov c, b ; And place it into C
13570  5AAA 2A            mov b, [d] ; Lower Word in B
13571  5AAB 60            sub a, b
13572  5AAC 27            mov b, a
13573  5AAD 11            mov a, b
out/startrek.asm line 13574: Label not found: (c)
out/startrek.asm line 13574: Unused data in MS byte of argument. (2)
13574  5AAE FD 22 00 00   mov g, c
13575  5AB2 26 32 00      mov b, $32
13576  5AB5 FD AB         swp b
13577  5AB7 D8            push b
13578  5AB8 07 25 1D      call get_rand
13579  5ABB 51 02 00      add sp, 2
13580  5ABE 54            add a, b
13581  5ABF D7            push a
13582  5AC0 FD 12         mov a, g
13583  5AC2 28            mov b, c
13584  5AC3 5C            adc a, b
13585  5AC4 39            mov c, a
13586  5AC5 E5            pop b
13587  5AC6 E4            pop a
13588  5AC7             ; END TERMS
13589  5AC7 E7            pop d
13590  5AC8 FD 43         mov [d], b
13591  5ACA             ;; printf("Damage Control reports\n'%s' damaged by hit\n\n", get_device_name(r)); 
13592  5ACA FA 00 00      lea d, [bp + 0] ; $r
13593  5ACD 32            mov bl, [d]
13594  5ACE A7 00         mov bh, 0
13595  5AD0 FD AB         swp b
13596  5AD2 D8            push b
13597  5AD3 07 B4 5E      call get_device_name
13598  5AD6 51 02 00      add sp, 2
13599  5AD9 FD AB         swp b
13600  5ADB D8            push b
13601  5ADC 26 05 76      mov b, __s162 ; "Damage Control reports\n'%s' damaged by hit\n\n"
13602  5ADF FD AB         swp b
13603  5AE1 D8            push b
13604  5AE2 07 D1 05      call printf
13605  5AE5 51 04 00      add sp, 4
13606  5AE8 0A EB 5A      jmp _if223_exit
13607  5AEB             _if223_exit:
13608  5AEB 0A EE 5A      jmp _if222_exit
13609  5AEE             _if222_exit:
13610  5AEE 0A F1 5A      jmp _if220_exit
13611  5AF1             _if220_exit:
13612  5AF1             ;; k++; 
13613  5AF1 FA F9 FF      lea d, [bp + -7] ; $k
13614  5AF4 2A            mov b, [d]
13615  5AF5 D8            push b
13616  5AF6 FD 77         inc b
13617  5AF8 FA F9 FF      lea d, [bp + -7] ; $k
13618  5AFB FD 43         mov [d], b
13619  5AFD E5            pop b
13620  5AFE             _for219_update:
13621  5AFE FA FB FF      lea d, [bp + -5] ; $i
13622  5B01 32            mov bl, [d]
13623  5B02 A7 00         mov bh, 0
13624  5B04 D8            push b
13625  5B05 FD 77         inc b
13626  5B07 FA FB FF      lea d, [bp + -5] ; $i
13627  5B0A FD 43         mov [d], b
13628  5B0C E5            pop b
13629  5B0D 0A 7B 58      jmp _for219_cond
13630  5B10             _for219_exit:
13631  5B10 F9            leave
13632  5B11 09            ret
13633  5B12             
13634  5B12             repair_damage:
13635  5B12 F8 00 00      enter 0 ; (push bp; mov bp, sp)
13636  5B15             ; $i 
13637  5B15             ; $d1 
13638  5B15             ; $repair_factor 
13639  5B15             ; $r 
13640  5B15 52 07 00      sub sp, 7
13641  5B18             ;; repair_factor = warp; 
13642  5B18 FA FB FF      lea d, [bp + -5] ; $repair_factor
13643  5B1B DA            push d
13644  5B1C FA 05 00      lea d, [bp + 5] ; $warp
13645  5B1F 2A            mov b, [d]
13646  5B20 E7            pop d
13647  5B21 FD 43         mov [d], b
13648  5B23             ;; if (warp >= 100) 
13649  5B23             _if224_cond:
13650  5B23 FA 05 00      lea d, [bp + 5] ; $warp
13651  5B26 2A            mov b, [d]
13652  5B27             ; START RELATIONAL
13653  5B27 D7            push a
13654  5B28 11            mov a, b
13655  5B29 26 64 00      mov b, $64
13656  5B2C B0            cmp a, b
13657  5B2D FD 82         sgeu ; >= (unsigned)
13658  5B2F E4            pop a
13659  5B30             ; END RELATIONAL
13660  5B30 C0 00 00      cmp b, 0
13661  5B33 C6 4C 5B      je _if224_exit
13662  5B36             _if224_true:
13663  5B36             ;; repair_factor = TO_FIXED00(1); 
13664  5B36 FA FB FF      lea d, [bp + -5] ; $repair_factor
13665  5B39 DA            push d
13666  5B3A 26 01 00      mov b, $1
13667  5B3D FD AB         swp b
13668  5B3F D8            push b
13669  5B40 07 02 1D      call TO_FIXED00
13670  5B43 51 02 00      add sp, 2
13671  5B46 E7            pop d
13672  5B47 FD 43         mov [d], b
13673  5B49 0A 4C 5B      jmp _if224_exit
13674  5B4C             _if224_exit:
13675  5B4C             ;; for (i = 1; i <= 8; i++) { 
13676  5B4C             _for225_init:
13677  5B4C FA FF FF      lea d, [bp + -1] ; $i
13678  5B4F DA            push d
13679  5B50 26 01 00      mov b, $1
13680  5B53 E7            pop d
13681  5B54 FD 43         mov [d], b
13682  5B56             _for225_cond:
13683  5B56 FA FF FF      lea d, [bp + -1] ; $i
13684  5B59 2A            mov b, [d]
13685  5B5A             ; START RELATIONAL
13686  5B5A D7            push a
13687  5B5B 11            mov a, b
13688  5B5C 26 08 00      mov b, $8
13689  5B5F B0            cmp a, b
13690  5B60 FD 73         slt ; <= (signed)
13691  5B62 E4            pop a
13692  5B63             ; END RELATIONAL
13693  5B63 C0 00 00      cmp b, 0
13694  5B66 C6 B5 5C      je _for225_exit
13695  5B69             _for225_block:
13696  5B69             ;; if (damage[i] < 0) { 
13697  5B69             _if226_cond:
13698  5B69 3B F1 62      mov d, _damage_data ; $damage
13699  5B6C D7            push a
13700  5B6D DA            push d
13701  5B6E FA FF FF      lea d, [bp + -1] ; $i
13702  5B71 2A            mov b, [d]
13703  5B72 E7            pop d
13704  5B73 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
13705  5B77 E4            pop a
13706  5B78 2A            mov b, [d]
13707  5B79             ; START RELATIONAL
13708  5B79 D7            push a
13709  5B7A 11            mov a, b
13710  5B7B 26 00 00      mov b, $0
13711  5B7E B0            cmp a, b
13712  5B7F FD 73         slt ; < (signed)
13713  5B81 E4            pop a
13714  5B82             ; END RELATIONAL
13715  5B82 C0 00 00      cmp b, 0
13716  5B85 C6 A5 5C      je _if226_exit
13717  5B88             _if226_true:
13718  5B88             ;; damage[i] = damage[i] + repair_factor; 
13719  5B88 3B F1 62      mov d, _damage_data ; $damage
13720  5B8B D7            push a
13721  5B8C DA            push d
13722  5B8D FA FF FF      lea d, [bp + -1] ; $i
13723  5B90 2A            mov b, [d]
13724  5B91 E7            pop d
13725  5B92 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
13726  5B96 E4            pop a
13727  5B97 DA            push d
13728  5B98 3B F1 62      mov d, _damage_data ; $damage
13729  5B9B D7            push a
13730  5B9C DA            push d
13731  5B9D FA FF FF      lea d, [bp + -1] ; $i
13732  5BA0 2A            mov b, [d]
13733  5BA1 E7            pop d
13734  5BA2 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
13735  5BA6 E4            pop a
13736  5BA7 2A            mov b, [d]
13737  5BA8             ; START TERMS
13738  5BA8 D7            push a
13739  5BA9 11            mov a, b
13740  5BAA FA FB FF      lea d, [bp + -5] ; $repair_factor
13741  5BAD 2A            mov b, [d]
13742  5BAE 56            add b, a
13743  5BAF E4            pop a
13744  5BB0             ; END TERMS
13745  5BB0 E7            pop d
13746  5BB1 FD 43         mov [d], b
13747  5BB3             ;; if (damage[i] > -10 && damage[i] < 0)	/* -0.1 */ 
13748  5BB3             _if227_cond:
13749  5BB3 3B F1 62      mov d, _damage_data ; $damage
13750  5BB6 D7            push a
13751  5BB7 DA            push d
13752  5BB8 FA FF FF      lea d, [bp + -1] ; $i
13753  5BBB 2A            mov b, [d]
13754  5BBC E7            pop d
13755  5BBD FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
13756  5BC1 E4            pop a
13757  5BC2 2A            mov b, [d]
13758  5BC3             ; START RELATIONAL
13759  5BC3 D7            push a
13760  5BC4 11            mov a, b
13761  5BC5 26 F6 FF      mov b, 65526
13762  5BC8 38 FF FF      mov c, 65535
13763  5BCB FD 22 00 00   mov g, 0
13764  5BCF FD 7F         sgt
13765  5BD1 E4            pop a
13766  5BD2             ; END RELATIONAL
13767  5BD2 D7            push a
13768  5BD3 FD D8         push g
13769  5BD5 11            mov a, b
out/startrek.asm line 13770: Label not found: (c)
out/startrek.asm line 13770: Unused data in MS byte of argument. (2)
13770  5BD6 FD 22 00 00   mov g, c
13771  5BDA 3B F1 62      mov d, _damage_data ; $damage
13772  5BDD D7            push a
13773  5BDE DA            push d
13774  5BDF FA FF FF      lea d, [bp + -1] ; $i
13775  5BE2 2A            mov b, [d]
13776  5BE3 E7            pop d
13777  5BE4 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
13778  5BE8 E4            pop a
13779  5BE9 2A            mov b, [d]
13780  5BEA             ; START RELATIONAL
13781  5BEA D7            push a
13782  5BEB 11            mov a, b
13783  5BEC 26 00 00      mov b, $0
13784  5BEF B0            cmp a, b
13785  5BF0 FD 73         slt ; < (signed)
13786  5BF2 E4            pop a
13787  5BF3             ; END RELATIONAL
13788  5BF3 38 00 00      mov c, 0
13789  5BF6 FD B1 00 00   sand32 ga, cb
13789  5BFA 00 00 
13790  5BFC FD F1         pop g
13791  5BFE E4            pop a
13792  5BFF C0 00 00      cmp b, 0
13793  5C02 C6 21 5C      je _if227_else
13794  5C05             _if227_true:
13795  5C05             ;; damage[i] = -10; 
13796  5C05 3B F1 62      mov d, _damage_data ; $damage
13797  5C08 D7            push a
13798  5C09 DA            push d
13799  5C0A FA FF FF      lea d, [bp + -1] ; $i
13800  5C0D 2A            mov b, [d]
13801  5C0E E7            pop d
13802  5C0F FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
13803  5C13 E4            pop a
13804  5C14 DA            push d
13805  5C15 26 F6 FF      mov b, 65526
13806  5C18 38 FF FF      mov c, 65535
13807  5C1B E7            pop d
13808  5C1C FD 43         mov [d], b
13809  5C1E 0A A2 5C      jmp _if227_exit
13810  5C21             _if227_else:
13811  5C21             ;; if (damage[i] >= 0) { 
13812  5C21             _if228_cond:
13813  5C21 3B F1 62      mov d, _damage_data ; $damage
13814  5C24 D7            push a
13815  5C25 DA            push d
13816  5C26 FA FF FF      lea d, [bp + -1] ; $i
13817  5C29 2A            mov b, [d]
13818  5C2A E7            pop d
13819  5C2B FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
13820  5C2F E4            pop a
13821  5C30 2A            mov b, [d]
13822  5C31             ; START RELATIONAL
13823  5C31 D7            push a
13824  5C32 11            mov a, b
13825  5C33 26 00 00      mov b, $0
13826  5C36 B0            cmp a, b
13827  5C37 FD 80         sge ; >=
13828  5C39 E4            pop a
13829  5C3A             ; END RELATIONAL
13830  5C3A C0 00 00      cmp b, 0
13831  5C3D C6 A2 5C      je _if228_exit
13832  5C40             _if228_true:
13833  5C40             ;; if (d1 != 1) { 
13834  5C40             _if229_cond:
13835  5C40 FA FD FF      lea d, [bp + -3] ; $d1
13836  5C43 2A            mov b, [d]
13837  5C44             ; START RELATIONAL
13838  5C44 D7            push a
13839  5C45 11            mov a, b
13840  5C46 26 01 00      mov b, $1
13841  5C49 B0            cmp a, b
13842  5C4A FD 72         sneq ; !=
13843  5C4C E4            pop a
13844  5C4D             ; END RELATIONAL
13845  5C4D C0 00 00      cmp b, 0
13846  5C50 C6 6D 5C      je _if229_exit
13847  5C53             _if229_true:
13848  5C53             ;; d1 = 1; 
13849  5C53 FA FD FF      lea d, [bp + -3] ; $d1
13850  5C56 DA            push d
13851  5C57 26 01 00      mov b, $1
13852  5C5A E7            pop d
13853  5C5B FD 43         mov [d], b
13854  5C5D             ;; puts(dcr_1); 
13855  5C5D 3B 00 64      mov d, _dcr_1 ; $dcr_1
13856  5C60 2A            mov b, [d]
13857  5C61 FD AB         swp b
13858  5C63 D8            push b
13859  5C64 07 37 13      call puts
13860  5C67 51 02 00      add sp, 2
13861  5C6A 0A 6D 5C      jmp _if229_exit
13862  5C6D             _if229_exit:
13863  5C6D             ;; printf("    %s repair completed\n\n", 
13864  5C6D FA FF FF      lea d, [bp + -1] ; $i
13865  5C70 2A            mov b, [d]
13866  5C71 FD AB         swp b
13867  5C73 D8            push b
13868  5C74 07 B4 5E      call get_device_name
13869  5C77 51 02 00      add sp, 2
13870  5C7A FD AB         swp b
13871  5C7C D8            push b
13872  5C7D 26 32 76      mov b, __s163 ; "    %s repair completed\n\n"
13873  5C80 FD AB         swp b
13874  5C82 D8            push b
13875  5C83 07 D1 05      call printf
13876  5C86 51 04 00      add sp, 4
13877  5C89             ;; damage[i] = 0; 
13878  5C89 3B F1 62      mov d, _damage_data ; $damage
13879  5C8C D7            push a
13880  5C8D DA            push d
13881  5C8E FA FF FF      lea d, [bp + -1] ; $i
13882  5C91 2A            mov b, [d]
13883  5C92 E7            pop d
13884  5C93 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
13885  5C97 E4            pop a
13886  5C98 DA            push d
13887  5C99 26 00 00      mov b, $0
13888  5C9C E7            pop d
13889  5C9D FD 43         mov [d], b
13890  5C9F 0A A2 5C      jmp _if228_exit
13891  5CA2             _if228_exit:
13892  5CA2             _if227_exit:
13893  5CA2 0A A5 5C      jmp _if226_exit
13894  5CA5             _if226_exit:
13895  5CA5             _for225_update:
13896  5CA5 FA FF FF      lea d, [bp + -1] ; $i
13897  5CA8 2A            mov b, [d]
13898  5CA9 D8            push b
13899  5CAA FD 77         inc b
13900  5CAC FA FF FF      lea d, [bp + -1] ; $i
13901  5CAF FD 43         mov [d], b
13902  5CB1 E5            pop b
13903  5CB2 0A 56 5B      jmp _for225_cond
13904  5CB5             _for225_exit:
13905  5CB5             ;; if (get_rand(10) <= 2) { 
13906  5CB5             _if230_cond:
13907  5CB5 26 0A 00      mov b, $a
13908  5CB8 FD AB         swp b
13909  5CBA D8            push b
13910  5CBB 07 25 1D      call get_rand
13911  5CBE 51 02 00      add sp, 2
13912  5CC1             ; START RELATIONAL
13913  5CC1 D7            push a
13914  5CC2 11            mov a, b
13915  5CC3 26 02 00      mov b, $2
13916  5CC6 B0            cmp a, b
13917  5CC7 FD 73         slt ; <= (signed)
13918  5CC9 E4            pop a
13919  5CCA             ; END RELATIONAL
13920  5CCA C0 00 00      cmp b, 0
13921  5CCD C6 CC 5D      je _if230_exit
13922  5CD0             _if230_true:
13923  5CD0             ;; r = rand8(); 
13924  5CD0 FA FA FF      lea d, [bp + -6] ; $r
13925  5CD3 DA            push d
13926  5CD4 07 74 1D      call rand8
13927  5CD7 E7            pop d
13928  5CD8 FD 3E         mov [d], bl
13929  5CDA             ;; if (get_rand(10) < 6) { 
13930  5CDA             _if231_cond:
13931  5CDA 26 0A 00      mov b, $a
13932  5CDD FD AB         swp b
13933  5CDF D8            push b
13934  5CE0 07 25 1D      call get_rand
13935  5CE3 51 02 00      add sp, 2
13936  5CE6             ; START RELATIONAL
13937  5CE6 D7            push a
13938  5CE7 11            mov a, b
13939  5CE8 26 06 00      mov b, $6
13940  5CEB B0            cmp a, b
13941  5CEC FD 73         slt ; < (signed)
13942  5CEE E4            pop a
13943  5CEF             ; END RELATIONAL
13944  5CEF C0 00 00      cmp b, 0
13945  5CF2 C6 62 5D      je _if231_else
13946  5CF5             _if231_true:
13947  5CF5             ;; damage[r] =damage[r]- (get_rand(500) + 100); 
13948  5CF5 3B F1 62      mov d, _damage_data ; $damage
13949  5CF8 D7            push a
13950  5CF9 DA            push d
13951  5CFA FA FA FF      lea d, [bp + -6] ; $r
13952  5CFD 32            mov bl, [d]
13953  5CFE A7 00         mov bh, 0
13954  5D00 E7            pop d
13955  5D01 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
13956  5D05 E4            pop a
13957  5D06 DA            push d
13958  5D07 3B F1 62      mov d, _damage_data ; $damage
13959  5D0A D7            push a
13960  5D0B DA            push d
13961  5D0C FA FA FF      lea d, [bp + -6] ; $r
13962  5D0F 32            mov bl, [d]
13963  5D10 A7 00         mov bh, 0
13964  5D12 E7            pop d
13965  5D13 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
13966  5D17 E4            pop a
13967  5D18 2A            mov b, [d]
13968  5D19             ; START TERMS
13969  5D19 D7            push a
13970  5D1A 11            mov a, b
13971  5D1B 26 F4 01      mov b, $1f4
13972  5D1E FD AB         swp b
13973  5D20 D8            push b
13974  5D21 07 25 1D      call get_rand
13975  5D24 51 02 00      add sp, 2
13976  5D27             ; START TERMS
13977  5D27 D7            push a
13978  5D28 11            mov a, b
13979  5D29 26 64 00      mov b, $64
13980  5D2C 56            add b, a
13981  5D2D E4            pop a
13982  5D2E             ; END TERMS
13983  5D2E 60            sub a, b
13984  5D2F 27            mov b, a
13985  5D30 E4            pop a
13986  5D31             ; END TERMS
13987  5D31 E7            pop d
13988  5D32 FD 43         mov [d], b
13989  5D34             ;; puts(dcr_1); 
13990  5D34 3B 00 64      mov d, _dcr_1 ; $dcr_1
13991  5D37 2A            mov b, [d]
13992  5D38 FD AB         swp b
13993  5D3A D8            push b
13994  5D3B 07 37 13      call puts
13995  5D3E 51 02 00      add sp, 2
13996  5D41             ;; printf("    %s damaged\n\n", get_device_name(r)); 
13997  5D41 FA FA FF      lea d, [bp + -6] ; $r
13998  5D44 32            mov bl, [d]
13999  5D45 A7 00         mov bh, 0
14000  5D47 FD AB         swp b
14001  5D49 D8            push b
14002  5D4A 07 B4 5E      call get_device_name
14003  5D4D 51 02 00      add sp, 2
14004  5D50 FD AB         swp b
14005  5D52 D8            push b
14006  5D53 26 4C 76      mov b, __s164 ; "    %s damaged\n\n"
14007  5D56 FD AB         swp b
14008  5D58 D8            push b
14009  5D59 07 D1 05      call printf
14010  5D5C 51 04 00      add sp, 4
14011  5D5F 0A C9 5D      jmp _if231_exit
14012  5D62             _if231_else:
14013  5D62             ;; damage[r] = damage[r] + get_rand(300) + 100; 
14014  5D62 3B F1 62      mov d, _damage_data ; $damage
14015  5D65 D7            push a
14016  5D66 DA            push d
14017  5D67 FA FA FF      lea d, [bp + -6] ; $r
14018  5D6A 32            mov bl, [d]
14019  5D6B A7 00         mov bh, 0
14020  5D6D E7            pop d
14021  5D6E FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
14022  5D72 E4            pop a
14023  5D73 DA            push d
14024  5D74 3B F1 62      mov d, _damage_data ; $damage
14025  5D77 D7            push a
14026  5D78 DA            push d
14027  5D79 FA FA FF      lea d, [bp + -6] ; $r
14028  5D7C 32            mov bl, [d]
14029  5D7D A7 00         mov bh, 0
14030  5D7F E7            pop d
14031  5D80 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
14032  5D84 E4            pop a
14033  5D85 2A            mov b, [d]
14034  5D86             ; START TERMS
14035  5D86 D7            push a
14036  5D87 11            mov a, b
14037  5D88 26 2C 01      mov b, $12c
14038  5D8B FD AB         swp b
14039  5D8D D8            push b
14040  5D8E 07 25 1D      call get_rand
14041  5D91 51 02 00      add sp, 2
14042  5D94 56            add b, a
14043  5D95 11            mov a, b
14044  5D96 26 64 00      mov b, $64
14045  5D99 56            add b, a
14046  5D9A E4            pop a
14047  5D9B             ; END TERMS
14048  5D9B E7            pop d
14049  5D9C FD 43         mov [d], b
14050  5D9E             ;; puts(dcr_1); 
14051  5D9E 3B 00 64      mov d, _dcr_1 ; $dcr_1
14052  5DA1 2A            mov b, [d]
14053  5DA2 FD AB         swp b
14054  5DA4 D8            push b
14055  5DA5 07 37 13      call puts
14056  5DA8 51 02 00      add sp, 2
14057  5DAB             ;; printf("    %s state of repair improved\n\n", 
14058  5DAB FA FA FF      lea d, [bp + -6] ; $r
14059  5DAE 32            mov bl, [d]
14060  5DAF A7 00         mov bh, 0
14061  5DB1 FD AB         swp b
14062  5DB3 D8            push b
14063  5DB4 07 B4 5E      call get_device_name
14064  5DB7 51 02 00      add sp, 2
14065  5DBA FD AB         swp b
14066  5DBC D8            push b
14067  5DBD 26 5D 76      mov b, __s165 ; "    %s state of repair improved\n\n"
14068  5DC0 FD AB         swp b
14069  5DC2 D8            push b
14070  5DC3 07 D1 05      call printf
14071  5DC6 51 04 00      add sp, 4
14072  5DC9             _if231_exit:
14073  5DC9 0A CC 5D      jmp _if230_exit
14074  5DCC             _if230_exit:
14075  5DCC F9            leave
14076  5DCD 09            ret
14077  5DCE             
14078  5DCE             find_set_empty_place:
14079  5DCE F8 00 00      enter 0 ; (push bp; mov bp, sp)
14080  5DD1             ; $r1 
14081  5DD1             ; $r2 
14082  5DD1 52 02 00      sub sp, 2
14083  5DD4             ;; do { 
14084  5DD4             _do232_block:
14085  5DD4             ;; r1 = rand8(); 
14086  5DD4 FA 00 00      lea d, [bp + 0] ; $r1
14087  5DD7 DA            push d
14088  5DD8 07 74 1D      call rand8
14089  5DDB E7            pop d
14090  5DDC FD 3E         mov [d], bl
14091  5DDE             ;; r2 = rand8(); 
14092  5DDE FA FF FF      lea d, [bp + -1] ; $r2
14093  5DE1 DA            push d
14094  5DE2 07 74 1D      call rand8
14095  5DE5 E7            pop d
14096  5DE6 FD 3E         mov [d], bl
14097  5DE8             ;; } while (quad[r1+-1][r2+-1] !=  		0       ); 
14098  5DE8             _do232_cond:
14099  5DE8 3B 0B 63      mov d, _quad_data ; $quad
14100  5DEB D7            push a
14101  5DEC DA            push d
14102  5DED FA 00 00      lea d, [bp + 0] ; $r1
14103  5DF0 32            mov bl, [d]
14104  5DF1 A7 00         mov bh, 0
14105  5DF3             ; START TERMS
14106  5DF3 D7            push a
14107  5DF4 11            mov a, b
14108  5DF5 26 FF FF      mov b, 65535
14109  5DF8 38 FF FF      mov c, 65535
14110  5DFB 54            add a, b
14111  5DFC D7            push a
14112  5DFD FD 12         mov a, g
14113  5DFF 28            mov b, c
14114  5E00 5C            adc a, b
14115  5E01 39            mov c, a
14116  5E02 E5            pop b
14117  5E03 E4            pop a
14118  5E04             ; END TERMS
14119  5E04 E7            pop d
14120  5E05 FD 13 08 00   mma 8 ; mov a, 8; mul a, b; add d, b
14121  5E09 DA            push d
14122  5E0A FA FF FF      lea d, [bp + -1] ; $r2
14123  5E0D 32            mov bl, [d]
14124  5E0E A7 00         mov bh, 0
14125  5E10             ; START TERMS
14126  5E10 D7            push a
14127  5E11 11            mov a, b
14128  5E12 26 FF FF      mov b, 65535
14129  5E15 38 FF FF      mov c, 65535
14130  5E18 54            add a, b
14131  5E19 D7            push a
14132  5E1A FD 12         mov a, g
14133  5E1C 28            mov b, c
14134  5E1D 5C            adc a, b
14135  5E1E 39            mov c, a
14136  5E1F E5            pop b
14137  5E20 E4            pop a
14138  5E21             ; END TERMS
14139  5E21 E7            pop d
14140  5E22 5A            add d, b
14141  5E23 E4            pop a
14142  5E24 32            mov bl, [d]
14143  5E25 A7 00         mov bh, 0
14144  5E27             ; START RELATIONAL
14145  5E27 D7            push a
14146  5E28 11            mov a, b
14147  5E29 26 00 00      mov b, $0
14148  5E2C B0            cmp a, b
14149  5E2D FD 72         sneq ; !=
14150  5E2F E4            pop a
14151  5E30             ; END RELATIONAL
14152  5E30 C0 01 00      cmp b, 1
14153  5E33 C6 D4 5D      je _do232_block
14154  5E36             _do232_exit:
14155  5E36             ;; quad[r1+-1][r2+-1] = t; 
14156  5E36 3B 0B 63      mov d, _quad_data ; $quad
14157  5E39 D7            push a
14158  5E3A DA            push d
14159  5E3B FA 00 00      lea d, [bp + 0] ; $r1
14160  5E3E 32            mov bl, [d]
14161  5E3F A7 00         mov bh, 0
14162  5E41             ; START TERMS
14163  5E41 D7            push a
14164  5E42 11            mov a, b
14165  5E43 26 FF FF      mov b, 65535
14166  5E46 38 FF FF      mov c, 65535
14167  5E49 54            add a, b
14168  5E4A D7            push a
14169  5E4B FD 12         mov a, g
14170  5E4D 28            mov b, c
14171  5E4E 5C            adc a, b
14172  5E4F 39            mov c, a
14173  5E50 E5            pop b
14174  5E51 E4            pop a
14175  5E52             ; END TERMS
14176  5E52 E7            pop d
14177  5E53 FD 13 08 00   mma 8 ; mov a, 8; mul a, b; add d, b
14178  5E57 DA            push d
14179  5E58 FA FF FF      lea d, [bp + -1] ; $r2
14180  5E5B 32            mov bl, [d]
14181  5E5C A7 00         mov bh, 0
14182  5E5E             ; START TERMS
14183  5E5E D7            push a
14184  5E5F 11            mov a, b
14185  5E60 26 FF FF      mov b, 65535
14186  5E63 38 FF FF      mov c, 65535
14187  5E66 54            add a, b
14188  5E67 D7            push a
14189  5E68 FD 12         mov a, g
14190  5E6A 28            mov b, c
14191  5E6B 5C            adc a, b
14192  5E6C 39            mov c, a
14193  5E6D E5            pop b
14194  5E6E E4            pop a
14195  5E6F             ; END TERMS
14196  5E6F E7            pop d
14197  5E70 5A            add d, b
14198  5E71 E4            pop a
14199  5E72 DA            push d
14200  5E73 FA 05 00      lea d, [bp + 5] ; $t
14201  5E76 32            mov bl, [d]
14202  5E77 A7 00         mov bh, 0
14203  5E79 E7            pop d
14204  5E7A FD 3E         mov [d], bl
14205  5E7C             ;; if (z1) 
14206  5E7C             _if233_cond:
14207  5E7C FA 06 00      lea d, [bp + 6] ; $z1
14208  5E7F 2A            mov b, [d]
14209  5E80 C0 00 00      cmp b, 0
14210  5E83 C6 97 5E      je _if233_exit
14211  5E86             _if233_true:
14212  5E86             ;; *z1 = r1; 
14213  5E86 FA 06 00      lea d, [bp + 6] ; $z1
14214  5E89 2A            mov b, [d]
14215  5E8A D8            push b
14216  5E8B FA 00 00      lea d, [bp + 0] ; $r1
14217  5E8E 32            mov bl, [d]
14218  5E8F A7 00         mov bh, 0
14219  5E91 E7            pop d
14220  5E92 FD 3E         mov [d], bl
14221  5E94 0A 97 5E      jmp _if233_exit
14222  5E97             _if233_exit:
14223  5E97             ;; if (z2) 
14224  5E97             _if234_cond:
14225  5E97 FA 08 00      lea d, [bp + 8] ; $z2
14226  5E9A 2A            mov b, [d]
14227  5E9B C0 00 00      cmp b, 0
14228  5E9E C6 B2 5E      je _if234_exit
14229  5EA1             _if234_true:
14230  5EA1             ;; *z2 = r2; 
14231  5EA1 FA 08 00      lea d, [bp + 8] ; $z2
14232  5EA4 2A            mov b, [d]
14233  5EA5 D8            push b
14234  5EA6 FA FF FF      lea d, [bp + -1] ; $r2
14235  5EA9 32            mov bl, [d]
14236  5EAA A7 00         mov bh, 0
14237  5EAC E7            pop d
14238  5EAD FD 3E         mov [d], bl
14239  5EAF 0A B2 5E      jmp _if234_exit
14240  5EB2             _if234_exit:
14241  5EB2 F9            leave
14242  5EB3 09            ret
14243  5EB4             
14244  5EB4             get_device_name:
14245  5EB4 F8 00 00      enter 0 ; (push bp; mov bp, sp)
14246  5EB7             ;; if (n < 0 || n > 8) 
14247  5EB7             _if235_cond:
14248  5EB7 FA 05 00      lea d, [bp + 5] ; $n
14249  5EBA 2A            mov b, [d]
14250  5EBB             ; START RELATIONAL
14251  5EBB D7            push a
14252  5EBC 11            mov a, b
14253  5EBD 26 00 00      mov b, $0
14254  5EC0 B0            cmp a, b
14255  5EC1 FD 73         slt ; < (signed)
14256  5EC3 E4            pop a
14257  5EC4             ; END RELATIONAL
14258  5EC4 D7            push a
14259  5EC5 11            mov a, b
14260  5EC6 FA 05 00      lea d, [bp + 5] ; $n
14261  5EC9 2A            mov b, [d]
14262  5ECA             ; START RELATIONAL
14263  5ECA D7            push a
14264  5ECB 11            mov a, b
14265  5ECC 26 08 00      mov b, $8
14266  5ECF B0            cmp a, b
14267  5ED0 FD 7F         sgt ; >
14268  5ED2 E4            pop a
14269  5ED3             ; END RELATIONAL
14270  5ED3 FD A8         sor a, b ; ||
14271  5ED5 E4            pop a
14272  5ED6 C0 00 00      cmp b, 0
14273  5ED9 C6 E9 5E      je _if235_exit
14274  5EDC             _if235_true:
14275  5EDC             ;; n = 0; 
14276  5EDC FA 05 00      lea d, [bp + 5] ; $n
14277  5EDF DA            push d
14278  5EE0 26 00 00      mov b, $0
14279  5EE3 E7            pop d
14280  5EE4 FD 43         mov [d], b
14281  5EE6 0A E9 5E      jmp _if235_exit
14282  5EE9             _if235_exit:
14283  5EE9             ;; return device_name[n]; 
14284  5EE9 3B C5 63      mov d, _device_name_data ; $device_name
14285  5EEC D7            push a
14286  5EED DA            push d
14287  5EEE FA 05 00      lea d, [bp + 5] ; $n
14288  5EF1 2A            mov b, [d]
14289  5EF2 E7            pop d
14290  5EF3 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
14291  5EF7 E4            pop a
14292  5EF8 2A            mov b, [d]
14293  5EF9 F9            leave
14294  5EFA 09            ret
14295  5EFB             
14296  5EFB             quadrant_name:
14297  5EFB F8 00 00      enter 0 ; (push bp; mov bp, sp)
14298  5EFE             ;; if (y < 1 || y > 8 || x < 1 || x > 8) 
14299  5EFE             _if236_cond:
14300  5EFE FA 06 00      lea d, [bp + 6] ; $y
14301  5F01 32            mov bl, [d]
14302  5F02 A7 00         mov bh, 0
14303  5F04             ; START RELATIONAL
14304  5F04 D7            push a
14305  5F05 11            mov a, b
14306  5F06 26 01 00      mov b, $1
14307  5F09 B0            cmp a, b
14308  5F0A FD 75         slu ; < (unsigned)
14309  5F0C E4            pop a
14310  5F0D             ; END RELATIONAL
14311  5F0D D7            push a
14312  5F0E 11            mov a, b
14313  5F0F FA 06 00      lea d, [bp + 6] ; $y
14314  5F12 32            mov bl, [d]
14315  5F13 A7 00         mov bh, 0
14316  5F15             ; START RELATIONAL
14317  5F15 D7            push a
14318  5F16 11            mov a, b
14319  5F17 26 08 00      mov b, $8
14320  5F1A B0            cmp a, b
14321  5F1B FD 81         sgu ; > (unsigned)
14322  5F1D E4            pop a
14323  5F1E             ; END RELATIONAL
14324  5F1E FD A8         sor a, b ; ||
14325  5F20 11            mov a, b
14326  5F21 FA 07 00      lea d, [bp + 7] ; $x
14327  5F24 32            mov bl, [d]
14328  5F25 A7 00         mov bh, 0
14329  5F27             ; START RELATIONAL
14330  5F27 D7            push a
14331  5F28 11            mov a, b
14332  5F29 26 01 00      mov b, $1
14333  5F2C B0            cmp a, b
14334  5F2D FD 75         slu ; < (unsigned)
14335  5F2F E4            pop a
14336  5F30             ; END RELATIONAL
14337  5F30 FD A8         sor a, b ; ||
14338  5F32 11            mov a, b
14339  5F33 FA 07 00      lea d, [bp + 7] ; $x
14340  5F36 32            mov bl, [d]
14341  5F37 A7 00         mov bh, 0
14342  5F39             ; START RELATIONAL
14343  5F39 D7            push a
14344  5F3A 11            mov a, b
14345  5F3B 26 08 00      mov b, $8
14346  5F3E B0            cmp a, b
14347  5F3F FD 81         sgu ; > (unsigned)
14348  5F41 E4            pop a
14349  5F42             ; END RELATIONAL
14350  5F42 FD A8         sor a, b ; ||
14351  5F44 E4            pop a
14352  5F45 C0 00 00      cmp b, 0
14353  5F48 C6 61 5F      je _if236_exit
14354  5F4B             _if236_true:
14355  5F4B             ;; strcpy(quadname, "Unknown"); 
14356  5F4B 26 8F 76      mov b, __s170 ; "Unknown"
14357  5F4E FD AB         swp b
14358  5F50 D8            push b
14359  5F51 3B 4B 63      mov d, _quadname_data ; $quadname
14360  5F54 2D            mov b, d
14361  5F55 FD AB         swp b
14362  5F57 D8            push b
14363  5F58 07 14 04      call strcpy
14364  5F5B 51 04 00      add sp, 4
14365  5F5E 0A 61 5F      jmp _if236_exit
14366  5F61             _if236_exit:
14367  5F61             ;; if (x <= 4) 
14368  5F61             _if237_cond:
14369  5F61 FA 07 00      lea d, [bp + 7] ; $x
14370  5F64 32            mov bl, [d]
14371  5F65 A7 00         mov bh, 0
14372  5F67             ; START RELATIONAL
14373  5F67 D7            push a
14374  5F68 11            mov a, b
14375  5F69 26 04 00      mov b, $4
14376  5F6C B0            cmp a, b
14377  5F6D FD 75         slu ; <= (unsigned)
14378  5F6F E4            pop a
14379  5F70             ; END RELATIONAL
14380  5F70 C0 00 00      cmp b, 0
14381  5F73 C6 9B 5F      je _if237_else
14382  5F76             _if237_true:
14383  5F76             ;; strcpy(quadname, quad_name[y]); 
14384  5F76 3B 81 63      mov d, _quad_name_data ; $quad_name
14385  5F79 D7            push a
14386  5F7A DA            push d
14387  5F7B FA 06 00      lea d, [bp + 6] ; $y
14388  5F7E 32            mov bl, [d]
14389  5F7F A7 00         mov bh, 0
14390  5F81 E7            pop d
14391  5F82 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
14392  5F86 E4            pop a
14393  5F87 2A            mov b, [d]
14394  5F88 FD AB         swp b
14395  5F8A D8            push b
14396  5F8B 3B 4B 63      mov d, _quadname_data ; $quadname
14397  5F8E 2D            mov b, d
14398  5F8F FD AB         swp b
14399  5F91 D8            push b
14400  5F92 07 14 04      call strcpy
14401  5F95 51 04 00      add sp, 4
14402  5F98 0A C4 5F      jmp _if237_exit
14403  5F9B             _if237_else:
14404  5F9B             ;; strcpy(quadname, quad_name[y + 8]); 
14405  5F9B 3B 81 63      mov d, _quad_name_data ; $quad_name
14406  5F9E D7            push a
14407  5F9F DA            push d
14408  5FA0 FA 06 00      lea d, [bp + 6] ; $y
14409  5FA3 32            mov bl, [d]
14410  5FA4 A7 00         mov bh, 0
14411  5FA6             ; START TERMS
14412  5FA6 D7            push a
14413  5FA7 11            mov a, b
14414  5FA8 26 08 00      mov b, $8
14415  5FAB 56            add b, a
14416  5FAC E4            pop a
14417  5FAD             ; END TERMS
14418  5FAD E7            pop d
14419  5FAE FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
14420  5FB2 E4            pop a
14421  5FB3 2A            mov b, [d]
14422  5FB4 FD AB         swp b
14423  5FB6 D8            push b
14424  5FB7 3B 4B 63      mov d, _quadname_data ; $quadname
14425  5FBA 2D            mov b, d
14426  5FBB FD AB         swp b
14427  5FBD D8            push b
14428  5FBE 07 14 04      call strcpy
14429  5FC1 51 04 00      add sp, 4
14430  5FC4             _if237_exit:
14431  5FC4             ;; if (small != 1) { 
14432  5FC4             _if238_cond:
14433  5FC4 FA 05 00      lea d, [bp + 5] ; $small
14434  5FC7 32            mov bl, [d]
14435  5FC8 A7 00         mov bh, 0
14436  5FCA             ; START RELATIONAL
14437  5FCA D7            push a
14438  5FCB 11            mov a, b
14439  5FCC 26 01 00      mov b, $1
14440  5FCF B0            cmp a, b
14441  5FD0 FD 72         sneq ; !=
14442  5FD2 E4            pop a
14443  5FD3             ; END RELATIONAL
14444  5FD3 C0 00 00      cmp b, 0
14445  5FD6 C6 2B 60      je _if238_exit
14446  5FD9             _if238_true:
14447  5FD9             ;; if (x > 4) 
14448  5FD9             _if239_cond:
14449  5FD9 FA 07 00      lea d, [bp + 7] ; $x
14450  5FDC 32            mov bl, [d]
14451  5FDD A7 00         mov bh, 0
14452  5FDF             ; START RELATIONAL
14453  5FDF D7            push a
14454  5FE0 11            mov a, b
14455  5FE1 26 04 00      mov b, $4
14456  5FE4 B0            cmp a, b
14457  5FE5 FD 81         sgu ; > (unsigned)
14458  5FE7 E4            pop a
14459  5FE8             ; END RELATIONAL
14460  5FE8 C0 00 00      cmp b, 0
14461  5FEB C6 06 60      je _if239_exit
14462  5FEE             _if239_true:
14463  5FEE             ;; x = x - 4; 
14464  5FEE FA 07 00      lea d, [bp + 7] ; $x
14465  5FF1 DA            push d
14466  5FF2 FA 07 00      lea d, [bp + 7] ; $x
14467  5FF5 32            mov bl, [d]
14468  5FF6 A7 00         mov bh, 0
14469  5FF8             ; START TERMS
14470  5FF8 D7            push a
14471  5FF9 11            mov a, b
14472  5FFA 26 04 00      mov b, $4
14473  5FFD 60            sub a, b
14474  5FFE 27            mov b, a
14475  5FFF E4            pop a
14476  6000             ; END TERMS
14477  6000 E7            pop d
14478  6001 FD 3E         mov [d], bl
14479  6003 0A 06 60      jmp _if239_exit
14480  6006             _if239_exit:
14481  6006             ;; strcat(quadname, sect_name[x]); 
14482  6006 3B F1 64      mov d, st_quadrant_name_sect_name_dt ; static sect_name
14483  6009 D7            push a
14484  600A DA            push d
14485  600B FA 07 00      lea d, [bp + 7] ; $x
14486  600E 32            mov bl, [d]
14487  600F A7 00         mov bh, 0
14488  6011 E7            pop d
14489  6012 FD 13 02 00   mma 2 ; mov a, 2; mul a, b; add d, b
14490  6016 E4            pop a
14491  6017 2A            mov b, [d]
14492  6018 FD AB         swp b
14493  601A D8            push b
14494  601B 3B 4B 63      mov d, _quadname_data ; $quadname
14495  601E 2D            mov b, d
14496  601F FD AB         swp b
14497  6021 D8            push b
14498  6022 07 D5 04      call strcat
14499  6025 51 04 00      add sp, 4
14500  6028 0A 2B 60      jmp _if238_exit
14501  602B             _if238_exit:
14502  602B             ;; return; 
14503  602B F9            leave
14504  602C 09            ret
14505  602D             
14506  602D             isqrt:
14507  602D F8 00 00      enter 0 ; (push bp; mov bp, sp)
14508  6030             ; $b 
14509  6030             ; $q 
14510  6030             ; $r 
14511  6030             ; $t 
14512  6030 52 08 00      sub sp, 8
14513  6033             ;; b = 0x4000; 
14514  6033 FA FF FF      lea d, [bp + -1] ; $b
14515  6036 DA            push d
14516  6037 26 00 40      mov b, $4000
14517  603A E7            pop d
14518  603B FD 43         mov [d], b
14519  603D             ;; q = 0; 
14520  603D FA FD FF      lea d, [bp + -3] ; $q
14521  6040 DA            push d
14522  6041 26 00 00      mov b, $0
14523  6044 E7            pop d
14524  6045 FD 43         mov [d], b
14525  6047             ;; r = i; 
14526  6047 FA FB FF      lea d, [bp + -5] ; $r
14527  604A DA            push d
14528  604B FA 05 00      lea d, [bp + 5] ; $i
14529  604E 2A            mov b, [d]
14530  604F E7            pop d
14531  6050 FD 43         mov [d], b
14532  6052             ;; while (b) { 
14533  6052             _while240_cond:
14534  6052 FA FF FF      lea d, [bp + -1] ; $b
14535  6055 2A            mov b, [d]
14536  6056 C0 00 00      cmp b, 0
14537  6059 C6 DA 60      je _while240_exit
14538  605C             _while240_block:
14539  605C             ;; t = q + b; 
14540  605C FA F9 FF      lea d, [bp + -7] ; $t
14541  605F DA            push d
14542  6060 FA FD FF      lea d, [bp + -3] ; $q
14543  6063 2A            mov b, [d]
14544  6064             ; START TERMS
14545  6064 D7            push a
14546  6065 11            mov a, b
14547  6066 FA FF FF      lea d, [bp + -1] ; $b
14548  6069 2A            mov b, [d]
14549  606A 56            add b, a
14550  606B E4            pop a
14551  606C             ; END TERMS
14552  606C E7            pop d
14553  606D FD 43         mov [d], b
14554  606F             ;; q =q>> 1; 
14555  606F FA FD FF      lea d, [bp + -3] ; $q
14556  6072 DA            push d
14557  6073 FA FD FF      lea d, [bp + -3] ; $q
14558  6076 2A            mov b, [d]
14559  6077             ; START SHIFT
14560  6077 D7            push a
14561  6078 11            mov a, b
14562  6079 26 01 00      mov b, $1
14563  607C FD 39         mov c, b
14564  607E A1            shr a, cl
14565  607F 27            mov b, a
14566  6080 E4            pop a
14567  6081             ; END SHIFT
14568  6081 E7            pop d
14569  6082 FD 43         mov [d], b
14570  6084             ;; if (r >= t) { 
14571  6084             _if241_cond:
14572  6084 FA FB FF      lea d, [bp + -5] ; $r
14573  6087 2A            mov b, [d]
14574  6088             ; START RELATIONAL
14575  6088 D7            push a
14576  6089 11            mov a, b
14577  608A FA F9 FF      lea d, [bp + -7] ; $t
14578  608D 2A            mov b, [d]
14579  608E B0            cmp a, b
14580  608F FD 82         sgeu ; >= (unsigned)
14581  6091 E4            pop a
14582  6092             ; END RELATIONAL
14583  6092 C0 00 00      cmp b, 0
14584  6095 C6 C2 60      je _if241_exit
14585  6098             _if241_true:
14586  6098             ;; r =r- t; 
14587  6098 FA FB FF      lea d, [bp + -5] ; $r
14588  609B DA            push d
14589  609C FA FB FF      lea d, [bp + -5] ; $r
14590  609F 2A            mov b, [d]
14591  60A0             ; START TERMS
14592  60A0 D7            push a
14593  60A1 11            mov a, b
14594  60A2 FA F9 FF      lea d, [bp + -7] ; $t
14595  60A5 2A            mov b, [d]
14596  60A6 60            sub a, b
14597  60A7 27            mov b, a
14598  60A8 E4            pop a
14599  60A9             ; END TERMS
14600  60A9 E7            pop d
14601  60AA FD 43         mov [d], b
14602  60AC             ;; q = q + b; 
14603  60AC FA FD FF      lea d, [bp + -3] ; $q
14604  60AF DA            push d
14605  60B0 FA FD FF      lea d, [bp + -3] ; $q
14606  60B3 2A            mov b, [d]
14607  60B4             ; START TERMS
14608  60B4 D7            push a
14609  60B5 11            mov a, b
14610  60B6 FA FF FF      lea d, [bp + -1] ; $b
14611  60B9 2A            mov b, [d]
14612  60BA 56            add b, a
14613  60BB E4            pop a
14614  60BC             ; END TERMS
14615  60BC E7            pop d
14616  60BD FD 43         mov [d], b
14617  60BF 0A C2 60      jmp _if241_exit
14618  60C2             _if241_exit:
14619  60C2             ;; b =b>> 2; 
14620  60C2 FA FF FF      lea d, [bp + -1] ; $b
14621  60C5 DA            push d
14622  60C6 FA FF FF      lea d, [bp + -1] ; $b
14623  60C9 2A            mov b, [d]
14624  60CA             ; START SHIFT
14625  60CA D7            push a
14626  60CB 11            mov a, b
14627  60CC 26 02 00      mov b, $2
14628  60CF FD 39         mov c, b
14629  60D1 A1            shr a, cl
14630  60D2 27            mov b, a
14631  60D3 E4            pop a
14632  60D4             ; END SHIFT
14633  60D4 E7            pop d
14634  60D5 FD 43         mov [d], b
14635  60D7 0A 52 60      jmp _while240_cond
14636  60DA             _while240_exit:
14637  60DA             ;; return q; 
14638  60DA FA FD FF      lea d, [bp + -3] ; $q
14639  60DD 2A            mov b, [d]
14640  60DE F9            leave
14641  60DF 09            ret
14642  60E0             
14643  60E0             square00:
14644  60E0 F8 00 00      enter 0 ; (push bp; mov bp, sp)
14645  60E3             ;; if (abs(t) > 181) { 
14646  60E3             _if242_cond:
14647  60E3 FA 05 00      lea d, [bp + 5] ; $t
14648  60E6 2A            mov b, [d]
14649  60E7 FD AB         swp b
14650  60E9 D8            push b
14651  60EA 07 83 13      call abs
14652  60ED 51 02 00      add sp, 2
14653  60F0             ; START RELATIONAL
14654  60F0 D7            push a
14655  60F1 11            mov a, b
14656  60F2 26 B5 00      mov b, $b5
14657  60F5 B0            cmp a, b
14658  60F6 FD 7F         sgt ; >
14659  60F8 E4            pop a
14660  60F9             ; END RELATIONAL
14661  60F9 C0 00 00      cmp b, 0
14662  60FC C6 2A 61      je _if242_else
14663  60FF             _if242_true:
14664  60FF             ;; t =t/ 10; 
14665  60FF FA 05 00      lea d, [bp + 5] ; $t
14666  6102 DA            push d
14667  6103 FA 05 00      lea d, [bp + 5] ; $t
14668  6106 2A            mov b, [d]
14669  6107             ; START FACTORS
14670  6107 D7            push a
14671  6108 11            mov a, b
14672  6109 26 0A 00      mov b, $a
14673  610C AE            div a, b
14674  610D 27            mov b, a
14675  610E E4            pop a
14676  610F             ; END FACTORS
14677  610F E7            pop d
14678  6110 FD 43         mov [d], b
14679  6112             ;; t =t* t; 
14680  6112 FA 05 00      lea d, [bp + 5] ; $t
14681  6115 DA            push d
14682  6116 FA 05 00      lea d, [bp + 5] ; $t
14683  6119 2A            mov b, [d]
14684  611A             ; START FACTORS
14685  611A D7            push a
14686  611B 11            mov a, b
14687  611C FA 05 00      lea d, [bp + 5] ; $t
14688  611F 2A            mov b, [d]
14689  6120 AC            mul a, b ; *
14690  6121 11            mov a, b
14691  6122 27            mov b, a
14692  6123 E4            pop a
14693  6124             ; END FACTORS
14694  6124 E7            pop d
14695  6125 FD 43         mov [d], b
14696  6127 0A 52 61      jmp _if242_exit
14697  612A             _if242_else:
14698  612A             ;; t =t* t; 
14699  612A FA 05 00      lea d, [bp + 5] ; $t
14700  612D DA            push d
14701  612E FA 05 00      lea d, [bp + 5] ; $t
14702  6131 2A            mov b, [d]
14703  6132             ; START FACTORS
14704  6132 D7            push a
14705  6133 11            mov a, b
14706  6134 FA 05 00      lea d, [bp + 5] ; $t
14707  6137 2A            mov b, [d]
14708  6138 AC            mul a, b ; *
14709  6139 11            mov a, b
14710  613A 27            mov b, a
14711  613B E4            pop a
14712  613C             ; END FACTORS
14713  613C E7            pop d
14714  613D FD 43         mov [d], b
14715  613F             ;; t =t/ 100; 
14716  613F FA 05 00      lea d, [bp + 5] ; $t
14717  6142 DA            push d
14718  6143 FA 05 00      lea d, [bp + 5] ; $t
14719  6146 2A            mov b, [d]
14720  6147             ; START FACTORS
14721  6147 D7            push a
14722  6148 11            mov a, b
14723  6149 26 64 00      mov b, $64
14724  614C AE            div a, b
14725  614D 27            mov b, a
14726  614E E4            pop a
14727  614F             ; END FACTORS
14728  614F E7            pop d
14729  6150 FD 43         mov [d], b
14730  6152             _if242_exit:
14731  6152             ;; return t; 
14732  6152 FA 05 00      lea d, [bp + 5] ; $t
14733  6155 2A            mov b, [d]
14734  6156 F9            leave
14735  6157 09            ret
14736  6158             
14737  6158             distance_to:
14738  6158 F8 00 00      enter 0 ; (push bp; mov bp, sp)
14739  615B             ; $j 
14740  615B 52 02 00      sub sp, 2
14741  615E             ;; j = square00(TO_FIXED00(k->y) - ship_y); 
14742  615E FA FF FF      lea d, [bp + -1] ; $j
14743  6161 DA            push d
14744  6162 FA 05 00      lea d, [bp + 5] ; $k
14745  6165 FD 2A         mov d, [d]
14746  6167 58 00 00      add d, 0
14747  616A 32            mov bl, [d]
14748  616B A7 00         mov bh, 0
14749  616D FD AB         swp b
14750  616F D8            push b
14751  6170 07 02 1D      call TO_FIXED00
14752  6173 51 02 00      add sp, 2
14753  6176             ; START TERMS
14754  6176 D7            push a
14755  6177 11            mov a, b
14756  6178 3B 05 63      mov d, _ship_y ; $ship_y
14757  617B 2A            mov b, [d]
14758  617C 60            sub a, b
14759  617D 27            mov b, a
14760  617E E4            pop a
14761  617F             ; END TERMS
14762  617F FD AB         swp b
14763  6181 D8            push b
14764  6182 07 E0 60      call square00
14765  6185 51 02 00      add sp, 2
14766  6188 E7            pop d
14767  6189 FD 43         mov [d], b
14768  618B             ;; j = j + square00(TO_FIXED00(k->x) - ship_x); 
14769  618B FA FF FF      lea d, [bp + -1] ; $j
14770  618E DA            push d
14771  618F FA FF FF      lea d, [bp + -1] ; $j
14772  6192 2A            mov b, [d]
14773  6193             ; START TERMS
14774  6193 D7            push a
14775  6194 11            mov a, b
14776  6195 FA 05 00      lea d, [bp + 5] ; $k
14777  6198 FD 2A         mov d, [d]
14778  619A 58 01 00      add d, 1
14779  619D 32            mov bl, [d]
14780  619E A7 00         mov bh, 0
14781  61A0 FD AB         swp b
14782  61A2 D8            push b
14783  61A3 07 02 1D      call TO_FIXED00
14784  61A6 51 02 00      add sp, 2
14785  61A9             ; START TERMS
14786  61A9 D7            push a
14787  61AA 11            mov a, b
14788  61AB 3B 07 63      mov d, _ship_x ; $ship_x
14789  61AE 2A            mov b, [d]
14790  61AF 60            sub a, b
14791  61B0 27            mov b, a
14792  61B1 E4            pop a
14793  61B2             ; END TERMS
14794  61B2 FD AB         swp b
14795  61B4 D8            push b
14796  61B5 07 E0 60      call square00
14797  61B8 51 02 00      add sp, 2
14798  61BB 56            add b, a
14799  61BC E4            pop a
14800  61BD             ; END TERMS
14801  61BD E7            pop d
14802  61BE FD 43         mov [d], b
14803  61C0             ;; j = isqrt(j); 
14804  61C0 FA FF FF      lea d, [bp + -1] ; $j
14805  61C3 DA            push d
14806  61C4 FA FF FF      lea d, [bp + -1] ; $j
14807  61C7 2A            mov b, [d]
14808  61C8 FD AB         swp b
14809  61CA D8            push b
14810  61CB 07 2D 60      call isqrt
14811  61CE 51 02 00      add sp, 2
14812  61D1 E7            pop d
14813  61D2 FD 43         mov [d], b
14814  61D4             ;; j =j* 10; 
14815  61D4 FA FF FF      lea d, [bp + -1] ; $j
14816  61D7 DA            push d
14817  61D8 FA FF FF      lea d, [bp + -1] ; $j
14818  61DB 2A            mov b, [d]
14819  61DC             ; START FACTORS
14820  61DC D7            push a
14821  61DD 11            mov a, b
14822  61DE 26 0A 00      mov b, $a
14823  61E1 AC            mul a, b ; *
14824  61E2 11            mov a, b
14825  61E3 27            mov b, a
14826  61E4 E4            pop a
14827  61E5             ; END FACTORS
14828  61E5 E7            pop d
14829  61E6 FD 43         mov [d], b
14830  61E8             ;; return j; 
14831  61E8 FA FF FF      lea d, [bp + -1] ; $j
14832  61EB 2A            mov b, [d]
14833  61EC F9            leave
14834  61ED 09            ret
14835  61EE             
14836  61EE             cint100:
14837  61EE F8 00 00      enter 0 ; (push bp; mov bp, sp)
14838  61F1             ;; return (d + 50) / 100; 
14839  61F1 FA 05 00      lea d, [bp + 5] ; $d
14840  61F4 2A            mov b, [d]
14841  61F5             ; START TERMS
14842  61F5 D7            push a
14843  61F6 11            mov a, b
14844  61F7 26 32 00      mov b, $32
14845  61FA 56            add b, a
14846  61FB E4            pop a
14847  61FC             ; END TERMS
14848  61FC             ; START FACTORS
14849  61FC D7            push a
14850  61FD 11            mov a, b
14851  61FE 26 64 00      mov b, $64
14852  6201 AE            div a, b
14853  6202 27            mov b, a
14854  6203 E4            pop a
14855  6204             ; END FACTORS
14856  6204 F9            leave
14857  6205 09            ret
14858  6206             
14859  6206             showfile:
14860  6206 F8 00 00      enter 0 ; (push bp; mov bp, sp)
14861  6209 F9            leave
14862  620A 09            ret
14863  620B             ; --- END TEXT BLOCK
14864  620B             
14865  620B             ; --- BEGIN DATA BLOCK
14866  620B 00          _starbases: .fill 1, 0
14867  620C 00          _base_y: .fill 1, 0
14868  620D 00          _base_x: .fill 1, 0
14869  620E 00          _starbases_left: .fill 1, 0
14870  620F             _c_data: 
14871  620F 00          .db 
14872  6210 00 00 00 FF .db $0,$0,$0,$ffff,$ffff,$ffff,$0,$1,$1,$1,$0,$1,$1,$1,$0,$ffff,$ffff,$ffff,$0,$1,$1,
14872  6214 FF FF 00 01 
14872  6218 01 01 00 01 
14872  621C 01 01 00 FF 
14872  6220 FF FF 00 01 
14872  6224 01 
14873  6225 00 00 00 00 .fill 9, 0
14873  6229 00 00 00 00 
14873  622D 00 
14874  622E 00          _docked: .fill 1, 0
14875  622F 00 00       _energy: .fill 2, 0
14876  6231 B8 0B       _energy0: .dw 3000
14877  6233 00 00 00 00 _map_data: .fill 162, 0
14877  6237 00 00 00 00 
14877  623B 00 00 00 00 
14877  623F 00 00 00 00 
14877  6243 00 00 00 00 
14877  6247 00 00 00 00 
14877  624B 00 00 00 00 
14877  624F 00 00 00 00 
14877  6253 00 00 00 00 
14877  6257 00 00 00 00 
14877  625B 00 00 00 00 
14877  625F 00 00 00 00 
14877  6263 00 00 00 00 
14877  6267 00 00 00 00 
14877  626B 00 00 00 00 
14877  626F 00 00 00 00 
14877  6273 00 00 00 00 
14877  6277 00 00 00 00 
14877  627B 00 00 00 00 
14877  627F 00 00 00 00 
14877  6283 00 00 00 00 
14877  6287 00 00 00 00 
14877  628B 00 00 00 00 
14877  628F 00 00 00 00 
14877  6293 00 00 00 00 
14877  6297 00 00 00 00 
14877  629B 00 00 00 00 
14877  629F 00 00 00 00 
14877  62A3 00 00 00 00 
14877  62A7 00 00 00 00 
14877  62AB 00 00 00 00 
14877  62AF 00 00 00 00 
14877  62B3 00 00 00 00 
14877  62B7 00 00 00 00 
14877  62BB 00 00 00 00 
14877  62BF 00 00 00 00 
14877  62C3 00 00 00 00 
14877  62C7 00 00 00 00 
14877  62CB 00 00 00 00 
14877  62CF 00 00 00 00 
14877  62D3 00 00 
14878  62D5 00 00 00 00 _kdata_data: .fill 12, 0
14878  62D9 00 00 00 00 
14878  62DD 00 00 00 00 
14879  62E1 00          _klingons: .fill 1, 0
14880  62E2 00          _total_klingons: .fill 1, 0
14881  62E3 00          _klingons_left: .fill 1, 0
14882  62E4 00          _torps: .fill 1, 0
14883  62E5 0A          _torps0: .db 10
14884  62E6 00 00       _quad_y: .fill 2, 0
14885  62E8 00 00       _quad_x: .fill 2, 0
14886  62EA 00 00       _shield: .fill 2, 0
14887  62EC 00          _stars: .fill 1, 0
14888  62ED 00 00       _time_start: .fill 2, 0
14889  62EF 00 00       _time_up: .fill 2, 0
14890  62F1 00 00 00 00 _damage_data: .fill 18, 0
14890  62F5 00 00 00 00 
14890  62F9 00 00 00 00 
14890  62FD 00 00 00 00 
14890  6301 00 00 
14891  6303 00 00       _d4: .fill 2, 0
14892  6305 00 00       _ship_y: .fill 2, 0
14893  6307 00 00       _ship_x: .fill 2, 0
14894  6309 00 00       _stardate: .fill 2, 0
14895  630B 00 00 00 00 _quad_data: .fill 64, 0
14895  630F 00 00 00 00 
14895  6313 00 00 00 00 
14895  6317 00 00 00 00 
14895  631B 00 00 00 00 
14895  631F 00 00 00 00 
14895  6323 00 00 00 00 
14895  6327 00 00 00 00 
14895  632B 00 00 00 00 
14895  632F 00 00 00 00 
14895  6333 00 00 00 00 
14895  6337 00 00 00 00 
14895  633B 00 00 00 00 
14895  633F 00 00 00 00 
14895  6343 00 00 00 00 
14895  6347 00 00 00 00 
14896  634B 00 00 00 00 _quadname_data: .fill 12, 0
14896  634F 00 00 00 00 
14896  6353 00 00 00 00 
14897  6357 72 65 70 6F _inc_1_data: .db "reports:\n  Incorrect course data, sir!\n", 0
14897  635B 72 74 73 3A 
14897  635F 0A 20 20 49 
14897  6363 6E 63 6F 72 
14897  6367 72 65 63 74 
14897  636B 20 63 6F 75 
14897  636F 72 73 65 20 
14897  6373 64 61 74 61 
14897  6377 2C 20 73 69 
14897  637B 72 21 0A 00 
14898  637F 57 63       _inc_1: .dw _inc_1_data
14899  6381             _quad_name_data: 
14900  6381 01 65 01 65 .dw __s0, __s0, __s1, __s2, __s3, __s4, __s5, __s6, __s7, __s8, __s9, __s10, __s11, __s12, __s13, __s14, __s15, 
14900  6385 09 65 0F 65 
14900  6389 17 65 1C 65 
14900  638D 24 65 2B 65 
14900  6391 37 65 3E 65 
14900  6395 45 65 4B 65 
14900  6399 53 65 5E 65 
14900  639D 68 65 70 65 
14900  63A1 79 65 
14901  63A3 00 00 00 00 .fill 34, 0
14901  63A7 00 00 00 00 
14901  63AB 00 00 00 00 
14901  63AF 00 00 00 00 
14901  63B3 00 00 00 00 
14901  63B7 00 00 00 00 
14901  63BB 00 00 00 00 
14901  63BF 00 00 00 00 
14901  63C3 00 00 
14902  63C5             _device_name_data: 
14903  63C5 7F 65 7F 65 .dw __s16, __s16, __s17, __s18, __s19, __s20, __s21, __s22, __s23, 
14903  63C9 8C 65 A0 65 
14903  63CD B3 65 C2 65 
14903  63D1 CF 65 DE 65 
14903  63D5 ED 65 
14904  63D7 00 00 00 00 .fill 18, 0
14904  63DB 00 00 00 00 
14904  63DF 00 00 00 00 
14904  63E3 00 00 00 00 
14904  63E7 00 00 
14905  63E9 44 61 6D 61 _dcr_1_data: .db "Damage Control report:", 0
14905  63ED 67 65 20 43 
14905  63F1 6F 6E 74 72 
14905  63F5 6F 6C 20 72 
14905  63F9 65 70 6F 72 
14905  63FD 74 3A 00 
14906  6400 E9 63       _dcr_1: .dw _dcr_1_data
14907  6402             _plural_2_data: 
14908  6402 00 00       .db $0,$0,
14909  6404             _plural_data: 
14910  6404 69 73 00    .db $69,$73,$0,
14911  6407 00          .fill 1, 0
14912  6408             _warpmax_data: 
14913  6408 08          .db $8,
14914  6409 00 00 00    .fill 3, 0
14915  640C 2D 2D 2D 2D _srs_1_data: .db "------------------------", 0
14915  6410 2D 2D 2D 2D 
14915  6414 2D 2D 2D 2D 
14915  6418 2D 2D 2D 2D 
14915  641C 2D 2D 2D 2D 
14915  6420 2D 2D 2D 2D 
14915  6424 00 
14916  6425 0C 64       _srs_1: .dw _srs_1_data
14917  6427             _tilestr_data: 
14918  6427 FE 65 02 66 .dw __s24, __s25, __s26, __s27, __s28, 
14918  642B 06 66 0A 66 
14918  642F 0E 66 
14919  6431 00 00 00 00 .fill 10, 0
14919  6435 00 00 00 00 
14919  6439 00 00 
14920  643B 2D 2D 2D 2D _lrs_1_data: .db "-------------------\n", 0
14920  643F 2D 2D 2D 2D 
14920  6443 2D 2D 2D 2D 
14920  6447 2D 2D 2D 2D 
14920  644B 2D 2D 2D 0A 
14920  644F 00 
14921  6450 3B 64       _lrs_1: .dw _lrs_1_data
14922  6452 20 20 20 2D _gr_1_data: .db "   ----- ----- ----- ----- ----- ----- ----- -----\n", 0
14922  6456 2D 2D 2D 2D 
14922  645A 20 2D 2D 2D 
14922  645E 2D 2D 20 2D 
14922  6462 2D 2D 2D 2D 
14922  6466 20 2D 2D 2D 
14922  646A 2D 2D 20 2D 
14922  646E 2D 2D 2D 2D 
14922  6472 20 2D 2D 2D 
14922  6476 2D 2D 20 2D 
14922  647A 2D 2D 2D 2D 
14922  647E 20 2D 2D 2D 
14922  6482 2D 2D 0A 00 
14923  6486 52 64       _gr_1: .dw _gr_1_data
14924  6488 73 00       _str_s_data: .db "s", 0
14925  648A 88 64       _str_s: .dw _str_s_data
14926  648C 20 20 2D 2D _gm_1_data: .db "  ----- ----- ----- ----- ----- ----- ----- -----\n", 0
14926  6490 2D 2D 2D 20 
14926  6494 2D 2D 2D 2D 
14926  6498 2D 20 2D 2D 
14926  649C 2D 2D 2D 20 
14926  64A0 2D 2D 2D 2D 
14926  64A4 2D 20 2D 2D 
14926  64A8 2D 2D 2D 20 
14926  64AC 2D 2D 2D 2D 
14926  64B0 2D 20 2D 2D 
14926  64B4 2D 2D 2D 20 
14926  64B8 2D 2D 2D 2D 
14926  64BC 2D 0A 00 
14927  64BF 8C 64       _gm_1: .dw _gm_1_data
14928  64C1 20 20 44 49 _dist_1_data: .db "  DISTANCE = 	[2*e\n\n", 0
14928  64C5 53 54 41 4E 
14928  64C9 43 45 20 3D 
14928  64CD 20 09 5B 32 
14928  64D1 22 2A 65 0A 
14928  64D5 0A 00 
14929  64D7 C1 64       _dist_1: .dw _dist_1_data
14930  64D9 00 00 00 00 st_print100_buf_dt: .fill 16, 0
14930  64DD 00 00 00 00 
14930  64E1 00 00 00 00 
14930  64E5 00 00 00 00 
14931  64E9 47 52 45 45 _sC_data: .db "GREEN", 0
14931  64ED 4E 00 
14932  64EF E9 64       _sC: .dw _sC_data
14933  64F1             st_quadrant_name_sect_name_dt: 
out/startrek.asm line 14934: Unknown token: (.)
out/startrek.asm line 14934: Unknown token.    
out/startrek.asm line 14934: Label not found: (fill10)
out/startrek.asm line 14934: Unknown token: (.)
out/startrek.asm line 14934: Unknown token.    
out/startrek.asm line 14934: Label not found: (fill10)
14934  64F1 7F 76 7F 76 .dw __s166, __s166, __s167, __s168, __s169, .fill 10, 0
14934  64F5 82 76 86 76 
14934  64F9 8B 76 00 00 
14934  64FD 00 00 
out/startrek.asm line 14935: Label not found: (st_sect_name_sect_name_dt)
out/startrek.asm line 14935: Label not found: (st_sect_name_sect_name_dt)
14935  64FF 00 00       st_quadrant_name: .dw st_sect_name_sect_name_dt
14936  6501 41 6E 74 61 __s0: .db "Antares", 0
14936  6505 72 65 73 00 
14937  6509 52 69 67 65 __s1: .db "Rigel", 0
14937  650D 6C 00 
14938  650F 50 72 6F 63 __s2: .db "Procyon", 0
14938  6513 79 6F 6E 00 
14939  6517 56 65 67 61 __s3: .db "Vega", 0
14939  651B 00 
14940  651C 43 61 6E 6F __s4: .db "Canopus", 0
14940  6520 70 75 73 00 
14941  6524 41 6C 74 61 __s5: .db "Altair", 0
14941  6528 69 72 00 
14942  652B 53 61 67 69 __s6: .db "Sagittarius", 0
14942  652F 74 74 61 72 
14942  6533 69 75 73 00 
14943  6537 50 6F 6C 6C __s7: .db "Pollux", 0
14943  653B 75 78 00 
14944  653E 53 69 72 69 __s8: .db "Sirius", 0
14944  6542 75 73 00 
14945  6545 44 65 6E 65 __s9: .db "Deneb", 0
14945  6549 62 00 
14946  654B 43 61 70 65 __s10: .db "Capella", 0
14946  654F 6C 6C 61 00 
14947  6553 42 65 74 65 __s11: .db "Betelgeuse", 0
14947  6557 6C 67 65 75 
14947  655B 73 65 00 
14948  655E 41 6C 64 65 __s12: .db "Aldebaran", 0
14948  6562 62 61 72 61 
14948  6566 6E 00 
14949  6568 52 65 67 75 __s13: .db "Regulus", 0
14949  656C 6C 75 73 00 
14950  6570 41 72 63 74 __s14: .db "Arcturus", 0
14950  6574 75 72 75 73 
14950  6578 00 
14951  6579 53 70 69 63 __s15: .db "Spica", 0
14951  657D 61 00 
14952  657F 57 61 72 70 __s16: .db "Warp engines", 0
14952  6583 20 65 6E 67 
14952  6587 69 6E 65 73 
14952  658B 00 
14953  658C 53 68 6F 72 __s17: .db "Short range sensors", 0
14953  6590 74 20 72 61 
14953  6594 6E 67 65 20 
14953  6598 73 65 6E 73 
14953  659C 6F 72 73 00 
14954  65A0 4C 6F 6E 67 __s18: .db "Long range sensors", 0
14954  65A4 20 72 61 6E 
14954  65A8 67 65 20 73 
14954  65AC 65 6E 73 6F 
14954  65B0 72 73 00 
14955  65B3 50 68 61 73 __s19: .db "Phaser control", 0
14955  65B7 65 72 20 63 
14955  65BB 6F 6E 74 72 
14955  65BF 6F 6C 00 
14956  65C2 50 68 6F 74 __s20: .db "Photon tubes", 0
14956  65C6 6F 6E 20 74 
14956  65CA 75 62 65 73 
14956  65CE 00 
14957  65CF 44 61 6D 61 __s21: .db "Damage control", 0
14957  65D3 67 65 20 63 
14957  65D7 6F 6E 74 72 
14957  65DB 6F 6C 00 
14958  65DE 53 68 69 65 __s22: .db "Shield control", 0
14958  65E2 6C 64 20 63 
14958  65E6 6F 6E 74 72 
14958  65EA 6F 6C 00 
14959  65ED 4C 69 62 72 __s23: .db "Library computer", 0
14959  65F1 61 72 79 20 
14959  65F5 63 6F 6D 70 
14959  65F9 75 74 65 72 
14959  65FD 00 
14960  65FE 20 20 20 00 __s24: .db "   ", 0
14961  6602 20 2A 20 00 __s25: .db " * ", 0
14962  6606 3E 21 3C 00 __s26: .db ">!<", 0
14963  660A 2B 4B 2B 00 __s27: .db "+K+", 0
14964  660E 3C 2A 3E 00 __s28: .db "<*>", 0
14965  6612 55 6E 65 78 __s29: .db "Unexpected format in printf.", 0
14965  6616 70 65 63 74 
14965  661A 65 64 20 66 
14965  661E 6F 72 6D 61 
14965  6622 74 20 69 6E 
14965  6626 20 70 72 69 
14965  662A 6E 74 66 2E 
14965  662E 00 
14966  662F 45 72 72 6F __s30: .db "Error: Unknown argument type.\n", 0
14966  6633 72 3A 20 55 
14966  6637 6E 6B 6E 6F 
14966  663B 77 6E 20 61 
14966  663F 72 67 75 6D 
14966  6643 65 6E 74 20 
14966  6647 74 79 70 65 
14966  664B 2E 0A 00 
14967  664E 1B 5B 32 4A __s31: .db "\033[2J\033[H", 0
14967  6652 1B 5B 48 00 
14968  6656 61 72 65 00 __s32: .db "are", 0
14969  665A 69 73 00    __s33: .db "is", 0
14970  665D 25 73 20 25 __s34: .db "%s %s inoperable.\n", 0
14970  6661 73 20 69 6E 
14970  6665 6F 70 65 72 
14970  6669 61 62 6C 65 
14970  666D 2E 0A 00 
14971  6670 73 74 61 72 __s35: .db "startrek.intro", 0
14971  6674 74 72 65 6B 
14971  6678 2E 69 6E 74 
14971  667C 72 6F 00 
14972  667F 73 74 61 72 __s36: .db "startrek.doc", 0
14972  6683 74 72 65 6B 
14972  6687 2E 64 6F 63 
14972  668B 00 
14973  668C 73 74 61 72 __s37: .db "startrek.logo", 0
14973  6690 74 72 65 6B 
14973  6694 2E 6C 6F 67 
14973  6698 6F 00 
14974  669A 73 74 61 72 __s38: .db "startrek.fatal", 0
14974  669E 74 72 65 6B 
14974  66A2 2E 66 61 74 
14974  66A6 61 6C 00 
14975  66A9 43 6F 6D 6D __s39: .db "Command? ", 0
14975  66AD 61 6E 64 3F 
14975  66B1 20 00 
14976  66B3 6E 61 76 00 __s40: .db "nav", 0
14977  66B7 73 72 73 00 __s41: .db "srs", 0
14978  66BB 6C 72 73 00 __s42: .db "lrs", 0
14979  66BF 70 68 61 00 __s43: .db "pha", 0
14980  66C3 74 6F 72 00 __s44: .db "tor", 0
14981  66C7 73 68 69 00 __s45: .db "shi", 0
14982  66CB 64 61 6D 00 __s46: .db "dam", 0
14983  66CF 63 6F 6D 00 __s47: .db "com", 0
14984  66D3 78 78 78 00 __s48: .db "xxx", 0
14985  66D7 45 6E 74 65 __s49: .db "Enter one of the following:\n", 0
14985  66DB 72 20 6F 6E 
14985  66DF 65 20 6F 66 
14985  66E3 20 74 68 65 
14985  66E7 20 66 6F 6C 
14985  66EB 6C 6F 77 69 
14985  66EF 6E 67 3A 0A 
14985  66F3 00 
14986  66F4 20 20 6E 61 __s50: .db "  nav - To Set Course", 0
14986  66F8 76 20 2D 20 
14986  66FC 54 6F 20 53 
14986  6700 65 74 20 43 
14986  6704 6F 75 72 73 
14986  6708 65 00 
14987  670A 20 20 73 72 __s51: .db "  srs - Short Range Sensors", 0
14987  670E 73 20 2D 20 
14987  6712 53 68 6F 72 
14987  6716 74 20 52 61 
14987  671A 6E 67 65 20 
14987  671E 53 65 6E 73 
14987  6722 6F 72 73 00 
14988  6726 20 20 6C 72 __s52: .db "  lrs - Long Range Sensors", 0
14988  672A 73 20 2D 20 
14988  672E 4C 6F 6E 67 
14988  6732 20 52 61 6E 
14988  6736 67 65 20 53 
14988  673A 65 6E 73 6F 
14988  673E 72 73 00 
14989  6741 20 20 70 68 __s53: .db "  pha - Phasers", 0
14989  6745 61 20 2D 20 
14989  6749 50 68 61 73 
14989  674D 65 72 73 00 
14990  6751 20 20 74 6F __s54: .db "  tor - Photon Torpedoes", 0
14990  6755 72 20 2D 20 
14990  6759 50 68 6F 74 
14990  675D 6F 6E 20 54 
14990  6761 6F 72 70 65 
14990  6765 64 6F 65 73 
14990  6769 00 
14991  676A 20 20 73 68 __s55: .db "  shi - Shield Control", 0
14991  676E 69 20 2D 20 
14991  6772 53 68 69 65 
14991  6776 6C 64 20 43 
14991  677A 6F 6E 74 72 
14991  677E 6F 6C 00 
14992  6781 20 20 64 61 __s56: .db "  dam - Damage Control", 0
14992  6785 6D 20 2D 20 
14992  6789 44 61 6D 61 
14992  678D 67 65 20 43 
14992  6791 6F 6E 74 72 
14992  6795 6F 6C 00 
14993  6798 20 20 63 6F __s57: .db "  com - Library Computer", 0
14993  679C 6D 20 2D 20 
14993  67A0 4C 69 62 72 
14993  67A4 61 72 79 20 
14993  67A8 43 6F 6D 70 
14993  67AC 75 74 65 72 
14993  67B0 00 
14994  67B1 20 20 78 78 __s58: .db "  xxx - Resign Command\n", 0
14994  67B5 78 20 2D 20 
14994  67B9 52 65 73 69 
14994  67BD 67 6E 20 43 
14994  67C1 6F 6D 6D 61 
14994  67C5 6E 64 0A 00 
14995  67C9 73 00       __s59: .db "s", 0
14996  67CB 4E 6F 77 20 __s60: .db "Now entering %s quadrant...\n\n", 0
14996  67CF 65 6E 74 65 
14996  67D3 72 69 6E 67 
14996  67D7 20 25 73 20 
14996  67DB 71 75 61 64 
14996  67DF 72 61 6E 74 
14996  67E3 2E 2E 2E 0A 
14996  67E7 0A 00 
14997  67E9 0A 59 6F 75 __s61: .db "\nYour mission begins with your starship located", 0
14997  67ED 72 20 6D 69 
14997  67F1 73 73 69 6F 
14997  67F5 6E 20 62 65 
14997  67F9 67 69 6E 73 
14997  67FD 20 77 69 74 
14997  6801 68 20 79 6F 
14997  6805 75 72 20 73 
14997  6809 74 61 72 73 
14997  680D 68 69 70 20 
14997  6811 6C 6F 63 61 
14997  6815 74 65 64 00 
14998  6819 69 6E 20 74 __s62: .db "in the galactic quadrant %s.\n\n", 0
14998  681D 68 65 20 67 
14998  6821 61 6C 61 63 
14998  6825 74 69 63 20 
14998  6829 71 75 61 64 
14998  682D 72 61 6E 74 
14998  6831 20 25 73 2E 
14998  6835 0A 0A 00 
14999  6838 43 6F 6D 62 __s63: .db "Combat Area  Condition Red\n", 0
14999  683C 61 74 20 41 
14999  6840 72 65 61 20 
14999  6844 20 43 6F 6E 
14999  6848 64 69 74 69 
14999  684C 6F 6E 20 52 
14999  6850 65 64 0A 00 
15000  6854 53 68 69 65 __s64: .db "Shields Dangerously Low\n", 0
15000  6858 6C 64 73 20 
15000  685C 44 61 6E 67 
15000  6860 65 72 6F 75 
15000  6864 73 6C 79 20 
15000  6868 4C 6F 77 0A 
15000  686C 00 
15001  686D 43 6F 75 72 __s65: .db "Course (0-9): ", 0
15001  6871 73 65 20 28 
15001  6875 30 2D 39 29 
15001  6879 3A 20 00 
15002  687C 4C 74 2E 20 __s66: .db "Lt. Sulu%s", 0
15002  6880 53 75 6C 75 
15002  6884 25 73 00 
15003  6887 30 2E 32 00 __s67: .db "0.2", 0
15004  688B 57 61 72 70 __s68: .db "Warp Factor (0-%s): ", 0
15004  688F 20 46 61 63 
15004  6893 74 6F 72 20 
15004  6897 28 30 2D 25 
15004  689B 73 29 3A 20 
15004  689F 00 
15005  68A0 57 61 72 70 __s69: .db "Warp Engines are damaged. Maximum speed = Warp 0.2.\n\n", 0
15005  68A4 20 45 6E 67 
15005  68A8 69 6E 65 73 
15005  68AC 20 61 72 65 
15005  68B0 20 64 61 6D 
15005  68B4 61 67 65 64 
15005  68B8 2E 20 4D 61 
15005  68BC 78 69 6D 75 
15005  68C0 6D 20 73 70 
15005  68C4 65 65 64 20 
15005  68C8 3D 20 57 61 
15005  68CC 72 70 20 30 
15005  68D0 2E 32 2E 0A 
15005  68D4 0A 00 
15006  68D6 43 68 69 65 __s70: .db "Chief Engineer Scott reports:\n  The engines won't take warp %s!\n\n", 0
15006  68DA 66 20 45 6E 
15006  68DE 67 69 6E 65 
15006  68E2 65 72 20 53 
15006  68E6 63 6F 74 74 
15006  68EA 20 72 65 70 
15006  68EE 6F 72 74 73 
15006  68F2 3A 0A 20 20 
15006  68F6 54 68 65 20 
15006  68FA 65 6E 67 69 
15006  68FE 6E 65 73 20 
15006  6902 77 6F 6E 27 
15006  6906 74 20 74 61 
15006  690A 6B 65 20 77 
15006  690E 61 72 70 20 
15006  6912 25 73 21 0A 
15006  6916 0A 
15007  6917 45 6E 67 69 __s71: .db "Engineering reports:\n  Insufficient energy available for maneuvering at warp %s!\n\n", 0
15007  691B 6E 65 65 72 
15007  691F 69 6E 67 20 
15007  6923 72 65 70 6F 
15007  6927 72 74 73 3A 
15007  692B 0A 20 20 49 
15007  692F 6E 73 75 66 
15007  6933 66 69 63 69 
15007  6937 65 6E 74 20 
15007  693B 65 6E 65 72 
15007  693F 67 79 20 61 
15007  6943 76 61 69 6C 
15007  6947 61 62 6C 65 
15007  694B 20 66 6F 72 
15007  694F 20 6D 61 6E 
15007  6953 65 75 76 65 
15007  6957 72 69 6E 67 
15007  695B 20 61 74 20 
15007  695F 77 61 72 70 
15007  6963 20 25 73 21 
15007  6967 0A 0A 00 
15008  696A 44 65 66 6C __s72: .db "Deflector Control Room acknowledges:\n  %d units of energy presently deployed to shields.\n", 0
15008  696E 65 63 74 6F 
15008  6972 72 20 43 6F 
15008  6976 6E 74 72 6F 
15008  697A 6C 20 52 6F 
15008  697E 6F 6D 20 61 
15008  6982 63 6B 6E 6F 
15008  6986 77 6C 65 64 
15008  698A 67 65 73 3A 
15008  698E 0A 20 20 25 
15008  6992 64 20 75 6E 
15008  6996 69 74 73 20 
15008  699A 6F 66 20 65 
15008  699E 6E 65 72 67 
15008  69A2 79 20 70 72 
15008  69A6 65 73 65 6E 
15008  69AA 74 6C 79 20 
15008  69AE 64 65 70 6C 
15008  69B2 6F 79 65 64 
15008  69B6 20 74 6F 20 
15008  69BA 73 68 69 65 
15008  69BE 6C 64 73 2E 
15008  69C2 0A 00 
out/startrek.asm line 15009: Maximum number of args exceeded. ("LT. Uhura reports:\n Message from Starfleet Command:\n\n Permission to attempt crossing of galactic perimeter\n is hereby *denied*. Shut down your engines.\n\n Chief Engineer Scott reports:\n Warp Engines shut down at sector %d, %d of quadrant %d, %d.\n\n",0)
15009  69C4 00          __s73: .db "LT. Uhura reports:\n Message from Starfleet Command:\n\n Permission to attempt crossing of galactic perimeter\n is hereby *denied*. Shut down your engines.\n\n Chief Engineer Scott reports:\n Warp Engines shut down at sector %d, %d of quadrant %d, %d.\n\n", 0
15010  69C5 57 61 72 70 __s74: .db "Warp Engines shut down at sector %d, %d due to bad navigation.\n\n", 0
15010  69C9 20 45 6E 67 
15010  69CD 69 6E 65 73 
15010  69D1 20 73 68 75 
15010  69D5 74 20 64 6F 
15010  69D9 77 6E 20 61 
15010  69DD 74 20 73 65 
15010  69E1 63 74 6F 72 
15010  69E5 20 25 64 2C 
15010  69E9 20 25 64 20 
15010  69ED 64 75 65 20 
15010  69F1 74 6F 20 62 
15010  69F5 61 64 20 6E 
15010  69F9 61 76 69 67 
15010  69FD 61 74 69 6F 
15010  6A01 6E 2E 0A 0A 
15010  6A05 00 
15011  6A06 53 68 69 65 __s75: .db "Shield Control supplies energy to complete maneuver.\n", 0
15011  6A0A 6C 64 20 43 
15011  6A0E 6F 6E 74 72 
15011  6A12 6F 6C 20 73 
15011  6A16 75 70 70 6C 
15011  6A1A 69 65 73 20 
15011  6A1E 65 6E 65 72 
15011  6A22 67 79 20 74 
15011  6A26 6F 20 63 6F 
15011  6A2A 6D 70 6C 65 
15011  6A2E 74 65 20 6D 
15011  6A32 61 6E 65 75 
15011  6A36 76 65 72 2E 
15011  6A3A 0A 00 
15012  6A3C 59 45 4C 4C __s76: .db "YELLOW", 0
15012  6A40 4F 57 00 
15013  6A43 2A 52 45 44 __s77: .db "*RED*", 0
15013  6A47 2A 00 
15014  6A49 44 4F 43 4B __s78: .db "DOCKED", 0
15014  6A4D 45 44 00 
15015  6A50 53 68 69 65 __s79: .db "Shields dropped for docking purposes.", 0
15015  6A54 6C 64 73 20 
15015  6A58 64 72 6F 70 
15015  6A5C 70 65 64 20 
15015  6A60 66 6F 72 20 
15015  6A64 64 6F 63 6B 
15015  6A68 69 6E 67 20 
15015  6A6C 70 75 72 70 
15015  6A70 6F 73 65 73 
15015  6A74 2E 00 
15016  6A76 0A 2A 2A 2A __s80: .db "\n*** Short Range Sensors are out ***", 0
15016  6A7A 20 53 68 6F 
15016  6A7E 72 74 20 52 
15016  6A82 61 6E 67 65 
15016  6A86 20 53 65 6E 
15016  6A8A 73 6F 72 73 
15016  6A8E 20 61 72 65 
15016  6A92 20 6F 75 74 
15016  6A96 20 2A 2A 2A 
15016  6A9A 00 
15017  6A9B 20 20 20 20 __s81: .db "    Stardate            %d\n", 0
15017  6A9F 53 74 61 72 
15017  6AA3 64 61 74 65 
15017  6AA7 20 20 20 20 
15017  6AAB 20 20 20 20 
15017  6AAF 20 20 20 20 
15017  6AB3 25 64 0A 00 
15018  6AB7 20 20 20 20 __s82: .db "    Condition           %s\n", 0
15018  6ABB 43 6F 6E 64 
15018  6ABF 69 74 69 6F 
15018  6AC3 6E 20 20 20 
15018  6AC7 20 20 20 20 
15018  6ACB 20 20 20 20 
15018  6ACF 25 73 0A 00 
15019  6AD3 20 20 20 20 __s83: .db "    Quadrant            %d, %d\n", 0
15019  6AD7 51 75 61 64 
15019  6ADB 72 61 6E 74 
15019  6ADF 20 20 20 20 
15019  6AE3 20 20 20 20 
15019  6AE7 20 20 20 20 
15019  6AEB 25 64 2C 20 
15019  6AEF 25 64 0A 00 
15020  6AF3 20 20 20 20 __s84: .db "    Sector              %d, %d\n", 0
15020  6AF7 53 65 63 74 
15020  6AFB 6F 72 20 20 
15020  6AFF 20 20 20 20 
15020  6B03 20 20 20 20 
15020  6B07 20 20 20 20 
15020  6B0B 25 64 2C 20 
15020  6B0F 25 64 0A 00 
15021  6B13 20 20 20 20 __s85: .db "    Photon Torpedoes    %d\n", 0
15021  6B17 50 68 6F 74 
15021  6B1B 6F 6E 20 54 
15021  6B1F 6F 72 70 65 
15021  6B23 64 6F 65 73 
15021  6B27 20 20 20 20 
15021  6B2B 25 64 0A 00 
15022  6B2F 20 20 20 20 __s86: .db "    Total Energy        %d\n", 0
15022  6B33 54 6F 74 61 
15022  6B37 6C 20 45 6E 
15022  6B3B 65 72 67 79 
15022  6B3F 20 20 20 20 
15022  6B43 20 20 20 20 
15022  6B47 25 64 0A 00 
15023  6B4B 20 20 20 20 __s87: .db "    Shields             %d\n", 0
15023  6B4F 53 68 69 65 
15023  6B53 6C 64 73 20 
15023  6B57 20 20 20 20 
15023  6B5B 20 20 20 20 
15023  6B5F 20 20 20 20 
15023  6B63 25 64 0A 00 
15024  6B67 20 20 20 20 __s88: .db "    Klingons Remaining  %d\n", 0
15024  6B6B 4B 6C 69 6E 
15024  6B6F 67 6F 6E 73 
15024  6B73 20 52 65 6D 
15024  6B77 61 69 6E 69 
15024  6B7B 6E 67 20 20 
15024  6B7F 25 64 0A 00 
15025  6B83 4C 6F 6E 67 __s89: .db "Long Range Scan for Quadrant %d, %d\n\n", 0
15025  6B87 20 52 61 6E 
15025  6B8B 67 65 20 53 
15025  6B8F 63 61 6E 20 
15025  6B93 66 6F 72 20 
15025  6B97 51 75 61 64 
15025  6B9B 72 61 6E 74 
15025  6B9F 20 25 64 2C 
15025  6BA3 20 25 64 0A 
15025  6BA7 0A 00 
15026  6BA9 25 73 3A 00 __s90: .db "%s:", 0
15027  6BAD 2A 2A 2A 00 __s91: .db "***", 0
15028  6BB1 20 3A 00    __s92: .db " :", 0
15029  6BB4 25 73 0A 00 __s93: .db "%s\n", 0
15030  6BB8 53 63 69 65 __s94: .db "Science Officer Spock reports:\n  'Sensors show no enemy ships in this quadrant'\n", 0
15030  6BBC 6E 63 65 20 
15030  6BC0 4F 66 66 69 
15030  6BC4 63 65 72 20 
15030  6BC8 53 70 6F 63 
15030  6BCC 6B 20 72 65 
15030  6BD0 70 6F 72 74 
15030  6BD4 73 3A 0A 20 
15030  6BD8 20 27 53 65 
15030  6BDC 6E 73 6F 72 
15030  6BE0 73 20 73 68 
15030  6BE4 6F 77 20 6E 
15030  6BE8 6F 20 65 6E 
15030  6BEC 65 6D 79 20 
15030  6BF0 73 68 69 70 
15030  6BF4 73 20 69 6E 
15030  6BF8 20 74 68 69 
15030  6BFC 73 20 71 75 
15030  6C00 61 64 72 61 
15030  6C04 6E 74 27 0A 
15030  6C08 00 
15031  6C09 43 6F 6D 70 __s95: .db "Computer failure hampers accuracy.", 0
15031  6C0D 75 74 65 72 
15031  6C11 20 66 61 69 
15031  6C15 6C 75 72 65 
15031  6C19 20 68 61 6D 
15031  6C1D 70 65 72 73 
15031  6C21 20 61 63 63 
15031  6C25 75 72 61 63 
15031  6C29 79 2E 00 
15032  6C2C 50 68 61 73 __s96: .db "Phasers locked on target;\n Energy available = %d units\n\n Number of units to fire: ", 0
15032  6C30 65 72 73 20 
15032  6C34 6C 6F 63 6B 
15032  6C38 65 64 20 6F 
15032  6C3C 6E 20 74 61 
15032  6C40 72 67 65 74 
15032  6C44 3B 0A 20 45 
15032  6C48 6E 65 72 67 
15032  6C4C 79 20 61 76 
15032  6C50 61 69 6C 61 
15032  6C54 62 6C 65 20 
15032  6C58 3D 20 25 64 
15032  6C5C 20 75 6E 69 
15032  6C60 74 73 0A 0A 
15032  6C64 20 4E 75 6D 
15032  6C68 62 65 72 20 
15032  6C6C 6F 66 20 75 
15032  6C70 6E 69 74 73 
15032  6C74 20 74 6F 20 
15032  6C78 66 69 72 65 
15032  6C7C 3A 20 00 
15033  6C7F 4E 6F 74 20 __s97: .db "Not enough energy available.\n", 0
15033  6C83 65 6E 6F 75 
15033  6C87 67 68 20 65 
15033  6C8B 6E 65 72 67 
15033  6C8F 79 20 61 76 
15033  6C93 61 69 6C 61 
15033  6C97 62 6C 65 2E 
15033  6C9B 0A 00 
15034  6C9D 53 65 6E 73 __s98: .db "Sensors show no damage to enemy at %d, %d\n\n", 0
15034  6CA1 6F 72 73 20 
15034  6CA5 73 68 6F 77 
15034  6CA9 20 6E 6F 20 
15034  6CAD 64 61 6D 61 
15034  6CB1 67 65 20 74 
15034  6CB5 6F 20 65 6E 
15034  6CB9 65 6D 79 20 
15034  6CBD 61 74 20 25 
15034  6CC1 64 2C 20 25 
15034  6CC5 64 0A 0A 00 
15035  6CC9 25 64 20 75 __s99: .db "%d unit hit on Klingon at sector %d, %d\n", 0
15035  6CCD 6E 69 74 20 
15035  6CD1 68 69 74 20 
15035  6CD5 6F 6E 20 4B 
15035  6CD9 6C 69 6E 67 
15035  6CDD 6F 6E 20 61 
15035  6CE1 74 20 73 65 
15035  6CE5 63 74 6F 72 
15035  6CE9 20 25 64 2C 
15035  6CED 20 25 64 0A 
15035  6CF1 00 
15036  6CF2 2A 2A 2A 20 __s100: .db "*** Klingon Destroyed ***\n", 0
15036  6CF6 4B 6C 69 6E 
15036  6CFA 67 6F 6E 20 
15036  6CFE 44 65 73 74 
15036  6D02 72 6F 79 65 
15036  6D06 64 20 2A 2A 
15036  6D0A 2A 0A 00 
15037  6D0D 20 20 20 28 __s101: .db "   (Sensors show %d units remaining.)\n\n", 0
15037  6D11 53 65 6E 73 
15037  6D15 6F 72 73 20 
15037  6D19 73 68 6F 77 
15037  6D1D 20 25 64 20 
15037  6D21 75 6E 69 74 
15037  6D25 73 20 72 65 
15037  6D29 6D 61 69 6E 
15037  6D2D 69 6E 67 2E 
15037  6D31 29 0A 0A 00 
15038  6D35 41 6C 6C 20 __s102: .db "All photon torpedoes expended", 0
15038  6D39 70 68 6F 74 
15038  6D3D 6F 6E 20 74 
15038  6D41 6F 72 70 65 
15038  6D45 64 6F 65 73 
15038  6D49 20 65 78 70 
15038  6D4D 65 6E 64 65 
15038  6D51 64 00 
15039  6D53 45 6E 73 69 __s103: .db "Ensign Chekov%s", 0
15039  6D57 67 6E 20 43 
15039  6D5B 68 65 6B 6F 
15039  6D5F 76 25 73 00 
15040  6D63 54 6F 72 70 __s104: .db "Torpedo Track:", 0
15040  6D67 65 64 6F 20 
15040  6D6B 54 72 61 63 
15040  6D6F 6B 3A 00 
15041  6D72 20 20 20 20 __s105: .db "    %d, %d\n", 0
15041  6D76 25 64 2C 20 
15041  6D7A 25 64 0A 00 
15042  6D7E 54 6F 72 70 __s106: .db "Torpedo Missed\n", 0
15042  6D82 65 64 6F 20 
15042  6D86 4D 69 73 73 
15042  6D8A 65 64 0A 00 
15043  6D8E 53 74 61 72 __s107: .db "Star at %d, %d absorbed torpedo energy.\n\n", 0
15043  6D92 20 61 74 20 
15043  6D96 25 64 2C 20 
15043  6D9A 25 64 20 61 
15043  6D9E 62 73 6F 72 
15043  6DA2 62 65 64 20 
15043  6DA6 74 6F 72 70 
15043  6DAA 65 64 6F 20 
15043  6DAE 65 6E 65 72 
15043  6DB2 67 79 2E 0A 
15043  6DB6 0A 00 
15044  6DB8 2A 2A 2A 20 __s108: .db "*** Starbase Destroyed ***", 0
15044  6DBC 53 74 61 72 
15044  6DC0 62 61 73 65 
15044  6DC4 20 44 65 73 
15044  6DC8 74 72 6F 79 
15044  6DCC 65 64 20 2A 
15044  6DD0 2A 2A 00 
15045  6DD3 54 68 61 74 __s109: .db "That does it, Captain!!", 0
15045  6DD7 20 64 6F 65 
15045  6DDB 73 20 69 74 
15045  6DDF 2C 20 43 61 
15045  6DE3 70 74 61 69 
15045  6DE7 6E 21 21 00 
15046  6DEB 59 6F 75 20 __s110: .db "You are hereby relieved of command\n", 0
15046  6DEF 61 72 65 20 
15046  6DF3 68 65 72 65 
15046  6DF7 62 79 20 72 
15046  6DFB 65 6C 69 65 
15046  6DFF 76 65 64 20 
15046  6E03 6F 66 20 63 
15046  6E07 6F 6D 6D 61 
15046  6E0B 6E 64 0A 00 
15047  6E0F 61 6E 64 20 __s111: .db "and sentenced to 99 stardates of hard", 0
15047  6E13 73 65 6E 74 
15047  6E17 65 6E 63 65 
15047  6E1B 64 20 74 6F 
15047  6E1F 20 39 39 20 
15047  6E23 73 74 61 72 
15047  6E27 64 61 74 65 
15047  6E2B 73 20 6F 66 
15047  6E2F 20 68 61 72 
15047  6E33 64 00 
15048  6E35 6C 61 62 6F __s112: .db "labor on Cygnus 12!!\n", 0
15048  6E39 72 20 6F 6E 
15048  6E3D 20 43 79 67 
15048  6E41 6E 75 73 20 
15048  6E45 31 32 21 21 
15048  6E49 0A 00 
15049  6E4B 53 74 61 72 __s113: .db "Starfleet Command reviewing your record to consider\n court martial!\n", 0
15049  6E4F 66 6C 65 65 
15049  6E53 74 20 43 6F 
15049  6E57 6D 6D 61 6E 
15049  6E5B 64 20 72 65 
15049  6E5F 76 69 65 77 
15049  6E63 69 6E 67 20 
15049  6E67 79 6F 75 72 
15049  6E6B 20 72 65 63 
15049  6E6F 6F 72 64 20 
15049  6E73 74 6F 20 63 
15049  6E77 6F 6E 73 69 
15049  6E7B 64 65 72 0A 
15049  6E7F 20 63 6F 75 
15049  6E83 72 74 20 6D 
15049  6E87 61 72 74 69 
15049  6E8B 61 6C 21 0A 
15049  6E8F 00 
15050  6E90 44 61 6D 61 __s114: .db "Damage Control report not available.", 0
15050  6E94 67 65 20 43 
15050  6E98 6F 6E 74 72 
15050  6E9C 6F 6C 20 72 
15050  6EA0 65 70 6F 72 
15050  6EA4 74 20 6E 6F 
15050  6EA8 74 20 61 76 
15050  6EAC 61 69 6C 61 
15050  6EB0 62 6C 65 2E 
15050  6EB4 00 
out/startrek.asm line 15051: Maximum number of args exceeded. ("\nTechnicians standing by to effect repairs to your ship;\nEstimated time to repair: %s stardates.\n Will you authorize the repair order (y/N)? ",0)
15051  6EB5 00          __s115: .db "\nTechnicians standing by to effect repairs to your ship;\nEstimated time to repair: %s stardates.\n Will you authorize the repair order (y/N)? ", 0
15052  6EB6 44 65 76 69 __s116: .db "Device            State of Repair", 0
15052  6EBA 63 65 20 20 
15052  6EBE 20 20 20 20 
15052  6EC2 20 20 20 20 
15052  6EC6 20 20 53 74 
15052  6ECA 61 74 65 20 
15052  6ECE 6F 66 20 52 
15052  6ED2 65 70 61 69 
15052  6ED6 72 00 
15053  6ED8 25 2D 32 35 __s117: .db "%-25s%6s\n", 0
15053  6EDC 73 25 36 73 
15053  6EE0 0A 00 
15054  6EE2 0A 00       __s118: .db "\n", 0
15055  6EE4 45 6E 65 72 __s119: .db "Energy available = %d\n\n Input number of units to shields: ", 0
15055  6EE8 67 79 20 61 
15055  6EEC 76 61 69 6C 
15055  6EF0 61 62 6C 65 
15055  6EF4 20 3D 20 25 
15055  6EF8 64 0A 0A 20 
15055  6EFC 49 6E 70 75 
15055  6F00 74 20 6E 75 
15055  6F04 6D 62 65 72 
15055  6F08 20 6F 66 20 
15055  6F0C 75 6E 69 74 
15055  6F10 73 20 74 6F 
15055  6F14 20 73 68 69 
15055  6F18 65 6C 64 73 
15055  6F1C 3A 20 00 
15056  6F1F 3C 53 68 69 __s120: .db "<Shields Unchanged>\n", 0
15056  6F23 65 6C 64 73 
15056  6F27 20 55 6E 63 
15056  6F2B 68 61 6E 67 
15056  6F2F 65 64 3E 0A 
15056  6F33 00 
15057  6F34 53 68 69 65 __s121: .db "Shield Control Reports:\n  'This is not the Federation Treasury.'", 0
15057  6F38 6C 64 20 43 
15057  6F3C 6F 6E 74 72 
15057  6F40 6F 6C 20 52 
15057  6F44 65 70 6F 72 
15057  6F48 74 73 3A 0A 
15057  6F4C 20 20 27 54 
15057  6F50 68 69 73 20 
15057  6F54 69 73 20 6E 
15057  6F58 6F 74 20 74 
15057  6F5C 68 65 20 46 
15057  6F60 65 64 65 72 
15057  6F64 61 74 69 6F 
15057  6F68 6E 20 54 72 
15057  6F6C 65 61 73 75 
15057  6F70 72 79 2E 27 
15057  6F74 00 
15058  6F75 44 65 66 6C __s122: .db "Deflector Control Room report:\n  'Shields now at %d units per your command.'\n\n", 0
15058  6F79 65 63 74 6F 
15058  6F7D 72 20 43 6F 
15058  6F81 6E 74 72 6F 
15058  6F85 6C 20 52 6F 
15058  6F89 6F 6D 20 72 
15058  6F8D 65 70 6F 72 
15058  6F91 74 3A 0A 20 
15058  6F95 20 27 53 68 
15058  6F99 69 65 6C 64 
15058  6F9D 73 20 6E 6F 
15058  6FA1 77 20 61 74 
15058  6FA5 20 25 64 20 
15058  6FA9 75 6E 69 74 
15058  6FAD 73 20 70 65 
15058  6FB1 72 20 79 6F 
15058  6FB5 75 72 20 63 
15058  6FB9 6F 6D 6D 61 
15058  6FBD 6E 64 2E 27 
15058  6FC1 0A 0A 00 
15059  6FC4 43 6F 6D 70 __s123: .db "Computer active and awating command: ", 0
15059  6FC8 75 74 65 72 
15059  6FCC 20 61 63 74 
15059  6FD0 69 76 65 20 
15059  6FD4 61 6E 64 20 
15059  6FD8 61 77 61 74 
15059  6FDC 69 6E 67 20 
15059  6FE0 63 6F 6D 6D 
15059  6FE4 61 6E 64 3A 
15059  6FE8 20 00 
15060  6FEA 46 75 6E 63 __s124: .db "Functions available from Library-Computer:\n\n", 0
15060  6FEE 74 69 6F 6E 
15060  6FF2 73 20 61 76 
15060  6FF6 61 69 6C 61 
15060  6FFA 62 6C 65 20 
15060  6FFE 66 72 6F 6D 
15060  7002 20 4C 69 62 
15060  7006 72 61 72 79 
15060  700A 2D 43 6F 6D 
15060  700E 70 75 74 65 
15060  7012 72 3A 0A 0A 
15060  7016 00 
15061  7017 20 20 20 30 __s125: .db "   0 = Cumulative Galactic Record\n", 0
15061  701B 20 3D 20 43 
15061  701F 75 6D 75 6C 
15061  7023 61 74 69 76 
15061  7027 65 20 47 61 
15061  702B 6C 61 63 74 
15061  702F 69 63 20 52 
15061  7033 65 63 6F 72 
15061  7037 64 0A 00 
15062  703A 20 20 20 31 __s126: .db "   1 = Status Report\n", 0
15062  703E 20 3D 20 53 
15062  7042 74 61 74 75 
15062  7046 73 20 52 65 
15062  704A 70 6F 72 74 
15062  704E 0A 00 
15063  7050 20 20 20 32 __s127: .db "   2 = Photon Torpedo Data\n", 0
15063  7054 20 3D 20 50 
15063  7058 68 6F 74 6F 
15063  705C 6E 20 54 6F 
15063  7060 72 70 65 64 
15063  7064 6F 20 44 61 
15063  7068 74 61 0A 00 
15064  706C 20 20 20 33 __s128: .db "   3 = Starbase Nav Data\n", 0
15064  7070 20 3D 20 53 
15064  7074 74 61 72 62 
15064  7078 61 73 65 20 
15064  707C 4E 61 76 20 
15064  7080 44 61 74 61 
15064  7084 0A 00 
15065  7086 20 20 20 34 __s129: .db "   4 = Direction/Distance Calculator\n", 0
15065  708A 20 3D 20 44 
15065  708E 69 72 65 63 
15065  7092 74 69 6F 6E 
15065  7096 2F 44 69 73 
15065  709A 74 61 6E 63 
15065  709E 65 20 43 61 
15065  70A2 6C 63 75 6C 
15065  70A6 61 74 6F 72 
15065  70AA 0A 00 
15066  70AC 20 20 20 35 __s130: .db "   5 = Galaxy 'Region Name' Map\n", 0
15066  70B0 20 3D 20 47 
15066  70B4 61 6C 61 78 
15066  70B8 79 20 27 52 
15066  70BC 65 67 69 6F 
15066  70C0 6E 20 4E 61 
15066  70C4 6D 65 27 20 
15066  70C8 4D 61 70 0A 
15066  70CC 00 
15067  70CD 0A 20 20 20 __s131: .db "\n     Computer Record of Galaxy for Quadrant %d,%d\n\n", 0
15067  70D1 20 20 43 6F 
15067  70D5 6D 70 75 74 
15067  70D9 65 72 20 52 
15067  70DD 65 63 6F 72 
15067  70E1 64 20 6F 66 
15067  70E5 20 47 61 6C 
15067  70E9 61 78 79 20 
15067  70ED 66 6F 72 20 
15067  70F1 51 75 61 64 
15067  70F5 72 61 6E 74 
15067  70F9 20 25 64 2C 
15067  70FD 25 64 0A 0A 
15067  7101 00 
15068  7102 20 20 20 20 __s132: .db "     1     2     3     4     5     6     7     8", 0
15068  7106 20 31 20 20 
15068  710A 20 20 20 32 
15068  710E 20 20 20 20 
15068  7112 20 33 20 20 
15068  7116 20 20 20 34 
15068  711A 20 20 20 20 
15068  711E 20 35 20 20 
15068  7122 20 20 20 36 
15068  7126 20 20 20 20 
15068  712A 20 37 20 20 
15068  712E 20 20 20 38 
15068  7132 00 
15069  7133 25 73 25 64 __s133: .db "%s%d", 0
15069  7137 00 
15070  7138 20 20 20 53 __s134: .db "   Status Report:\n", 0
15070  713C 74 61 74 75 
15070  7140 73 20 52 65 
15070  7144 70 6F 72 74 
15070  7148 3A 0A 00 
15071  714B 4B 6C 69 6E __s135: .db "Klingon%s Left: %d\n Mission must be completed in %d.%d stardates\n", 0
15071  714F 67 6F 6E 25 
15071  7153 73 20 4C 65 
15071  7157 66 74 3A 20 
15071  715B 25 64 0A 20 
15071  715F 4D 69 73 73 
15071  7163 69 6F 6E 20 
15071  7167 6D 75 73 74 
15071  716B 20 62 65 20 
15071  716F 63 6F 6D 70 
15071  7173 6C 65 74 65 
15071  7177 64 20 69 6E 
15071  717B 20 25 64 2E 
15071  717F 25 64 20 73 
15071  7183 74 61 72 64 
15071  7187 61 74 65 73 
15071  718B 0A 00 
15072  718D 59 6F 75 72 __s136: .db "Your stupidity has left you on your own in the galaxy\n -- you have no starbases left!\n", 0
15072  7191 20 73 74 75 
15072  7195 70 69 64 69 
15072  7199 74 79 20 68 
15072  719D 61 73 20 6C 
15072  71A1 65 66 74 20 
15072  71A5 79 6F 75 20 
15072  71A9 6F 6E 20 79 
15072  71AD 6F 75 72 20 
15072  71B1 6F 77 6E 20 
15072  71B5 69 6E 20 74 
15072  71B9 68 65 20 67 
15072  71BD 61 6C 61 78 
15072  71C1 79 0A 20 2D 
15072  71C5 2D 20 79 6F 
15072  71C9 75 20 68 61 
15072  71CD 76 65 20 6E 
15072  71D1 6F 20 73 74 
15072  71D5 61 72 62 61 
15072  71D9 73 65 73 20 
15072  71DD 6C 65 66 74 
15072  71E1 21 0A 00 
15073  71E4 54 68 65 20 __s137: .db "The Federation is maintaining %d starbase%s in the galaxy\n\n", 0
15073  71E8 46 65 64 65 
15073  71EC 72 61 74 69 
15073  71F0 6F 6E 20 69 
15073  71F4 73 20 6D 61 
15073  71F8 69 6E 74 61 
15073  71FC 69 6E 69 6E 
15073  7200 67 20 25 64 
15073  7204 20 73 74 61 
15073  7208 72 62 61 73 
15073  720C 65 25 73 20 
15073  7210 69 6E 20 74 
15073  7214 68 65 20 67 
15073  7218 61 6C 61 78 
15073  721C 79 0A 0A 00 
15074  7220 46 72 6F 6D __s138: .db "From Enterprise to Klingon battlecriuser%s:\n\n", 0
15074  7224 20 45 6E 74 
15074  7228 65 72 70 72 
15074  722C 69 73 65 20 
15074  7230 74 6F 20 4B 
15074  7234 6C 69 6E 67 
15074  7238 6F 6E 20 62 
15074  723C 61 74 74 6C 
15074  7240 65 63 72 69 
15074  7244 75 73 65 72 
15074  7248 25 73 3A 0A 
15074  724C 0A 00 
15075  724E 4D 72 2E 20 __s139: .db "Mr. Spock reports,\n  'Sensors show no starbases in this quadrant.'\n", 0
15075  7252 53 70 6F 63 
15075  7256 6B 20 72 65 
15075  725A 70 6F 72 74 
15075  725E 73 2C 0A 20 
15075  7262 20 27 53 65 
15075  7266 6E 73 6F 72 
15075  726A 73 20 73 68 
15075  726E 6F 77 20 6E 
15075  7272 6F 20 73 74 
15075  7276 61 72 62 61 
15075  727A 73 65 73 20 
15075  727E 69 6E 20 74 
15075  7282 68 69 73 20 
15075  7286 71 75 61 64 
15075  728A 72 61 6E 74 
15075  728E 2E 27 0A 00 
15076  7292 44 69 72 65 __s140: .db "Direction/Distance Calculator\n You are at quadrant %d,%d sector %d,%d\n\n Please enter initial X coordinate: ", 0
15076  7296 63 74 69 6F 
15076  729A 6E 2F 44 69 
15076  729E 73 74 61 6E 
15076  72A2 63 65 20 43 
15076  72A6 61 6C 63 75 
15076  72AA 6C 61 74 6F 
15076  72AE 72 0A 20 59 
15076  72B2 6F 75 20 61 
15076  72B6 72 65 20 61 
15076  72BA 74 20 71 75 
15076  72BE 61 64 72 61 
15076  72C2 6E 74 20 25 
15076  72C6 64 2C 25 64 
15076  72CA 20 73 65 63 
15076  72CE 74 6F 72 20 
15076  72D2 25 64 2C 25 
15076  72D6 64 0A 0A 20 
15076  72DA 50 6C 65 61 
15076  72DE 73 65 20 65 
15076  72E2 6E 74 65 72 
15076  72E6 20 69 6E 69 
15076  72EA 74 69 61 6C 
15076  72EE 20 58 20 63 
15076  72F2 6F 6F 72 64 
15076  72F6 69 6E 61 74 
15076  72FA 65 3A 20 00 
15077  72FE 50 6C 65 61 __s141: .db "Please enter initial Y coordinate: ", 0
15077  7302 73 65 20 65 
15077  7306 6E 74 65 72 
15077  730A 20 69 6E 69 
15077  730E 74 69 61 6C 
15077  7312 20 59 20 63 
15077  7316 6F 6F 72 64 
15077  731A 69 6E 61 74 
15077  731E 65 3A 20 00 
15078  7322 50 6C 65 61 __s142: .db "Please enter final X coordinate: ", 0
15078  7326 73 65 20 65 
15078  732A 6E 74 65 72 
15078  732E 20 66 69 6E 
15078  7332 61 6C 20 58 
15078  7336 20 63 6F 6F 
15078  733A 72 64 69 6E 
15078  733E 61 74 65 3A 
15078  7342 20 00 
15079  7344 50 6C 65 61 __s143: .db "Please enter final Y coordinate: ", 0
15079  7348 73 65 20 65 
15079  734C 6E 74 65 72 
15079  7350 20 66 69 6E 
15079  7354 61 6C 20 59 
15079  7358 20 63 6F 6F 
15079  735C 72 64 69 6E 
15079  7360 61 74 65 3A 
15079  7364 20 00 
15080  7366 0A 20 20 20 __s144: .db "\n                   The Galaxy\n\n", 0
15080  736A 20 20 20 20 
15080  736E 20 20 20 20 
15080  7372 20 20 20 20 
15080  7376 20 20 20 20 
15080  737A 54 68 65 20 
15080  737E 47 61 6C 61 
15080  7382 78 79 0A 0A 
15080  7386 00 
15081  7387 20 20 20 20 __s145: .db "    1     2     3     4     5     6     7     8\n", 0
15081  738B 31 20 20 20 
15081  738F 20 20 32 20 
15081  7393 20 20 20 20 
15081  7397 33 20 20 20 
15081  739B 20 20 34 20 
15081  739F 20 20 20 20 
15081  73A3 35 20 20 20 
15081  73A7 20 20 36 20 
15081  73AB 20 20 20 20 
15081  73AF 37 20 20 20 
15081  73B3 20 20 38 0A 
15081  73B7 00 
15082  73B8 25 73 25 64 __s146: .db "%s%d ", 0
15082  73BC 20 00 
15083  73BE 20 20 44 49 __s147: .db "  DIRECTION = ", 0
15083  73C2 52 45 43 54 
15083  73C6 49 4F 4E 20 
15083  73CA 3D 20 00 
15084  73CD 25 73 00    __s148: .db "%s", 0
15085  73D0 54 68 65 20 __s149: .db "The Enterprise has been destroyed. The Federation will be conquered.\n", 0
15085  73D4 45 6E 74 65 
15085  73D8 72 70 72 69 
15085  73DC 73 65 20 68 
15085  73E0 61 73 20 62 
15085  73E4 65 65 6E 20 
15085  73E8 64 65 73 74 
15085  73EC 72 6F 79 65 
15085  73F0 64 2E 20 54 
15085  73F4 68 65 20 46 
15085  73F8 65 64 65 72 
15085  73FC 61 74 69 6F 
15085  7400 6E 20 77 69 
15085  7404 6C 6C 20 62 
15085  7408 65 20 63 6F 
15085  740C 6E 71 75 65 
15085  7410 72 65 64 2E 
15085  7414 0A 00 
15086  7416 49 74 20 69 __s150: .db "It is stardate %d.\n\n", 0
15086  741A 73 20 73 74 
15086  741E 61 72 64 61 
15086  7422 74 65 20 25 
15086  7426 64 2E 0A 0A 
15086  742A 00 
15087  742B 54 68 65 72 __s151: .db "There were %d Klingon Battlecruisers left at the end of your mission.\n\n", 0
15087  742F 65 20 77 65 
15087  7433 72 65 20 25 
15087  7437 64 20 4B 6C 
15087  743B 69 6E 67 6F 
15087  743F 6E 20 42 61 
15087  7443 74 74 6C 65 
15087  7447 63 72 75 69 
15087  744B 73 65 72 73 
15087  744F 20 6C 65 66 
15087  7453 74 20 61 74 
15087  7457 20 74 68 65 
15087  745B 20 65 6E 64 
15087  745F 20 6F 66 20 
15087  7463 79 6F 75 72 
15087  7467 20 6D 69 73 
15087  746B 73 69 6F 6E 
15087  746F 2E 0A 0A 00 
15088  7473 43 6F 6E 67 __s152: .db "Congratulations, Captain!  The last Klingon Battle Cruiser\n menacing the Federation has been destoyed.\n", 0
15088  7477 72 61 74 75 
15088  747B 6C 61 74 69 
15088  747F 6F 6E 73 2C 
15088  7483 20 43 61 70 
15088  7487 74 61 69 6E 
15088  748B 21 20 20 54 
15088  748F 68 65 20 6C 
15088  7493 61 73 74 20 
15088  7497 4B 6C 69 6E 
15088  749B 67 6F 6E 20 
15088  749F 42 61 74 74 
15088  74A3 6C 65 20 43 
15088  74A7 72 75 69 73 
15088  74AB 65 72 0A 20 
15088  74AF 6D 65 6E 61 
15088  74B3 63 69 6E 67 
15088  74B7 20 74 68 65 
15088  74BB 20 46 65 64 
15088  74BF 65 72 61 74 
15088  74C3 69 6F 6E 20 
15088  74C7 68 61 73 20 
15088  74CB 62 65 65 6E 
15088  74CF 20 64 65 73 
15088  74D3 74 6F 79 65 
15088  74D7 64 2E 0A 00 
15089  74DB 59 6F 75 72 __s153: .db "Your efficiency rating is %s\n", 0
15089  74DF 20 65 66 66 
15089  74E3 69 63 69 65 
15089  74E7 6E 63 79 20 
15089  74EB 72 61 74 69 
15089  74EF 6E 67 20 69 
15089  74F3 73 20 25 73 
15089  74F7 0A 00 
15090  74F9 54 68 65 20 __s154: .db "The Federation is in need of a new starship commander", 0
15090  74FD 46 65 64 65 
15090  7501 72 61 74 69 
15090  7505 6F 6E 20 69 
15090  7509 73 20 69 6E 
15090  750D 20 6E 65 65 
15090  7511 64 20 6F 66 
15090  7515 20 61 20 6E 
15090  7519 65 77 20 73 
15090  751D 74 61 72 73 
15090  7521 68 69 70 20 
15090  7525 63 6F 6D 6D 
15090  7529 61 6E 64 65 
15090  752D 72 00 
15091  752F 20 66 6F 72 __s155: .db " for a similar mission.\n", 0
15091  7533 20 61 20 73 
15091  7537 69 6D 69 6C 
15091  753B 61 72 20 6D 
15091  753F 69 73 73 69 
15091  7543 6F 6E 2E 0A 
15091  7547 00 
15092  7548 49 66 20 74 __s156: .db "If there is a volunteer, let him step forward and", 0
15092  754C 68 65 72 65 
15092  7550 20 69 73 20 
15092  7554 61 20 76 6F 
15092  7558 6C 75 6E 74 
15092  755C 65 65 72 2C 
15092  7560 20 6C 65 74 
15092  7564 20 68 69 6D 
15092  7568 20 73 74 65 
15092  756C 70 20 66 6F 
15092  7570 72 77 61 72 
15092  7574 64 20 61 6E 
15092  7578 64 00 
15093  757A 20 65 6E 74 __s157: .db " enter 'aye': ", 0
15093  757E 65 72 20 27 
15093  7582 61 79 65 27 
15093  7586 3A 20 00 
15094  7589 61 79 65 00 __s158: .db "aye", 0
15095  758D 53 74 61 72 __s159: .db "Starbase shields protect the Enterprise\n", 0
15095  7591 62 61 73 65 
15095  7595 20 73 68 69 
15095  7599 65 6C 64 73 
15095  759D 20 70 72 6F 
15095  75A1 74 65 63 74 
15095  75A5 20 74 68 65 
15095  75A9 20 45 6E 74 
15095  75AD 65 72 70 72 
15095  75B1 69 73 65 0A 
15095  75B5 00 
15096  75B6 25 64 20 75 __s160: .db "%d unit hit on Enterprise from sector %d, %d\n", 0
15096  75BA 6E 69 74 20 
15096  75BE 68 69 74 20 
15096  75C2 6F 6E 20 45 
15096  75C6 6E 74 65 72 
15096  75CA 70 72 69 73 
15096  75CE 65 20 66 72 
15096  75D2 6F 6D 20 73 
15096  75D6 65 63 74 6F 
15096  75DA 72 20 25 64 
15096  75DE 2C 20 25 64 
15096  75E2 0A 00 
15097  75E4 20 20 20 20 __s161: .db "    <Shields down to %d units>\n\n", 0
15097  75E8 3C 53 68 69 
15097  75EC 65 6C 64 73 
15097  75F0 20 64 6F 77 
15097  75F4 6E 20 74 6F 
15097  75F8 20 25 64 20 
15097  75FC 75 6E 69 74 
15097  7600 73 3E 0A 0A 
15097  7604 00 
15098  7605 44 61 6D 61 __s162: .db "Damage Control reports\n'%s' damaged by hit\n\n", 0
15098  7609 67 65 20 43 
15098  760D 6F 6E 74 72 
15098  7611 6F 6C 20 72 
15098  7615 65 70 6F 72 
15098  7619 74 73 0A 27 
15098  761D 25 73 27 20 
15098  7621 64 61 6D 61 
15098  7625 67 65 64 20 
15098  7629 62 79 20 68 
15098  762D 69 74 0A 0A 
15098  7631 00 
15099  7632 20 20 20 20 __s163: .db "    %s repair completed\n\n", 0
15099  7636 25 73 20 72 
15099  763A 65 70 61 69 
15099  763E 72 20 63 6F 
15099  7642 6D 70 6C 65 
15099  7646 74 65 64 0A 
15099  764A 0A 00 
15100  764C 20 20 20 20 __s164: .db "    %s damaged\n\n", 0
15100  7650 25 73 20 64 
15100  7654 61 6D 61 67 
15100  7658 65 64 0A 0A 
15100  765C 00 
15101  765D 20 20 20 20 __s165: .db "    %s state of repair improved\n\n", 0
15101  7661 25 73 20 73 
15101  7665 74 61 74 65 
15101  7669 20 6F 66 20 
15101  766D 72 65 70 61 
15101  7671 69 72 20 69 
15101  7675 6D 70 72 6F 
15101  7679 76 65 64 0A 
15101  767D 0A 00 
15102  767F 20 49 00    __s166: .db " I", 0
15103  7682 20 49 49 00 __s167: .db " II", 0
15104  7686 20 49 49 49 __s168: .db " III", 0
15104  768A 00 
15105  768B 20 49 56 00 __s169: .db " IV", 0
15106  768F 55 6E 6B 6E __s170: .db "Unknown", 0
15106  7693 6F 77 6E 00 
15107  7697             
15108  7697 99 76       _heap_top: .dw _heap
15109  7699 00          _heap: .db 0
15110  769A             ; --- END DATA BLOCK
15111  769A             
15112  769A             .end
tasm: Number of errors = 54
