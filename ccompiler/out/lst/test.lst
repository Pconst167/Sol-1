0001   0000             ; --- FILENAME: test.c
0002   0000             .include "lib/asm/kernel.exp"
0001+  0000             text_org    .EQU  $0400
0002+  0000             sys_bkpt         .EQU  $0000
0003+  0000             sys_rtc          .EQU  $0001
0004+  0000             sys_ide          .EQU  $0002
0005+  0000             sys_io           .EQU  $0003
0006+  0000             sys_filesystem   .EQU  $0004
0007+  0000             sys_spawn_proc   .EQU  $0005
0008+  0000             sys_list         .EQU  $0006
0009+  0000             sys_datetime     .EQU  $0007
0010+  0000             sys_reboot       .EQU  $0008
0011+  0000             sys_pause_proc   .EQU  $0009
0012+  0000             sys_resume_proc  .EQU  $000a
0013+  0000             sys_terminate_proc .EQU  $000b
0014+  0000             sys_system       .EQU  $000c
0015+  0000             sys_boot_install .EQU  $000d
0003   0000             .include "lib/asm/bios.exp"
0001+  0000             BIOS_RESET_VECTOR .EQU  $01c0
0002+  0000             IDE_buffer       .EQU  $8204
0003+  0000             boot_origin      .EQU  $8004
0004+  0000             bios_uart        .EQU  $0002
0005+  0000             bios_ide         .EQU  $0003
0004   0400             .org text_org
0005   0400             
0006   0400             ; --- BEGIN TEXT SEGMENT
0007   0400             main:
0008   0400 FD 49 E0 FF   mov bp, $FFE0 ;
0009   0404 FD 47 E0 FF   mov sp, $FFE0 ; Make space for argc(2 bytes) and for 10 pointers in argv (local variables)
0010   0408             ; struct s1 mys2 = mys1; 
0011   0408 52 07 00      sub sp, 7
0012   040B             ; --- START LOCAL VAR INITIALIZATION
0013   040B FA FA FF      lea d, [bp + -6] ; $mys2
0014   040E DA            push d
0015   040F                            
0016   040F 3B 25 04      mov d, _mys1_data ; $mys1
0017   0412 2D            mov b, d
0018   0413 38 00 00      mov c, 0
0019   0416 E7            pop d
0020   0417 FD 28         mov si, b
0021   0419 FD 50         mov di, d
0022   041B 38 07 00      mov c, 7
0023   041E FD F5         rep movsb
0024   0420             ; --- END LOCAL VAR INITIALIZATION
0025   0420             ; "hello world"; 
0026   0420                            
0027   0420 26 2C 04      mov b, _s0 ; "hello world"
0028   0423 05 0B         syscall sys_terminate_proc
0029   0425             ; --- END TEXT SEGMENT
0030   0425             
0031   0425             ; --- BEGIN DATA SEGMENT
0032   0425 00 00 00 00 _mys1_data: .fill 7, 0
0032   0429 00 00 00 
0033   042C 68 65 6C 6C _s0: .db "hello world", 0
0033   0430 6F 20 77 6F 
0033   0434 72 6C 64 00 
0034   0438             
0035   0438 3A 04       _heap_top: .dw _heap
0036   043A 00          _heap: .db 0
0037   043B             ; --- END DATA SEGMENT
0038   043B             
0039   043B             .end
tasm: Number of errors = 0
